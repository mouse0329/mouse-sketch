const _0x38107e=_0x51ce;(function(_0x38326f,_0xc29795){const _0x29db5d=_0x51ce,_0x3ee37d=_0x38326f();while(!![]){try{const _0xdbbdff=-parseInt(_0x29db5d(0x1f3))/0x1*(parseInt(_0x29db5d(0x190))/0x2)+parseInt(_0x29db5d(0x1d8))/0x3*(parseInt(_0x29db5d(0x187))/0x4)+-parseInt(_0x29db5d(0x1ac))/0x5+parseInt(_0x29db5d(0x1ec))/0x6+-parseInt(_0x29db5d(0x1ee))/0x7*(-parseInt(_0x29db5d(0x1ef))/0x8)+parseInt(_0x29db5d(0x1c1))/0x9+-parseInt(_0x29db5d(0x185))/0xa;if(_0xdbbdff===_0xc29795)break;else _0x3ee37d['push'](_0x3ee37d['shift']());}catch(_0x3576c6){_0x3ee37d['push'](_0x3ee37d['shift']());}}}(_0xfdf8,0xd72d0));const _0x2a9ba2=(function(){let _0x50e8f3=!![];return function(_0x4610c7,_0x8b7027){const _0x4b21ba=_0x50e8f3?function(){const _0x43eba8=_0x51ce;if(_0x8b7027){const _0x3eda2e=_0x8b7027[_0x43eba8(0x18b)](_0x4610c7,arguments);return _0x8b7027=null,_0x3eda2e;}}:function(){};return _0x50e8f3=![],_0x4b21ba;};}()),_0x1967c9=_0x2a9ba2(this,function(){const _0x76e24b=_0x51ce;return _0x1967c9[_0x76e24b(0x1f9)]()['search'](_0x76e24b(0x1bc))[_0x76e24b(0x1f9)]()[_0x76e24b(0x1a5)](_0x1967c9)['search'](_0x76e24b(0x1bc));});_0x1967c9(),window[_0x38107e(0x172)]('DOMContentLoaded',()=>{const _0x5df978=_0x38107e,_0x7eb5df=document[_0x5df978(0x1e9)]('penAlphaMode');_0x7eb5df&&(_0x7eb5df[_0x5df978(0x195)]=penAlphaMode,_0x7eb5df[_0x5df978(0x1a0)]=_0x4b65ae=>{const _0x344fa2=_0x5df978;penAlphaMode=_0x4b65ae[_0x344fa2(0x1df)][_0x344fa2(0x195)];});const _0x3e5911=document[_0x5df978(0x1e9)](_0x5df978(0x1b5));if(_0x3e5911){const _0x270ec8=localStorage[_0x5df978(0x17f)](_0x5df978(0x1f7))||_0x5df978(0x181);applyTheme(_0x270ec8),_0x3e5911[_0x5df978(0x172)](_0x5df978(0x19a),()=>{toggleTheme();});}window[_0x5df978(0x172)]('resize',updateMenuBtnDisplay),updateMenuBtnDisplay();const _0x3ce247=document[_0x5df978(0x1e9)](_0x5df978(0x1aa)),_0x560a73=document['getElementById'](_0x5df978(0x1f8)),_0x5954f9=document[_0x5df978(0x1e9)](_0x5df978(0x173)),_0x59a8eb=document[_0x5df978(0x196)](_0x5df978(0x18c)),_0x30e6c5=document[_0x5df978(0x196)](_0x5df978(0x1ba)),_0x4cfce5=_0x5954f9?_0x5954f9[_0x5df978(0x1d0)]:null,_0x4ab473=_0x5954f9?_0x5954f9[_0x5df978(0x1f5)]:null;let _0x29810d=null;function _0x240707(){const _0xed4f5d=_0x5df978;try{if(!_0x5954f9)return;const _0x2c6c0f=window[_0xed4f5d(0x178)],_0xe6c562=_0x2c6c0f<=0x384;if(_0xe6c562&&_0x59a8eb&&_0x5954f9['parentNode']!==_0x59a8eb){if(_0x29810d===null)_0x29810d=_0x5954f9['getAttribute'](_0xed4f5d(0x1e1))||'';_0x59a8eb[_0xed4f5d(0x1ae)](_0x5954f9),_0x5954f9['classList'][_0xed4f5d(0x1ab)](_0xed4f5d(0x189));const _0x3a52b9=_0x30e6c5?_0x30e6c5[_0xed4f5d(0x18f)]:0x38;_0x5954f9[_0xed4f5d(0x1e1)][_0xed4f5d(0x1f2)]=_0xed4f5d(0x17e),_0x5954f9[_0xed4f5d(0x1e1)][_0xed4f5d(0x1d3)]=_0xed4f5d(0x1f4),_0x5954f9[_0xed4f5d(0x1e1)][_0xed4f5d(0x169)]=_0xed4f5d(0x1f4),_0x5954f9[_0xed4f5d(0x1e1)][_0xed4f5d(0x163)]=_0x3a52b9+0x8+'px',_0x5954f9[_0xed4f5d(0x1e1)]['zIndex']=0x1770,_0x5954f9['style'][_0xed4f5d(0x162)]=_0xed4f5d(0x197),_0x5954f9['style'][_0xed4f5d(0x19b)]=_0xed4f5d(0x1b2),_0x5954f9[_0xed4f5d(0x1e1)][_0xed4f5d(0x1c4)]='none';}else{if(!_0xe6c562&&_0x4cfce5&&_0x5954f9[_0xed4f5d(0x1d0)]!==_0x4cfce5){_0x4ab473&&_0x4ab473[_0xed4f5d(0x1d0)]===_0x4cfce5?_0x4cfce5[_0xed4f5d(0x1dd)](_0x5954f9,_0x4ab473):_0x4cfce5[_0xed4f5d(0x1ae)](_0x5954f9);_0x5954f9[_0xed4f5d(0x1dc)][_0xed4f5d(0x1b9)](_0xed4f5d(0x189));if(_0x29810d!==null){if(_0x29810d==='')_0x5954f9[_0xed4f5d(0x18a)](_0xed4f5d(0x1e1));else _0x5954f9[_0xed4f5d(0x1b1)]('style',_0x29810d);_0x29810d=null;}}else{if(_0xe6c562&&_0x5954f9[_0xed4f5d(0x1d0)]===_0x59a8eb){const _0x1521da=_0x30e6c5?_0x30e6c5['offsetHeight']:0x38;_0x5954f9[_0xed4f5d(0x1e1)]['bottom']=_0x1521da+0x8+'px';}}}}catch(_0x48f9f0){console[_0xed4f5d(0x16b)]('relocateRightToolbar\x20error',_0x48f9f0);}}_0x3ce247&&(_0x3ce247[_0x5df978(0x1e1)]['display']=_0x5df978(0x164),_0x3ce247[_0x5df978(0x172)]('click',()=>{const _0x2ca1eb=_0x5df978;if(window['innerWidth']<=0x384&&_0x5954f9){const _0x1f1812=_0x5954f9[_0x2ca1eb(0x1e1)]['display']!==_0x2ca1eb(0x1e0);_0x5954f9[_0x2ca1eb(0x1e1)][_0x2ca1eb(0x1c4)]=_0x1f1812?_0x2ca1eb(0x1e0):_0x2ca1eb(0x1d1),_0x5954f9['classList']['toggle'](_0x2ca1eb(0x182),!_0x1f1812);}else _0x560a73&&_0x560a73[_0x2ca1eb(0x1dc)][_0x2ca1eb(0x1d9)](_0x2ca1eb(0x17d));}));window[_0x5df978(0x172)](_0x5df978(0x1ea),_0x240707),_0x240707();const _0x26beb0=document[_0x5df978(0x1e9)](_0x5df978(0x1c5));_0x26beb0&&(_0x26beb0[_0x5df978(0x1b8)]=_0x4ff6ed=>setZoomValue(_0x4ff6ed[_0x5df978(0x1df)][_0x5df978(0x195)]));const _0x2ddc45=document[_0x5df978(0x1e9)]('openColorPickerBtn'),_0x5e291c=document[_0x5df978(0x1e9)](_0x5df978(0x1c7));function _0x44fab5(){const _0x1b6769=_0x5df978;if(typeof showColorPickerDialog!==_0x1b6769(0x16f))return;const _0x4cbae3=currentColor===_0x1b6769(0x168)||!currentColor?_0x1b6769(0x1a9):currentColor;showColorPickerDialog({'color':_0x4cbae3,'alpha':typeof currentAlpha===_0x1b6769(0x19e)?currentAlpha:0x1,'onChange':({hex:_0x38167f,rgba:_0x47b574,a:_0x563dde})=>{const _0x2ab377=_0x1b6769;try{_0x47b574&&_0x47b574[0x3]===0x0?(currentColor=_0x2ab377(0x168),currentAlpha=0x0):(currentColor=_0x38167f||(_0x47b574?rgbToHex(_0x47b574[0x0],_0x47b574[0x1],_0x47b574[0x2]):_0x4cbae3),currentAlpha=_0x47b574&&typeof _0x47b574[0x3]===_0x2ab377(0x19e)?_0x47b574[0x3]:_0x563dde||0x1);updateCurrentColorSwatch();const _0x5b3518=document[_0x2ab377(0x1e9)](_0x2ab377(0x194));if(_0x5b3518&&currentColor!==_0x2ab377(0x168))_0x5b3518[_0x2ab377(0x195)]=currentColor;}catch(_0x4acf84){console[_0x2ab377(0x16b)](_0x2ab377(0x1bf),_0x4acf84);}},'onOk':({hex:_0x5351dd,rgba:_0x4f7aea,a:_0xa523c0})=>{const _0x112aa8=_0x1b6769;_0x4f7aea&&_0x4f7aea[0x3]===0x0?(currentColor=_0x112aa8(0x168),currentAlpha=0x0):(currentColor=_0x5351dd||(_0x4f7aea?rgbToHex(_0x4f7aea[0x0],_0x4f7aea[0x1],_0x4f7aea[0x2]):_0x4cbae3),currentAlpha=_0x4f7aea&&typeof _0x4f7aea[0x3]===_0x112aa8(0x19e)?_0x4f7aea[0x3]:_0xa523c0||0x1);updateCurrentColorSwatch();const _0x55e629=document[_0x112aa8(0x1e9)](_0x112aa8(0x194));if(_0x55e629&&currentColor!==_0x112aa8(0x168))_0x55e629['value']=currentColor;}});}if(_0x2ddc45)_0x2ddc45['addEventListener'](_0x5df978(0x19a),_0x44fab5);if(_0x5e291c)_0x5e291c[_0x5df978(0x172)]('click',_0x44fab5);const _0xbb09a7=document[_0x5df978(0x1e9)](_0x5df978(0x1da)),_0x4f4e8b=document['getElementById']('pasteLayerBtn');if(_0xbb09a7)_0xbb09a7[_0x5df978(0x172)](_0x5df978(0x19a),()=>{const _0x466d42=_0x5df978;try{copyLayer();}catch(_0xd9fc2d){console[_0x466d42(0x16b)](_0x466d42(0x1ad),_0xd9fc2d);}});_0x4f4e8b&&(_0x4f4e8b['addEventListener'](_0x5df978(0x19a),()=>{const _0x12fb81=_0x5df978;try{pasteLayer();}catch(_0x1635b1){console[_0x12fb81(0x16b)](_0x12fb81(0x171),_0x1635b1);}}),_0x4f4e8b[_0x5df978(0x1b7)]=!copiedLayerDataUrl);let _0x507654=![],_0x4412f7=null;function _0x28d082(_0x3bc1b9){const _0x5cea62=_0x5df978;if(!_0x3bc1b9)return![];const _0x55093a=_0x3bc1b9[_0x5cea62(0x17b)]&&_0x3bc1b9[_0x5cea62(0x17b)][_0x5cea62(0x183)]();if(_0x55093a===_0x5cea62(0x19f)||_0x55093a===_0x5cea62(0x166)||_0x55093a===_0x5cea62(0x1a6))return!![];if(_0x3bc1b9[_0x5cea62(0x1fc)])return!![];return![];}window[_0x5df978(0x172)](_0x5df978(0x17c),_0x315d7e=>{const _0x3f7bce=_0x5df978;_0x315d7e[_0x3f7bce(0x1c8)]===_0x3f7bce(0x191)&&!_0x507654&&!_0x28d082(document[_0x3f7bce(0x1b3)])&&(_0x4412f7=currentTool,setTool(_0x3f7bce(0x1bd)),_0x507654=!![]);},{'passive':!![]}),window[_0x5df978(0x172)](_0x5df978(0x18d),_0x16f9a4=>{const _0x34fe25=_0x5df978;if(_0x16f9a4[_0x34fe25(0x1c8)]==='Shift'&&_0x507654){if(currentTool==='pan'&&_0x4412f7)setTool(_0x4412f7);_0x4412f7=null,_0x507654=![];}},{'passive':!![]}),window[_0x5df978(0x172)](_0x5df978(0x17c),_0x555951=>{const _0x18fdd4=_0x5df978;if(_0x28d082(document[_0x18fdd4(0x1b3)]))return;const _0x32b1e6=navigator['platform']&&navigator['platform']['toUpperCase']()[_0x18fdd4(0x1e4)](_0x18fdd4(0x1fa))>=0x0,_0x45380d=_0x32b1e6?_0x555951[_0x18fdd4(0x184)]:_0x555951[_0x18fdd4(0x1a4)];if(!_0x45380d)return;const _0x4a2c2a=(_0x555951[_0x18fdd4(0x1c8)]||'')[_0x18fdd4(0x183)]();if(_0x4a2c2a==='z'&&!_0x555951[_0x18fdd4(0x1e3)]){_0x555951[_0x18fdd4(0x1cd)]();try{undo();}catch(_0x404de3){console[_0x18fdd4(0x16b)]('undo\x20shortcut\x20error',_0x404de3);}}else{if(_0x4a2c2a==='z'&&_0x555951[_0x18fdd4(0x1e3)]||_0x4a2c2a==='y'){_0x555951[_0x18fdd4(0x1cd)]();try{redo();}catch(_0x488047){console['error'](_0x18fdd4(0x177),_0x488047);}}}},{'passive':![]}),window[_0x5df978(0x1d2)]=function(){const _0x4ef24b=_0x5df978;if(document[_0x4ef24b(0x1e9)](_0x4ef24b(0x1cb)))return;const _0x1c1f54=document[_0x4ef24b(0x1cc)]('div');_0x1c1f54['id']=_0x4ef24b(0x1cb),_0x1c1f54[_0x4ef24b(0x1e1)][_0x4ef24b(0x1f2)]=_0x4ef24b(0x17e),_0x1c1f54['style'][_0x4ef24b(0x1d3)]='0',_0x1c1f54['style'][_0x4ef24b(0x1fb)]='0',_0x1c1f54[_0x4ef24b(0x1e1)][_0x4ef24b(0x162)]=_0x4ef24b(0x1e6),_0x1c1f54[_0x4ef24b(0x1e1)]['height']=_0x4ef24b(0x1b4),_0x1c1f54['style'][_0x4ef24b(0x1c4)]=_0x4ef24b(0x1c3),_0x1c1f54['style'][_0x4ef24b(0x1e8)]=_0x4ef24b(0x1d6),_0x1c1f54[_0x4ef24b(0x1e1)][_0x4ef24b(0x1c9)]=_0x4ef24b(0x1d6),_0x1c1f54[_0x4ef24b(0x1e1)]['zIndex']=0x2710,_0x1c1f54[_0x4ef24b(0x1e1)][_0x4ef24b(0x1e2)]='rgba(0,0,0,0.35)';const _0x596806=window['NEZUMI_BUILD_META']||{},_0x2a108c=_0x596806['version']||'不明',_0x33cc5f=_0x596806['id']||'不明';_0x1c1f54[_0x4ef24b(0x16c)]=_0x4ef24b(0x1a1)+_0x2a108c+_0x4ef24b(0x18e)+_0x33cc5f+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>©\x202025\x20nezumi-sketch\x20<a\x20href=\x22https://github.com/mouse0329\x22\x20rel=\x22noopener\x20noreferrer\x22>github\x20mouse0329</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><a\x20href=\x22/terms\x22>利用規約</a>\u3000<a\x20href=\x22/license\x22>ライセンス</a>\u3000<a\x20href=\x22/about\x22>紹介ページ</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:right;margin-top:10px;\x22><button\x20id=\x22aboutCloseBtn\x22>閉じる</button></div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',document[_0x4ef24b(0x199)][_0x4ef24b(0x1ae)](_0x1c1f54),_0x1c1f54[_0x4ef24b(0x196)](_0x4ef24b(0x1f0))['onclick']=()=>_0x1c1f54[_0x4ef24b(0x1b9)](),_0x1c1f54[_0x4ef24b(0x172)](_0x4ef24b(0x19a),_0x470aa3=>{const _0x3c4780=_0x4ef24b;if(_0x470aa3[_0x3c4780(0x1df)]===_0x1c1f54)_0x1c1f54[_0x3c4780(0x1b9)]();});};const _0x1ef304=document[_0x5df978(0x1e9)](_0x5df978(0x198)),_0x58f485=document[_0x5df978(0x1e9)]('nudgeDownBtn'),_0x19e0b3=document['getElementById'](_0x5df978(0x1de)),_0x170134=document[_0x5df978(0x1e9)](_0x5df978(0x16e)),_0x179e18=document['getElementById'](_0x5df978(0x1d5));function _0x4bdabc(){let _0x4ea963=0x1;if(_0x179e18){_0x4ea963=parseInt(_0x179e18['value'],0xa)||0x1;if(_0x4ea963<0x1)_0x4ea963=0x1;}return _0x4ea963;}if(_0x1ef304)_0x1ef304[_0x5df978(0x172)](_0x5df978(0x19a),()=>nudgeActiveLayer(0x0,-_0x4bdabc()));if(_0x58f485)_0x58f485[_0x5df978(0x172)](_0x5df978(0x19a),()=>nudgeActiveLayer(0x0,_0x4bdabc()));if(_0x19e0b3)_0x19e0b3[_0x5df978(0x172)](_0x5df978(0x19a),()=>nudgeActiveLayer(-_0x4bdabc(),0x0));if(_0x170134)_0x170134[_0x5df978(0x172)](_0x5df978(0x19a),()=>nudgeActiveLayer(_0x4bdabc(),0x0));}),window['onload']=()=>{const _0x5dc830=_0x38107e;canvas=document[_0x5dc830(0x1e9)](_0x5dc830(0x1be)),wrapper=document[_0x5dc830(0x1e9)]('canvas-container')||canvas?.[_0x5dc830(0x192)]||null;if(!canvas){console[_0x5dc830(0x16b)](_0x5dc830(0x19d));return;}ctx=canvas[_0x5dc830(0x176)]('2d'),projects=[createProject()],activeProject=0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),initCanvas(),setTool(_0x5dc830(0x1ce)),updateCurrentColorSwatch(),loadPaletteFromDB()[_0x5dc830(0x1c2)](()=>createPalette());const _0x149336=document[_0x5dc830(0x1e9)](_0x5dc830(0x17a));if(_0x149336)_0x149336['value']=penSize;const _0x4148e2=document[_0x5dc830(0x1e9)]('penMode');if(_0x4148e2)_0x4148e2['value']=penMode;const _0x12c45e=document[_0x5dc830(0x1e9)](_0x5dc830(0x1e7)),_0x55345b=document[_0x5dc830(0x1e9)]('animSpeedValue');_0x12c45e&&_0x55345b&&((!Number['isFinite'](animationDelay)||animationDelay<=0x0)&&(animationDelay=0x12c),_0x12c45e[_0x5dc830(0x195)]=animationDelay,_0x55345b[_0x5dc830(0x195)]=animationDelay,_0x12c45e['oninput']=_0x543800=>{const _0x5d3f99=_0x5dc830;_0x55345b['value']=_0x543800[_0x5d3f99(0x1df)]['value'],setAnimationDelay(_0x543800[_0x5d3f99(0x1df)][_0x5d3f99(0x195)]);},_0x55345b[_0x5dc830(0x1a0)]=_0x3939e2=>{const _0x3f58a7=_0x5dc830;let _0x3c426f=Math[_0x3f58a7(0x1d7)](0xa,Math[_0x3f58a7(0x1eb)](0x1388,parseInt(_0x3939e2['target'][_0x3f58a7(0x195)],0xa)||animationDelay));_0x12c45e['value']=_0x3c426f,_0x55345b[_0x3f58a7(0x195)]=_0x3c426f,setAnimationDelay(_0x3c426f);});canvas['onmousedown']=handleMouseDown,canvas[_0x5dc830(0x188)]=handleMouseMove,canvas[_0x5dc830(0x174)]=handleMouseUp,canvas['onmouseleave']=handleMouseUp,canvas['ontouchstart']=handleTouchStart,canvas[_0x5dc830(0x1a2)]=handleTouchMove,canvas['ontouchend']=handleTouchEnd,canvas['ontouchcancel']=handleTouchEnd,canvas[_0x5dc830(0x172)](_0x5dc830(0x193),handleTouchStart,{'passive':![]}),canvas[_0x5dc830(0x172)](_0x5dc830(0x1d4),handleTouchMove,{'passive':![]}),canvas['addEventListener'](_0x5dc830(0x165),handleTouchEnd,{'passive':![]}),canvas[_0x5dc830(0x172)](_0x5dc830(0x1a7),handleTouchEnd,{'passive':![]});try{showLoading(_0x5dc830(0x179));}catch(_0x596b7c){}loadProjectFromIDB()['catch'](_0x2560e6=>{const _0x4e9ee9=_0x5dc830;console[_0x4e9ee9(0x1b0)](_0x4e9ee9(0x1bb),_0x2560e6);})['finally'](()=>{const _0x12d852=_0x5dc830;try{hideLoading();}catch(_0x1d987e){}if(typeof window[_0x12d852(0x1a3)]===_0x12d852(0x16f))window[_0x12d852(0x1a3)]();});};function handleMouseDown(_0xb96441){const _0x3ab2a7=_0x38107e;if(currentTool===_0x3ab2a7(0x1bd)){isDrawing=!![],panStart={'x':_0xb96441[_0x3ab2a7(0x16a)],'y':_0xb96441['clientY'],'posX':posX,'posY':posY},canvas[_0x3ab2a7(0x1e1)]['cursor']=_0x3ab2a7(0x1c0);return;}isDrawing=!![],saveHistory();const _0x3f1f79=getCanvasCoords(_0xb96441),_0xec7018=Math[_0x3ab2a7(0x1ed)](_0x3f1f79['x']/cellSize),_0x157cd5=Math['floor'](_0x3f1f79['y']/cellSize);currentTool==='fill'?(fillAt(_0xec7018,_0x157cd5),saveHistory(),isDrawing=![],lastMouse=null):(drawDotXY(_0xec7018,_0x157cd5),lastMouse={'x':_0xec7018,'y':_0x157cd5});}function handleMouseMove(_0x30d76a){const _0x2ae5be=_0x38107e;if(!isDrawing)return;if(currentTool===_0x2ae5be(0x1bd)&&panStart){const _0x486b7f=_0x30d76a[_0x2ae5be(0x16a)]-panStart['x'],_0x787c35=_0x30d76a['clientY']-panStart['y'];posX=panStart[_0x2ae5be(0x1c6)]+_0x486b7f,posY=panStart['posY']+_0x787c35,updateTransform();return;}const _0x1ef26a=getCanvasCoords(_0x30d76a),_0xa2b629=Math['floor'](_0x1ef26a['x']/cellSize),_0x57dd0e=Math[_0x2ae5be(0x1ed)](_0x1ef26a['y']/cellSize);if(!lastMouse){drawDotXY(_0xa2b629,_0x57dd0e),lastMouse={'x':_0xa2b629,'y':_0x57dd0e};return;}const _0x5ca7b5=_0xa2b629-lastMouse['x'],_0x121e1e=_0x57dd0e-lastMouse['y'],_0x4ef06d=Math['max'](Math[_0x2ae5be(0x186)](_0x5ca7b5),Math[_0x2ae5be(0x186)](_0x121e1e));if(_0x4ef06d<=0x1)drawDotXY(_0xa2b629,_0x57dd0e);else for(let _0x507002=0x1;_0x507002<=_0x4ef06d;_0x507002++){const _0x5592e5=Math[_0x2ae5be(0x1af)](lastMouse['x']+_0x5ca7b5*_0x507002/_0x4ef06d),_0x37678f=Math[_0x2ae5be(0x1af)](lastMouse['y']+_0x121e1e*_0x507002/_0x4ef06d);drawDotXY(_0x5592e5,_0x37678f);}lastMouse={'x':_0xa2b629,'y':_0x57dd0e};}function _0x51ce(_0x5395f1,_0x5f10c1){_0x5395f1=_0x5395f1-0x162;const _0x3b9ef6=_0xfdf8();let _0x1967c9=_0x3b9ef6[_0x5395f1];return _0x1967c9;}function handleMouseUp(_0xfe1a77){const _0x33f788=_0x38107e;if(currentTool==='pan'){isDrawing=![],panStart=null,canvas[_0x33f788(0x1e1)][_0x33f788(0x170)]=_0x33f788(0x1a8);return;}isDrawing&&saveHistory(),isDrawing=![],lastMouse=null;}function handleTouchStart(_0x39ad46){const _0x3b4cff=_0x38107e;if(_0x39ad46[_0x3b4cff(0x1cf)]['length']===0x2){_0x39ad46[_0x3b4cff(0x1cd)](),isPinching=!![],isDrawing=![],lastTouch=null;const _0x3b3974=_0x39ad46[_0x3b4cff(0x1cf)][0x0],_0xf6bc4c=_0x39ad46[_0x3b4cff(0x1cf)][0x1];pinchStartDistance=Math[_0x3b4cff(0x1e5)](_0xf6bc4c[_0x3b4cff(0x16a)]-_0x3b3974[_0x3b4cff(0x16a)],_0xf6bc4c['clientY']-_0x3b3974[_0x3b4cff(0x1b6)]),pinchStartMid={'clientX':(_0x3b3974[_0x3b4cff(0x16a)]+_0xf6bc4c[_0x3b4cff(0x16a)])/0x2,'clientY':(_0x3b3974['clientY']+_0xf6bc4c[_0x3b4cff(0x1b6)])/0x2},pinchStartScale=scale,pinchStartPosX=posX,pinchStartPosY=posY,pinchRect=canvas[_0x3b4cff(0x1f1)]();}else{if(_0x39ad46[_0x3b4cff(0x1cf)]['length']===0x1){if(colorPickMode){_0x39ad46[_0x3b4cff(0x1cd)]();const _0xd6a73e=_0x39ad46[_0x3b4cff(0x1cf)][0x0];onCanvasColorPick({'clientX':_0xd6a73e[_0x3b4cff(0x16a)],'clientY':_0xd6a73e['clientY']});return;}_0x39ad46[_0x3b4cff(0x1cd)]();if(isPinching)return;const _0x72d2b3=_0x39ad46[_0x3b4cff(0x1cf)][0x0];if(currentTool===_0x3b4cff(0x1bd)){isDrawing=!![],panStart={'x':_0x72d2b3['clientX'],'y':_0x72d2b3[_0x3b4cff(0x1b6)],'posX':posX,'posY':posY};if(canvas)canvas[_0x3b4cff(0x1e1)][_0x3b4cff(0x170)]=_0x3b4cff(0x1c0);return;}isDrawing=!![],saveHistory();let _0x16b5cf=getTouchPos(_0x39ad46);lastTouch=_0x16b5cf,currentTool===_0x3b4cff(0x180)?(fillAt(_0x16b5cf['x'],_0x16b5cf['y']),saveHistory(),isDrawing=![]):drawDotTouch(_0x16b5cf['x'],_0x16b5cf['y']);}}}function handleTouchMove(_0x41352e){const _0x50d80e=_0x38107e;if(isPinching||_0x41352e[_0x50d80e(0x1cf)]&&_0x41352e[_0x50d80e(0x1cf)][_0x50d80e(0x1db)]===0x2){_0x41352e[_0x50d80e(0x1cd)](),isDrawing=![],lastTouch=null;const _0x250634=_0x41352e['touches'][0x0],_0x297976=_0x41352e[_0x50d80e(0x1cf)][0x1],_0x2a6384=Math['hypot'](_0x297976[_0x50d80e(0x16a)]-_0x250634[_0x50d80e(0x16a)],_0x297976[_0x50d80e(0x1b6)]-_0x250634[_0x50d80e(0x1b6)]),_0x42681f={'clientX':(_0x250634[_0x50d80e(0x16a)]+_0x297976[_0x50d80e(0x16a)])/0x2,'clientY':(_0x250634[_0x50d80e(0x1b6)]+_0x297976[_0x50d80e(0x1b6)])/0x2};if(!pinchStartDistance)pinchStartDistance=_0x2a6384||0x1;const _0x3ea9dc=_0x2a6384/pinchStartDistance||0x1;let _0x483682=pinchStartScale*_0x3ea9dc;_0x483682=Math[_0x50d80e(0x1eb)](Math[_0x50d80e(0x1d7)](_0x483682,0.2),0x5);const _0x5b8b0e=pinchRect||canvas['getBoundingClientRect'](),_0x132518=(pinchStartMid[_0x50d80e(0x16a)]-_0x5b8b0e[_0x50d80e(0x1d3)]-pinchStartPosX)/pinchStartScale,_0x18ceea=(pinchStartMid['clientY']-_0x5b8b0e[_0x50d80e(0x1fb)]-pinchStartPosY)/pinchStartScale;posX=_0x42681f[_0x50d80e(0x16a)]-_0x5b8b0e[_0x50d80e(0x1d3)]-_0x132518*_0x483682,posY=_0x42681f['clientY']-_0x5b8b0e['top']-_0x18ceea*_0x483682,scale=_0x483682,updateTransform();return;}if(currentTool===_0x50d80e(0x1bd)&&panStart&&_0x41352e[_0x50d80e(0x1cf)]&&_0x41352e['touches'][0x0]){_0x41352e[_0x50d80e(0x1cd)]();const _0xfb5995=_0x41352e['touches'][0x0],_0x5a3d0d=_0xfb5995[_0x50d80e(0x16a)]-panStart['x'],_0x20a216=_0xfb5995[_0x50d80e(0x1b6)]-panStart['y'];posX=panStart[_0x50d80e(0x1c6)]+_0x5a3d0d,posY=panStart['posY']+_0x20a216,updateTransform();return;}if(!isDrawing)return;if(_0x41352e[_0x50d80e(0x1cf)]&&_0x41352e[_0x50d80e(0x1cf)][_0x50d80e(0x1db)]>0x1)return;_0x41352e[_0x50d80e(0x1cd)]();let _0x25a49e=getTouchPos(_0x41352e);if(lastTouch){let _0x1113ad=Math[_0x50d80e(0x186)]((_0x25a49e['x']-lastTouch['x'])*cellSize),_0x35796a=Math['abs']((_0x25a49e['y']-lastTouch['y'])*cellSize);if(_0x1113ad>=PAN_CANCEL_DISTANCE||_0x35796a>=PAN_CANCEL_DISTANCE){if(currentTool!==_0x50d80e(0x1ce)){isDrawing=![];return;}}}if(lastTouch){let _0x2c5be4=_0x25a49e['x']-lastTouch['x'],_0x827233=_0x25a49e['y']-lastTouch['y'],_0x3cac49=Math[_0x50d80e(0x1d7)](Math[_0x50d80e(0x186)](_0x2c5be4),Math[_0x50d80e(0x186)](_0x827233));for(let _0x4ad56f=0x1;_0x4ad56f<=_0x3cac49;_0x4ad56f++){let _0x131d74=Math[_0x50d80e(0x1af)](lastTouch['x']+_0x2c5be4*_0x4ad56f/_0x3cac49),_0x460f2d=Math['round'](lastTouch['y']+_0x827233*_0x4ad56f/_0x3cac49);drawDotTouch(_0x131d74,_0x460f2d);}}else drawDotTouch(_0x25a49e['x'],_0x25a49e['y']);lastTouch=_0x25a49e;}function handleTouchEnd(_0x4f26f9){const _0x40e47b=_0x38107e;isPinching&&_0x4f26f9[_0x40e47b(0x1cf)]&&_0x4f26f9[_0x40e47b(0x1cf)]['length']<0x2&&(isPinching=![],pinchStartDistance=0x0,pinchStartMid=null,pinchRect=null);isDrawing&&(!_0x4f26f9[_0x40e47b(0x1cf)]||_0x4f26f9[_0x40e47b(0x1cf)][_0x40e47b(0x1db)]===0x0)&&saveHistory();if(_0x4f26f9[_0x40e47b(0x1cf)]&&_0x4f26f9[_0x40e47b(0x1cf)][_0x40e47b(0x1db)]===0x1){let _0x5fb86d=_0x4f26f9[_0x40e47b(0x1cf)][0x0];lastTouch=getTouchPos({'touches':[_0x5fb86d]}),isDrawing=!![];if(currentTool===_0x40e47b(0x1bd)){panStart={'x':_0x5fb86d[_0x40e47b(0x16a)],'y':_0x5fb86d[_0x40e47b(0x1b6)],'posX':posX,'posY':posY};if(canvas)canvas[_0x40e47b(0x1e1)]['cursor']=_0x40e47b(0x1c0);}}else{isDrawing=![],lastTouch=null;if(currentTool==='pan'){panStart=null;if(canvas)canvas[_0x40e47b(0x1e1)][_0x40e47b(0x170)]=_0x40e47b(0x1a8);}}}function onCanvasColorPick(_0x1fc857){const _0x14aef5=_0x38107e;try{const _0x367edb=getCanvasCoords(_0x1fc857),_0x4e523f=Math[_0x14aef5(0x1ed)](_0x367edb['x']),_0x17bdb6=Math[_0x14aef5(0x1ed)](_0x367edb['y']),_0x4f6a3e=ctx[_0x14aef5(0x1fd)](_0x4e523f,_0x17bdb6,0x1,0x1)['data'],_0x41d7b8=_0x4f6a3e[0x0],_0x31c273=_0x4f6a3e[0x1],_0x2fa955=_0x4f6a3e[0x2],_0x4c260e=_0x4f6a3e[0x3];if(_0x4c260e===0x0){currentColor=_0x14aef5(0x168);const _0x4e14d7=document[_0x14aef5(0x1e9)](_0x14aef5(0x194));if(_0x4e14d7)_0x4e14d7[_0x14aef5(0x195)]=_0x14aef5(0x1a9);console[_0x14aef5(0x19c)]('Picked\x20transparent');}else{const _0xccb214='#'+[_0x41d7b8,_0x31c273,_0x2fa955][_0x14aef5(0x167)](_0x1b6670=>_0x1b6670['toString'](0x10)[_0x14aef5(0x16d)](0x2,'0'))[_0x14aef5(0x1ca)]('');currentColor=_0xccb214;const _0x1845b4=document[_0x14aef5(0x1e9)](_0x14aef5(0x194));if(_0x1845b4)_0x1845b4['value']=_0xccb214;console[_0x14aef5(0x19c)](_0x14aef5(0x175),_0xccb214);}}catch(_0x4cde4d){console[_0x14aef5(0x16b)]('onCanvasColorPick\x20error',_0x4cde4d);}colorPickMode=![];if(canvas)canvas['style']['cursor']=_0x14aef5(0x1f6);}function _0xfdf8(){const _0x5df156=['</b>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20バージョンID:\x20','offsetHeight','2MeCltf','Shift','parentElement','touchstart','colorPicker','value','querySelector','auto','nudgeUpBtn','body','click','boxShadow','info','canvas\x20要素が見つからないチュー','number','input','onchange','\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22background:var(--surface);padding:18px\x2022px;border-radius:10px;min-width:280px;max-width:720px;text-align:left;box-shadow:0\x202px\x2024px\x20rgba(0,0,0,0.25);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:0;\x22>ネズミスケッチについて</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ネズミスケッチは、簡単にドット絵アニメーションを作成できるツールです。</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>バージョン:\x20<b>','ontouchmove','startAutoSaveInterval','ctrlKey','constructor','select','touchcancel','grab','#000000','toolsToggleBtn','add','742640NJZSWS','copyLayer\x20error','appendChild','round','warn','setAttribute','0\x202px\x2010px\x20rgba(0,0,0,0.15)','activeElement','100vh','themeToggleBtn','clientY','disabled','oninput','remove','footer','IndexedDB\x20からの読み込みに失敗したチュー','(((.+)+)+)+$','pan','canvas','color\x20picker\x20onChange\x20error','grabbing','4046976AbNdKn','then','flex','display','zoomSlider','posX','currentColorSwatch','key','justifyContent','join','about-dialog','createElement','preventDefault','pen','touches','parentNode','block','showAboutDialog','left','touchmove','nudgeStep','center','max','1225041OSzWly','toggle','copyLayerBtn','length','classList','insertBefore','nudgeLeftBtn','target','none','style','background','shiftKey','indexOf','hypot','100vw','animSpeedRange','alignItems','getElementById','resize','min','2304252UGbMGI','floor','133ozXcbq','710376OQCeyJ','#aboutCloseBtn','getBoundingClientRect','position','1133805bdQKNf','8px','nextSibling','default','nezumi-theme','right-panel','toString','MAC','top','isContentEditable','getImageData','width','bottom','inline-block','touchend','textarea','map','transparent','right','clientX','error','innerHTML','padStart','nudgeRightBtn','function','cursor','pasteLayer\x20error','addEventListener','right-toolbar','onmouseup','Picked\x20color','getContext','redo\x20shortcut\x20error','innerWidth','自動復元中...','penSize','tagName','keydown','open','fixed','getItem','fill','light','mobile-open','toLowerCase','metaKey','15821970TvTHWG','abs','12TRLlWd','onmousemove','toolbar-mobile','removeAttribute','apply','.tool-btn-container','keyup'];_0xfdf8=function(){return _0x5df156;};return _0xfdf8();}