const _0x5adb32=_0xea1c;(function(_0x153ae2,_0x5b4e9f){const _0x298e5f=_0xea1c,_0x26b9ba=_0x153ae2();while(!![]){try{const _0x42e874=-parseInt(_0x298e5f(0x200))/0x1+parseInt(_0x298e5f(0x1c6))/0x2*(parseInt(_0x298e5f(0x1a6))/0x3)+parseInt(_0x298e5f(0x1d8))/0x4*(-parseInt(_0x298e5f(0x203))/0x5)+-parseInt(_0x298e5f(0x1c7))/0x6+parseInt(_0x298e5f(0x1b5))/0x7*(-parseInt(_0x298e5f(0x1d3))/0x8)+-parseInt(_0x298e5f(0x1b7))/0x9+-parseInt(_0x298e5f(0x205))/0xa*(-parseInt(_0x298e5f(0x1f5))/0xb);if(_0x42e874===_0x5b4e9f)break;else _0x26b9ba['push'](_0x26b9ba['shift']());}catch(_0x129a3d){_0x26b9ba['push'](_0x26b9ba['shift']());}}}(_0x3605,0x35820));const _0x107af6=(function(){let _0x120474=!![];return function(_0x152eda,_0x4fd8cc){const _0x4f9c5f=_0x120474?function(){const _0xe6e17e=_0xea1c;if(_0x4fd8cc){const _0x7c05a4=_0x4fd8cc[_0xe6e17e(0x1c4)](_0x152eda,arguments);return _0x4fd8cc=null,_0x7c05a4;}}:function(){};return _0x120474=![],_0x4f9c5f;};}()),_0x2cbe24=_0x107af6(this,function(){const _0x20411c=_0xea1c;return _0x2cbe24[_0x20411c(0x1fe)]()[_0x20411c(0x1e6)](_0x20411c(0x1f4))['toString']()['constructor'](_0x2cbe24)[_0x20411c(0x1e6)](_0x20411c(0x1f4));});_0x2cbe24();function createProject(_0x2556db=0x10,_0x1b7419=0x10,_0x26c807=''){const _0xa72ae0=_0xea1c;let _0x1dc21f=0x14,_0x5c0f1d=[],_0x51030b=[],_0x5604ce=[],_0x26a127=document[_0xa72ae0(0x1f1)]('canvas');_0x26a127[_0xa72ae0(0x1cc)]=_0x2556db*_0x1dc21f,_0x26a127[_0xa72ae0(0x1fd)]=_0x1b7419*_0x1dc21f,_0x5c0f1d['push']({'canvas':_0x26a127,'visible':!![]}),_0x51030b[_0xa72ae0(0x212)]([]),_0x5604ce['push']([]);let _0x92de0f={'layers':_0x5c0f1d,'activeLayer':0x0,'layerHistories':_0x51030b,'layerRedoStacks':_0x5604ce};return{'frames':[_0x92de0f],'activeFrame':0x0,'width':_0x2556db,'height':_0x1b7419,'name':_0x26c807||'画像'+(projects[_0xa72ae0(0x21e)]+0x1)};}function editProjectName(_0x15c8a3,_0x151cda){const _0x34a562=_0xea1c,_0x580563=document['createElement'](_0x34a562(0x220));_0x580563[_0x34a562(0x1a1)]=_0x34a562(0x1ce),_0x580563[_0x34a562(0x202)]=projects[_0x15c8a3]['name']||'画像'+(_0x15c8a3+0x1),_0x580563['className']=_0x34a562(0x1d1),_0x580563['style'][_0x34a562(0x1cc)]=_0x34a562(0x20d),_0x580563[_0x34a562(0x1a4)]=()=>{const _0x3add90=_0x34a562;projects[_0x15c8a3][_0x3add90(0x1b8)]=_0x580563[_0x3add90(0x202)][_0x3add90(0x1da)]()||'画像'+(_0x15c8a3+0x1),updateProjectUI();},_0x580563[_0x34a562(0x1eb)]=_0x3ea832=>{const _0x4e1197=_0x34a562;if(_0x3ea832[_0x4e1197(0x221)]===_0x4e1197(0x209))_0x580563[_0x4e1197(0x1ca)]();},_0x151cda['replaceWith'](_0x580563),_0x580563[_0x34a562(0x1a2)](),_0x580563[_0x34a562(0x1aa)]();}function _0x3605(){const _0xe8bc3f=['複製できないレイヤーがありますチュー','number','toDataURL','push','file','textContent','replace','canvas','-frames-layers.zip','nezumi-sketch.msketch','activeProject','projects','loadProjectFromIDB:\x20localStorage\x20quick\x20load\x20failed','offsetCells','splice','length','data','input','key','nezumi-sketch-save-quick','debug','-layer','addEventListener','blob','visibilitychange','getImageData','requestAutoSave','frames','getItem','pen','type','focus','IndexedDBからの読み込みに失敗したチュー…','onblur','floor','6555MCyLpf','disabled','function','src','select','処理中...','stringify','frame-','loadProjectFromIDB:\x20DB\x20に保存が見つかりませんでした。localStorage\x20のクイック保存を確認します。','ファイルにプロジェクトメタデータが見つかりませんでした。読み込みできません。','max','removeChild','保存に失敗したチュー:','layer-','application/json','21BFUqTn','warn','3152475bYpdyf','name','isFinite','isArray','createObjectURL','clearRect','error','map','some','startsWith','catch','image','requestAutoSave:\x20timer\x20fired','apply','all','124hvNLhk','1395378XDTriE','layerHistories','readAsText','blur','duplicateLayerAt\x20draw\x20error','width','then','text','auto-save\x20(interval)\x20failed','nezumi-sketch-save','project-name-edit','layers','962968jBWIpF','onerror','image/png','click','auto-save\x20failed','12xGUMXd','active','trim','folder','loadProjectFromIDB:\x20localStorage\x20のクイック保存を復元します','layerRedoStacks','nezumi-animation','startCell','activeLayer','log','generateAsync','flushQuickSaveToLocalStorage\x20failed','files','activeFrame','search','undefined','.png','getElementById','startAutoSaveInterval:\x20starting\x20interval\x20','onkeydown','getContext','requestAutoSave:\x20scheduling\x20save\x20in\x20','result','visible','beforeunload','createElement','info','href','(((.+)+)+)+$','1078CpmGLK','body','startAutoSaveInterval','スタンドアロン形式のプロジェクトを読み込みました:\x20','drawImage','layerExportStatus','forEach','」を削除しますか？','height','toString','setItem','59042hulonf','cloneLayer\x20draw\x20error','value','674455MGqpBp','charCodeAt','152180jaKrid','appendChild','nudgeActiveLayer:\x20対象レイヤーのキャンバスが見つかりません','onload','Enter','target','loadProjectFromIDB:\x20データ確認','split','80px','parse'];_0x3605=function(){return _0xe8bc3f;};return _0x3605();}function addProject(){showNewProjectDialog((_0x6d7c3,_0x4f6584,_0x1e53f5)=>{const _0x3c65a6=_0xea1c;if(!Number[_0x3c65a6(0x1b9)](_0x6d7c3)||_0x6d7c3<0x1)_0x6d7c3=0x10;if(!Number[_0x3c65a6(0x1b9)](_0x4f6584)||_0x4f6584<0x1)_0x4f6584=0x10;projects[_0x3c65a6(0x212)](createProject(_0x6d7c3,_0x4f6584,_0x1e53f5)),activeProject=projects[_0x3c65a6(0x21e)]-0x1,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();});}function removeProjectAt(_0x408cab){const _0x5ef269=_0xea1c;if(projects[_0x5ef269(0x21e)]<=0x1)return;const _0xdb3896=projects[_0x408cab]&&projects[_0x408cab][_0x5ef269(0x1b8)]?projects[_0x408cab]['name']:'画像'+(_0x408cab+0x1);if(!confirm('「'+_0xdb3896+_0x5ef269(0x1fc)))return;projects[_0x5ef269(0x21d)](_0x408cab,0x1);if(activeProject>=projects['length'])activeProject=projects[_0x5ef269(0x21e)]-0x1;updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();}function getCurrentProject(){return projects[activeProject];}function addFrame(){const _0x3a25ea=_0xea1c,_0x3273f5=getCurrentProject(),_0x48f9c9=_0x3273f5[_0x3a25ea(0x22a)][_0x3273f5[_0x3a25ea(0x1e5)]],_0xea74de=_0x13a3f2=>{const _0x2fbad9=_0x3a25ea,_0x2bb565=_0x13a3f2&&_0x13a3f2[_0x2fbad9(0x216)]?_0x13a3f2[_0x2fbad9(0x216)]:_0x13a3f2;if(!_0x2bb565)return console[_0x2fbad9(0x1b6)](_0x2fbad9(0x20f),_0x13a3f2),null;const _0x164727=document[_0x2fbad9(0x1f1)](_0x2fbad9(0x216));_0x164727[_0x2fbad9(0x1cc)]=_0x2bb565[_0x2fbad9(0x1cc)]||_0x3273f5['width']*cellSize,_0x164727[_0x2fbad9(0x1fd)]=_0x2bb565[_0x2fbad9(0x1fd)]||_0x3273f5[_0x2fbad9(0x1fd)]*cellSize;const _0x357db0=_0x164727[_0x2fbad9(0x1ec)]('2d');try{_0x357db0['drawImage'](_0x2bb565,0x0,0x0);}catch(_0x523315){console[_0x2fbad9(0x1b6)](_0x2fbad9(0x201),_0x523315);}return{'canvas':_0x164727,'visible':_0x13a3f2&&typeof _0x13a3f2[_0x2fbad9(0x1ef)]!==_0x2fbad9(0x1e7)?_0x13a3f2[_0x2fbad9(0x1ef)]:!![]};},_0x5e5ee2=_0x48f9c9[_0x3a25ea(0x1d2)]['map'](_0xea74de),_0x4a06cf=_0x5e5ee2[_0x3a25ea(0x1be)](()=>[]),_0x2598d3=_0x5e5ee2[_0x3a25ea(0x1be)](()=>[]),_0x35fe6f={'layers':_0x5e5ee2,'activeLayer':0x0,'layerHistories':_0x4a06cf,'layerRedoStacks':_0x2598d3};_0x3273f5[_0x3a25ea(0x22a)]['splice'](_0x3273f5[_0x3a25ea(0x1e5)]+0x1,0x0,_0x35fe6f),_0x3273f5['activeFrame']++,updateFrameUI(),updateLayerUI(),redrawAll();}const cloneLayer=_0x1583ba=>{const _0x480877=_0xea1c,_0x81c9f1=_0x1583ba&&_0x1583ba[_0x480877(0x216)]?_0x1583ba['canvas']:_0x1583ba;if(!_0x81c9f1)return console[_0x480877(0x1b6)](_0x480877(0x20f),_0x1583ba),null;const _0x4c46b5=document['createElement']('canvas');_0x4c46b5[_0x480877(0x1cc)]=_0x81c9f1[_0x480877(0x1cc)],_0x4c46b5[_0x480877(0x1fd)]=_0x81c9f1[_0x480877(0x1fd)];const _0x1d87c5=_0x4c46b5[_0x480877(0x1ec)]('2d');try{_0x1d87c5['drawImage'](_0x81c9f1,0x0,0x0);}catch(_0x31a478){console['warn'](_0x480877(0x201),_0x31a478);}return{'canvas':_0x4c46b5,'visible':_0x1583ba&&typeof _0x1583ba[_0x480877(0x1ef)]!==_0x480877(0x1e7)?_0x1583ba['visible']:!![]};};function removeFrameAt(_0x956204){const _0x46e64c=_0xea1c;let _0x4994f1=getCurrentProject();if(_0x4994f1[_0x46e64c(0x22a)][_0x46e64c(0x21e)]<=0x1)return;_0x4994f1['frames'][_0x46e64c(0x21d)](_0x956204,0x1);if(_0x4994f1[_0x46e64c(0x1e5)]>=_0x4994f1[_0x46e64c(0x22a)][_0x46e64c(0x21e)])_0x4994f1[_0x46e64c(0x1e5)]=_0x4994f1['frames']['length']-0x1;updateFrameUI(),updateLayerUI(),redrawAll();}function getCurrentFrame(){const _0x1f32f8=_0xea1c,_0x3ce82d=getCurrentProject();if(!_0x3ce82d||!_0x3ce82d['frames']||typeof _0x3ce82d[_0x1f32f8(0x1e5)]!=='number'||!_0x3ce82d[_0x1f32f8(0x22a)][_0x3ce82d[_0x1f32f8(0x1e5)]])return null;return _0x3ce82d[_0x1f32f8(0x22a)][_0x3ce82d['activeFrame']];}function swapLayer(_0x45710a,_0x300b60){const _0x16da00=_0xea1c;let _0x59c5cb=getCurrentFrame();[_0x59c5cb['layers'][_0x45710a],_0x59c5cb['layers'][_0x300b60]]=[_0x59c5cb[_0x16da00(0x1d2)][_0x300b60],_0x59c5cb['layers'][_0x45710a]],[_0x59c5cb[_0x16da00(0x1c8)][_0x45710a],_0x59c5cb['layerHistories'][_0x300b60]]=[_0x59c5cb[_0x16da00(0x1c8)][_0x300b60],_0x59c5cb[_0x16da00(0x1c8)][_0x45710a]],[_0x59c5cb[_0x16da00(0x1dd)][_0x45710a],_0x59c5cb[_0x16da00(0x1dd)][_0x300b60]]=[_0x59c5cb[_0x16da00(0x1dd)][_0x300b60],_0x59c5cb['layerRedoStacks'][_0x45710a]];if(_0x59c5cb[_0x16da00(0x1e0)]===_0x45710a)_0x59c5cb[_0x16da00(0x1e0)]=_0x300b60;else{if(_0x59c5cb[_0x16da00(0x1e0)]===_0x300b60)_0x59c5cb[_0x16da00(0x1e0)]=_0x45710a;}updateLayerUI(),redrawAll();if(typeof requestAutoSave===_0x16da00(0x1a8))requestAutoSave();}function removeLayerAt(_0x3e401a){const _0x50e02b=_0xea1c;let _0x581647=getCurrentFrame();if(_0x581647[_0x50e02b(0x1d2)][_0x50e02b(0x21e)]<=0x1)return;_0x581647['layers'][_0x50e02b(0x21d)](_0x3e401a,0x1),_0x581647['layerHistories'][_0x50e02b(0x21d)](_0x3e401a,0x1),_0x581647[_0x50e02b(0x1dd)][_0x50e02b(0x21d)](_0x3e401a,0x1);if(_0x581647[_0x50e02b(0x1e0)]>=_0x581647[_0x50e02b(0x1d2)][_0x50e02b(0x21e)])_0x581647['activeLayer']=_0x581647[_0x50e02b(0x1d2)][_0x50e02b(0x21e)]-0x1;updateLayerUI(),redrawAll();if(typeof requestAutoSave==='function')requestAutoSave();}function addLayer(){const _0x583cda=_0xea1c;let _0x1203a6=getCurrentProject(),_0x15cdf1=getCurrentFrame(),_0x35d0b0=document[_0x583cda(0x1f1)](_0x583cda(0x216));_0x35d0b0[_0x583cda(0x1cc)]=_0x1203a6['width']*cellSize,_0x35d0b0[_0x583cda(0x1fd)]=_0x1203a6[_0x583cda(0x1fd)]*cellSize,_0x15cdf1[_0x583cda(0x1d2)][_0x583cda(0x212)]({'canvas':_0x35d0b0,'visible':!![]}),_0x15cdf1[_0x583cda(0x1c8)][_0x583cda(0x212)]([]),_0x15cdf1['layerRedoStacks']['push']([]),_0x15cdf1[_0x583cda(0x1e0)]=_0x15cdf1['layers'][_0x583cda(0x21e)]-0x1,saveHistory(),updateLayerUI(),redrawAll();}function removeLayer(){const _0xf0ca28=_0xea1c;let _0x5a1ae5=getCurrentFrame();if(_0x5a1ae5[_0xf0ca28(0x1d2)][_0xf0ca28(0x21e)]<=0x1)return;_0x5a1ae5[_0xf0ca28(0x1d2)][_0xf0ca28(0x21d)](_0x5a1ae5[_0xf0ca28(0x1e0)],0x1),_0x5a1ae5['layerHistories'][_0xf0ca28(0x21d)](_0x5a1ae5[_0xf0ca28(0x1e0)],0x1),_0x5a1ae5[_0xf0ca28(0x1dd)][_0xf0ca28(0x21d)](_0x5a1ae5['activeLayer'],0x1),_0x5a1ae5[_0xf0ca28(0x1e0)]=Math[_0xf0ca28(0x1b0)](0x0,_0x5a1ae5[_0xf0ca28(0x1e0)]-0x1),updateLayerUI(),redrawAll();if(typeof requestAutoSave===_0xf0ca28(0x1a8))requestAutoSave();}function duplicateLayerAt(_0x1882d3){const _0x45c567=_0xea1c,_0x54ab99=getCurrentProject(),_0x8b8947=getCurrentFrame();if(!_0x54ab99||!_0x8b8947||typeof _0x1882d3!==_0x45c567(0x210)||!_0x8b8947[_0x45c567(0x1d2)][_0x1882d3])return;const _0x4ab52f=_0x8b8947[_0x45c567(0x1d2)][_0x1882d3],_0x5f5df9=_0x4ab52f&&_0x4ab52f[_0x45c567(0x216)]?_0x4ab52f[_0x45c567(0x216)]:_0x4ab52f;if(!_0x5f5df9)return;const _0x2944d2=document[_0x45c567(0x1f1)]('canvas');_0x2944d2[_0x45c567(0x1cc)]=_0x54ab99[_0x45c567(0x1cc)]*cellSize,_0x2944d2[_0x45c567(0x1fd)]=_0x54ab99[_0x45c567(0x1fd)]*cellSize;const _0x3360a9=_0x2944d2['getContext']('2d');_0x3360a9['clearRect'](0x0,0x0,_0x2944d2[_0x45c567(0x1cc)],_0x2944d2[_0x45c567(0x1fd)]);try{_0x3360a9['drawImage'](_0x5f5df9,0x0,0x0);}catch(_0x28965f){console[_0x45c567(0x1b6)](_0x45c567(0x1cb),_0x28965f);}const _0x3361b7=_0x1882d3+0x1;_0x8b8947['layers']['splice'](_0x3361b7,0x0,{'canvas':_0x2944d2,'visible':!![]});if(Array[_0x45c567(0x1ba)](_0x8b8947[_0x45c567(0x1c8)]))_0x8b8947[_0x45c567(0x1c8)][_0x45c567(0x21d)](_0x3361b7,0x0,[]);if(Array[_0x45c567(0x1ba)](_0x8b8947[_0x45c567(0x1dd)]))_0x8b8947['layerRedoStacks']['splice'](_0x3361b7,0x0,[]);_0x8b8947['activeLayer']=_0x3361b7,saveHistory(),updateLayerUI(),redrawAll();if(typeof requestAutoSave===_0x45c567(0x1a8))requestAutoSave();}function selectLayer(_0x13b6c3){const _0x4152fb=_0xea1c;getCurrentFrame()[_0x4152fb(0x1e0)]=parseInt(_0x13b6c3),updateLayerUI();}function copyLayer(){const _0x5e97c6=_0xea1c,_0x3d8c80=getCurrentFrame();if(!_0x3d8c80)return;const _0x4f93f4=_0x3d8c80[_0x5e97c6(0x1e0)];if(typeof _0x4f93f4!==_0x5e97c6(0x210)||!_0x3d8c80[_0x5e97c6(0x1d2)][_0x4f93f4])return;const _0x4b9293=_0x3d8c80['layers'][_0x4f93f4],_0x17ccf2=_0x4b9293&&_0x4b9293[_0x5e97c6(0x216)]?_0x4b9293[_0x5e97c6(0x216)]:_0x4b9293;if(!_0x17ccf2||typeof _0x17ccf2[_0x5e97c6(0x211)]!==_0x5e97c6(0x1a8))return;copiedLayerDataUrl=_0x17ccf2[_0x5e97c6(0x211)]();const _0x4014d4=document[_0x5e97c6(0x1e9)]('pasteLayerBtn');if(_0x4014d4)_0x4014d4[_0x5e97c6(0x1a7)]=![];}function pasteLayer(){const _0x8653d9=_0xea1c;if(!copiedLayerDataUrl)return;const _0x1dc354=getCurrentProject(),_0x481f84=getCurrentFrame();if(!_0x1dc354||!_0x481f84)return;const _0x32a88e=document['createElement'](_0x8653d9(0x216));_0x32a88e[_0x8653d9(0x1cc)]=_0x1dc354['width']*cellSize,_0x32a88e[_0x8653d9(0x1fd)]=_0x1dc354[_0x8653d9(0x1fd)]*cellSize;const _0xe0b0e8=_0x32a88e[_0x8653d9(0x1ec)]('2d'),_0x1bbe97=new Image();_0x1bbe97[_0x8653d9(0x208)]=()=>{const _0x514de4=_0x8653d9;_0xe0b0e8[_0x514de4(0x1bc)](0x0,0x0,_0x32a88e[_0x514de4(0x1cc)],_0x32a88e[_0x514de4(0x1fd)]),_0xe0b0e8['drawImage'](_0x1bbe97,0x0,0x0),_0x481f84[_0x514de4(0x1d2)]['push']({'canvas':_0x32a88e,'visible':!![]}),_0x481f84[_0x514de4(0x1c8)]['push']([]),_0x481f84[_0x514de4(0x1dd)][_0x514de4(0x212)]([]),_0x481f84[_0x514de4(0x1e0)]=_0x481f84[_0x514de4(0x1d2)][_0x514de4(0x21e)]-0x1,saveHistory(),updateLayerUI(),redrawAll();},_0x1bbe97[_0x8653d9(0x1a9)]=copiedLayerDataUrl;}async function exportLayersAsGif(){const _0x275d9b=_0xea1c,_0x48f9f0=document[_0x275d9b(0x1e9)]('layerExportStatus');if(_0x48f9f0)_0x48f9f0[_0x275d9b(0x214)]=_0x275d9b(0x1ab);const _0x125dc2=getCurrentProject();if(!_0x125dc2){if(_0x48f9f0)_0x48f9f0[_0x275d9b(0x214)]='';return;}const _0x5170d0=_0x125dc2[_0x275d9b(0x22a)],_0x5eea51=_0x125dc2[_0x275d9b(0x1cc)]*cellSize,_0x451096=_0x125dc2[_0x275d9b(0x1fd)]*cellSize;let _0x34c7ec=0x0;_0x5170d0[_0x275d9b(0x1fb)](_0x1d5072=>{const _0x5835d5=_0x275d9b;_0x34c7ec=Math[_0x5835d5(0x1b0)](_0x34c7ec,_0x1d5072[_0x5835d5(0x1d2)][_0x5835d5(0x21e)]);});for(let _0x481ce8=0x0;_0x481ce8<_0x34c7ec;_0x481ce8++){const _0x22b161=await Promise[_0x275d9b(0x1c5)](_0x5170d0[_0x275d9b(0x1be)](_0x5958f9=>{return new Promise(_0x1f42ba=>{const _0x406953=_0xea1c,_0x254235=document[_0x406953(0x1f1)](_0x406953(0x216));_0x254235[_0x406953(0x1cc)]=_0x5eea51,_0x254235[_0x406953(0x1fd)]=_0x451096;const _0x15bcae=_0x254235[_0x406953(0x1ec)]('2d'),_0x29b538=_0x5958f9[_0x406953(0x1d2)][_0x481ce8]&&_0x5958f9[_0x406953(0x1d2)][_0x481ce8][_0x406953(0x216)]?_0x5958f9[_0x406953(0x1d2)][_0x481ce8][_0x406953(0x216)]:_0x5958f9[_0x406953(0x1d2)][_0x481ce8];if(_0x29b538)_0x15bcae[_0x406953(0x1f9)](_0x29b538,0x0,0x0);const _0x3facea=new Image();_0x3facea[_0x406953(0x208)]=()=>_0x1f42ba(_0x3facea),_0x3facea[_0x406953(0x1a9)]=_0x254235['toDataURL'](_0x406953(0x1d5));});})),_0x545e34=_0x22b161[_0x275d9b(0x1bf)](_0x52afd3=>{const _0x112bab=_0x275d9b,_0x297a7b=document[_0x112bab(0x1f1)](_0x112bab(0x216));_0x297a7b[_0x112bab(0x1cc)]=_0x5eea51,_0x297a7b[_0x112bab(0x1fd)]=_0x451096;const _0x22e26d=_0x297a7b[_0x112bab(0x1ec)]('2d');_0x22e26d[_0x112bab(0x1f9)](_0x52afd3,0x0,0x0);const _0xde033d=_0x22e26d['getImageData'](0x0,0x0,_0x5eea51,_0x451096)[_0x112bab(0x21f)];for(let _0x538ba5=0x3;_0x538ba5<_0xde033d[_0x112bab(0x21e)];_0x538ba5+=0x4)if(_0xde033d[_0x538ba5]!==0x0)return!![];return![];});if(!_0x545e34)continue;const _0x4f3ec8=(_0x125dc2[_0x275d9b(0x1b8)]||_0x275d9b(0x1de))[_0x275d9b(0x215)](/[\\/:*?"<>|]/g,'_')+(_0x275d9b(0x224)+(_0x481ce8+0x1)+'.gif');convertToGIF(_0x22b161,animationDelay,_0x4f3ec8),await new Promise(_0x23b154=>setTimeout(_0x23b154,0x78));}if(_0x48f9f0)_0x48f9f0[_0x275d9b(0x214)]='';}async function exportLayersAsApng(){const _0x41ebfe=_0xea1c,_0x31c24e=document[_0x41ebfe(0x1e9)](_0x41ebfe(0x1fa));if(_0x31c24e)_0x31c24e[_0x41ebfe(0x214)]='処理中...';const _0x3106c4=getCurrentProject();if(!_0x3106c4){if(_0x31c24e)_0x31c24e[_0x41ebfe(0x214)]='';return;}const _0x3f40bf=_0x3106c4[_0x41ebfe(0x22a)],_0x2e1ba1=_0x3106c4[_0x41ebfe(0x1cc)]*cellSize,_0x1e5235=_0x3106c4['height']*cellSize;let _0x56f692=0x0;_0x3f40bf['forEach'](_0x1e1c54=>{const _0x25862e=_0x41ebfe;_0x56f692=Math[_0x25862e(0x1b0)](_0x56f692,_0x1e1c54[_0x25862e(0x1d2)][_0x25862e(0x21e)]);});for(let _0x4476c6=0x0;_0x4476c6<_0x56f692;_0x4476c6++){const _0x596575=await Promise[_0x41ebfe(0x1c5)](_0x3f40bf[_0x41ebfe(0x1be)](_0x1b12ef=>{return new Promise(_0x286253=>{const _0x1e948f=_0xea1c,_0x1859fc=document[_0x1e948f(0x1f1)](_0x1e948f(0x216));_0x1859fc[_0x1e948f(0x1cc)]=_0x2e1ba1,_0x1859fc[_0x1e948f(0x1fd)]=_0x1e5235;const _0x5b24dd=_0x1859fc[_0x1e948f(0x1ec)]('2d'),_0x4a6033=_0x1b12ef[_0x1e948f(0x1d2)][_0x4476c6]&&_0x1b12ef['layers'][_0x4476c6][_0x1e948f(0x216)]?_0x1b12ef[_0x1e948f(0x1d2)][_0x4476c6][_0x1e948f(0x216)]:_0x1b12ef[_0x1e948f(0x1d2)][_0x4476c6];if(_0x4a6033)_0x5b24dd[_0x1e948f(0x1f9)](_0x4a6033,0x0,0x0);const _0x7b3857=new Image();_0x7b3857[_0x1e948f(0x208)]=()=>_0x286253(_0x7b3857),_0x7b3857[_0x1e948f(0x1a9)]=_0x1859fc[_0x1e948f(0x211)](_0x1e948f(0x1d5));});})),_0x4c5172=_0x596575[_0x41ebfe(0x1bf)](_0x217999=>{const _0x25434d=_0x41ebfe,_0x19a69a=document[_0x25434d(0x1f1)](_0x25434d(0x216));_0x19a69a[_0x25434d(0x1cc)]=_0x2e1ba1,_0x19a69a[_0x25434d(0x1fd)]=_0x1e5235;const _0x4be339=_0x19a69a['getContext']('2d');_0x4be339['drawImage'](_0x217999,0x0,0x0);const _0x2b3b25=_0x4be339[_0x25434d(0x228)](0x0,0x0,_0x2e1ba1,_0x1e5235)['data'];for(let _0x27b8f6=0x3;_0x27b8f6<_0x2b3b25[_0x25434d(0x21e)];_0x27b8f6+=0x4)if(_0x2b3b25[_0x27b8f6]!==0x0)return!![];return![];});if(!_0x4c5172)continue;const _0x5c82c1=(_0x3106c4[_0x41ebfe(0x1b8)]||_0x41ebfe(0x1de))[_0x41ebfe(0x215)](/[\\/:*?"<>|]/g,'_')+('-layer'+(_0x4476c6+0x1)+'.apng');convertToAPNG(_0x596575,_0x2e1ba1,_0x1e5235,animationDelay,_0x5c82c1),await new Promise(_0x4211d0=>setTimeout(_0x4211d0,0x78));}if(_0x31c24e)_0x31c24e[_0x41ebfe(0x214)]='';}async function exportFramesLayersZip(){const _0x545b9d=_0xea1c,_0x2c81b4=document[_0x545b9d(0x1e9)](_0x545b9d(0x1fa));if(_0x2c81b4)_0x2c81b4['textContent']='ZIP作成中...';const _0x14c6fe=getCurrentProject();if(!_0x14c6fe){if(_0x2c81b4)_0x2c81b4[_0x545b9d(0x214)]='';return;}const _0x16909f=_0x14c6fe['frames'],_0x24c846=_0x14c6fe[_0x545b9d(0x1cc)]*cellSize,_0x1b2f2e=_0x14c6fe['height']*cellSize,_0x29ca0a=new JSZip();for(let _0x319fae=0x0;_0x319fae<_0x16909f[_0x545b9d(0x21e)];_0x319fae++){const _0x2f1fcb=_0x16909f[_0x319fae],_0x124876=_0x29ca0a[_0x545b9d(0x1db)](_0x545b9d(0x1ad)+(_0x319fae+0x1));for(let _0xc36e8f=0x0;_0xc36e8f<_0x2f1fcb[_0x545b9d(0x1d2)][_0x545b9d(0x21e)];_0xc36e8f++){const _0xe3e7ef=document[_0x545b9d(0x1f1)](_0x545b9d(0x216));_0xe3e7ef[_0x545b9d(0x1cc)]=_0x24c846,_0xe3e7ef[_0x545b9d(0x1fd)]=_0x1b2f2e;const _0x114a94=_0xe3e7ef['getContext']('2d');_0x114a94[_0x545b9d(0x1bc)](0x0,0x0,_0x24c846,_0x1b2f2e);const _0x2ad276=_0x2f1fcb[_0x545b9d(0x1d2)][_0xc36e8f];if(_0x2ad276){const _0x7aa1ab=_0x2ad276[_0x545b9d(0x216)]?_0x2ad276[_0x545b9d(0x216)]:_0x2ad276;if(_0x7aa1ab)_0x114a94[_0x545b9d(0x1f9)](_0x7aa1ab,0x0,0x0);}const _0x4963c4=_0xe3e7ef[_0x545b9d(0x211)](_0x545b9d(0x1d5)),_0x17b23b=_0x4963c4[_0x545b9d(0x20c)](',')[0x1],_0x1d3daf=atob(_0x17b23b),_0x5c6053=new Uint8Array(_0x1d3daf[_0x545b9d(0x21e)]);for(let _0xf6ce53=0x0;_0xf6ce53<_0x1d3daf[_0x545b9d(0x21e)];_0xf6ce53++)_0x5c6053[_0xf6ce53]=_0x1d3daf[_0x545b9d(0x204)](_0xf6ce53);_0x124876[_0x545b9d(0x213)](_0x545b9d(0x1b3)+(_0xc36e8f+0x1)+_0x545b9d(0x1e8),_0x5c6053);}}const _0x236d5c=await _0x29ca0a[_0x545b9d(0x1e2)]({'type':_0x545b9d(0x226)}),_0x490148=(_0x14c6fe[_0x545b9d(0x1b8)]||'nezumi-export')[_0x545b9d(0x215)](/[\\/:*?"<>|]/g,'_'),_0x539291=document[_0x545b9d(0x1f1)]('a');_0x539291['href']=URL['createObjectURL'](_0x236d5c),_0x539291['download']=_0x490148+_0x545b9d(0x217),document[_0x545b9d(0x1f6)][_0x545b9d(0x206)](_0x539291),_0x539291['click'](),setTimeout(()=>{const _0x1c1529=_0x545b9d;URL['revokeObjectURL'](_0x539291['href']),document[_0x1c1529(0x1f6)][_0x1c1529(0x1b1)](_0x539291);if(_0x2c81b4)_0x2c81b4[_0x1c1529(0x214)]='';},0x4b0);}function saveProjectFile(){const _0x30b56a=_0xea1c,_0x407779=typeof getSavePayload==='function'?getSavePayload():{'projects':projects[_0x30b56a(0x1be)](_0x4f2cdd=>({'width':_0x4f2cdd[_0x30b56a(0x1cc)],'height':_0x4f2cdd[_0x30b56a(0x1fd)],'name':_0x4f2cdd['name']||'','activeFrame':_0x4f2cdd[_0x30b56a(0x1e5)],'frames':_0x4f2cdd[_0x30b56a(0x22a)][_0x30b56a(0x1be)](_0x2f1ee4=>({'activeLayer':_0x2f1ee4[_0x30b56a(0x1e0)],'layers':_0x2f1ee4[_0x30b56a(0x1d2)][_0x30b56a(0x1be)](_0x86275e=>_0x86275e&&_0x86275e[_0x30b56a(0x216)]?_0x86275e[_0x30b56a(0x216)][_0x30b56a(0x211)]():_0x86275e&&_0x86275e[_0x30b56a(0x211)]?_0x86275e[_0x30b56a(0x211)]():null)}))})),'activeProject':activeProject},_0x3ff9d2=new Blob([JSON['stringify'](_0x407779)],{'type':_0x30b56a(0x1b4)}),_0x51ddd3=document[_0x30b56a(0x1f1)]('a');_0x51ddd3['download']=_0x30b56a(0x218),_0x51ddd3[_0x30b56a(0x1f3)]=URL[_0x30b56a(0x1bb)](_0x3ff9d2),_0x51ddd3[_0x30b56a(0x1d6)]();}function getSavePayload(){const _0x1bff14=_0xea1c;return{'projects':projects[_0x1bff14(0x1be)](_0xd7a39a=>({'width':_0xd7a39a[_0x1bff14(0x1cc)],'height':_0xd7a39a[_0x1bff14(0x1fd)],'name':_0xd7a39a[_0x1bff14(0x1b8)]||'','activeFrame':_0xd7a39a['activeFrame'],'frames':_0xd7a39a[_0x1bff14(0x22a)][_0x1bff14(0x1be)](_0x6524c5=>({'activeLayer':_0x6524c5[_0x1bff14(0x1e0)],'layers':_0x6524c5[_0x1bff14(0x1d2)][_0x1bff14(0x1be)](_0x1bd082=>_0x1bd082&&_0x1bd082[_0x1bff14(0x216)]?_0x1bd082[_0x1bff14(0x216)][_0x1bff14(0x211)]():_0x1bd082&&_0x1bd082[_0x1bff14(0x211)]?_0x1bd082['toDataURL']():null)}))})),'activeProject':activeProject};}async function saveProjectToIDB(){const _0x221206=_0xea1c,_0x3421a4=getSavePayload();try{await idbSet(_0x221206(0x1d0),_0x3421a4),console[_0x221206(0x1e1)]('プロジェクトをIndexedDBに保存したチュー！');}catch(_0x2928ac){console[_0x221206(0x1bd)](_0x221206(0x1b2),_0x2928ac);}}function flushQuickSaveToLocalStorage(){const _0xda2aa3=_0xea1c;try{const _0x145392=getSavePayload();localStorage[_0xda2aa3(0x1ff)](_0xda2aa3(0x222),JSON[_0xda2aa3(0x1ac)](_0x145392)),console['debug']('flushQuickSaveToLocalStorage:\x20saved\x20quick\x20snapshot');}catch(_0x3c9567){console['error'](_0xda2aa3(0x1e3),_0x3c9567);}}window[_0x5adb32(0x225)](_0x5adb32(0x227),()=>{const _0x18ff9e=_0x5adb32;if(document['hidden']&&autosaveDirty){flushQuickSaveToLocalStorage();if(typeof saveProjectToIDB===_0x18ff9e(0x1a8))saveProjectToIDB();}}),window[_0x5adb32(0x225)](_0x5adb32(0x1f0),()=>{const _0x33d331=_0x5adb32;if(autosaveDirty){flushQuickSaveToLocalStorage();if(typeof saveProjectToIDB===_0x33d331(0x1a8))saveProjectToIDB();}});let autosaveDirty=![],autosaveTimer=null;const AUTOSAVE_DELAY=0x1388,AUTOSAVE_INTERVAL=0xea60;function requestAutoSave(){const _0x4253c3=_0x5adb32;autosaveDirty=!![];if(autosaveTimer)clearTimeout(autosaveTimer);console[_0x4253c3(0x223)](_0x4253c3(0x1ed)+AUTOSAVE_DELAY+'ms'),autosaveTimer=setTimeout(async()=>{const _0x3eb16c=_0x4253c3;console['debug'](_0x3eb16c(0x1c3));if(!autosaveDirty)return;try{await saveProjectToIDB(),autosaveDirty=![],console[_0x3eb16c(0x1e1)]('auto-save:\x20saved');}catch(_0x107736){console['error'](_0x3eb16c(0x1d7),_0x107736);}},AUTOSAVE_DELAY);}function startAutoSaveInterval(){const _0x56b713=_0x5adb32;console[_0x56b713(0x223)](_0x56b713(0x1ea)+AUTOSAVE_INTERVAL+'ms'),setInterval(async()=>{const _0x100a9b=_0x56b713;if(!autosaveDirty)return;try{await saveProjectToIDB(),autosaveDirty=![],console[_0x100a9b(0x1e1)]('auto-save\x20(interval):\x20saved');}catch(_0x13319b){console[_0x100a9b(0x1bd)](_0x100a9b(0x1cf),_0x13319b);}},AUTOSAVE_INTERVAL);}window[_0x5adb32(0x229)]=requestAutoSave,window[_0x5adb32(0x1f7)]=startAutoSaveInterval;function loadProjectFile(_0x1585d7){const _0x4b9ee4=_0x5adb32,_0x1bdc04=_0x1585d7[_0x4b9ee4(0x20a)][_0x4b9ee4(0x1e4)][0x0];if(!_0x1bdc04)return;if(_0x1bdc04[_0x4b9ee4(0x1a1)]&&_0x1bdc04[_0x4b9ee4(0x1a1)][_0x4b9ee4(0x1c0)](_0x4b9ee4(0x1c2))){loadStandaloneFromFile(_0x1bdc04)[_0x4b9ee4(0x1cd)](_0x155cc2=>{const _0x57aa49=_0x4b9ee4;alert(_0x57aa49(0x1f8)+(_0x155cc2[_0x57aa49(0x1b8)]||'画像'));})[_0x4b9ee4(0x1c1)](_0x4fd847=>{const _0x25da9b=_0x4b9ee4;console[_0x25da9b(0x1b6)](_0x4fd847),alert(_0x25da9b(0x1af));});return;}const _0x6aaa7d=new FileReader();try{showLoading('ファイルを読み込み中...');}catch(_0x573c02){}_0x6aaa7d[_0x4b9ee4(0x208)]=function(_0x4db4ea){const _0x1784bb=_0x4b9ee4;try{const _0x269c99=JSON[_0x1784bb(0x20e)](_0x4db4ea['target'][_0x1784bb(0x1ee)]);projects=_0x269c99[_0x1784bb(0x21a)][_0x1784bb(0x1be)]((_0x7c476a,_0x3afb8d)=>{const _0x33f850=_0x1784bb;let _0x24ad40=createProject(_0x7c476a['width'],_0x7c476a[_0x33f850(0x1fd)],_0x7c476a[_0x33f850(0x1b8)]||'画像'+(_0x3afb8d+0x1));return _0x24ad40[_0x33f850(0x22a)]=_0x7c476a[_0x33f850(0x22a)][_0x33f850(0x1be)](_0x354b55=>{const _0x5c8019=_0x33f850;let _0x31d1cd={'layers':[],'activeLayer':_0x354b55[_0x5c8019(0x1e0)],'layerHistories':[],'layerRedoStacks':[]};for(let _0x2a6380=0x0;_0x2a6380<_0x354b55[_0x5c8019(0x1d2)]['length'];_0x2a6380++){let _0x56456c=new Image();_0x56456c['src']=_0x354b55['layers'][_0x2a6380];let _0x2fe1c=document[_0x5c8019(0x1f1)](_0x5c8019(0x216));_0x2fe1c[_0x5c8019(0x1cc)]=_0x7c476a['width']*cellSize,_0x2fe1c[_0x5c8019(0x1fd)]=_0x7c476a['height']*cellSize,_0x56456c[_0x5c8019(0x208)]=()=>{const _0x5b3b75=_0x5c8019;let _0x2234e3=_0x2fe1c[_0x5b3b75(0x1ec)]('2d');_0x2234e3[_0x5b3b75(0x1bc)](0x0,0x0,_0x2fe1c['width'],_0x2fe1c['height']),_0x2234e3[_0x5b3b75(0x1f9)](_0x56456c,0x0,0x0);try{redrawAll();}catch(_0x2338f3){}},_0x31d1cd[_0x5c8019(0x1d2)][_0x5c8019(0x212)](_0x2fe1c),_0x31d1cd[_0x5c8019(0x1c8)][_0x5c8019(0x212)]([]),_0x31d1cd[_0x5c8019(0x1dd)][_0x5c8019(0x212)]([]);}return _0x31d1cd;}),_0x24ad40[_0x33f850(0x1e5)]=_0x7c476a[_0x33f850(0x1e5)],_0x24ad40[_0x33f850(0x1b8)]=_0x7c476a[_0x33f850(0x1b8)]||'画像'+(_0x3afb8d+0x1),_0x24ad40;}),activeProject=_0x269c99[_0x1784bb(0x219)]||0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();}catch(_0xd8a1c7){alert('ファイルの読み込みに失敗しました。');}finally{try{hideLoading();}catch(_0x2a9955){}}},_0x6aaa7d[_0x4b9ee4(0x1d4)]=function(){try{hideLoading();}catch(_0x51cce4){}},_0x6aaa7d[_0x4b9ee4(0x1c9)](_0x1bdc04);}function _0xea1c(_0x1f7476,_0x2bce63){_0x1f7476=_0x1f7476-0x19f;const _0x42b1b6=_0x3605();let _0x2cbe24=_0x42b1b6[_0x1f7476];return _0x2cbe24;}async function loadProjectFromIDB(){const _0x29cda1=_0x5adb32;try{let _0x41e535=await idbGet('nezumi-sketch-save');if(!_0x41e535){console[_0x29cda1(0x1f2)](_0x29cda1(0x1ae));try{const _0x1ad127=localStorage[_0x29cda1(0x19f)]('nezumi-sketch-save-quick');if(_0x1ad127){const _0x353b76=JSON[_0x29cda1(0x20e)](_0x1ad127);_0x353b76&&_0x353b76[_0x29cda1(0x21a)]&&(console[_0x29cda1(0x1f2)](_0x29cda1(0x1dc)),_0x41e535=_0x353b76);}}catch(_0x206eb1){console[_0x29cda1(0x1b6)](_0x29cda1(0x21b),_0x206eb1);}if(!_0x41e535){if(typeof requestAutoSave===_0x29cda1(0x1a8))requestAutoSave();return;}}console[_0x29cda1(0x1e1)](_0x29cda1(0x20b),{'projects':Array[_0x29cda1(0x1ba)](_0x41e535['projects'])?_0x41e535[_0x29cda1(0x21a)][_0x29cda1(0x21e)]:0x0,'activeProject':_0x41e535[_0x29cda1(0x219)]}),projects=_0x41e535[_0x29cda1(0x21a)][_0x29cda1(0x1be)]((_0x3449bb,_0x134c61)=>{const _0x3d1f80=_0x29cda1;let _0x16f78f=createProject(_0x3449bb['width'],_0x3449bb[_0x3d1f80(0x1fd)],_0x3449bb[_0x3d1f80(0x1b8)]||'画像'+(_0x134c61+0x1));return _0x16f78f[_0x3d1f80(0x22a)]=_0x3449bb[_0x3d1f80(0x22a)]['map'](_0x1828e4=>{const _0x33a204=_0x3d1f80;let _0x35b884={'layers':[],'activeLayer':_0x1828e4[_0x33a204(0x1e0)],'layerHistories':[],'layerRedoStacks':[]};for(let _0x41fb77=0x0;_0x41fb77<_0x1828e4[_0x33a204(0x1d2)]['length'];_0x41fb77++){let _0x3c69df=new Image();_0x3c69df['src']=_0x1828e4[_0x33a204(0x1d2)][_0x41fb77];let _0x531d82=document[_0x33a204(0x1f1)](_0x33a204(0x216));_0x531d82[_0x33a204(0x1cc)]=_0x3449bb[_0x33a204(0x1cc)]*cellSize,_0x531d82[_0x33a204(0x1fd)]=_0x3449bb['height']*cellSize,_0x3c69df[_0x33a204(0x208)]=()=>{const _0x2a3982=_0x33a204;let _0x1ae283=_0x531d82[_0x2a3982(0x1ec)]('2d');_0x1ae283[_0x2a3982(0x1bc)](0x0,0x0,_0x531d82[_0x2a3982(0x1cc)],_0x531d82['height']),_0x1ae283[_0x2a3982(0x1f9)](_0x3c69df,0x0,0x0);try{redrawAll();}catch(_0x57071a){}},_0x35b884[_0x33a204(0x1d2)][_0x33a204(0x212)]({'canvas':_0x531d82,'visible':!![]}),_0x35b884[_0x33a204(0x1c8)][_0x33a204(0x212)]([]),_0x35b884[_0x33a204(0x1dd)][_0x33a204(0x212)]([]);}return _0x35b884;}),_0x16f78f[_0x3d1f80(0x1e5)]=_0x3449bb[_0x3d1f80(0x1e5)],_0x16f78f['name']=_0x3449bb[_0x3d1f80(0x1b8)]||'画像'+(_0x134c61+0x1),_0x16f78f;}),activeProject=_0x41e535[_0x29cda1(0x219)]||0x0,await wait(0x64),updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();try{if(typeof updateUndoRedoButtons===_0x29cda1(0x1a8))updateUndoRedoButtons();}catch(_0x498fc2){}setTool(_0x29cda1(0x1a0)),console[_0x29cda1(0x1e1)]('IndexedDBからプロジェクトを読み込んだチュー！');}catch(_0x4d5004){alert(_0x29cda1(0x1a3)),console[_0x29cda1(0x1bd)](_0x4d5004);}}function shiftLayerCanvas(_0x458fff,_0x24e51d,_0x203e6b){const _0x4cd371=_0x5adb32;if(!_0x458fff)return;const _0x4caee8=_0x458fff['width'],_0x19d4e2=_0x458fff['height'],_0x5bdbb5=document['createElement'](_0x4cd371(0x216));_0x5bdbb5['width']=_0x4caee8,_0x5bdbb5['height']=_0x19d4e2;const _0xa8cf9b=_0x5bdbb5[_0x4cd371(0x1ec)]('2d');_0xa8cf9b[_0x4cd371(0x1bc)](0x0,0x0,_0x4caee8,_0x19d4e2),_0xa8cf9b[_0x4cd371(0x1f9)](_0x458fff,0x0,0x0);const _0x1c5946=_0x458fff[_0x4cd371(0x1ec)]('2d');_0x1c5946[_0x4cd371(0x1bc)](0x0,0x0,_0x4caee8,_0x19d4e2),_0x1c5946[_0x4cd371(0x1f9)](_0x5bdbb5,_0x24e51d,_0x203e6b);}function nudgeActiveLayer(_0x724c7,_0x24b00a){const _0x3d4a7d=_0x5adb32,_0x35f7a9=getCurrentProject();if(!_0x35f7a9)return;const _0x38b302=getCurrentFrame();if(!_0x38b302)return;const _0x5bd91b=_0x38b302[_0x3d4a7d(0x1e0)];if(_0x5bd91b==null)return;const _0x41b3c6=(_0x724c7||0x0)*cellSize,_0x1caa3d=(_0x24b00a||0x0)*cellSize;if(_0x41b3c6===0x0&&_0x1caa3d===0x0)return;saveHistory();const _0x243428=_0x38b302[_0x3d4a7d(0x1d2)][_0x5bd91b],_0x516006=_0x243428&&_0x243428['canvas']?_0x243428[_0x3d4a7d(0x216)]:_0x243428;_0x516006?(shiftLayerCanvas(_0x516006,_0x41b3c6,_0x1caa3d),redrawAll()):console['warn'](_0x3d4a7d(0x207),_0x243428);}function startLayerMove(_0x394589){const _0x2942ca=_0x5adb32;layerMoveState[_0x2942ca(0x1d9)]=!![];const _0x4ebec6=getCanvasCoords(_0x394589);layerMoveState[_0x2942ca(0x1df)]={'x':Math[_0x2942ca(0x1a5)](_0x4ebec6['x']/cellSize),'y':Math[_0x2942ca(0x1a5)](_0x4ebec6['y']/cellSize)},layerMoveState['offsetCells']={'x':0x0,'y':0x0};}function endLayerMove(_0xb2906d){const _0x4c129b=_0x5adb32;if(!layerMoveState[_0x4c129b(0x1d9)])return;const _0x5a4f08=layerMoveState[_0x4c129b(0x21c)]['x']*cellSize,_0x214ac2=layerMoveState['offsetCells']['y']*cellSize;if(_0x5a4f08!==0x0||_0x214ac2!==0x0){saveHistory();const _0x445d36=getCurrentFrame();if(_0x445d36&&typeof _0x445d36[_0x4c129b(0x1e0)]===_0x4c129b(0x210)){const _0x42d6f4=_0x445d36[_0x4c129b(0x1d2)][_0x445d36[_0x4c129b(0x1e0)]],_0x575cd2=_0x42d6f4&&_0x42d6f4[_0x4c129b(0x216)]?_0x42d6f4[_0x4c129b(0x216)]:_0x42d6f4;if(_0x575cd2)shiftLayerCanvas(_0x575cd2,_0x5a4f08,_0x214ac2);}}layerMoveState[_0x4c129b(0x1d9)]=![],layerMoveState[_0x4c129b(0x1df)]=null,layerMoveState[_0x4c129b(0x21c)]={'x':0x0,'y':0x0},redrawAll();}