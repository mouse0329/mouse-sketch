const a0_0x38aafa=a0_0x1925;(function(_0x210ce2,_0x5cbda2){const _0x1b21bb=a0_0x1925,_0x3cb88a=_0x210ce2();while(!![]){try{const _0x45bff4=parseInt(_0x1b21bb(0x26d))/0x1*(parseInt(_0x1b21bb(0x20a))/0x2)+-parseInt(_0x1b21bb(0x24d))/0x3+-parseInt(_0x1b21bb(0x284))/0x4+parseInt(_0x1b21bb(0x1cb))/0x5+-parseInt(_0x1b21bb(0x1e9))/0x6+-parseInt(_0x1b21bb(0x2b9))/0x7*(parseInt(_0x1b21bb(0x26e))/0x8)+parseInt(_0x1b21bb(0x28d))/0x9*(parseInt(_0x1b21bb(0x271))/0xa);if(_0x45bff4===_0x5cbda2)break;else _0x3cb88a['push'](_0x3cb88a['shift']());}catch(_0x4788c8){_0x3cb88a['push'](_0x3cb88a['shift']());}}}(a0_0x5ad1,0x65d10));const a0_0x53f6c7=(function(){let _0x28eacf=!![];return function(_0x57c088,_0xd1ac34){const _0x528139=_0x28eacf?function(){const _0x4c3f94=a0_0x1925;if(_0xd1ac34){const _0x21f86c=_0xd1ac34[_0x4c3f94(0x2b0)](_0x57c088,arguments);return _0xd1ac34=null,_0x21f86c;}}:function(){};return _0x28eacf=![],_0x528139;};}()),a0_0x5506da=a0_0x53f6c7(this,function(){const _0x56b4f1=a0_0x1925;return a0_0x5506da[_0x56b4f1(0x279)]()[_0x56b4f1(0x1ac)](_0x56b4f1(0x197))['toString']()[_0x56b4f1(0x28c)](a0_0x5506da)[_0x56b4f1(0x1ac)]('(((.+)+)+)+$');});a0_0x5506da();let canvas=document[a0_0x38aafa(0x275)]('canvas'),ctx=canvas[a0_0x38aafa(0x2c6)]('2d');const wrapper=document[a0_0x38aafa(0x275)](a0_0x38aafa(0x1cf));let cellSize=0x14,currentColor=a0_0x38aafa(0x265),currentTool=a0_0x38aafa(0x182),penSize=0x1,penMode=a0_0x38aafa(0x2e2),layers=[],activeLayer=0x0,layerHistories=[],layerRedoStacks=[],currentWidth=0x10,currentHeight=0x10,projects=[],activeProject=0x0,isDrawing=![];function createProject(_0x1365fe=0x10,_0x332b47=0x10,_0x209832=''){const _0x2a8ed6=a0_0x38aafa;let _0x468995=0x14,_0x5935ad=[],_0x3e17a1=[],_0x38986a=[],_0x2123cc=document[_0x2a8ed6(0x1d6)](_0x2a8ed6(0x19d));_0x2123cc[_0x2a8ed6(0x1b8)]=_0x1365fe*_0x468995,_0x2123cc[_0x2a8ed6(0x27c)]=_0x332b47*_0x468995,_0x5935ad[_0x2a8ed6(0x278)](_0x2123cc),_0x3e17a1[_0x2a8ed6(0x278)]([]),_0x38986a[_0x2a8ed6(0x278)]([]);let _0x2114aa={'layers':_0x5935ad,'activeLayer':0x0,'layerHistories':_0x3e17a1,'layerRedoStacks':_0x38986a};return{'frames':[_0x2114aa],'activeFrame':0x0,'width':_0x1365fe,'height':_0x332b47,'name':_0x209832||'ÁîªÂÉè'+(projects['length']+0x1)};}function updateProjectUI(){const _0x28883d=a0_0x38aafa,_0x10aa3d=document[_0x28883d(0x275)](_0x28883d(0x228));_0x10aa3d[_0x28883d(0x25f)]='';for(let _0x2663ae=0x0;_0x2663ae<projects[_0x28883d(0x1c4)];_0x2663ae++){const _0x51b10e=document['createElement']('div');_0x51b10e[_0x28883d(0x252)]=_0x28883d(0x2bc)+(_0x2663ae===activeProject?_0x28883d(0x1e4):''),_0x51b10e[_0x28883d(0x234)]=()=>{activeProject=_0x2663ae,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();};const _0x173d4e=document['createElement'](_0x28883d(0x28e));_0x173d4e[_0x28883d(0x252)]=_0x28883d(0x1d4),_0x173d4e[_0x28883d(0x221)]=projects[_0x2663ae][_0x28883d(0x2e6)]||'ÁîªÂÉè'+(_0x2663ae+0x1),_0x173d4e[_0x28883d(0x198)]='„ÇØ„É™„ÉÉ„ÇØ„ÅßÂêçÂâç„ÇíÁ∑®ÈõÜ',_0x173d4e['onclick']=_0x1e3db1=>{const _0x326507=_0x28883d;_0x1e3db1[_0x326507(0x214)](),editProjectName(_0x2663ae,_0x173d4e);},_0x51b10e[_0x28883d(0x237)](_0x173d4e);const _0x58aef8=document[_0x28883d(0x1d6)](_0x28883d(0x2a4));_0x58aef8[_0x28883d(0x221)]='ÂâäÈô§',_0x58aef8[_0x28883d(0x252)]=_0x28883d(0x27a),_0x58aef8['disabled']=projects[_0x28883d(0x1c4)]===0x1,_0x58aef8[_0x28883d(0x234)]=_0x5a7466=>{const _0x20c092=_0x28883d;_0x5a7466[_0x20c092(0x214)](),removeProjectAt(_0x2663ae);},_0x51b10e['appendChild'](_0x58aef8),_0x10aa3d[_0x28883d(0x237)](_0x51b10e);}document[_0x28883d(0x275)](_0x28883d(0x1ed))['textContent']='('+projects[_0x28883d(0x1c4)]+'Êûö)';}function editProjectName(_0x4b7e0e,_0x7a5c7b){const _0x382874=a0_0x38aafa,_0x365581=document[_0x382874(0x1d6)](_0x382874(0x295));_0x365581[_0x382874(0x17d)]=_0x382874(0x23e),_0x365581['value']=projects[_0x4b7e0e][_0x382874(0x2e6)]||'ÁîªÂÉè'+(_0x4b7e0e+0x1),_0x365581['className']=_0x382874(0x186),_0x365581['style'][_0x382874(0x1b8)]=_0x382874(0x29d),_0x365581[_0x382874(0x1f4)]=()=>{const _0xfeeef1=_0x382874;projects[_0x4b7e0e][_0xfeeef1(0x2e6)]=_0x365581[_0xfeeef1(0x24e)][_0xfeeef1(0x19b)]()||'ÁîªÂÉè'+(_0x4b7e0e+0x1),updateProjectUI();},_0x365581[_0x382874(0x2ca)]=_0x44b7ce=>{const _0x568f75=_0x382874;if(_0x44b7ce['key']===_0x568f75(0x276))_0x365581[_0x568f75(0x1ef)]();},_0x7a5c7b[_0x382874(0x2e8)](_0x365581),_0x365581[_0x382874(0x2be)](),_0x365581[_0x382874(0x1aa)]();}function showNewProjectDialog(_0x317064){const _0x570196=a0_0x38aafa;let _0x5a973e=document[_0x570196(0x275)]('new-project-dialog');if(_0x5a973e)_0x5a973e[_0x570196(0x187)]();const _0x49d7eb=document[_0x570196(0x1d6)](_0x570196(0x2c9));_0x49d7eb['id']=_0x570196(0x1db),_0x49d7eb[_0x570196(0x1f8)][_0x570196(0x1f7)]=_0x570196(0x1e3),_0x49d7eb[_0x570196(0x1f8)][_0x570196(0x2a7)]='0',_0x49d7eb[_0x570196(0x1f8)]['top']='0',_0x49d7eb['style'][_0x570196(0x1b8)]='100vw',_0x49d7eb['style'][_0x570196(0x27c)]=_0x570196(0x1f1),_0x49d7eb[_0x570196(0x1f8)]['background']=_0x570196(0x180),_0x49d7eb[_0x570196(0x1f8)][_0x570196(0x2f0)]=_0x570196(0x20c),_0x49d7eb[_0x570196(0x1f8)][_0x570196(0x19e)]=_0x570196(0x243),_0x49d7eb[_0x570196(0x1f8)][_0x570196(0x1fd)]=_0x570196(0x243),_0x49d7eb['style'][_0x570196(0x24b)]=_0x570196(0x1c9),_0x49d7eb[_0x570196(0x25f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22background:#fff;\x20border-radius:10px;\x20box-shadow:0\x202px\x2016px\x20#0003;\x20padding:28px\x2032px;\x20min-width:240px;\x20text-align:center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:0;\x22>Êñ∞„Åó„ÅÑÁîªÂÉè„ÅÆ„Çµ„Ç§„Ç∫</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:12px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>ÂêçÂâç:\x20<input\x20id=\x22newProjName\x22\x20type=\x22text\x22\x20maxlength=\x2232\x22\x20value=\x22ÁîªÂÉè'+(projects['length']+0x1)+'\x22\x20style=\x22width:120px;\x22></label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:12px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>ÂπÖ:\x20<input\x20id=\x22newProjW\x22\x20type=\x22number\x22\x20min=\x221\x22\x20max=\x22256\x22\x20value=\x2216\x22\x20style=\x22width:60px;\x22></label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22margin-left:12px;\x22>È´ò„Åï:\x20<input\x20id=\x22newProjH\x22\x20type=\x22number\x22\x20min=\x221\x22\x20max=\x22256\x22\x20value=\x2216\x22\x20style=\x22width:60px;\x22></label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22newProjOkBtn\x22>‰ΩúÊàê</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22newProjCancelBtn\x22\x20style=\x22margin-left:12px;\x22>„Ç≠„É£„É≥„Çª„É´</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',document['body'][_0x570196(0x237)](_0x49d7eb),_0x49d7eb[_0x570196(0x2c0)](_0x570196(0x2e4))[_0x570196(0x234)]=()=>{const _0xb5d0d7=_0x570196,_0x527811=parseInt(_0x49d7eb[_0xb5d0d7(0x2c0)]('#newProjW')[_0xb5d0d7(0x24e)],0xa),_0x43752a=parseInt(_0x49d7eb[_0xb5d0d7(0x2c0)](_0xb5d0d7(0x1b0))['value'],0xa),_0x16d997=_0x49d7eb[_0xb5d0d7(0x2c0)]('#newProjName')[_0xb5d0d7(0x24e)][_0xb5d0d7(0x19b)]();_0x49d7eb[_0xb5d0d7(0x187)]();if(_0x317064)_0x317064(_0x527811,_0x43752a,_0x16d997);},_0x49d7eb[_0x570196(0x2c0)](_0x570196(0x1f9))[_0x570196(0x234)]=()=>{_0x49d7eb['remove']();};}function addProject(){showNewProjectDialog((_0x20f922,_0x2ebf5d,_0x49f297)=>{const _0xe5b34c=a0_0x1925;if(!Number[_0xe5b34c(0x28b)](_0x20f922)||_0x20f922<0x1)_0x20f922=0x10;if(!Number[_0xe5b34c(0x28b)](_0x2ebf5d)||_0x2ebf5d<0x1)_0x2ebf5d=0x10;projects[_0xe5b34c(0x278)](createProject(_0x20f922,_0x2ebf5d,_0x49f297)),activeProject=projects['length']-0x1,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();});}function removeProjectAt(_0x1d72d7){const _0x5f11ce=a0_0x38aafa;if(projects[_0x5f11ce(0x1c4)]<=0x1)return;projects[_0x5f11ce(0x2b7)](_0x1d72d7,0x1);if(activeProject>=projects[_0x5f11ce(0x1c4)])activeProject=projects[_0x5f11ce(0x1c4)]-0x1;updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();}function getCurrentProject(){return projects[activeProject];}function updateFrameUI(){const _0x1d227a=a0_0x38aafa,_0x569dae=document['getElementById'](_0x1d227a(0x1c6)),_0x4e6c16=getCurrentProject();_0x569dae['innerHTML']='';for(let _0x5a8d8c=0x0;_0x5a8d8c<_0x4e6c16['frames']['length'];_0x5a8d8c++){const _0x56c7fa=document[_0x1d227a(0x1d6)](_0x1d227a(0x2c9));_0x56c7fa[_0x1d227a(0x252)]=_0x1d227a(0x254)+(_0x5a8d8c===_0x4e6c16[_0x1d227a(0x2a5)]?_0x1d227a(0x1e4):''),_0x56c7fa[_0x1d227a(0x234)]=()=>{const _0x283f19=_0x1d227a;_0x4e6c16[_0x283f19(0x2a5)]=_0x5a8d8c,updateFrameUI(),updateLayerUI(),redrawAll();};const _0x78c309=document['createElement'](_0x1d227a(0x19d));_0x78c309[_0x1d227a(0x252)]=_0x1d227a(0x1da),_0x78c309[_0x1d227a(0x1b8)]=0x20,_0x78c309[_0x1d227a(0x27c)]=0x20;let _0x190678=_0x78c309[_0x1d227a(0x2c6)]('2d');_0x190678[_0x1d227a(0x22d)](0x0,0x0,0x20,0x20);for(let _0x65c446=0x0;_0x65c446<_0x4e6c16['frames'][_0x5a8d8c][_0x1d227a(0x262)]['length'];_0x65c446++){_0x190678[_0x1d227a(0x1ff)](_0x4e6c16[_0x1d227a(0x2b3)][_0x5a8d8c][_0x1d227a(0x262)][_0x65c446],0x0,0x0,_0x78c309[_0x1d227a(0x1b8)],_0x78c309[_0x1d227a(0x27c)]);}_0x56c7fa['appendChild'](_0x78c309);const _0x285555=document['createElement'](_0x1d227a(0x28e));_0x285555[_0x1d227a(0x221)]='F'+(_0x5a8d8c+0x1),_0x56c7fa[_0x1d227a(0x237)](_0x285555);const _0x43d313=document[_0x1d227a(0x1d6)]('button');_0x43d313[_0x1d227a(0x221)]='ÂâäÈô§',_0x43d313[_0x1d227a(0x252)]=_0x1d227a(0x286),_0x43d313[_0x1d227a(0x256)]=_0x4e6c16[_0x1d227a(0x2b3)][_0x1d227a(0x1c4)]===0x1,_0x43d313[_0x1d227a(0x234)]=_0x24eaa9=>{const _0x7df24=_0x1d227a;_0x24eaa9[_0x7df24(0x214)](),removeFrameAt(_0x5a8d8c);},_0x56c7fa[_0x1d227a(0x237)](_0x43d313),_0x569dae[_0x1d227a(0x237)](_0x56c7fa);}document[_0x1d227a(0x275)](_0x1d227a(0x240))['textContent']='('+_0x4e6c16[_0x1d227a(0x2b3)][_0x1d227a(0x1c4)]+_0x1d227a(0x2c4);}function addFrame(){const _0x3d9243=a0_0x38aafa;let _0x236038=getCurrentProject(),_0x32cd57=_0x236038[_0x3d9243(0x2b3)][_0x236038[_0x3d9243(0x2a5)]],_0x23c635=_0x32cd57[_0x3d9243(0x262)][_0x3d9243(0x294)](_0x42c364=>{const _0x44110f=_0x3d9243;let _0x18f041=document[_0x44110f(0x1d6)]('canvas');return _0x18f041[_0x44110f(0x1b8)]=_0x42c364[_0x44110f(0x1b8)],_0x18f041[_0x44110f(0x27c)]=_0x42c364[_0x44110f(0x27c)],_0x18f041[_0x44110f(0x2c6)]('2d')[_0x44110f(0x1ff)](_0x42c364,0x0,0x0),_0x18f041;}),_0x51ca62=_0x23c635[_0x3d9243(0x294)](()=>[]),_0x4ee6cf=_0x23c635[_0x3d9243(0x294)](()=>[]),_0x27d738={'layers':_0x23c635,'activeLayer':0x0,'layerHistories':_0x51ca62,'layerRedoStacks':_0x4ee6cf};_0x236038[_0x3d9243(0x2b3)][_0x3d9243(0x2b7)](_0x236038[_0x3d9243(0x2a5)]+0x1,0x0,_0x27d738),_0x236038['activeFrame']++,updateFrameUI(),updateLayerUI(),redrawAll();}function removeFrameAt(_0x18264a){const _0x881c85=a0_0x38aafa;let _0x2db182=getCurrentProject();if(_0x2db182['frames'][_0x881c85(0x1c4)]<=0x1)return;_0x2db182['frames']['splice'](_0x18264a,0x1);if(_0x2db182[_0x881c85(0x2a5)]>=_0x2db182['frames'][_0x881c85(0x1c4)])_0x2db182['activeFrame']=_0x2db182[_0x881c85(0x2b3)][_0x881c85(0x1c4)]-0x1;updateFrameUI(),updateLayerUI(),redrawAll();}function getCurrentFrame(){const _0x362953=a0_0x38aafa;return getCurrentProject()[_0x362953(0x2b3)][getCurrentProject()[_0x362953(0x2a5)]];}function updateLayerUI(){const _0x5689d7=a0_0x38aafa;let {layers:_0x1802bf,activeLayer:_0x58dfa2}=getCurrentFrame();document[_0x5689d7(0x275)]('layerCount')[_0x5689d7(0x221)]='('+_0x1802bf['length']+'Êûö)';const _0x28dbf9=document[_0x5689d7(0x275)](_0x5689d7(0x23b));_0x28dbf9['innerHTML']='';for(let _0x4a10cf=_0x1802bf[_0x5689d7(0x1c4)]-0x1;_0x4a10cf>=0x0;_0x4a10cf--){const _0x1f44e3=document[_0x5689d7(0x1d6)]('div');_0x1f44e3['className']=_0x5689d7(0x2d7)+(_0x4a10cf===_0x58dfa2?_0x5689d7(0x1e4):''),_0x1f44e3['onclick']=_0x250a2c=>{const _0x1aa492=_0x5689d7;if(_0x250a2c[_0x1aa492(0x2e5)][_0x1aa492(0x22b)]['contains'](_0x1aa492(0x20e)))return;getCurrentFrame()[_0x1aa492(0x1b5)]=_0x4a10cf,updateLayerUI(),redrawAll();};const _0x28caa6=document['createElement'](_0x5689d7(0x19d));_0x28caa6[_0x5689d7(0x252)]=_0x5689d7(0x1f2),_0x28caa6[_0x5689d7(0x1b8)]=0x20,_0x28caa6[_0x5689d7(0x27c)]=0x20;let _0x3cd1bf=_0x28caa6[_0x5689d7(0x2c6)]('2d');_0x3cd1bf['clearRect'](0x0,0x0,0x20,0x20),_0x3cd1bf[_0x5689d7(0x1ff)](_0x1802bf[_0x4a10cf],0x0,0x0,_0x28caa6[_0x5689d7(0x1b8)],_0x28caa6[_0x5689d7(0x27c)]),_0x1f44e3[_0x5689d7(0x237)](_0x28caa6);const _0x5e73d4=document['createElement'](_0x5689d7(0x28e));_0x5e73d4[_0x5689d7(0x221)]=_0x5689d7(0x2d6)+(_0x4a10cf+0x1),_0x1f44e3[_0x5689d7(0x237)](_0x5e73d4);const _0x5353aa=document[_0x5689d7(0x1d6)](_0x5689d7(0x2a4));_0x5353aa[_0x5689d7(0x221)]='‚Üë',_0x5353aa[_0x5689d7(0x252)]=_0x5689d7(0x20e),_0x5353aa['title']='‰∏ä„Å´ÁßªÂãï',_0x5353aa[_0x5689d7(0x256)]=_0x4a10cf===_0x1802bf[_0x5689d7(0x1c4)]-0x1,_0x5353aa[_0x5689d7(0x234)]=_0xbd0434=>{const _0x3d5457=_0x5689d7;_0xbd0434['stopPropagation'](),_0x4a10cf<_0x1802bf[_0x3d5457(0x1c4)]-0x1&&swapLayer(_0x4a10cf,_0x4a10cf+0x1);},_0x1f44e3[_0x5689d7(0x237)](_0x5353aa);const _0x9b4e70=document['createElement']('button');_0x9b4e70['textContent']='‚Üì',_0x9b4e70['className']=_0x5689d7(0x20e),_0x9b4e70['title']='‰∏ã„Å´ÁßªÂãï',_0x9b4e70[_0x5689d7(0x256)]=_0x4a10cf===0x0,_0x9b4e70['onclick']=_0x5ad245=>{const _0x1eb698=_0x5689d7;_0x5ad245[_0x1eb698(0x214)](),_0x4a10cf>0x0&&swapLayer(_0x4a10cf,_0x4a10cf-0x1);},_0x1f44e3[_0x5689d7(0x237)](_0x9b4e70);const _0x3417dd=document[_0x5689d7(0x1d6)](_0x5689d7(0x2a4));_0x3417dd[_0x5689d7(0x221)]='ÂâäÈô§',_0x3417dd[_0x5689d7(0x252)]=_0x5689d7(0x20e),_0x3417dd[_0x5689d7(0x198)]='„Åì„ÅÆ„É¨„Ç§„É§„Éº„ÇíÂâäÈô§',_0x3417dd[_0x5689d7(0x256)]=_0x1802bf[_0x5689d7(0x1c4)]===0x1,_0x3417dd[_0x5689d7(0x234)]=_0x4e3d62=>{const _0x36f122=_0x5689d7;_0x4e3d62[_0x36f122(0x214)](),removeLayerAt(_0x4a10cf);},_0x1f44e3[_0x5689d7(0x237)](_0x3417dd),_0x28dbf9[_0x5689d7(0x237)](_0x1f44e3);}}function swapLayer(_0x2f0b30,_0x20482f){const _0x17709b=a0_0x38aafa;let _0x3a42e7=getCurrentFrame();[_0x3a42e7[_0x17709b(0x262)][_0x2f0b30],_0x3a42e7[_0x17709b(0x262)][_0x20482f]]=[_0x3a42e7[_0x17709b(0x262)][_0x20482f],_0x3a42e7[_0x17709b(0x262)][_0x2f0b30]],[_0x3a42e7[_0x17709b(0x29c)][_0x2f0b30],_0x3a42e7['layerHistories'][_0x20482f]]=[_0x3a42e7[_0x17709b(0x29c)][_0x20482f],_0x3a42e7['layerHistories'][_0x2f0b30]],[_0x3a42e7[_0x17709b(0x2d0)][_0x2f0b30],_0x3a42e7[_0x17709b(0x2d0)][_0x20482f]]=[_0x3a42e7[_0x17709b(0x2d0)][_0x20482f],_0x3a42e7[_0x17709b(0x2d0)][_0x2f0b30]];if(_0x3a42e7[_0x17709b(0x1b5)]===_0x2f0b30)_0x3a42e7[_0x17709b(0x1b5)]=_0x20482f;else{if(_0x3a42e7['activeLayer']===_0x20482f)_0x3a42e7[_0x17709b(0x1b5)]=_0x2f0b30;}updateLayerUI(),redrawAll();}function removeLayerAt(_0x5bdd3a){const _0x14d131=a0_0x38aafa;let _0x179c2e=getCurrentFrame();if(_0x179c2e[_0x14d131(0x262)][_0x14d131(0x1c4)]<=0x1)return;_0x179c2e[_0x14d131(0x262)][_0x14d131(0x2b7)](_0x5bdd3a,0x1),_0x179c2e[_0x14d131(0x29c)][_0x14d131(0x2b7)](_0x5bdd3a,0x1),_0x179c2e['layerRedoStacks']['splice'](_0x5bdd3a,0x1);if(_0x179c2e[_0x14d131(0x1b5)]>=_0x179c2e[_0x14d131(0x262)][_0x14d131(0x1c4)])_0x179c2e['activeLayer']=_0x179c2e[_0x14d131(0x262)][_0x14d131(0x1c4)]-0x1;updateLayerUI(),redrawAll();}function addLayer(){const _0x4c262a=a0_0x38aafa;let _0x204b1a=getCurrentProject(),_0x82f8df=getCurrentFrame(),_0x343561=document[_0x4c262a(0x1d6)](_0x4c262a(0x19d));_0x343561['width']=_0x204b1a['width']*cellSize,_0x343561[_0x4c262a(0x27c)]=_0x204b1a['height']*cellSize,_0x82f8df[_0x4c262a(0x262)][_0x4c262a(0x278)](_0x343561),_0x82f8df[_0x4c262a(0x29c)][_0x4c262a(0x278)]([]),_0x82f8df[_0x4c262a(0x2d0)]['push']([]),_0x82f8df['activeLayer']=_0x82f8df[_0x4c262a(0x262)]['length']-0x1,saveHistory(),updateLayerUI(),redrawAll();}function removeLayer(){const _0x57500b=a0_0x38aafa;let _0x259241=getCurrentFrame();if(_0x259241[_0x57500b(0x262)][_0x57500b(0x1c4)]<=0x1)return;_0x259241['layers']['splice'](_0x259241[_0x57500b(0x1b5)],0x1),_0x259241[_0x57500b(0x29c)][_0x57500b(0x2b7)](_0x259241[_0x57500b(0x1b5)],0x1),_0x259241[_0x57500b(0x2d0)]['splice'](_0x259241[_0x57500b(0x1b5)],0x1),_0x259241[_0x57500b(0x1b5)]=Math['max'](0x0,_0x259241[_0x57500b(0x1b5)]-0x1),updateLayerUI(),redrawAll();}function selectLayer(_0x46c1e2){const _0x1061e1=a0_0x38aafa;getCurrentFrame()[_0x1061e1(0x1b5)]=parseInt(_0x46c1e2),updateLayerUI();}let PALETTE_COLORS=[a0_0x38aafa(0x1f3),a0_0x38aafa(0x1ba),a0_0x38aafa(0x244),a0_0x38aafa(0x19a),a0_0x38aafa(0x281),'#ffffff',a0_0x38aafa(0x265),a0_0x38aafa(0x2c2),a0_0x38aafa(0x266),'#00ff00',a0_0x38aafa(0x29a),a0_0x38aafa(0x296),a0_0x38aafa(0x291),a0_0x38aafa(0x1b9),a0_0x38aafa(0x1ee),a0_0x38aafa(0x202),a0_0x38aafa(0x26c),a0_0x38aafa(0x269),a0_0x38aafa(0x219),'#c0c0c0',a0_0x38aafa(0x25b)],currentAlpha=0x1,animationTimer=null,animationDelay=0x12c,animationIndex=0x0;function playAnimation(){const _0xb1fb2b=a0_0x38aafa;let _0xaa5952=getCurrentProject();if(!_0xaa5952||!_0xaa5952['frames']||_0xaa5952[_0xb1fb2b(0x2b3)][_0xb1fb2b(0x1c4)]<=0x1)return;if(animationTimer)return;animationIndex=0x0;const _0x204981=_0xaa5952[_0xb1fb2b(0x2b3)];animationTimer=setInterval(()=>{const _0x2983f7=_0xb1fb2b;ctx['clearRect'](0x0,0x0,canvas[_0x2983f7(0x1b8)],canvas[_0x2983f7(0x27c)]);let _0x445586=_0x204981[animationIndex];for(let _0x239eef=0x0;_0x239eef<_0x445586[_0x2983f7(0x262)][_0x2983f7(0x1c4)];_0x239eef++){ctx[_0x2983f7(0x1ff)](_0x445586['layers'][_0x239eef],0x0,0x0);}drawGrid(_0xaa5952[_0x2983f7(0x1b8)],_0xaa5952[_0x2983f7(0x27c)]),animationIndex=(animationIndex+0x1)%_0x204981[_0x2983f7(0x1c4)];},animationDelay);}function stopAnimation(){animationTimer&&(clearInterval(animationTimer),animationTimer=null,redrawAll());}function setAnimationDelay(_0x52355a){const _0x59126b=a0_0x38aafa;_0x52355a=Math[_0x59126b(0x2c3)](0xa,parseInt(_0x52355a,0xa)||0x12c),animationDelay=_0x52355a,animationTimer&&(clearInterval(animationTimer),animationTimer=null,playAnimation());}function setTool(_0x4b69e6){const _0x21dfe5=a0_0x38aafa;currentTool=_0x4b69e6,document[_0x21dfe5(0x29b)](_0x21dfe5(0x191))['forEach'](_0x20b62a=>{const _0x43fb23=_0x21dfe5;_0x20b62a['classList'][_0x43fb23(0x29f)](_0x43fb23(0x1a9),_0x20b62a[_0x43fb23(0x2ba)][_0x43fb23(0x1be)]===_0x4b69e6);}),document[_0x21dfe5(0x29b)]('#palette-toolbar\x20.tool-btn')[_0x21dfe5(0x1bd)](_0x59f5e3=>{const _0x48b72d=_0x21dfe5;_0x59f5e3['classList'][_0x48b72d(0x29f)](_0x48b72d(0x1a9),_0x59f5e3[_0x48b72d(0x2ba)][_0x48b72d(0x1be)]===_0x4b69e6);}),_0x4b69e6===_0x21dfe5(0x232)?canvas['style']['cursor']=_0x21dfe5(0x231):canvas[_0x21dfe5(0x1f8)][_0x21dfe5(0x2bd)]='crosshair';}function setPenSize(_0x3e61e2){const _0x37fca2=a0_0x38aafa;penSize=parseInt(_0x3e61e2)||0x1;let _0x4cf700=document['getElementById'](_0x37fca2(0x1c3));if(_0x4cf700)_0x4cf700[_0x37fca2(0x24e)]=penSize;let _0xdf0b4f=document[_0x37fca2(0x275)](_0x37fca2(0x250));if(_0xdf0b4f)_0xdf0b4f[_0x37fca2(0x24e)]=penSize;}function setPenMode(_0x4b3aed){const _0x14e669=a0_0x38aafa;penMode=_0x4b3aed;let _0x22bf02=document[_0x14e669(0x275)](_0x14e669(0x23a));if(_0x22bf02)_0x22bf02[_0x14e669(0x24e)]=penMode;let _0x4fd853=document[_0x14e669(0x275)](_0x14e669(0x1a1));if(_0x4fd853)_0x4fd853[_0x14e669(0x24e)]=penMode;}function a0_0x5ad1(){const _0x1c381c=['strokeStyle','zoomValue','splice','get','63psIyud','dataset','has','project-item','cursor','focus','nezumi-sketch.msketch','querySelector','warn','#ffa500','max','„Ç≥„Éû)','key','getContext','palette-del-btn','byteLength','div','onkeydown','application/octet-stream','„Éë„É¨„ÉÉ„Éà„Å´Ëâ≤„ÇíËøΩÂä†','IndexedDB„Åã„Çâ„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åü„ÉÅ„É•„Éº‚Ä¶','sidebar','„Éï„É¨„Éº„É†„Åå„ÅÇ„Çä„Åæ„Åõ„Çì','layerRedoStacks','.gif','vp8','100%','„Éï„Ç°„Ç§„É´„Å´„Éó„É≠„Ç∏„Çß„ÇØ„Éà„É°„Çø„Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇË™≠„ÅøËæº„Åø„Åß„Åç„Åæ„Åõ„Çì„ÄÇ','destination-out','„É¨„Ç§„É§„Éº','layer-item','touches','stroke','WebCodecs','closePath','background','selected','pointerup','restore','eraser','nezumi-palette','square','close','#newProjOkBtn','target','name','„Åì„ÅÆËâ≤„Çí„Éë„É¨„ÉÉ„Éà„Åã„ÇâÂâäÈô§','replaceWith','nezumi-sketch-save','circle','beginPath','open','click','dark','nezumi-animation.apng','display','type','pointermove','then','rgba(0,0,0,0.3)','error','pen','main-container','translate(','onload','project-name-edit','remove','overflow','themeToggleBtn','image/jpeg','menu-toggle-btn','match','hypot','>2</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x223\x22','image/apng','GIF','.tool-btn','result','clientX','VideoEncoder','Ë™≠Ëæº„Ç®„É©„Éº','top','(((.+)+)+)+$','title','documentElement','#888888','trim','isArray','canvas','alignItems','putImageData','colorPicker','palette-penMode','number','startsWith','nezumi-theme','touch','abs','floor','fill','active','select','keyup','search','pathname','auto','boolean','#newProjH','none','min','src','menu-toggle-btn-close','activeLayer','touchcancel','onmouseleave','width','#800000','#000000','touchstart','zoomSlider','forEach','tool','webp','px,\x20','render','grabbing','penSize','length','onerror','frameList','catch','href','3000','color','458555ntXURF','keydown','pointerdown','preventDefault','canvas-container','„ÉÄ„Éº„ÇØ„ÉÜ„Éº„Éû„Å´ÂàáÊõø','nezumi-animation.gif','block','insertBefore','project-name','getItem','createElement','shift','alphaSlider','\x22\x20data-tool=\x22fill\x22\x20onclick=\x22setTool(\x27fill\x27)\x22><span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>format_color_fill</span>Â°ó„Çä„Å§„Å∂„Åó</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22margin-left:8px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Â§™„Åï:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22palette-penSize\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x221\x22','frame-thumb','new-project-dialog','removeChild','>1</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x222\x22','add','toDataURL','clear','touchend','encode','fixed','\x20active','stringify','.palette-color','deltaY','body','3937560ufqvBg','pop','%</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22undo()\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>undo</span>\x20Êàª„Åô\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22redo()\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>redo</span>\x20Êàª„Åô„ÇíÊàª„Åô\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','touchAction','projectCount','#808000','blur','setPointerCapture','100vh','layer-thumb','transparent','onblur','onmousedown','slice','position','style','#newProjCancelBtn','image/png','GIF„Å´Â§âÊèõ„Åß„Åç„ÇãÁîªÂÉè„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ','setItem','justifyContent','save','drawImage','nezumi-drawing','createObjectURL','#008000','image/','.section.collapsible\x20.section-content','animSpeedValue','data-theme','nezumi-standalone','(prefers-color-scheme:\x20dark)','flush','14uGmiOY','palette-add-btn','flex','globalCompositeOperation','layer-btn','„É°„Çø„Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü','rgba(','„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ','ontouchend','alphaValue','stopPropagation','download','fillRect','_spritesheet.png','.section-content','#800080','ontouchstart','light','„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíIndexedDB„Å´‰øùÂ≠ò„Åó„Åü„ÉÅ„É•„ÉºÔºÅ','addEventListener','UPNG','nezumi-animation','pointerType','textContent','onchange','readonly','<span\x20style=\x22font-size:13px;color:#888;\x22>ÈÄèÊòé</span>','undefined','objectStore','#palette-alphaValue','projectList','animSpeedRange','innerWidth','classList','beforeunload','clearRect','keyval','project','color-palette','grab','pan','\x22\x20style=\x22vertical-align:\x20middle;\x20width:70px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22palette-alphaValue\x22>','onclick','finished','subarray','appendChild','onmouseup','onmousemove','penMode','layerList','files','activeProject','text','contains','frameCount','#palette-alphaSlider','jpeg','center','#444444','palette-alphaValue','#palette-penSize','palette-alphaSlider','jpg','nezumi_about_visited','arc','zIndex','Shift','1023636OyXKxu','value','projects','palette-penSize','resize','className','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22tool-btn','frame-item','revokeObjectURL','disabled','.webm','\x0a---NEZUMI_METADATA_START---\x0a','readwrite','all','#ff69b4','#00000000','clientY','palette-toolbar','innerHTML','onsuccess','data','layers','nezumi-projects','„Éï„É¨„Éº„É†Èñì„ÅÆ‰ΩôÁôΩ(px)\x20„ÇíÊåáÂÆöÔºà‰æã:\x200Ôºâ','#ff0000','#ffff00','ontouchmove','filter','#000080','anonymous','#ccc','#008080','18959ijBvyJ','693928GhthjY','round','pointerId','10XJZHgl','„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Åå„ÅÇ„Çä„Åæ„Åõ„Çì','onupgradeneeded','.apng','getElementById','Enter','.toggle-btn','push','toString','project-btn','„Åì„ÅÆ„Éñ„É©„Ç¶„Ç∂„ÅØWebCodecs„Å´„Çà„ÇãWEBP„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„Å´ÂØæÂøú„Åó„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ','height','replace','decode','transaction','getBoundingClientRect','#cccccc','IndexedDB„Åã„Çâ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíË™≠„ÅøËæº„Çì„Å†„ÉÅ„É•„ÉºÔºÅ','„Çπ„Çø„É≥„Éâ„Ç¢„É≠„É≥ÂΩ¢Âºè„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü:\x20','1663240xvhpIM','split','frame-btn','getImageData','parse','hidden','oninput','isFinite','constructor','21479103enQVXi','span','touchmove','crossOrigin','#ff00ff','nezumi-sketch-db','DOMContentLoaded','map','input','#0000ff','put','\x20selected','application/json','#00ffff','querySelectorAll','layerHistories','80px','moveTo','toggle','globalAlpha','sidebar-open','addFrame','oncomplete','button','activeFrame','removeEventListener','left','configure','aria-pressed','fillStyle','nezumi-spritesheet','ontouchcancel','\x22\x20data-tool=\x22pen\x22\x20onclick=\x22setTool(\x27pen\x27)\x22><span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>edit</span>„Éö„É≥</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22tool-btn','/about?terms=true','matchMedia','apply','/index.html','#palette-penMode','frames','setAttribute'];a0_0x5ad1=function(){return _0x1c381c;};return a0_0x5ad1();}function hexToRgba(_0x1166da,_0x6d43a5=0x1){const _0x3577b5=a0_0x38aafa;if(_0x1166da===_0x3577b5(0x1f3)||_0x1166da===_0x3577b5(0x25c))return[0x0,0x0,0x0,0x0];_0x1166da=_0x1166da[_0x3577b5(0x27d)]('#','');if(_0x1166da[_0x3577b5(0x1c4)]===0x3)_0x1166da=_0x1166da[_0x3577b5(0x285)]('')['map'](_0x427711=>_0x427711+_0x427711)['join']('');let _0x33f564=parseInt(_0x1166da,0x10);return[_0x33f564>>0x10&0xff,_0x33f564>>0x8&0xff,_0x33f564&0xff,Math[_0x3577b5(0x26f)](0xff*_0x6d43a5)];}function fillAt(_0x103901,_0x38ddbc){const _0x31eac5=a0_0x38aafa;let _0x51aee8=getCurrentProject(),_0x518c18=getCurrentFrame(),_0x2309c5=_0x518c18[_0x31eac5(0x262)][_0x518c18[_0x31eac5(0x1b5)]][_0x31eac5(0x2c6)]('2d'),_0x8d8ba9=_0x2309c5[_0x31eac5(0x287)](0x0,0x0,_0x51aee8[_0x31eac5(0x1b8)]*cellSize,_0x51aee8[_0x31eac5(0x27c)]*cellSize),_0xcf391d=_0x103901*cellSize,_0x23fac1=_0x38ddbc*cellSize,_0x31d232=getPixel(_0x8d8ba9,_0xcf391d,_0x23fac1),_0x2fd53a=currentColor==='transparent'||currentColor===_0x31eac5(0x25c)||currentAlpha===0x0?[0x0,0x0,0x0,0x0]:hexToRgba(currentColor,currentAlpha);if(colorsMatch(_0x31d232,_0x2fd53a))return;let _0xdda77a=[[_0x103901,_0x38ddbc]],_0x373b9a=new Set();while(_0xdda77a[_0x31eac5(0x1c4)]){let [_0x1ebcc4,_0x3ba95c]=_0xdda77a['pop']();if(_0x1ebcc4<0x0||_0x3ba95c<0x0||_0x1ebcc4>=_0x51aee8['width']||_0x3ba95c>=_0x51aee8[_0x31eac5(0x27c)])continue;let _0x3ac04e=_0x1ebcc4+','+_0x3ba95c;if(_0x373b9a[_0x31eac5(0x2bb)](_0x3ac04e))continue;_0x373b9a[_0x31eac5(0x1de)](_0x3ac04e);let _0x5afb9c=_0x1ebcc4*cellSize,_0x3b1d7b=_0x3ba95c*cellSize,_0x591c68=getPixel(_0x8d8ba9,_0x5afb9c,_0x3b1d7b);if(!colorsMatch(_0x591c68,_0x31d232))continue;for(let _0x97d894=0x0;_0x97d894<cellSize;_0x97d894++){for(let _0x422b20=0x0;_0x422b20<cellSize;_0x422b20++){setPixel(_0x8d8ba9,_0x5afb9c+_0x422b20,_0x3b1d7b+_0x97d894,_0x2fd53a);}}_0xdda77a[_0x31eac5(0x278)]([_0x1ebcc4+0x1,_0x3ba95c]),_0xdda77a[_0x31eac5(0x278)]([_0x1ebcc4-0x1,_0x3ba95c]),_0xdda77a[_0x31eac5(0x278)]([_0x1ebcc4,_0x3ba95c+0x1]),_0xdda77a['push']([_0x1ebcc4,_0x3ba95c-0x1]);}_0x2309c5[_0x31eac5(0x19f)](_0x8d8ba9,0x0,0x0),redrawAll();}function getPixel(_0x264389,_0x5692c9,_0x4fed8d){const _0x2d5f51=a0_0x38aafa;let _0x21af70=(_0x4fed8d*_0x264389['width']+_0x5692c9)*0x4;return[_0x264389['data'][_0x21af70],_0x264389['data'][_0x21af70+0x1],_0x264389[_0x2d5f51(0x261)][_0x21af70+0x2],_0x264389[_0x2d5f51(0x261)][_0x21af70+0x3]];}function setPixel(_0x2ba249,_0x32e97c,_0x2d0dc3,_0x337ac1){const _0x8335b0=a0_0x38aafa;let _0x47f5b2=(_0x2d0dc3*_0x2ba249[_0x8335b0(0x1b8)]+_0x32e97c)*0x4;_0x2ba249[_0x8335b0(0x261)][_0x47f5b2]=_0x337ac1[0x0],_0x2ba249[_0x8335b0(0x261)][_0x47f5b2+0x1]=_0x337ac1[0x1],_0x2ba249['data'][_0x47f5b2+0x2]=_0x337ac1[0x2],_0x2ba249[_0x8335b0(0x261)][_0x47f5b2+0x3]=_0x337ac1[0x3];}function colorsMatch(_0x444ad5,_0x5d2b86){return _0x444ad5[0x0]===_0x5d2b86[0x0]&&_0x444ad5[0x1]===_0x5d2b86[0x1]&&_0x444ad5[0x2]===_0x5d2b86[0x2]&&_0x444ad5[0x3]===_0x5d2b86[0x3];}function handleMouseDown(_0xf79253){const _0x4d95dd=a0_0x38aafa;isDrawing=!![];const _0x8be2b7=getCanvasCoords(_0xf79253),_0x19828d=Math[_0x4d95dd(0x1a7)](_0x8be2b7['x']/cellSize),_0x57024a=Math['floor'](_0x8be2b7['y']/cellSize);currentTool===_0x4d95dd(0x1a8)?(fillAt(_0x19828d,_0x57024a),saveHistory(),isDrawing=![],lastMouse=null):(drawDotXY(_0x19828d,_0x57024a),lastMouse={'x':_0x19828d,'y':_0x57024a});}function handleMouseMove(_0xbac061){const _0x45ccf0=a0_0x38aafa;if(!isDrawing)return;const _0x3fc4f0=getCanvasCoords(_0xbac061),_0x35e898=Math[_0x45ccf0(0x1a7)](_0x3fc4f0['x']/cellSize),_0x4473d0=Math[_0x45ccf0(0x1a7)](_0x3fc4f0['y']/cellSize);if(!lastMouse){drawDotXY(_0x35e898,_0x4473d0),lastMouse={'x':_0x35e898,'y':_0x4473d0};return;}const _0x84e01b=_0x35e898-lastMouse['x'],_0x48a8d8=_0x4473d0-lastMouse['y'],_0x1fa734=Math[_0x45ccf0(0x2c3)](Math[_0x45ccf0(0x1a6)](_0x84e01b),Math[_0x45ccf0(0x1a6)](_0x48a8d8));if(_0x1fa734<=0x1)drawDotXY(_0x35e898,_0x4473d0);else for(let _0x7d7ce4=0x1;_0x7d7ce4<=_0x1fa734;_0x7d7ce4++){const _0x28b896=Math['round'](lastMouse['x']+_0x84e01b*_0x7d7ce4/_0x1fa734),_0x1db7dc=Math[_0x45ccf0(0x26f)](lastMouse['y']+_0x48a8d8*_0x7d7ce4/_0x1fa734);drawDotXY(_0x28b896,_0x1db7dc);}lastMouse={'x':_0x35e898,'y':_0x4473d0};}function handleMouseUp(_0x19fe94){isDrawing&&saveHistory(),isDrawing=![],lastMouse=null;}let lastTouch=null,lastMouse=null,isPinching=![],pinchStartDistance=0x0,pinchStartMid=null,pinchStartScale=0x1,pinchStartPosX=0x0,pinchStartPosY=0x0,pinchRect=null;function getTouchPos(_0xd666a5){const _0x3738fb=a0_0x38aafa,_0x97a6ec=canvas[_0x3738fb(0x280)]();let _0x1b39a5=_0xd666a5[_0x3738fb(0x2d8)]&&_0xd666a5[_0x3738fb(0x2d8)][0x0]?_0xd666a5[_0x3738fb(0x2d8)][0x0]:_0xd666a5['changedTouches'][0x0];const _0x3f3fa7=canvas[_0x3738fb(0x1b8)]/_0x97a6ec['width'],_0x40e94c=canvas[_0x3738fb(0x27c)]/_0x97a6ec[_0x3738fb(0x27c)],_0x550439=_0x1b39a5[_0x3738fb(0x193)],_0x3789b7=_0x1b39a5[_0x3738fb(0x25d)],_0x5a1053=(_0x550439-_0x97a6ec[_0x3738fb(0x2a7)])*_0x3f3fa7,_0x37f4de=(_0x3789b7-_0x97a6ec[_0x3738fb(0x196)])*_0x40e94c;return{'x':Math[_0x3738fb(0x1a7)](_0x5a1053/cellSize),'y':Math[_0x3738fb(0x1a7)](_0x37f4de/cellSize)};}function handleTouchStart(_0x1a33bb){const _0x19b51a=a0_0x38aafa;if(_0x1a33bb['touches'][_0x19b51a(0x1c4)]===0x2){_0x1a33bb[_0x19b51a(0x1ce)](),isPinching=!![],isDrawing=![];const _0x5e003d=_0x1a33bb[_0x19b51a(0x2d8)][0x0],_0x17da1f=_0x1a33bb[_0x19b51a(0x2d8)][0x1];pinchStartDistance=Math[_0x19b51a(0x18d)](_0x17da1f['clientX']-_0x5e003d[_0x19b51a(0x193)],_0x17da1f[_0x19b51a(0x25d)]-_0x5e003d['clientY']),pinchStartMid={'clientX':(_0x5e003d[_0x19b51a(0x193)]+_0x17da1f[_0x19b51a(0x193)])/0x2,'clientY':(_0x5e003d[_0x19b51a(0x25d)]+_0x17da1f[_0x19b51a(0x25d)])/0x2},pinchStartScale=scale,pinchStartPosX=posX,pinchStartPosY=posY,pinchRect=canvas[_0x19b51a(0x280)]();}else{if(_0x1a33bb[_0x19b51a(0x2d8)][_0x19b51a(0x1c4)]===0x1){_0x1a33bb['preventDefault']();if(isPinching)return;isDrawing=!![];let _0xc25e76=getTouchPos(_0x1a33bb);lastTouch=_0xc25e76,currentTool===_0x19b51a(0x1a8)?(fillAt(_0xc25e76['x'],_0xc25e76['y']),saveHistory(),isDrawing=![]):drawDotTouch(_0xc25e76['x'],_0xc25e76['y']);}}}function handleTouchMove(_0x528009){const _0x2d81cb=a0_0x38aafa;if(isPinching||_0x528009[_0x2d81cb(0x2d8)]&&_0x528009['touches'][_0x2d81cb(0x1c4)]===0x2){_0x528009[_0x2d81cb(0x1ce)]();const _0xdbcd32=_0x528009[_0x2d81cb(0x2d8)][0x0],_0x32dbe6=_0x528009[_0x2d81cb(0x2d8)][0x1],_0x5f137a=Math['hypot'](_0x32dbe6[_0x2d81cb(0x193)]-_0xdbcd32[_0x2d81cb(0x193)],_0x32dbe6['clientY']-_0xdbcd32[_0x2d81cb(0x25d)]),_0x6a9058={'clientX':(_0xdbcd32[_0x2d81cb(0x193)]+_0x32dbe6[_0x2d81cb(0x193)])/0x2,'clientY':(_0xdbcd32['clientY']+_0x32dbe6[_0x2d81cb(0x25d)])/0x2};if(!pinchStartDistance)pinchStartDistance=_0x5f137a||0x1;const _0x198754=_0x5f137a/pinchStartDistance||0x1;let _0x4d48b6=pinchStartScale*_0x198754;_0x4d48b6=Math['min'](Math[_0x2d81cb(0x2c3)](_0x4d48b6,0.2),0x5);const _0x308d03=pinchRect||canvas['getBoundingClientRect'](),_0x482744=(pinchStartMid[_0x2d81cb(0x193)]-_0x308d03[_0x2d81cb(0x2a7)]-pinchStartPosX)/pinchStartScale,_0x122594=(pinchStartMid['clientY']-_0x308d03[_0x2d81cb(0x196)]-pinchStartPosY)/pinchStartScale;posX=_0x6a9058[_0x2d81cb(0x193)]-_0x308d03[_0x2d81cb(0x2a7)]-_0x482744*_0x4d48b6,posY=_0x6a9058['clientY']-_0x308d03[_0x2d81cb(0x196)]-_0x122594*_0x4d48b6,scale=_0x4d48b6,updateTransform();return;}if(!isDrawing)return;if(_0x528009['touches']&&_0x528009[_0x2d81cb(0x2d8)]['length']>0x1)return;_0x528009['preventDefault']();let _0x42cf89=getTouchPos(_0x528009);if(lastTouch){let _0x1c1ae6=Math[_0x2d81cb(0x1a6)]((_0x42cf89['x']-lastTouch['x'])*cellSize),_0x4fb337=Math[_0x2d81cb(0x1a6)]((_0x42cf89['y']-lastTouch['y'])*cellSize);if(_0x1c1ae6>=PAN_CANCEL_DISTANCE||_0x4fb337>=PAN_CANCEL_DISTANCE){if(currentTool!==_0x2d81cb(0x182)){isDrawing=![];return;}}}if(lastTouch){let _0x50748b=_0x42cf89['x']-lastTouch['x'],_0xdb6cb4=_0x42cf89['y']-lastTouch['y'],_0x1192ce=Math['max'](Math['abs'](_0x50748b),Math[_0x2d81cb(0x1a6)](_0xdb6cb4));for(let _0x492b8b=0x1;_0x492b8b<=_0x1192ce;_0x492b8b++){let _0x1b6415=Math[_0x2d81cb(0x26f)](lastTouch['x']+_0x50748b*_0x492b8b/_0x1192ce),_0x57bc05=Math[_0x2d81cb(0x26f)](lastTouch['y']+_0xdb6cb4*_0x492b8b/_0x1192ce);drawDotTouch(_0x1b6415,_0x57bc05);}}else drawDotTouch(_0x42cf89['x'],_0x42cf89['y']);lastTouch=_0x42cf89;}function handleTouchEnd(_0x4465b0){const _0x41afbe=a0_0x38aafa;isPinching&&_0x4465b0[_0x41afbe(0x2d8)]&&_0x4465b0['touches'][_0x41afbe(0x1c4)]<0x2&&(isPinching=![],pinchStartDistance=0x0,pinchStartMid=null,pinchRect=null);isDrawing&&(!_0x4465b0['touches']||_0x4465b0[_0x41afbe(0x2d8)]['length']===0x0)&&saveHistory();if(_0x4465b0['touches']&&_0x4465b0[_0x41afbe(0x2d8)][_0x41afbe(0x1c4)]===0x1){let _0x40c58c=_0x4465b0[_0x41afbe(0x2d8)][0x0];lastTouch=getTouchPos({'touches':[_0x40c58c]}),isDrawing=!![];}else isDrawing=![],lastTouch=null;}function drawDotXY(_0x432b9b,_0x52bb07){const _0x47fb79=a0_0x38aafa;let _0x3378db=getCurrentProject(),_0x1a78e1=getCurrentFrame();if(!_0x1a78e1||!_0x3378db)return;if(typeof _0x432b9b!==_0x47fb79(0x1a2)||typeof _0x52bb07!==_0x47fb79(0x1a2)||_0x432b9b<0x0||_0x52bb07<0x0||!Number['isFinite'](_0x3378db['width'])||!Number['isFinite'](_0x3378db[_0x47fb79(0x27c)])||_0x432b9b>=_0x3378db['width']||_0x52bb07>=_0x3378db[_0x47fb79(0x27c)]||!Array[_0x47fb79(0x19c)](_0x1a78e1['layers'])||typeof _0x1a78e1[_0x47fb79(0x1b5)]!==_0x47fb79(0x1a2)||!_0x1a78e1[_0x47fb79(0x262)][_0x1a78e1['activeLayer']])return;let _0x914319=_0x1a78e1[_0x47fb79(0x262)][_0x1a78e1['activeLayer']][_0x47fb79(0x2c6)]('2d');if(!_0x914319)return;if(currentTool==='eraser'||currentColor===_0x47fb79(0x1f3)||currentColor===_0x47fb79(0x25c)||currentAlpha===0x0)drawPenShape(_0x914319,_0x432b9b,_0x52bb07,_0x47fb79(0x25c),!![]);else{let _0x5e3640=hexToRgba(currentColor,currentAlpha);_0x914319[_0x47fb79(0x1fe)](),_0x914319[_0x47fb79(0x2a0)]=_0x5e3640[0x3]/0xff,drawPenShape(_0x914319,_0x432b9b,_0x52bb07,_0x47fb79(0x210)+_0x5e3640[0x0]+','+_0x5e3640[0x1]+','+_0x5e3640[0x2]+','+_0x5e3640[0x3]/0xff+')',![]),_0x914319[_0x47fb79(0x2df)]();}redrawAll();}function drawPenShape(_0x426931,_0x3d6a77,_0x789ba2,_0x4a7258,_0x29c685){const _0x2f4fc7=a0_0x38aafa,_0x512e42=_0x3d6a77*cellSize,_0x112fa5=_0x789ba2*cellSize,_0x369a50=penSize*cellSize;_0x29c685?(_0x426931[_0x2f4fc7(0x1fe)](),_0x426931[_0x2f4fc7(0x20d)]=_0x2f4fc7(0x2d5),penMode===_0x2f4fc7(0x2ea)?(_0x426931[_0x2f4fc7(0x2eb)](),_0x426931[_0x2f4fc7(0x24a)](_0x512e42+cellSize/0x2,_0x112fa5+cellSize/0x2,_0x369a50/0x2,0x0,Math['PI']*0x2),_0x426931[_0x2f4fc7(0x1a8)]()):_0x426931[_0x2f4fc7(0x22d)](_0x512e42-Math[_0x2f4fc7(0x1a7)]((penSize-0x1)/0x2)*cellSize,_0x112fa5-Math[_0x2f4fc7(0x1a7)]((penSize-0x1)/0x2)*cellSize,_0x369a50,_0x369a50),_0x426931[_0x2f4fc7(0x2df)]()):(_0x426931[_0x2f4fc7(0x1fe)](),_0x426931[_0x2f4fc7(0x2aa)]=_0x4a7258,penMode===_0x2f4fc7(0x2ea)?(_0x426931['beginPath'](),_0x426931[_0x2f4fc7(0x24a)](_0x512e42+cellSize/0x2,_0x112fa5+cellSize/0x2,_0x369a50/0x2,0x0,Math['PI']*0x2),_0x426931['fill']()):_0x426931[_0x2f4fc7(0x216)](_0x512e42-Math['floor']((penSize-0x1)/0x2)*cellSize,_0x112fa5-Math[_0x2f4fc7(0x1a7)]((penSize-0x1)/0x2)*cellSize,_0x369a50,_0x369a50),_0x426931[_0x2f4fc7(0x2df)]());}function drawDotTouch(_0x42b01c,_0x1170c0){const _0x417ed9=a0_0x38aafa;let _0xaf872=getCurrentProject(),_0x519b1d=getCurrentFrame();if(_0x42b01c<0x0||_0x1170c0<0x0||_0x42b01c>=_0xaf872[_0x417ed9(0x1b8)]||_0x1170c0>=_0xaf872[_0x417ed9(0x27c)])return;let _0xf16887=_0x519b1d[_0x417ed9(0x262)][_0x519b1d[_0x417ed9(0x1b5)]]['getContext']('2d');if(currentTool==='eraser'||currentColor==='transparent'||currentColor===_0x417ed9(0x25c)||currentAlpha===0x0)drawPenShape(_0xf16887,_0x42b01c,_0x1170c0,_0x417ed9(0x25c),!![]);else{let _0x52213=hexToRgba(currentColor,currentAlpha);_0xf16887[_0x417ed9(0x1fe)](),_0xf16887[_0x417ed9(0x2a0)]=_0x52213[0x3]/0xff,drawPenShape(_0xf16887,_0x42b01c,_0x1170c0,'rgba('+_0x52213[0x0]+','+_0x52213[0x1]+','+_0x52213[0x2]+','+_0x52213[0x3]/0xff+')',![]),_0xf16887['restore']();}redrawAll();}function applyTheme(_0x4ce410){const _0x3f222e=a0_0x38aafa;document[_0x3f222e(0x199)][_0x3f222e(0x2b4)](_0x3f222e(0x206),_0x4ce410);const _0x97f2ae=document[_0x3f222e(0x275)](_0x3f222e(0x189));_0x97f2ae&&(_0x97f2ae['textContent']=_0x4ce410==='dark'?'‚òÄÔ∏è':'üåô',_0x97f2ae[_0x3f222e(0x2b4)](_0x3f222e(0x2a9),_0x4ce410==='dark'),_0x97f2ae['title']=_0x4ce410===_0x3f222e(0x2ee)?'„É©„Ç§„Éà„ÉÜ„Éº„Éû„Å´ÂàáÊõø':_0x3f222e(0x1d0)),localStorage[_0x3f222e(0x1fc)](_0x3f222e(0x1a4),_0x4ce410);}function toggleTheme(){const _0x415dfe=a0_0x38aafa;applyTheme(document['documentElement']['getAttribute'](_0x415dfe(0x206))===_0x415dfe(0x2ee)?_0x415dfe(0x21b):_0x415dfe(0x2ee));}(function initTheme(){const _0x304abf=a0_0x38aafa,_0x4d5eb1=localStorage[_0x304abf(0x1d5)](_0x304abf(0x1a4))||(window['matchMedia']&&window[_0x304abf(0x2af)](_0x304abf(0x208))['matches']?'dark':_0x304abf(0x21b));applyTheme(_0x4d5eb1),document[_0x304abf(0x21d)](_0x304abf(0x293),()=>{const _0x3e8442=_0x304abf,_0x135486=document[_0x3e8442(0x275)](_0x3e8442(0x189));_0x135486&&(_0x135486[_0x3e8442(0x21d)]('click',toggleTheme),_0x135486[_0x3e8442(0x21d)](_0x3e8442(0x1cc),_0x2a0ff1=>{const _0x44542c=_0x3e8442;(_0x2a0ff1[_0x44542c(0x2c5)]===_0x44542c(0x276)||_0x2a0ff1[_0x44542c(0x2c5)]==='\x20')&&(_0x2a0ff1[_0x44542c(0x1ce)](),toggleTheme());}));});}(),window['onload']=()=>{const _0x5c12e0=a0_0x38aafa;projects=[createProject()],activeProject=0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),initCanvas(),setTool('pen'),loadPaletteFromDB()[_0x5c12e0(0x17f)](()=>createPalette()),document['getElementById']('penSize')[_0x5c12e0(0x24e)]=penSize,document[_0x5c12e0(0x275)]('penMode')[_0x5c12e0(0x24e)]=penMode;const _0x36b6a1=document[_0x5c12e0(0x275)](_0x5c12e0(0x229)),_0x3d152f=document[_0x5c12e0(0x275)](_0x5c12e0(0x205));_0x36b6a1&&_0x3d152f&&(_0x36b6a1['value']=animationDelay,_0x3d152f[_0x5c12e0(0x24e)]=animationDelay,_0x36b6a1[_0x5c12e0(0x28a)]=_0x57097b=>{const _0x30fafd=_0x5c12e0;_0x3d152f['value']=_0x57097b[_0x30fafd(0x2e5)][_0x30fafd(0x24e)],setAnimationDelay(_0x57097b[_0x30fafd(0x2e5)][_0x30fafd(0x24e)]);},_0x3d152f[_0x5c12e0(0x222)]=_0x158c76=>{const _0x5e8338=_0x5c12e0;let _0x17c0f8=Math[_0x5e8338(0x2c3)](0xa,Math['min'](0x1388,parseInt(_0x158c76[_0x5e8338(0x2e5)]['value'])||animationDelay));_0x36b6a1[_0x5e8338(0x24e)]=_0x17c0f8,_0x3d152f['value']=_0x17c0f8,setAnimationDelay(_0x17c0f8);}),canvas[_0x5c12e0(0x239)]=handleMouseMove,canvas[_0x5c12e0(0x238)]=handleMouseUp,canvas[_0x5c12e0(0x1b7)]=handleMouseUp,canvas[_0x5c12e0(0x21a)]=handleTouchStart,canvas[_0x5c12e0(0x267)]=handleTouchMove,canvas[_0x5c12e0(0x212)]=handleTouchEnd,canvas[_0x5c12e0(0x2ac)]=handleTouchEnd,canvas[_0x5c12e0(0x21d)]('touchstart',handleTouchStart,{'passive':![]}),canvas[_0x5c12e0(0x21d)](_0x5c12e0(0x28f),handleTouchMove,{'passive':![]}),canvas['addEventListener'](_0x5c12e0(0x1e1),handleTouchEnd,{'passive':![]}),canvas[_0x5c12e0(0x21d)](_0x5c12e0(0x1b6),handleTouchEnd,{'passive':![]}),idbGet(_0x5c12e0(0x263))&&loadProjectFromIDB();});function drawGrid(_0x4689af,_0xf32364){const _0x3e0770=a0_0x38aafa;ctx[_0x3e0770(0x1fe)](),ctx[_0x3e0770(0x2b5)]=_0x3e0770(0x26b);for(let _0x5a2415=0x0;_0x5a2415<=_0x4689af;_0x5a2415++){ctx[_0x3e0770(0x2eb)](),ctx[_0x3e0770(0x29e)](_0x5a2415*cellSize,0x0),ctx['lineTo'](_0x5a2415*cellSize,_0xf32364*cellSize),ctx['stroke']();}for(let _0x4a9d97=0x0;_0x4a9d97<=_0xf32364;_0x4a9d97++){ctx['beginPath'](),ctx[_0x3e0770(0x29e)](0x0,_0x4a9d97*cellSize),ctx['lineTo'](_0x4689af*cellSize,_0x4a9d97*cellSize),ctx[_0x3e0770(0x2d9)]();}ctx[_0x3e0770(0x2df)]();}function redrawAll(){const _0x16be82=a0_0x38aafa;let _0x12e292=getCurrentProject(),_0x2f14d6=getCurrentFrame();canvas[_0x16be82(0x1b8)]=_0x12e292[_0x16be82(0x1b8)]*cellSize,canvas[_0x16be82(0x27c)]=_0x12e292[_0x16be82(0x27c)]*cellSize,ctx['clearRect'](0x0,0x0,canvas[_0x16be82(0x1b8)],canvas['height']);for(let _0x214cfe=0x0;_0x214cfe<_0x2f14d6[_0x16be82(0x262)]['length'];_0x214cfe++){ctx['drawImage'](_0x2f14d6[_0x16be82(0x262)][_0x214cfe],0x0,0x0);}drawGrid(_0x12e292['width'],_0x12e292[_0x16be82(0x27c)]),wrapper&&(wrapper[_0x16be82(0x1f8)]['width']=_0x16be82(0x2d3),wrapper[_0x16be82(0x1f8)][_0x16be82(0x27c)]=_0x16be82(0x1ae));}function saveHistory(){const _0xc6080f=a0_0x38aafa;let _0x4cdaa0=getCurrentFrame(),_0xdcf86f=_0x4cdaa0[_0xc6080f(0x29c)][_0x4cdaa0[_0xc6080f(0x1b5)]];_0xdcf86f['push'](_0x4cdaa0[_0xc6080f(0x262)][_0x4cdaa0[_0xc6080f(0x1b5)]]['toDataURL']());if(_0xdcf86f[_0xc6080f(0x1c4)]>0x32)_0xdcf86f[_0xc6080f(0x1d7)]();_0x4cdaa0[_0xc6080f(0x2d0)][_0x4cdaa0['activeLayer']]=[];}function undo(){const _0x5b8806=a0_0x38aafa;let _0x19db83=getCurrentFrame(),_0xef8ba=_0x19db83[_0x5b8806(0x29c)][_0x19db83['activeLayer']],_0x525c13=_0x19db83[_0x5b8806(0x2d0)][_0x19db83[_0x5b8806(0x1b5)]];if(!_0xef8ba||_0xef8ba[_0x5b8806(0x1c4)]<0x2)return;_0x525c13['push'](_0xef8ba['pop']());let _0x2a7dec=new Image();_0x2a7dec[_0x5b8806(0x185)]=()=>{const _0x2a340a=_0x5b8806;let _0x51964e=_0x19db83[_0x2a340a(0x262)][_0x19db83[_0x2a340a(0x1b5)]][_0x2a340a(0x2c6)]('2d');_0x51964e[_0x2a340a(0x22d)](0x0,0x0,_0x19db83[_0x2a340a(0x262)][_0x19db83['activeLayer']][_0x2a340a(0x1b8)],_0x19db83[_0x2a340a(0x262)][_0x19db83[_0x2a340a(0x1b5)]][_0x2a340a(0x27c)]),_0x51964e['drawImage'](_0x2a7dec,0x0,0x0),redrawAll();},_0x2a7dec['src']=_0xef8ba[_0xef8ba['length']-0x1];}function redo(){const _0x280c66=a0_0x38aafa;let _0x561e8c=getCurrentFrame(),_0x44d0e2=_0x561e8c['layerHistories'][_0x561e8c['activeLayer']],_0xa70c8c=_0x561e8c['layerRedoStacks'][_0x561e8c['activeLayer']];if(!_0xa70c8c||_0xa70c8c['length']===0x0)return;let _0x3e9b75=_0xa70c8c[_0x280c66(0x1ea)]();_0x44d0e2['push'](_0x3e9b75);let _0x2b8fd5=new Image();_0x2b8fd5[_0x280c66(0x185)]=()=>{const _0x3fc1be=_0x280c66;let _0x1c11a6=_0x561e8c['layers'][_0x561e8c[_0x3fc1be(0x1b5)]][_0x3fc1be(0x2c6)]('2d');_0x1c11a6[_0x3fc1be(0x22d)](0x0,0x0,_0x561e8c[_0x3fc1be(0x262)][_0x561e8c[_0x3fc1be(0x1b5)]]['width'],_0x561e8c['layers'][_0x561e8c['activeLayer']][_0x3fc1be(0x27c)]),_0x1c11a6[_0x3fc1be(0x1ff)](_0x2b8fd5,0x0,0x0),redrawAll();},_0x2b8fd5[_0x280c66(0x1b3)]=_0x3e9b75;}function exportImage(_0x184eca){const _0x240c4e=a0_0x38aafa;let _0x37c7f1=getCurrentProject(),_0xd5275f=_0x37c7f1[_0x240c4e(0x2b3)],_0x45408b=_0x184eca===_0x240c4e(0x248)||_0x184eca===_0x240c4e(0x242)?_0x240c4e(0x18a):_0x240c4e(0x203)+_0x184eca,_0x3b33ca=_0xd5275f[_0x240c4e(0x1c4)]>0x1,_0x5693a9=(_0x37c7f1[_0x240c4e(0x2e6)]||_0x240c4e(0x200))[_0x240c4e(0x27d)](/[\\/:*?"<>|]/g,'_');if(!_0x3b33ca){let _0x10da63=document[_0x240c4e(0x1d6)](_0x240c4e(0x19d));_0x10da63['width']=_0x37c7f1[_0x240c4e(0x1b8)]*cellSize,_0x10da63['height']=_0x37c7f1[_0x240c4e(0x27c)]*cellSize;let _0x1e8216=_0x10da63['getContext']('2d'),_0x122b07=getCurrentFrame();for(let _0x1f5c0e=0x0;_0x1f5c0e<_0x122b07[_0x240c4e(0x262)][_0x240c4e(0x1c4)];_0x1f5c0e++){_0x1e8216['drawImage'](_0x122b07[_0x240c4e(0x262)][_0x1f5c0e],0x0,0x0);}let _0x4aa309=document[_0x240c4e(0x1d6)]('a');_0x4aa309[_0x240c4e(0x215)]=_0x5693a9+'.'+_0x184eca,_0x184eca===_0x240c4e(0x248)||_0x184eca==='jpeg'?_0x4aa309['href']=_0x10da63[_0x240c4e(0x1df)](_0x45408b,0.92):_0x4aa309[_0x240c4e(0x1c8)]=_0x10da63[_0x240c4e(0x1df)](_0x45408b),_0x4aa309['click']();}else{if(_0x184eca===_0x240c4e(0x1bf)&&typeof window[_0x240c4e(0x2da)]!==_0x240c4e(0x225))exportWebpAnimation(_0xd5275f,_0x37c7f1[_0x240c4e(0x1b8)]*cellSize,_0x37c7f1[_0x240c4e(0x27c)]*cellSize,_0x5693a9);else for(let _0x3eed2c=0x0;_0x3eed2c<_0xd5275f[_0x240c4e(0x1c4)];_0x3eed2c++){let _0x23d6f2=document[_0x240c4e(0x1d6)](_0x240c4e(0x19d));_0x23d6f2[_0x240c4e(0x1b8)]=_0x37c7f1[_0x240c4e(0x1b8)]*cellSize,_0x23d6f2[_0x240c4e(0x27c)]=_0x37c7f1[_0x240c4e(0x27c)]*cellSize;let _0x16059b=_0x23d6f2['getContext']('2d'),_0x43633b=_0xd5275f[_0x3eed2c];for(let _0x7bf2d9=0x0;_0x7bf2d9<_0x43633b[_0x240c4e(0x262)][_0x240c4e(0x1c4)];_0x7bf2d9++){_0x16059b[_0x240c4e(0x1ff)](_0x43633b['layers'][_0x7bf2d9],0x0,0x0);}let _0x5b5765=document[_0x240c4e(0x1d6)]('a');_0x5b5765[_0x240c4e(0x215)]=_0x5693a9+'-f'+(_0x3eed2c+0x1)+'.'+_0x184eca,_0x184eca===_0x240c4e(0x248)||_0x184eca===_0x240c4e(0x242)?_0x5b5765['href']=_0x23d6f2[_0x240c4e(0x1df)](_0x45408b,0.92):_0x5b5765[_0x240c4e(0x1c8)]=_0x23d6f2['toDataURL'](_0x45408b),setTimeout(()=>_0x5b5765[_0x240c4e(0x2ed)](),_0x3eed2c*0x64);}}}async function exportWebpAnimation(_0x33b855,_0x1625d7,_0x1a4543,_0x43242c=a0_0x38aafa(0x21f)){const _0x73a967=a0_0x38aafa;if(!window[_0x73a967(0x2da)]||!window[_0x73a967(0x194)]){alert(_0x73a967(0x27b));return;}const _0x119625=[],_0x53a93d=new VideoEncoder({'output':_0xa4fb66=>_0x119625[_0x73a967(0x278)](_0xa4fb66),'error':_0x5ad02d=>console['error'](_0x5ad02d)});_0x53a93d[_0x73a967(0x2a8)]({'codec':_0x73a967(0x2d2),'width':_0x1625d7,'height':_0x1a4543,'framerate':0x5});for(let _0x239f88=0x0;_0x239f88<_0x33b855['length'];_0x239f88++){let _0x14fab6=document[_0x73a967(0x1d6)](_0x73a967(0x19d));_0x14fab6[_0x73a967(0x1b8)]=_0x1625d7,_0x14fab6[_0x73a967(0x27c)]=_0x1a4543;let _0x37e5a4=_0x14fab6[_0x73a967(0x2c6)]('2d'),_0x4a745d=_0x33b855[_0x239f88];for(let _0x255b21=0x0;_0x255b21<_0x4a745d[_0x73a967(0x262)]['length'];_0x255b21++){_0x37e5a4[_0x73a967(0x1ff)](_0x4a745d[_0x73a967(0x262)][_0x255b21],0x0,0x0);}let _0x59fa83=await createImageBitmap(_0x14fab6);_0x53a93d[_0x73a967(0x1e2)](_0x59fa83,{'keyFrame':!![],'duration':0xc8}),_0x59fa83[_0x73a967(0x2e3)]();}await _0x53a93d[_0x73a967(0x209)](),_0x53a93d[_0x73a967(0x2e3)]();const _0x2d0a80=new Blob(_0x119625[_0x73a967(0x294)](_0x2cf248=>_0x2cf248[_0x73a967(0x2c8)]?_0x2cf248:_0x2cf248[_0x73a967(0x261)]),{'type':'video/webm'}),_0x1f30dc=document[_0x73a967(0x1d6)]('a');_0x1f30dc[_0x73a967(0x215)]=_0x43242c+_0x73a967(0x257),_0x1f30dc[_0x73a967(0x1c8)]=URL[_0x73a967(0x201)](_0x2d0a80),_0x1f30dc[_0x73a967(0x2ed)]();}function exportGif(){const _0x944cf0=a0_0x38aafa;let _0x1bb193=getCurrentProject(),_0x1d337e=_0x1bb193[_0x944cf0(0x2b3)],_0x38d7cd=_0x1bb193[_0x944cf0(0x1b8)]*cellSize,_0x4d17f3=_0x1bb193[_0x944cf0(0x27c)]*cellSize;const _0x37499d=_0x1d337e[_0x944cf0(0x294)](_0x55571=>{const _0x442c3d=_0x944cf0;let _0x236bfa=document['createElement']('canvas');_0x236bfa[_0x442c3d(0x1b8)]=_0x38d7cd,_0x236bfa[_0x442c3d(0x27c)]=_0x4d17f3;let _0xfc8367=_0x236bfa['getContext']('2d');for(let _0x2b104b=0x0;_0x2b104b<_0x55571[_0x442c3d(0x262)]['length'];_0x2b104b++){_0xfc8367[_0x442c3d(0x1ff)](_0x55571[_0x442c3d(0x262)][_0x2b104b],0x0,0x0);}return _0x236bfa[_0x442c3d(0x1df)](_0x442c3d(0x1fa));});Promise[_0x944cf0(0x25a)](_0x37499d[_0x944cf0(0x294)](_0x1f92b7=>{return new Promise(_0x4f4c90=>{const _0x4155ee=a0_0x1925,_0xb56734=new Image();_0xb56734[_0x4155ee(0x1b3)]=_0x1f92b7,_0xb56734[_0x4155ee(0x185)]=()=>_0x4f4c90(_0xb56734);});}))[_0x944cf0(0x17f)](_0x8d424a=>{const _0x32858=_0x944cf0,_0x24ae95=_0x8d424a[_0x32858(0x268)](_0x2df9a2=>_0x2df9a2[_0x32858(0x1b8)]>0x0&&_0x2df9a2[_0x32858(0x27c)]>0x0);if(_0x24ae95['length']===0x0){alert(_0x32858(0x1fb));return;}const _0x54d440=(_0x1bb193[_0x32858(0x2e6)]||_0x32858(0x21f))[_0x32858(0x27d)](/[\\/:*?"<>|]/g,'_');convertToGIF(_0x24ae95,animationDelay,_0x54d440+_0x32858(0x2d1));});}function exportApng(){const _0x4e90bb=a0_0x38aafa;let _0x23326c=getCurrentProject(),_0x384b71=_0x23326c[_0x4e90bb(0x2b3)],_0x2951a8=_0x23326c[_0x4e90bb(0x1b8)]*cellSize,_0x4c9c0f=_0x23326c['height']*cellSize;const _0x5c8ee7=_0x384b71[_0x4e90bb(0x294)](_0xa7b6d8=>{const _0x320890=_0x4e90bb;let _0x14ec05=document[_0x320890(0x1d6)](_0x320890(0x19d));_0x14ec05['width']=_0x2951a8,_0x14ec05[_0x320890(0x27c)]=_0x4c9c0f;let _0x50b773=_0x14ec05['getContext']('2d');for(let _0x462422=0x0;_0x462422<_0xa7b6d8[_0x320890(0x262)][_0x320890(0x1c4)];_0x462422++){_0x50b773['drawImage'](_0xa7b6d8[_0x320890(0x262)][_0x462422],0x0,0x0);}let _0x4f6b3a=new Image();return _0x4f6b3a[_0x320890(0x1b3)]=_0x14ec05['toDataURL'](_0x320890(0x1fa)),_0x4f6b3a;}),_0x4f60ec=(_0x23326c['name']||_0x4e90bb(0x21f))[_0x4e90bb(0x27d)](/[\\/:*?"<>|]/g,'_');convertToAPNG(_0x5c8ee7,_0x2951a8,_0x4c9c0f,animationDelay,_0x4f60ec+_0x4e90bb(0x274));}const dbName=a0_0x38aafa(0x292),storeName=a0_0x38aafa(0x22e);function openDB(){return new Promise((_0x2ffc85,_0x277b2d)=>{const _0x4c2a6f=a0_0x1925,_0x28ba2d=indexedDB['open'](dbName,0x1);_0x28ba2d[_0x4c2a6f(0x273)]=()=>{_0x28ba2d['result']['createObjectStore'](storeName);},_0x28ba2d['onsuccess']=()=>_0x2ffc85(_0x28ba2d['result']),_0x28ba2d[_0x4c2a6f(0x1c5)]=()=>_0x277b2d(_0x28ba2d[_0x4c2a6f(0x181)]);});}async function idbSet(_0x3d3654,_0xeca22c){const _0x3fdddd=await openDB();return new Promise((_0x8755e0,_0x155c80)=>{const _0x1df2fb=a0_0x1925,_0x3ecb12=_0x3fdddd[_0x1df2fb(0x27f)](storeName,_0x1df2fb(0x259));_0x3ecb12[_0x1df2fb(0x226)](storeName)[_0x1df2fb(0x297)](_0xeca22c,_0x3d3654),_0x3ecb12[_0x1df2fb(0x2a3)]=()=>_0x8755e0(),_0x3ecb12['onerror']=()=>_0x155c80(_0x3ecb12['error']);});}async function idbGet(_0x9d20e){const _0x5e099c=await openDB();return new Promise((_0x28b0b5,_0x364f15)=>{const _0x53dcb9=a0_0x1925,_0x2f3185=_0x5e099c[_0x53dcb9(0x27f)](storeName,_0x53dcb9(0x223)),_0x30e38e=_0x2f3185[_0x53dcb9(0x226)](storeName)[_0x53dcb9(0x2b8)](_0x9d20e);_0x30e38e[_0x53dcb9(0x260)]=()=>_0x28b0b5(_0x30e38e['result']),_0x30e38e[_0x53dcb9(0x1c5)]=()=>_0x364f15(_0x30e38e[_0x53dcb9(0x181)]);});}async function idbDelete(_0x1172d2){const _0x59e105=await openDB();return new Promise((_0x21f507,_0x307673)=>{const _0x2d1ab7=a0_0x1925,_0x15d71b=_0x59e105['transaction'](storeName,'readwrite');_0x15d71b[_0x2d1ab7(0x226)](storeName)['delete'](_0x1172d2),_0x15d71b[_0x2d1ab7(0x2a3)]=()=>_0x21f507(),_0x15d71b[_0x2d1ab7(0x1c5)]=()=>_0x307673(_0x15d71b['error']);});}async function idbClear(){const _0x3650ff=await openDB();return new Promise((_0x20b6c5,_0x4dd79b)=>{const _0x463178=a0_0x1925,_0x4718a8=_0x3650ff[_0x463178(0x27f)](storeName,_0x463178(0x259));_0x4718a8[_0x463178(0x226)](storeName)[_0x463178(0x1e0)](),_0x4718a8['oncomplete']=()=>_0x20b6c5(),_0x4718a8[_0x463178(0x1c5)]=()=>_0x4dd79b(_0x4718a8['error']);});}function saveProjectFile(){const _0x3c30ac=a0_0x38aafa,_0x37a701={'projects':projects[_0x3c30ac(0x294)](_0x223a07=>({'width':_0x223a07[_0x3c30ac(0x1b8)],'height':_0x223a07[_0x3c30ac(0x27c)],'name':_0x223a07[_0x3c30ac(0x2e6)]||'','activeFrame':_0x223a07[_0x3c30ac(0x2a5)],'frames':_0x223a07[_0x3c30ac(0x2b3)][_0x3c30ac(0x294)](_0x1b574b=>({'activeLayer':_0x1b574b[_0x3c30ac(0x1b5)],'layers':_0x1b574b['layers'][_0x3c30ac(0x294)](_0x15b6ad=>_0x15b6ad[_0x3c30ac(0x1df)]())}))})),'activeProject':activeProject},_0x2a964e=new Blob([JSON[_0x3c30ac(0x1e5)](_0x37a701)],{'type':_0x3c30ac(0x299)}),_0x47ab9d=document[_0x3c30ac(0x1d6)]('a');_0x47ab9d['download']='nezumi-sketch.msketch',_0x47ab9d[_0x3c30ac(0x1c8)]=URL[_0x3c30ac(0x201)](_0x2a964e),_0x47ab9d[_0x3c30ac(0x2ed)]();}function a0_0x1925(_0x24c11,_0x15be4d){_0x24c11=_0x24c11-0x17d;const _0x1f2c49=a0_0x5ad1();let _0x5506da=_0x1f2c49[_0x24c11];return _0x5506da;}function saveProjectFile(){const _0x221ebe=a0_0x38aafa,_0x5e03ca={'projects':projects[_0x221ebe(0x294)](_0xc38049=>({'width':_0xc38049['width'],'height':_0xc38049[_0x221ebe(0x27c)],'name':_0xc38049[_0x221ebe(0x2e6)]||'','activeFrame':_0xc38049[_0x221ebe(0x2a5)],'frames':_0xc38049[_0x221ebe(0x2b3)][_0x221ebe(0x294)](_0x4989a9=>({'activeLayer':_0x4989a9[_0x221ebe(0x1b5)],'layers':_0x4989a9[_0x221ebe(0x262)][_0x221ebe(0x294)](_0x27ad4c=>_0x27ad4c[_0x221ebe(0x1df)]())}))})),'activeProject':activeProject},_0x2e261f=new Blob([JSON[_0x221ebe(0x1e5)](_0x5e03ca)],{'type':_0x221ebe(0x299)}),_0x362dff=document[_0x221ebe(0x1d6)]('a');_0x362dff[_0x221ebe(0x215)]=_0x221ebe(0x2bf),_0x362dff[_0x221ebe(0x1c8)]=URL[_0x221ebe(0x201)](_0x2e261f),_0x362dff[_0x221ebe(0x2ed)]();}async function saveProjectToIDB(){const _0x130975=a0_0x38aafa,_0x1a3342={'projects':projects['map'](_0x5268af=>({'width':_0x5268af[_0x130975(0x1b8)],'height':_0x5268af[_0x130975(0x27c)],'name':_0x5268af[_0x130975(0x2e6)]||'','activeFrame':_0x5268af[_0x130975(0x2a5)],'frames':_0x5268af[_0x130975(0x2b3)][_0x130975(0x294)](_0x1b7f45=>({'activeLayer':_0x1b7f45[_0x130975(0x1b5)],'layers':_0x1b7f45[_0x130975(0x262)]['map'](_0x5ae387=>_0x5ae387[_0x130975(0x1df)]())}))})),'activeProject':activeProject};try{await idbSet('nezumi-sketch-save',_0x1a3342),console['log'](_0x130975(0x21c));}catch(_0x3b2e70){console[_0x130975(0x181)]('‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åü„ÉÅ„É•„Éº:',_0x3b2e70);}}setInterval(()=>{saveProjectToIDB();},0x2710),window[a0_0x38aafa(0x21d)](a0_0x38aafa(0x22c),_0x217a07=>{saveProjectToIDB();});function loadProjectFile(_0x5b1e73){const _0xae79fb=a0_0x38aafa,_0x84ce16=_0x5b1e73['target'][_0xae79fb(0x23c)][0x0];if(!_0x84ce16)return;if(_0x84ce16[_0xae79fb(0x17d)]&&_0x84ce16[_0xae79fb(0x17d)][_0xae79fb(0x1a3)]('image')){loadStandaloneFromFile(_0x84ce16)['then'](_0x177630=>{const _0x3f4e90=_0xae79fb;alert(_0x3f4e90(0x283)+(_0x177630[_0x3f4e90(0x2e6)]||'ÁîªÂÉè'));})[_0xae79fb(0x1c7)](_0x3923a2=>{const _0x8f3dc3=_0xae79fb;console[_0x8f3dc3(0x2c1)](_0x3923a2),alert(_0x8f3dc3(0x2d4));});return;}const _0x169932=new FileReader();_0x169932[_0xae79fb(0x185)]=function(_0x40a653){const _0x3f9dde=_0xae79fb;try{const _0x535e62=JSON[_0x3f9dde(0x288)](_0x40a653[_0x3f9dde(0x2e5)][_0x3f9dde(0x192)]);projects=_0x535e62[_0x3f9dde(0x24f)][_0x3f9dde(0x294)]((_0x146602,_0x3b91d4)=>{const _0x3216be=_0x3f9dde;let _0x313324=createProject(_0x146602['width'],_0x146602[_0x3216be(0x27c)],_0x146602[_0x3216be(0x2e6)]||'ÁîªÂÉè'+(_0x3b91d4+0x1));return _0x313324[_0x3216be(0x2b3)]=_0x146602['frames'][_0x3216be(0x294)](_0x153a5d=>{const _0x18c91a=_0x3216be;let _0x11e19a={'layers':[],'activeLayer':_0x153a5d[_0x18c91a(0x1b5)],'layerHistories':[],'layerRedoStacks':[]};for(let _0xad94e6=0x0;_0xad94e6<_0x153a5d['layers']['length'];_0xad94e6++){let _0x5064ac=new Image();_0x5064ac[_0x18c91a(0x1b3)]=_0x153a5d[_0x18c91a(0x262)][_0xad94e6];let _0x11e713=document[_0x18c91a(0x1d6)](_0x18c91a(0x19d));_0x11e713[_0x18c91a(0x1b8)]=_0x146602[_0x18c91a(0x1b8)]*cellSize,_0x11e713['height']=_0x146602[_0x18c91a(0x27c)]*cellSize,_0x5064ac[_0x18c91a(0x185)]=()=>{const _0x110d37=_0x18c91a;let _0x43a799=_0x11e713[_0x110d37(0x2c6)]('2d');_0x43a799['clearRect'](0x0,0x0,_0x11e713[_0x110d37(0x1b8)],_0x11e713[_0x110d37(0x27c)]),_0x43a799[_0x110d37(0x1ff)](_0x5064ac,0x0,0x0);},_0x5064ac['onload'](),_0x11e19a[_0x18c91a(0x262)][_0x18c91a(0x278)](_0x11e713),_0x11e19a['layerHistories'][_0x18c91a(0x278)]([]),_0x11e19a[_0x18c91a(0x2d0)][_0x18c91a(0x278)]([]);}return _0x11e19a;}),_0x313324[_0x3216be(0x2a5)]=_0x146602['activeFrame'],_0x313324['name']=_0x146602[_0x3216be(0x2e6)]||'ÁîªÂÉè'+(_0x3b91d4+0x1),_0x313324;}),activeProject=_0x535e62[_0x3f9dde(0x23d)]||0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();}catch(_0x465061){alert(_0x3f9dde(0x211));}},_0x169932['readAsText'](_0x84ce16);}async function loadProjectFromIDB(){const _0x163a94=a0_0x38aafa;try{const _0x2d9667=await idbGet(_0x163a94(0x2e9));if(!_0x2d9667)return;projects=_0x2d9667['projects']['map']((_0x39f5b1,_0x4670f9)=>{const _0x3014fb=_0x163a94;let _0x386e9c=createProject(_0x39f5b1[_0x3014fb(0x1b8)],_0x39f5b1[_0x3014fb(0x27c)],_0x39f5b1['name']||'ÁîªÂÉè'+(_0x4670f9+0x1));return _0x386e9c[_0x3014fb(0x2b3)]=_0x39f5b1[_0x3014fb(0x2b3)][_0x3014fb(0x294)](_0x12ea06=>{const _0x519496=_0x3014fb;let _0xec11f9={'layers':[],'activeLayer':_0x12ea06['activeLayer'],'layerHistories':[],'layerRedoStacks':[]};for(let _0x51d86f=0x0;_0x51d86f<_0x12ea06[_0x519496(0x262)][_0x519496(0x1c4)];_0x51d86f++){let _0x87db9d=new Image();_0x87db9d[_0x519496(0x1b3)]=_0x12ea06[_0x519496(0x262)][_0x51d86f];let _0x5af032=document['createElement'](_0x519496(0x19d));_0x5af032['width']=_0x39f5b1['width']*cellSize,_0x5af032[_0x519496(0x27c)]=_0x39f5b1[_0x519496(0x27c)]*cellSize,_0x87db9d[_0x519496(0x185)]=()=>{const _0x157a97=_0x519496;let _0x18355d=_0x5af032['getContext']('2d');_0x18355d[_0x157a97(0x22d)](0x0,0x0,_0x5af032[_0x157a97(0x1b8)],_0x5af032['height']),_0x18355d[_0x157a97(0x1ff)](_0x87db9d,0x0,0x0);},_0xec11f9[_0x519496(0x262)][_0x519496(0x278)](_0x5af032),_0xec11f9[_0x519496(0x29c)][_0x519496(0x278)]([]),_0xec11f9[_0x519496(0x2d0)][_0x519496(0x278)]([]);}return _0xec11f9;}),_0x386e9c[_0x3014fb(0x2a5)]=_0x39f5b1[_0x3014fb(0x2a5)],_0x386e9c[_0x3014fb(0x2e6)]=_0x39f5b1['name']||'ÁîªÂÉè'+(_0x4670f9+0x1),_0x386e9c;}),activeProject=_0x2d9667[_0x163a94(0x23d)]||0x0,await wait(0x64),updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll(),setTool(_0x163a94(0x182)),console['log'](_0x163a94(0x282));}catch(_0x20c865){alert(_0x163a94(0x2cd)),console['error'](_0x20c865);}}function wait(_0xeda288){return new Promise(_0x1785d0=>setTimeout(_0x1785d0,_0xeda288));}function initCanvas(){const _0x23254c=a0_0x38aafa,_0x58e8a9=parseInt(0x10),_0x38365f=parseInt(0x10);let _0x428a53=getCurrentProject();_0x428a53[_0x23254c(0x1b8)]=_0x58e8a9,_0x428a53[_0x23254c(0x27c)]=_0x38365f,canvas[_0x23254c(0x1b8)]=_0x58e8a9*cellSize,canvas[_0x23254c(0x27c)]=_0x38365f*cellSize,_0x428a53[_0x23254c(0x262)]=[],_0x428a53[_0x23254c(0x29c)]=[],_0x428a53[_0x23254c(0x2d0)]=[];let _0x14f729=document[_0x23254c(0x1d6)](_0x23254c(0x19d));_0x14f729[_0x23254c(0x1b8)]=_0x58e8a9*cellSize,_0x14f729[_0x23254c(0x27c)]=_0x38365f*cellSize,_0x428a53[_0x23254c(0x262)]['push'](_0x14f729),_0x428a53[_0x23254c(0x29c)][_0x23254c(0x278)]([]),_0x428a53[_0x23254c(0x2d0)]['push']([]),_0x428a53[_0x23254c(0x1b5)]=0x0,saveHistory(),updateFrameUI(),updateLayerUI(),redrawAll(),canvas[_0x23254c(0x1f5)]=null,canvas['onmousemove']=null,canvas[_0x23254c(0x238)]=null,canvas[_0x23254c(0x1b7)]=null,canvas[_0x23254c(0x21a)]=null,canvas[_0x23254c(0x267)]=null,canvas[_0x23254c(0x212)]=null,canvas[_0x23254c(0x2ac)]=null,canvas[_0x23254c(0x2a6)]('touchstart',handleTouchStart),canvas[_0x23254c(0x2a6)](_0x23254c(0x28f),handleTouchMove),canvas[_0x23254c(0x2a6)](_0x23254c(0x1e1),handleTouchEnd),canvas[_0x23254c(0x2a6)](_0x23254c(0x1b6),handleTouchEnd),canvas[_0x23254c(0x1f5)]=handleMouseDown,canvas[_0x23254c(0x239)]=handleMouseMove,canvas[_0x23254c(0x238)]=handleMouseUp,canvas[_0x23254c(0x1b7)]=handleMouseUp,canvas[_0x23254c(0x21a)]=handleTouchStart,canvas[_0x23254c(0x267)]=handleTouchMove,canvas['ontouchend']=handleTouchEnd,canvas[_0x23254c(0x2ac)]=handleTouchEnd,canvas[_0x23254c(0x21d)](_0x23254c(0x1bb),handleTouchStart,{'passive':![]}),canvas[_0x23254c(0x21d)]('touchmove',handleTouchMove,{'passive':![]}),canvas[_0x23254c(0x21d)](_0x23254c(0x1e1),handleTouchEnd,{'passive':![]}),canvas['addEventListener'](_0x23254c(0x1b6),handleTouchEnd,{'passive':![]});}function createPalette(){const _0x3630f8=a0_0x38aafa,_0x4a8198=document[_0x3630f8(0x275)](_0x3630f8(0x230));if(!_0x4a8198)return;_0x4a8198[_0x3630f8(0x25f)]='',PALETTE_COLORS[_0x3630f8(0x1bd)]((_0x2ece41,_0x517bba)=>{const _0x2b0fc3=_0x3630f8,_0x2bbc73=document[_0x2b0fc3(0x1d6)](_0x2b0fc3(0x2a4));_0x2bbc73['className']='palette-color';_0x2ece41==='transparent'||_0x2ece41===_0x2b0fc3(0x25c)?(_0x2bbc73[_0x2b0fc3(0x1f8)][_0x2b0fc3(0x2dc)]='repeating-conic-gradient(#eee\x200%\x2025%,\x20#fff\x200%\x2050%)\x2050%\x20/\x2016px\x2016px',_0x2bbc73[_0x2b0fc3(0x198)]='ÈÄèÊòé',_0x2bbc73[_0x2b0fc3(0x25f)]=_0x2b0fc3(0x224)):(_0x2bbc73[_0x2b0fc3(0x1f8)][_0x2b0fc3(0x2dc)]=_0x2ece41,_0x2bbc73['title']=_0x2ece41);_0x2bbc73[_0x2b0fc3(0x234)]=()=>{const _0x2fba9a=_0x2b0fc3;currentColor=_0x2ece41,_0x2ece41===_0x2fba9a(0x1f3)||_0x2ece41===_0x2fba9a(0x25c)?document[_0x2fba9a(0x275)](_0x2fba9a(0x1a0))[_0x2fba9a(0x24e)]=_0x2fba9a(0x1ba):document[_0x2fba9a(0x275)](_0x2fba9a(0x1a0))[_0x2fba9a(0x24e)]=_0x2ece41,document[_0x2fba9a(0x29b)](_0x2fba9a(0x1e6))[_0x2fba9a(0x1bd)](_0x5d29ca=>_0x5d29ca[_0x2fba9a(0x22b)][_0x2fba9a(0x187)](_0x2fba9a(0x2dd))),_0x2bbc73[_0x2fba9a(0x22b)][_0x2fba9a(0x1de)](_0x2fba9a(0x2dd));};if(_0x517bba!==0x0){const _0x382712=document[_0x2b0fc3(0x1d6)](_0x2b0fc3(0x28e));_0x382712[_0x2b0fc3(0x221)]='√ó',_0x382712[_0x2b0fc3(0x252)]=_0x2b0fc3(0x2c7),_0x382712[_0x2b0fc3(0x198)]=_0x2b0fc3(0x2e7),_0x382712[_0x2b0fc3(0x234)]=_0x2c865b=>{const _0x4f6951=_0x2b0fc3;_0x2c865b[_0x4f6951(0x214)](),PALETTE_COLORS[_0x4f6951(0x1c4)]>0x2&&(PALETTE_COLORS[_0x4f6951(0x2b7)](_0x517bba,0x1),createPalette());},_0x2bbc73[_0x2b0fc3(0x237)](_0x382712);}_0x4a8198[_0x2b0fc3(0x237)](_0x2bbc73);});const _0x358df6=document[_0x3630f8(0x1d6)](_0x3630f8(0x2a4));_0x358df6['className']=_0x3630f8(0x20b),_0x358df6[_0x3630f8(0x198)]=_0x3630f8(0x2cc),_0x358df6[_0x3630f8(0x25f)]='+',_0x358df6[_0x3630f8(0x234)]=_0x28ef44=>{const _0xcf24cc=_0x3630f8;_0x28ef44['stopPropagation']();const _0x2ba41d=document[_0xcf24cc(0x1d6)](_0xcf24cc(0x295));_0x2ba41d[_0xcf24cc(0x17d)]=_0xcf24cc(0x1ca),_0x2ba41d['style'][_0xcf24cc(0x2f0)]=_0xcf24cc(0x1b1);let _0x398f9e=![];_0x2ba41d[_0xcf24cc(0x28a)]=_0x415c2a=>{const _0xa36300=_0xcf24cc;if(!_0x398f9e){PALETTE_COLORS['unshift'](_0x415c2a[_0xa36300(0x2e5)]['value']);if(PALETTE_COLORS['length']>0x18)PALETTE_COLORS=PALETTE_COLORS[_0xa36300(0x1f6)](0x0,0x18);savePaletteToDB(),createPalette(),_0x398f9e=!![],_0x2ba41d[_0xa36300(0x187)]();}},_0x2ba41d[_0xcf24cc(0x21d)]('blur',()=>{const _0x5796a0=_0xcf24cc;if(!_0x398f9e)_0x2ba41d[_0x5796a0(0x187)]();}),_0x2ba41d[_0xcf24cc(0x21d)]('click',_0x124f32=>_0x124f32['stopPropagation']()),document[_0xcf24cc(0x1e8)][_0xcf24cc(0x237)](_0x2ba41d),_0x2ba41d[_0xcf24cc(0x2be)](),_0x2ba41d[_0xcf24cc(0x2ed)]();},_0x4a8198[_0x3630f8(0x1d3)](_0x358df6,_0x4a8198['firstChild']);let _0x27e85b=document['getElementById']('palette-toolbar');!_0x27e85b&&(_0x27e85b=document['createElement'](_0x3630f8(0x2c9)),_0x27e85b['id']=_0x3630f8(0x25e),_0x27e85b[_0x3630f8(0x252)]='palette-toolbar',_0x4a8198['parentNode'][_0x3630f8(0x237)](_0x27e85b)),_0x27e85b['innerHTML']=_0x3630f8(0x253)+(currentTool===_0x3630f8(0x182)?_0x3630f8(0x1e4):'')+_0x3630f8(0x2ad)+(currentTool===_0x3630f8(0x2e0)?_0x3630f8(0x1e4):'')+'\x22\x20data-tool=\x22eraser\x22\x20onclick=\x22setTool(\x27eraser\x27)\x22><span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>delete</span>Ê∂à„Åó„Ç¥„É†</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22tool-btn'+(currentTool===_0x3630f8(0x1a8)?_0x3630f8(0x1e4):'')+_0x3630f8(0x1d9)+(penSize==0x1?'\x20selected':'')+_0x3630f8(0x1dd)+(penSize==0x2?_0x3630f8(0x298):'')+_0x3630f8(0x18e)+(penSize==0x3?_0x3630f8(0x298):'')+'>3</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x224\x22'+(penSize==0x4?_0x3630f8(0x298):'')+'>4</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22margin-left:8px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22palette-penMode\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22square\x22'+(penMode==='square'?_0x3630f8(0x298):'')+'>ÂõõËßí„Éö„É≥</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22circle\x22'+(penMode===_0x3630f8(0x2ea)?'\x20selected':'')+'>‰∏∏„Éö„É≥</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22margin-left:8px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ÈÄèÊòéÂ∫¶:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22range\x22\x20id=\x22palette-alphaSlider\x22\x20min=\x220\x22\x20max=\x22100\x22\x20value=\x22'+Math[_0x3630f8(0x26f)](currentAlpha*0x64)+_0x3630f8(0x233)+Math[_0x3630f8(0x26f)](currentAlpha*0x64)+_0x3630f8(0x1eb),_0x27e85b['querySelector'](_0x3630f8(0x246))[_0x3630f8(0x222)]=_0x3a0275=>setPenSize(_0x3a0275['target'][_0x3630f8(0x24e)]),_0x27e85b[_0x3630f8(0x2c0)](_0x3630f8(0x2b2))[_0x3630f8(0x222)]=_0xcdf2bd=>setPenMode(_0xcdf2bd[_0x3630f8(0x2e5)][_0x3630f8(0x24e)]),_0x27e85b[_0x3630f8(0x29b)]('.tool-btn')[_0x3630f8(0x1bd)](_0x3b169b=>{const _0x20c58=_0x3630f8;_0x3b169b[_0x20c58(0x234)]=()=>setTool(_0x3b169b['dataset']['tool']);}),_0x27e85b[_0x3630f8(0x2c0)](_0x3630f8(0x241))[_0x3630f8(0x28a)]=_0x30925a=>{const _0x456939=_0x3630f8;setAlpha(_0x30925a[_0x456939(0x2e5)]['value']),_0x27e85b[_0x456939(0x2c0)](_0x456939(0x227))[_0x456939(0x221)]=_0x30925a[_0x456939(0x2e5)][_0x456939(0x24e)]+'%';let _0x264f56=document['getElementById'](_0x456939(0x1d8)),_0x3ebda6=document[_0x456939(0x275)](_0x456939(0x213));if(_0x264f56)_0x264f56['value']=_0x30925a[_0x456939(0x2e5)][_0x456939(0x24e)];if(_0x3ebda6)_0x3ebda6[_0x456939(0x221)]=_0x30925a['target'][_0x456939(0x24e)]+'%';};}function setAlpha(_0x4a70a0){const _0x4c654e=a0_0x38aafa;let _0x578bec=Math[_0x4c654e(0x2c3)](0x0,Math[_0x4c654e(0x1b2)](0x64,parseInt(_0x4a70a0,0xa)||0x0));currentAlpha=_0x578bec/0x64;let _0x3c3a74=document[_0x4c654e(0x275)](_0x4c654e(0x1d8)),_0x26edae=document[_0x4c654e(0x275)]('alphaValue');if(_0x3c3a74)_0x3c3a74['value']=_0x578bec;if(_0x26edae)_0x26edae[_0x4c654e(0x221)]=_0x578bec+'%';let _0x4d95ae=document[_0x4c654e(0x275)](_0x4c654e(0x247)),_0x2a6d02=document[_0x4c654e(0x275)](_0x4c654e(0x245));if(_0x4d95ae)_0x4d95ae[_0x4c654e(0x24e)]=_0x578bec;if(_0x2a6d02)_0x2a6d02[_0x4c654e(0x221)]=_0x578bec+'%';}async function savePaletteToDB(){const _0xbbc9bc=a0_0x38aafa;try{await idbSet(_0xbbc9bc(0x2e1),PALETTE_COLORS);}catch(_0x242646){console[_0xbbc9bc(0x181)]('‰øùÂ≠ò„Ç®„É©„Éº',_0x242646);}}async function loadPaletteFromDB(){const _0x16e73d=a0_0x38aafa;try{const _0x3fad1a=await idbGet(_0x16e73d(0x2e1));Array[_0x16e73d(0x19c)](_0x3fad1a)&&_0x3fad1a[_0x16e73d(0x1c4)]&&(PALETTE_COLORS=_0x3fad1a);}catch(_0xd23212){console[_0x16e73d(0x181)](_0x16e73d(0x195),_0xd23212);}}document['addEventListener']('DOMContentLoaded',()=>{const _0x44e46a=a0_0x38aafa,_0x16a4f2=document['getElementById'](_0x44e46a(0x1a0));_0x16a4f2&&(_0x16a4f2[_0x44e46a(0x28a)]=_0x3df10d=>{const _0x229bd6=_0x44e46a;currentColor=_0x3df10d[_0x229bd6(0x2e5)][_0x229bd6(0x24e)],document[_0x229bd6(0x29b)](_0x229bd6(0x1e6))[_0x229bd6(0x1bd)](_0x137628=>_0x137628[_0x229bd6(0x22b)][_0x229bd6(0x187)](_0x229bd6(0x2dd)));});const _0x53a43a=document[_0x44e46a(0x275)](_0x44e46a(0x1d8)),_0x3a2d05=document[_0x44e46a(0x275)](_0x44e46a(0x213));_0x53a43a&&_0x3a2d05&&(_0x53a43a['oninput']=_0x521794=>{const _0x3e9a2c=_0x44e46a;setAlpha(_0x521794[_0x3e9a2c(0x2e5)][_0x3e9a2c(0x24e)]),_0x3a2d05[_0x3e9a2c(0x221)]=_0x521794[_0x3e9a2c(0x2e5)]['value']+'%';let _0x6406a1=document['getElementById'](_0x3e9a2c(0x247)),_0x9c85e6=document['getElementById'](_0x3e9a2c(0x245));if(_0x6406a1)_0x6406a1['value']=_0x521794[_0x3e9a2c(0x2e5)][_0x3e9a2c(0x24e)];if(_0x9c85e6)_0x9c85e6[_0x3e9a2c(0x221)]=_0x521794[_0x3e9a2c(0x2e5)]['value']+'%';});});async function convertToGIF(_0x5a4582,_0x20bf2f=0xc8,_0x2198fa=a0_0x38aafa(0x1d1)){const _0x4e2a1e=a0_0x38aafa,_0x409ca1=new window[(_0x4e2a1e(0x190))]({'workers':0x2,'quality':0xa,'workerScript':'lib/gif.worker.js'});_0x5a4582[_0x4e2a1e(0x1bd)](_0x2ff859=>_0x409ca1[_0x4e2a1e(0x2a2)](_0x2ff859,{'delay':_0x20bf2f})),_0x409ca1['on'](_0x4e2a1e(0x235),_0x5e4389=>{const _0x41900a=_0x4e2a1e,_0x3f4dec=URL['createObjectURL'](_0x5e4389),_0x31528f=document[_0x41900a(0x1d6)]('a');_0x31528f['href']=_0x3f4dec,_0x31528f['download']=_0x2198fa,document[_0x41900a(0x1e8)]['appendChild'](_0x31528f),_0x31528f[_0x41900a(0x2ed)](),setTimeout(()=>{const _0x534849=_0x41900a;document[_0x534849(0x1e8)][_0x534849(0x1dc)](_0x31528f),URL[_0x534849(0x255)](_0x3f4dec);},0x3e8);}),_0x409ca1[_0x4e2a1e(0x1c1)]();}function makeAPNGBlob(_0x5432f4,_0x5d8b5f,_0xa4f771,_0x4413fd=0xc8){const _0x23cdaf=a0_0x38aafa,_0x4adcb2=[],_0xe91eab=[],_0x2df9fe=document[_0x23cdaf(0x1d6)](_0x23cdaf(0x19d));_0x2df9fe['width']=_0x5d8b5f,_0x2df9fe['height']=_0xa4f771;const _0x2aacc7=_0x2df9fe[_0x23cdaf(0x2c6)]('2d');_0x5432f4[_0x23cdaf(0x1bd)](_0x3e7d70=>{const _0x2480a6=_0x23cdaf;_0x2aacc7[_0x2480a6(0x22d)](0x0,0x0,_0x5d8b5f,_0xa4f771),_0x2aacc7['drawImage'](_0x3e7d70,0x0,0x0,_0x5d8b5f,_0xa4f771);const _0x1d0448=_0x2aacc7[_0x2480a6(0x287)](0x0,0x0,_0x5d8b5f,_0xa4f771)[_0x2480a6(0x261)]['buffer'];_0x4adcb2['push'](_0x1d0448),_0xe91eab['push'](_0x4413fd);});const _0x22f7c3=window[_0x23cdaf(0x21e)][_0x23cdaf(0x1e2)](_0x4adcb2,_0x5d8b5f,_0xa4f771,0x0,_0xe91eab);return new Blob([_0x22f7c3],{'type':_0x23cdaf(0x18f)});}function convertToAPNG(_0x1b6377,_0x4e9816,_0x53f860,_0x1ce826=0xc8,_0x42981f=a0_0x38aafa(0x2ef)){const _0x3eee18=a0_0x38aafa,_0x10d959=makeAPNGBlob(_0x1b6377,_0x4e9816,_0x53f860,_0x1ce826),_0x3b5203=URL['createObjectURL'](_0x10d959),_0x39c87c=document['createElement']('a');_0x39c87c[_0x3eee18(0x1c8)]=_0x3b5203,_0x39c87c[_0x3eee18(0x215)]=_0x42981f,document[_0x3eee18(0x1e8)][_0x3eee18(0x237)](_0x39c87c),_0x39c87c['click'](),setTimeout(()=>{const _0x24910a=_0x3eee18;document[_0x24910a(0x1e8)][_0x24910a(0x1dc)](_0x39c87c),URL[_0x24910a(0x255)](_0x3b5203);},0x3e8);}async function loadImages(_0x4c6ebb){const _0x501a4e=a0_0x38aafa,_0x1ed915=await Promise['all'](_0x4c6ebb[_0x501a4e(0x294)](_0x5060f6=>{return new Promise(_0x3361e6=>{const _0x372c9b=a0_0x1925,_0xbac8af=new Image();_0xbac8af[_0x372c9b(0x290)]=_0x372c9b(0x26a),_0xbac8af[_0x372c9b(0x1b3)]=_0x5060f6,_0xbac8af[_0x372c9b(0x185)]=()=>_0x3361e6(_0xbac8af);});}));return _0x1ed915;}function exportSpriteSheetDialog(){const _0x116e3c=a0_0x38aafa;let _0x3f0fde=prompt('„Çπ„Éó„É©„Ç§„Éà„Ç∑„Éº„Éà„ÅÆÊã°Â§ßÁéá„ÇíÊåáÂÆöÔºà‰æã:\x201\x20=\x20ÂÖÉ„Çµ„Ç§„Ç∫,\x202\x20=\x202ÂÄçÔºâ','1');if(_0x3f0fde===null)return;let _0x35a371=Math[_0x116e3c(0x2c3)](0x1,parseInt(_0x3f0fde,0xa)||0x1),_0x40dfbc=prompt(_0x116e3c(0x264),'0');if(_0x40dfbc===null)return;let _0x1ab78e=Math[_0x116e3c(0x2c3)](0x0,parseInt(_0x40dfbc,0xa)||0x0);exportSpriteSheet(_0x35a371,_0x1ab78e);}function exportSpriteSheet(_0x478df7=0x1,_0x3622aa=0x0){const _0x3bbf30=a0_0x38aafa,_0x58058d=getCurrentProject();if(!_0x58058d){alert(_0x3bbf30(0x272));return;}const _0x23f7b9=_0x58058d['frames'];if(!_0x23f7b9||_0x23f7b9[_0x3bbf30(0x1c4)]===0x0){alert(_0x3bbf30(0x2cf));return;}const _0x24d367=_0x58058d[_0x3bbf30(0x1b8)]*cellSize,_0x5710d8=_0x58058d[_0x3bbf30(0x27c)]*cellSize,_0x322154=_0x24d367*_0x23f7b9[_0x3bbf30(0x1c4)]*_0x478df7+Math[_0x3bbf30(0x2c3)](0x0,_0x23f7b9[_0x3bbf30(0x1c4)]-0x1)*_0x3622aa,_0x2e4d2d=_0x5710d8*_0x478df7,_0x45bdcd=document['createElement'](_0x3bbf30(0x19d));_0x45bdcd[_0x3bbf30(0x1b8)]=_0x322154,_0x45bdcd['height']=_0x2e4d2d;const _0x1985c4=_0x45bdcd[_0x3bbf30(0x2c6)]('2d');_0x1985c4[_0x3bbf30(0x22d)](0x0,0x0,_0x45bdcd[_0x3bbf30(0x1b8)],_0x45bdcd[_0x3bbf30(0x27c)]);let _0x511399=0x0;for(let _0x2dfda4=0x0;_0x2dfda4<_0x23f7b9[_0x3bbf30(0x1c4)];_0x2dfda4++){let _0x31c9ed=document[_0x3bbf30(0x1d6)]('canvas');_0x31c9ed['width']=_0x24d367,_0x31c9ed[_0x3bbf30(0x27c)]=_0x5710d8;let _0x3c6640=_0x31c9ed[_0x3bbf30(0x2c6)]('2d');for(let _0x475d24=0x0;_0x475d24<_0x23f7b9[_0x2dfda4]['layers']['length'];_0x475d24++){_0x3c6640[_0x3bbf30(0x1ff)](_0x23f7b9[_0x2dfda4][_0x3bbf30(0x262)][_0x475d24],0x0,0x0);}_0x478df7===0x1&&_0x3622aa===0x0?(_0x1985c4['drawImage'](_0x31c9ed,_0x511399,0x0),_0x511399+=_0x24d367):(_0x1985c4[_0x3bbf30(0x1ff)](_0x31c9ed,0x0,0x0,_0x24d367,_0x5710d8,_0x511399,0x0,_0x24d367*_0x478df7,_0x5710d8*_0x478df7),_0x511399+=_0x24d367*_0x478df7),_0x2dfda4<_0x23f7b9['length']-0x1&&_0x3622aa>0x0&&(_0x511399+=_0x3622aa);}const _0x333e9c=(_0x58058d[_0x3bbf30(0x2e6)]||_0x3bbf30(0x2ab))['replace'](/[\\/:*?"<>|]/g,'_'),_0x246440=document[_0x3bbf30(0x1d6)]('a');_0x246440['href']=_0x45bdcd['toDataURL']('image/png'),_0x246440[_0x3bbf30(0x215)]=_0x333e9c+_0x3bbf30(0x217),document[_0x3bbf30(0x1e8)][_0x3bbf30(0x237)](_0x246440),_0x246440[_0x3bbf30(0x2ed)](),setTimeout(()=>{document['body']['removeChild'](_0x246440);},0x3e8);}const NEZUMI_METADATA_SIG=a0_0x38aafa(0x258);function appendMetadataToBlob(_0xd22cbc,_0x45e001){const _0x485dfd=a0_0x38aafa,_0xa65df5=new TextEncoder(),_0x2e95d8=_0xa65df5[_0x485dfd(0x1e2)](NEZUMI_METADATA_SIG),_0x23ecce=_0xa65df5[_0x485dfd(0x1e2)](JSON[_0x485dfd(0x1e5)](_0x45e001));return new Blob([_0xd22cbc,_0x2e95d8,_0x23ecce],{'type':_0xd22cbc[_0x485dfd(0x17d)]||_0x485dfd(0x2cb)});}function indexOfSubarray(_0x3f4d1b,_0x587b62){const _0x3ca14d=a0_0x38aafa;for(let _0xc113a6=0x0;_0xc113a6<=_0x3f4d1b[_0x3ca14d(0x1c4)]-_0x587b62['length'];_0xc113a6++){let _0x2f9d0f=!![];for(let _0x25629a=0x0;_0x25629a<_0x587b62[_0x3ca14d(0x1c4)];_0x25629a++){if(_0x3f4d1b[_0xc113a6+_0x25629a]!==_0x587b62[_0x25629a]){_0x2f9d0f=![];break;}}if(_0x2f9d0f)return _0xc113a6;}return-0x1;}function extractMetadataFromArrayBuffer(_0x23102e){const _0x338baf=a0_0x38aafa,_0x56eb7c=new TextEncoder()[_0x338baf(0x1e2)](NEZUMI_METADATA_SIG),_0x45eb41=new Uint8Array(_0x23102e),_0xd5b63c=indexOfSubarray(_0x45eb41,_0x56eb7c);if(_0xd5b63c===-0x1)return null;const _0x3b75cd=_0x45eb41[_0x338baf(0x236)](_0xd5b63c+_0x56eb7c['length']);try{const _0x7f4171=new TextDecoder()[_0x338baf(0x27e)](_0x3b75cd);return JSON[_0x338baf(0x288)](_0x7f4171);}catch(_0x5034ad){return null;}}async function exportStandalone(){const _0x5a482c=a0_0x38aafa;let _0x498a87=getCurrentProject(),_0x2483b4=_0x498a87['frames'],_0x51cc22=_0x498a87[_0x5a482c(0x1b8)]*cellSize,_0x30f919=_0x498a87[_0x5a482c(0x27c)]*cellSize;const _0x48f8fa=_0x2483b4[_0x5a482c(0x294)](_0x425607=>{const _0x2eca7b=_0x5a482c;let _0x22952b=document[_0x2eca7b(0x1d6)](_0x2eca7b(0x19d));_0x22952b[_0x2eca7b(0x1b8)]=_0x51cc22,_0x22952b[_0x2eca7b(0x27c)]=_0x30f919;let _0x13d906=_0x22952b[_0x2eca7b(0x2c6)]('2d');for(let _0x3b3e67=0x0;_0x3b3e67<_0x425607['layers'][_0x2eca7b(0x1c4)];_0x3b3e67++){_0x13d906[_0x2eca7b(0x1ff)](_0x425607['layers'][_0x3b3e67],0x0,0x0);}let _0x348441=new Image();return _0x348441[_0x2eca7b(0x1b3)]=_0x22952b['toDataURL'](_0x2eca7b(0x1fa)),_0x348441;});await Promise[_0x5a482c(0x25a)](_0x48f8fa[_0x5a482c(0x294)](_0xa33324=>new Promise(_0x1a50e3=>{const _0x21d6b0=_0x5a482c;_0xa33324[_0x21d6b0(0x185)]=_0x1a50e3;})))['catch'](()=>{});const _0x3833ea=(_0x498a87[_0x5a482c(0x2e6)]||_0x5a482c(0x21f))[_0x5a482c(0x27d)](/[\\/:*?"<>|]/g,'_'),_0x22d2b7=makeAPNGBlob(_0x48f8fa,_0x51cc22,_0x30f919,animationDelay),_0x2d5f18={'type':_0x5a482c(0x207),'version':0x1,'project':{'width':_0x498a87[_0x5a482c(0x1b8)],'height':_0x498a87[_0x5a482c(0x27c)],'name':_0x498a87[_0x5a482c(0x2e6)]||'','activeFrame':_0x498a87['activeFrame'],'frames':_0x498a87[_0x5a482c(0x2b3)][_0x5a482c(0x294)](_0x35e808=>({'activeLayer':_0x35e808[_0x5a482c(0x1b5)],'layers':_0x35e808['layers'][_0x5a482c(0x294)](_0x1e15b8=>_0x1e15b8[_0x5a482c(0x1df)]())}))}},_0x108e0f=appendMetadataToBlob(_0x22d2b7,_0x2d5f18),_0x2226f8=URL[_0x5a482c(0x201)](_0x108e0f),_0x2837da=document['createElement']('a');_0x2837da[_0x5a482c(0x1c8)]=_0x2226f8,_0x2837da[_0x5a482c(0x215)]=_0x3833ea+'.apng',document[_0x5a482c(0x1e8)]['appendChild'](_0x2837da),_0x2837da[_0x5a482c(0x2ed)](),setTimeout(()=>{const _0x4f11ca=_0x5a482c;document[_0x4f11ca(0x1e8)][_0x4f11ca(0x1dc)](_0x2837da),URL[_0x4f11ca(0x255)](_0x2226f8);},0x3e8);}function loadStandaloneFromFile(_0x9c4df8){return new Promise((_0x18eeb0,_0x558d9c)=>{const _0x3ff356=a0_0x1925,_0x1377a5=new FileReader();_0x1377a5[_0x3ff356(0x185)]=_0x255f25=>{const _0x319f9d=_0x3ff356,_0x3f82bf=_0x255f25[_0x319f9d(0x2e5)][_0x319f9d(0x192)],_0x33f61f=extractMetadataFromArrayBuffer(_0x3f82bf);if(!_0x33f61f||!_0x33f61f['project']){_0x558d9c(new Error(_0x319f9d(0x20f)));return;}const _0x33b589=_0x33f61f[_0x319f9d(0x22f)];try{const _0x18bf74=createProject(_0x33b589[_0x319f9d(0x1b8)],_0x33b589[_0x319f9d(0x27c)],_0x33b589[_0x319f9d(0x2e6)]||'ÁîªÂÉè');_0x18bf74[_0x319f9d(0x2b3)]=_0x33b589[_0x319f9d(0x2b3)]['map'](_0x2a7492=>{const _0x4ed187=_0x319f9d;let _0x435b9f={'layers':[],'activeLayer':_0x2a7492['activeLayer'],'layerHistories':[],'layerRedoStacks':[]};for(let _0x4f4ffb=0x0;_0x4f4ffb<_0x2a7492[_0x4ed187(0x262)][_0x4ed187(0x1c4)];_0x4f4ffb++){let _0xaf939f=new Image();_0xaf939f[_0x4ed187(0x1b3)]=_0x2a7492['layers'][_0x4f4ffb];let _0x21bebb=document['createElement'](_0x4ed187(0x19d));_0x21bebb[_0x4ed187(0x1b8)]=_0x33b589['width']*cellSize,_0x21bebb[_0x4ed187(0x27c)]=_0x33b589['height']*cellSize,_0xaf939f['onload']=()=>{const _0x373ee8=_0x4ed187;let _0x1116e1=_0x21bebb[_0x373ee8(0x2c6)]('2d');_0x1116e1[_0x373ee8(0x22d)](0x0,0x0,_0x21bebb[_0x373ee8(0x1b8)],_0x21bebb[_0x373ee8(0x27c)]),_0x1116e1['drawImage'](_0xaf939f,0x0,0x0);},_0x435b9f['layers'][_0x4ed187(0x278)](_0x21bebb);}return _0x435b9f;}),projects[_0x319f9d(0x278)](_0x18bf74),activeProject=projects[_0x319f9d(0x1c4)]-0x1,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll(),_0x18eeb0(_0x18bf74);}catch(_0x503a8e){_0x558d9c(_0x503a8e);}},_0x1377a5[_0x3ff356(0x1c5)]=_0x1c2b22=>_0x558d9c(_0x1c2b22),_0x1377a5['readAsArrayBuffer'](_0x9c4df8);});}function toggleSection(_0x403850){const _0x4fdd12=a0_0x38aafa,_0x360df1=document[_0x4fdd12(0x275)](_0x403850),_0x44bdb4=_0x360df1[_0x4fdd12(0x2c0)](_0x4fdd12(0x218)),_0x5300e4=_0x360df1[_0x4fdd12(0x2c0)](_0x4fdd12(0x277));_0x44bdb4['style'][_0x4fdd12(0x2f0)]==='none'?(_0x44bdb4[_0x4fdd12(0x1f8)][_0x4fdd12(0x2f0)]='',_0x5300e4[_0x4fdd12(0x221)]='‚ñº'):(_0x44bdb4[_0x4fdd12(0x1f8)]['display']=_0x4fdd12(0x1b1),_0x5300e4[_0x4fdd12(0x221)]='‚ñ≤');}document[a0_0x38aafa(0x21d)](a0_0x38aafa(0x293),()=>{const _0x2fa95d=a0_0x38aafa;document['querySelectorAll'](_0x2fa95d(0x204))[_0x2fa95d(0x1bd)](_0x3bca9c=>_0x3bca9c[_0x2fa95d(0x1f8)][_0x2fa95d(0x2f0)]=''),document['querySelectorAll']('.section.collapsible\x20.toggle-btn')['forEach'](_0x17ee5c=>_0x17ee5c[_0x2fa95d(0x221)]='‚ñº');}),window[a0_0x38aafa(0x21d)](a0_0x38aafa(0x251),updateMenuBtnDisplay),document[a0_0x38aafa(0x21d)](a0_0x38aafa(0x293),updateMenuBtnDisplay);function toggleSideMenu(_0x536dfe){const _0x4b563b=a0_0x38aafa,_0x54f006=document['getElementById']('sidebar'),_0x30512a=document[_0x4b563b(0x275)](_0x4b563b(0x183)),_0x14258c=document[_0x4b563b(0x275)](_0x4b563b(0x18b)),_0x5bb40a=document[_0x4b563b(0x275)](_0x4b563b(0x1b4)),_0x107a70=_0x54f006[_0x4b563b(0x22b)][_0x4b563b(0x23f)]('open');let _0x370ca7=typeof _0x536dfe===_0x4b563b(0x1af)?_0x536dfe:!_0x107a70;_0x370ca7?(_0x54f006['classList'][_0x4b563b(0x1de)](_0x4b563b(0x2ec)),_0x30512a[_0x4b563b(0x22b)]['add'](_0x4b563b(0x2a1)),document['body']['style']['overflow']=_0x4b563b(0x289),document[_0x4b563b(0x1e8)][_0x4b563b(0x1f8)][_0x4b563b(0x1ec)]=_0x4b563b(0x1b1),window[_0x4b563b(0x22a)]<=0x384&&(_0x5bb40a['style'][_0x4b563b(0x2f0)]=_0x4b563b(0x1d2),_0x14258c['style'][_0x4b563b(0x2f0)]=_0x4b563b(0x1b1))):(_0x54f006['classList']['remove']('open'),_0x30512a[_0x4b563b(0x22b)]['remove'](_0x4b563b(0x2a1)),document[_0x4b563b(0x1e8)][_0x4b563b(0x1f8)]['overflow']='',document[_0x4b563b(0x1e8)][_0x4b563b(0x1f8)][_0x4b563b(0x1ec)]='',window[_0x4b563b(0x22a)]<=0x384&&(_0x5bb40a[_0x4b563b(0x1f8)]['display']=_0x4b563b(0x1b1),_0x14258c['style'][_0x4b563b(0x2f0)]='block'));}function updateMenuBtnDisplay(){const _0xabc363=a0_0x38aafa,_0x16ca39=document[_0xabc363(0x275)]('sidebar'),_0xb2fb6e=document['getElementById'](_0xabc363(0x183)),_0x25a3db=document['getElementById'](_0xabc363(0x18b)),_0x15f0af=document[_0xabc363(0x275)](_0xabc363(0x1b4));window[_0xabc363(0x22a)]>0x384?(_0x16ca39[_0xabc363(0x22b)]['remove'](_0xabc363(0x2ec)),_0xb2fb6e[_0xabc363(0x22b)][_0xabc363(0x187)](_0xabc363(0x2a1)),_0x15f0af['style'][_0xabc363(0x2f0)]='none',_0x25a3db[_0xabc363(0x1f8)][_0xabc363(0x2f0)]=_0xabc363(0x1b1),document[_0xabc363(0x1e8)][_0xabc363(0x1f8)][_0xabc363(0x188)]='',document[_0xabc363(0x1e8)][_0xabc363(0x1f8)]['touchAction']=''):_0x16ca39[_0xabc363(0x22b)][_0xabc363(0x23f)]('open')?(_0x15f0af['style'][_0xabc363(0x2f0)]=_0xabc363(0x1d2),_0x25a3db[_0xabc363(0x1f8)][_0xabc363(0x2f0)]=_0xabc363(0x1b1)):(_0x15f0af[_0xabc363(0x1f8)][_0xabc363(0x2f0)]=_0xabc363(0x1b1),_0x25a3db[_0xabc363(0x1f8)]['display']=_0xabc363(0x1d2));}document[a0_0x38aafa(0x21d)](a0_0x38aafa(0x2ed),function(_0x4b5c38){const _0x4a8505=a0_0x38aafa;if(window[_0x4a8505(0x22a)]>0x384)return;const _0x4e7d8c=document[_0x4a8505(0x275)](_0x4a8505(0x2ce)),_0xd249f8=document[_0x4a8505(0x275)]('main-container'),_0x5c6384=document[_0x4a8505(0x275)](_0x4a8505(0x18b)),_0xf9c351=document[_0x4a8505(0x275)]('menu-toggle-btn-close');!_0x4e7d8c[_0x4a8505(0x23f)](_0x4b5c38[_0x4a8505(0x2e5)])&&_0x4b5c38[_0x4a8505(0x2e5)]!==_0x5c6384&&_0x4b5c38[_0x4a8505(0x2e5)]!==_0xf9c351&&(_0x4e7d8c[_0x4a8505(0x22b)][_0x4a8505(0x187)](_0x4a8505(0x2ec)),_0xd249f8[_0x4a8505(0x22b)][_0x4a8505(0x187)](_0x4a8505(0x2a1)),_0xf9c351[_0x4a8505(0x1f8)][_0x4a8505(0x2f0)]='none',_0x5c6384[_0x4a8505(0x1f8)][_0x4a8505(0x2f0)]=_0x4a8505(0x1d2),document[_0x4a8505(0x1e8)][_0x4a8505(0x1f8)][_0x4a8505(0x188)]='',document['body'][_0x4a8505(0x1f8)][_0x4a8505(0x1ec)]='');}),(function(){const _0x1e3063=a0_0x38aafa;try{(location[_0x1e3063(0x1ad)][_0x1e3063(0x18c)](/index\.html$/)||location[_0x1e3063(0x1ad)]==='/'||location[_0x1e3063(0x1ad)]===_0x1e3063(0x2b1))&&(!localStorage[_0x1e3063(0x1d5)](_0x1e3063(0x249))&&(localStorage[_0x1e3063(0x1fc)](_0x1e3063(0x249),'1'),location[_0x1e3063(0x1c8)]=_0x1e3063(0x2ae)));}catch(_0x3bffbf){}}());let scale=0x1,posX=0x0,posY=0x0,lastX=0x0,lastY=0x0,dragging=![],startX=0x0,startY=0x0,shiftPressed=![],pointerDownX=0x0,pointerDownY=0x0;const PAN_CANCEL_DISTANCE=0x8;document[a0_0x38aafa(0x21d)](a0_0x38aafa(0x1cc),_0x562704=>{const _0x35aa17=a0_0x38aafa;if(_0x562704[_0x35aa17(0x2c5)]===_0x35aa17(0x24c))shiftPressed=!![];}),document[a0_0x38aafa(0x21d)](a0_0x38aafa(0x1ab),_0x355a30=>{const _0x3de968=a0_0x38aafa;if(_0x355a30[_0x3de968(0x2c5)]===_0x3de968(0x24c))shiftPressed=![];}),canvas['addEventListener'](a0_0x38aafa(0x1cd),_0xfec914=>{const _0x1325c1=a0_0x38aafa;if(_0xfec914[_0x1325c1(0x220)]===_0x1325c1(0x1a5))return;currentTool===_0x1325c1(0x232)||shiftPressed?(dragging=!![],isDrawing=![],startX=_0xfec914[_0x1325c1(0x193)],startY=_0xfec914[_0x1325c1(0x25d)],lastX=posX,lastY=posY,canvas[_0x1325c1(0x1f0)](_0xfec914[_0x1325c1(0x270)]),canvas[_0x1325c1(0x1f8)][_0x1325c1(0x2bd)]=_0x1325c1(0x1c2)):(isDrawing=!![],pointerDownX=_0xfec914[_0x1325c1(0x193)],pointerDownY=_0xfec914['clientY'],handleMouseDown(_0xfec914),canvas['setPointerCapture'](_0xfec914[_0x1325c1(0x270)]));}),canvas[a0_0x38aafa(0x21d)](a0_0x38aafa(0x17e),_0x2b4026=>{const _0x4f500f=a0_0x38aafa;if(_0x2b4026[_0x4f500f(0x220)]===_0x4f500f(0x1a5))return;if(dragging)posX=lastX+(_0x2b4026[_0x4f500f(0x193)]-startX),posY=lastY+(_0x2b4026['clientY']-startY),updateTransform();else{if(isDrawing){if(currentTool!==_0x4f500f(0x182)){const _0x233708=Math[_0x4f500f(0x1a6)](_0x2b4026[_0x4f500f(0x193)]-pointerDownX),_0x52352b=Math[_0x4f500f(0x1a6)](_0x2b4026[_0x4f500f(0x25d)]-pointerDownY);if(_0x233708>=PAN_CANCEL_DISTANCE||_0x52352b>=PAN_CANCEL_DISTANCE){isDrawing=![];try{handleMouseUp(_0x2b4026);}catch(_0x36ac5c){}return;}}handleMouseMove(_0x2b4026);}}}),canvas[a0_0x38aafa(0x21d)](a0_0x38aafa(0x2de),_0xfc25cb=>{const _0x18b389=a0_0x38aafa;if(_0xfc25cb[_0x18b389(0x220)]===_0x18b389(0x1a5))return;dragging=![];isDrawing&&handleMouseUp(_0xfc25cb);isDrawing=![];try{canvas['releasePointerCapture'](_0xfc25cb[_0x18b389(0x270)]);}catch(_0x2fe28c){}if(currentTool==='pan')canvas[_0x18b389(0x1f8)][_0x18b389(0x2bd)]='grab';else canvas[_0x18b389(0x1f8)]['cursor']='crosshair';}),wrapper[a0_0x38aafa(0x21d)]('wheel',_0x5b5eb2=>{const _0x41de1c=a0_0x38aafa;_0x5b5eb2['preventDefault']();const _0x13d609=canvas['getBoundingClientRect'](),_0x4dc9c7=_0x5b5eb2[_0x41de1c(0x193)],_0x467f6c=_0x5b5eb2[_0x41de1c(0x25d)],_0x1887ed=(_0x4dc9c7-_0x13d609[_0x41de1c(0x2a7)]-posX)/scale,_0x255bc9=(_0x467f6c-_0x13d609[_0x41de1c(0x196)]-posY)/scale,_0x42b77d=_0x5b5eb2[_0x41de1c(0x1e7)]>0x0?0.9:1.1;let _0x1697f8=scale*_0x42b77d;_0x1697f8=Math[_0x41de1c(0x1b2)](Math[_0x41de1c(0x2c3)](_0x1697f8,0.2),0x5),posX=_0x4dc9c7-_0x13d609[_0x41de1c(0x2a7)]-_0x1887ed*_0x1697f8,posY=_0x467f6c-_0x13d609[_0x41de1c(0x196)]-_0x255bc9*_0x1697f8,scale=_0x1697f8,updateTransform();const _0x2d0889=document[_0x41de1c(0x275)]('zoomSlider'),_0x5d1cff=document[_0x41de1c(0x275)](_0x41de1c(0x2b6));if(_0x2d0889)_0x2d0889[_0x41de1c(0x24e)]=Math[_0x41de1c(0x26f)](scale*0x64);if(_0x5d1cff)_0x5d1cff[_0x41de1c(0x221)]=Math[_0x41de1c(0x26f)](scale*0x64)+'%';},{'passive':![]});function updateTransform(){const _0x13b983=a0_0x38aafa;canvas[_0x13b983(0x1f8)]['transform']=_0x13b983(0x184)+posX+_0x13b983(0x1c0)+posY+'px)\x20scale('+scale+')';}function setZoomValue(_0x477356){const _0x541303=a0_0x38aafa,_0x298870=Math['max'](0x14,Math[_0x541303(0x1b2)](0x1f4,parseInt(_0x477356,0xa)||0x64)),_0x54c360=_0x298870/0x64;scale=_0x54c360,updateTransform();const _0x5c5b04=document[_0x541303(0x275)](_0x541303(0x1bc)),_0x1b786b=document[_0x541303(0x275)](_0x541303(0x2b6));if(_0x5c5b04)_0x5c5b04[_0x541303(0x24e)]=_0x298870;if(_0x1b786b)_0x1b786b[_0x541303(0x221)]=_0x298870+'%';}function zoomIn(){const _0x56edc6=a0_0x38aafa,_0x59ca70=document[_0x56edc6(0x275)](_0x56edc6(0x1bc));let _0x2df697=_0x59ca70?parseInt(_0x59ca70[_0x56edc6(0x24e)],0xa):Math[_0x56edc6(0x26f)](scale*0x64);_0x2df697=Math[_0x56edc6(0x1b2)](0x1f4,_0x2df697+0xa),setZoomValue(_0x2df697);}function zoomOut(){const _0x40419d=a0_0x38aafa,_0x12418e=document[_0x40419d(0x275)]('zoomSlider');let _0x47f806=_0x12418e?parseInt(_0x12418e[_0x40419d(0x24e)],0xa):Math[_0x40419d(0x26f)](scale*0x64);_0x47f806=Math[_0x40419d(0x2c3)](0x14,_0x47f806-0xa),setZoomValue(_0x47f806);}const zs=document[a0_0x38aafa(0x275)]('zoomSlider');if(zs)zs[a0_0x38aafa(0x28a)]=_0x59888d=>setZoomValue(_0x59888d['target'][a0_0x38aafa(0x24e)]);const zv=document[a0_0x38aafa(0x275)]('zoomValue');if(zv)zv['textContent']=Math['round'](scale*0x64)+'%';function getCanvasCoords(_0x2ac51a){const _0x57b351=a0_0x38aafa,_0x755283=canvas['getBoundingClientRect'](),_0x200216=canvas['width']/_0x755283[_0x57b351(0x1b8)],_0x43284a=canvas[_0x57b351(0x27c)]/_0x755283[_0x57b351(0x27c)],_0x50ebc9=(_0x2ac51a[_0x57b351(0x193)]-_0x755283[_0x57b351(0x2a7)])*_0x200216,_0x4d0363=(_0x2ac51a[_0x57b351(0x25d)]-_0x755283[_0x57b351(0x196)])*_0x43284a;return{'x':_0x50ebc9,'y':_0x4d0363};}function handleDrawStart(_0x38ee9f){const _0x26e70a=a0_0x38aafa,_0x559111=getCanvasCoords(_0x38ee9f);ctx[_0x26e70a(0x2eb)](),ctx[_0x26e70a(0x29e)](_0x559111['x'],_0x559111['y']);}function handleDrawMove(_0x369d8e){const _0x805a53=a0_0x38aafa,_0x5f2c58=getCanvasCoords(_0x369d8e);ctx['lineTo'](_0x5f2c58['x'],_0x5f2c58['y']),ctx[_0x805a53(0x2d9)]();}function handleDrawEnd(_0x81f0){const _0x1d6093=a0_0x38aafa;ctx[_0x1d6093(0x2db)]();}