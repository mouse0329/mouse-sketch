const _0x174762=_0x529c;(function(_0x4b5497,_0x3d23dd){const _0x5ae0cc=_0x529c,_0x3bc235=_0x4b5497();while(!![]){try{const _0x29970a=parseInt(_0x5ae0cc(0x246))/0x1*(-parseInt(_0x5ae0cc(0x205))/0x2)+-parseInt(_0x5ae0cc(0x1f1))/0x3*(parseInt(_0x5ae0cc(0x249))/0x4)+parseInt(_0x5ae0cc(0x24f))/0x5+parseInt(_0x5ae0cc(0x204))/0x6+parseInt(_0x5ae0cc(0x1fa))/0x7*(-parseInt(_0x5ae0cc(0x1f8))/0x8)+parseInt(_0x5ae0cc(0x220))/0x9*(-parseInt(_0x5ae0cc(0x1d3))/0xa)+parseInt(_0x5ae0cc(0x23b))/0xb;if(_0x29970a===_0x3d23dd)break;else _0x3bc235['push'](_0x3bc235['shift']());}catch(_0xba6e36){_0x3bc235['push'](_0x3bc235['shift']());}}}(_0x3083,0xb1f58));const _0x206c0f=(function(){let _0x16516b=!![];return function(_0x4e6374,_0x507cf1){const _0x7139ad=_0x16516b?function(){const _0x4ed50d=_0x529c;if(_0x507cf1){const _0xa76dba=_0x507cf1[_0x4ed50d(0x1da)](_0x4e6374,arguments);return _0x507cf1=null,_0xa76dba;}}:function(){};return _0x16516b=![],_0x7139ad;};}()),_0x399457=_0x206c0f(this,function(){const _0x326d87=_0x529c;return _0x399457[_0x326d87(0x24d)]()[_0x326d87(0x230)](_0x326d87(0x1de))[_0x326d87(0x24d)]()[_0x326d87(0x239)](_0x399457)[_0x326d87(0x230)](_0x326d87(0x1de));});_0x399457();function createProject(_0x22bbbc=0x10,_0x2c5b74=0x10,_0x5c0ebf=''){const _0x2fe59b=_0x529c;let _0x3600cc=0x14,_0x447ff9=[],_0x223ca3=[],_0x23ebd9=[],_0x461327=document[_0x2fe59b(0x1e9)](_0x2fe59b(0x203));_0x461327[_0x2fe59b(0x24b)]=_0x22bbbc*_0x3600cc,_0x461327[_0x2fe59b(0x1df)]=_0x2c5b74*_0x3600cc,_0x447ff9[_0x2fe59b(0x232)]({'canvas':_0x461327,'visible':!![]}),_0x223ca3[_0x2fe59b(0x232)]([]),_0x23ebd9[_0x2fe59b(0x232)]([]);let _0x2454e2={'layers':_0x447ff9,'activeLayer':0x0,'layerHistories':_0x223ca3,'layerRedoStacks':_0x23ebd9};return{'frames':[_0x2454e2],'activeFrame':0x0,'width':_0x22bbbc,'height':_0x2c5b74,'name':_0x5c0ebf||'画像'+(projects[_0x2fe59b(0x250)]+0x1)};}function editProjectName(_0x158ba0,_0x28c66a){const _0x2db4f0=_0x529c,_0x4347d4=document[_0x2db4f0(0x1e9)](_0x2db4f0(0x1f7));_0x4347d4[_0x2db4f0(0x209)]=_0x2db4f0(0x247),_0x4347d4[_0x2db4f0(0x235)]=projects[_0x158ba0][_0x2db4f0(0x1d4)]||'画像'+(_0x158ba0+0x1),_0x4347d4[_0x2db4f0(0x23e)]=_0x2db4f0(0x1d0),_0x4347d4[_0x2db4f0(0x215)][_0x2db4f0(0x24b)]=_0x2db4f0(0x20c),_0x4347d4[_0x2db4f0(0x259)]=()=>{const _0xb99901=_0x2db4f0;projects[_0x158ba0]['name']=_0x4347d4[_0xb99901(0x235)][_0xb99901(0x212)]()||'画像'+(_0x158ba0+0x1),updateProjectUI();},_0x4347d4[_0x2db4f0(0x1f3)]=_0x175ea0=>{const _0x3efb55=_0x2db4f0;if(_0x175ea0['key']===_0x3efb55(0x23f))_0x4347d4[_0x3efb55(0x217)]();},_0x28c66a[_0x2db4f0(0x251)](_0x4347d4),_0x4347d4[_0x2db4f0(0x21f)](),_0x4347d4[_0x2db4f0(0x1d1)]();}function addProject(){showNewProjectDialog((_0x3be46d,_0x53970f,_0xf5f5c4)=>{const _0x984720=_0x529c;if(!Number[_0x984720(0x1f5)](_0x3be46d)||_0x3be46d<0x1)_0x3be46d=0x10;if(!Number[_0x984720(0x1f5)](_0x53970f)||_0x53970f<0x1)_0x53970f=0x10;projects[_0x984720(0x232)](createProject(_0x3be46d,_0x53970f,_0xf5f5c4)),activeProject=projects['length']-0x1,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();});}function removeProjectAt(_0xe6e209){const _0x24469a=_0x529c;if(projects['length']<=0x1)return;const _0x154bea=projects[_0xe6e209]&&projects[_0xe6e209]['name']?projects[_0xe6e209][_0x24469a(0x1d4)]:'画像'+(_0xe6e209+0x1);if(!confirm('「'+_0x154bea+_0x24469a(0x1ea)))return;projects[_0x24469a(0x225)](_0xe6e209,0x1);if(activeProject>=projects['length'])activeProject=projects['length']-0x1;updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();}function getCurrentProject(){return projects[activeProject];}function addFrame(){const _0xdaa768=_0x529c,_0x35c12f=getCurrentProject(),_0x40944b=_0x35c12f[_0xdaa768(0x214)][_0x35c12f['activeFrame']],_0x1214e3=_0x4d40bc=>{const _0x361d25=_0xdaa768,_0x5e7655=_0x4d40bc&&_0x4d40bc[_0x361d25(0x203)]?_0x4d40bc[_0x361d25(0x203)]:_0x4d40bc;if(!_0x5e7655)return console[_0x361d25(0x1fb)]('複製できないレイヤーがありますチュー',_0x4d40bc),null;const _0xcc1700=document['createElement'](_0x361d25(0x203));_0xcc1700[_0x361d25(0x24b)]=_0x5e7655[_0x361d25(0x24b)]||_0x35c12f[_0x361d25(0x24b)]*cellSize,_0xcc1700[_0x361d25(0x1df)]=_0x5e7655['height']||_0x35c12f[_0x361d25(0x1df)]*cellSize;const _0x130599=_0xcc1700[_0x361d25(0x213)]('2d');try{_0x130599[_0x361d25(0x227)](_0x5e7655,0x0,0x0);}catch(_0x34e34b){console[_0x361d25(0x1fb)](_0x361d25(0x223),_0x34e34b);}return{'canvas':_0xcc1700,'visible':_0x4d40bc&&typeof _0x4d40bc[_0x361d25(0x211)]!==_0x361d25(0x255)?_0x4d40bc[_0x361d25(0x211)]:!![]};},_0x5a8258=_0x40944b[_0xdaa768(0x21a)][_0xdaa768(0x241)](_0x1214e3),_0x9e8862=_0x5a8258[_0xdaa768(0x241)](()=>[]),_0x749c42=_0x5a8258[_0xdaa768(0x241)](()=>[]),_0x6aa17a={'layers':_0x5a8258,'activeLayer':0x0,'layerHistories':_0x9e8862,'layerRedoStacks':_0x749c42};_0x35c12f['frames'][_0xdaa768(0x225)](_0x35c12f[_0xdaa768(0x22a)]+0x1,0x0,_0x6aa17a),_0x35c12f['activeFrame']++,updateFrameUI(),updateLayerUI(),redrawAll();}const cloneLayer=_0x4c251e=>{const _0x240fe5=_0x529c,_0x50ab1e=_0x4c251e&&_0x4c251e[_0x240fe5(0x203)]?_0x4c251e[_0x240fe5(0x203)]:_0x4c251e;if(!_0x50ab1e)return console[_0x240fe5(0x1fb)](_0x240fe5(0x200),_0x4c251e),null;const _0x2a52c9=document[_0x240fe5(0x1e9)](_0x240fe5(0x203));_0x2a52c9[_0x240fe5(0x24b)]=_0x50ab1e[_0x240fe5(0x24b)],_0x2a52c9['height']=_0x50ab1e[_0x240fe5(0x1df)];const _0x574fc0=_0x2a52c9[_0x240fe5(0x213)]('2d');try{_0x574fc0['drawImage'](_0x50ab1e,0x0,0x0);}catch(_0x2105f0){console[_0x240fe5(0x1fb)](_0x240fe5(0x223),_0x2105f0);}return{'canvas':_0x2a52c9,'visible':_0x4c251e&&typeof _0x4c251e['visible']!==_0x240fe5(0x255)?_0x4c251e[_0x240fe5(0x211)]:!![]};};function removeFrameAt(_0x461f92){const _0x2e1a1f=_0x529c;let _0x285112=getCurrentProject();if(_0x285112['frames'][_0x2e1a1f(0x250)]<=0x1)return;_0x285112[_0x2e1a1f(0x214)][_0x2e1a1f(0x225)](_0x461f92,0x1);if(_0x285112['activeFrame']>=_0x285112[_0x2e1a1f(0x214)][_0x2e1a1f(0x250)])_0x285112[_0x2e1a1f(0x22a)]=_0x285112[_0x2e1a1f(0x214)][_0x2e1a1f(0x250)]-0x1;updateFrameUI(),updateLayerUI(),redrawAll();}function getCurrentFrame(){const _0x4fcbae=_0x529c,_0x2e2940=getCurrentProject();if(!_0x2e2940||!_0x2e2940[_0x4fcbae(0x214)]||typeof _0x2e2940[_0x4fcbae(0x22a)]!=='number'||!_0x2e2940[_0x4fcbae(0x214)][_0x2e2940['activeFrame']])return null;return _0x2e2940[_0x4fcbae(0x214)][_0x2e2940[_0x4fcbae(0x22a)]];}function swapLayer(_0x183db7,_0x7f60b6){const _0x2fa7ac=_0x529c;let _0x4dad52=getCurrentFrame();[_0x4dad52[_0x2fa7ac(0x21a)][_0x183db7],_0x4dad52['layers'][_0x7f60b6]]=[_0x4dad52[_0x2fa7ac(0x21a)][_0x7f60b6],_0x4dad52[_0x2fa7ac(0x21a)][_0x183db7]],[_0x4dad52['layerHistories'][_0x183db7],_0x4dad52[_0x2fa7ac(0x25c)][_0x7f60b6]]=[_0x4dad52[_0x2fa7ac(0x25c)][_0x7f60b6],_0x4dad52[_0x2fa7ac(0x25c)][_0x183db7]],[_0x4dad52[_0x2fa7ac(0x238)][_0x183db7],_0x4dad52[_0x2fa7ac(0x238)][_0x7f60b6]]=[_0x4dad52[_0x2fa7ac(0x238)][_0x7f60b6],_0x4dad52['layerRedoStacks'][_0x183db7]];if(_0x4dad52[_0x2fa7ac(0x1fc)]===_0x183db7)_0x4dad52[_0x2fa7ac(0x1fc)]=_0x7f60b6;else{if(_0x4dad52[_0x2fa7ac(0x1fc)]===_0x7f60b6)_0x4dad52[_0x2fa7ac(0x1fc)]=_0x183db7;}updateLayerUI(),redrawAll();if(typeof requestAutoSave===_0x2fa7ac(0x236))requestAutoSave();}function removeLayerAt(_0x2a7992){const _0xf77a34=_0x529c;let _0x36b6dc=getCurrentFrame();if(_0x36b6dc[_0xf77a34(0x21a)][_0xf77a34(0x250)]<=0x1)return;_0x36b6dc[_0xf77a34(0x21a)][_0xf77a34(0x225)](_0x2a7992,0x1),_0x36b6dc['layerHistories'][_0xf77a34(0x225)](_0x2a7992,0x1),_0x36b6dc[_0xf77a34(0x238)][_0xf77a34(0x225)](_0x2a7992,0x1);if(_0x36b6dc[_0xf77a34(0x1fc)]>=_0x36b6dc[_0xf77a34(0x21a)][_0xf77a34(0x250)])_0x36b6dc[_0xf77a34(0x1fc)]=_0x36b6dc[_0xf77a34(0x21a)][_0xf77a34(0x250)]-0x1;updateLayerUI(),redrawAll();if(typeof requestAutoSave==='function')requestAutoSave();}function addLayer(){const _0x5bb1f6=_0x529c;let _0x1c2b19=getCurrentProject(),_0x389fe0=getCurrentFrame(),_0x357529=document[_0x5bb1f6(0x1e9)](_0x5bb1f6(0x203));_0x357529[_0x5bb1f6(0x24b)]=_0x1c2b19[_0x5bb1f6(0x24b)]*cellSize,_0x357529[_0x5bb1f6(0x1df)]=_0x1c2b19[_0x5bb1f6(0x1df)]*cellSize,_0x389fe0[_0x5bb1f6(0x21a)][_0x5bb1f6(0x232)]({'canvas':_0x357529,'visible':!![]}),_0x389fe0['layerHistories'][_0x5bb1f6(0x232)]([]),_0x389fe0[_0x5bb1f6(0x238)][_0x5bb1f6(0x232)]([]),_0x389fe0['activeLayer']=_0x389fe0[_0x5bb1f6(0x21a)][_0x5bb1f6(0x250)]-0x1,saveHistory(),updateLayerUI(),redrawAll();}function removeLayer(){const _0x10c543=_0x529c;let _0x35d3de=getCurrentFrame();if(_0x35d3de[_0x10c543(0x21a)]['length']<=0x1)return;_0x35d3de[_0x10c543(0x21a)][_0x10c543(0x225)](_0x35d3de[_0x10c543(0x1fc)],0x1),_0x35d3de[_0x10c543(0x25c)][_0x10c543(0x225)](_0x35d3de[_0x10c543(0x1fc)],0x1),_0x35d3de[_0x10c543(0x238)][_0x10c543(0x225)](_0x35d3de[_0x10c543(0x1fc)],0x1),_0x35d3de['activeLayer']=Math['max'](0x0,_0x35d3de[_0x10c543(0x1fc)]-0x1),updateLayerUI(),redrawAll();if(typeof requestAutoSave===_0x10c543(0x236))requestAutoSave();}function duplicateLayerAt(_0x1f7d83){const _0xbf1101=_0x529c,_0x40c70=getCurrentProject(),_0x55c5df=getCurrentFrame();if(!_0x40c70||!_0x55c5df||typeof _0x1f7d83!=='number'||!_0x55c5df['layers'][_0x1f7d83])return;const _0xe3c6f3=_0x55c5df[_0xbf1101(0x21a)][_0x1f7d83],_0x11a1bb=_0xe3c6f3&&_0xe3c6f3['canvas']?_0xe3c6f3['canvas']:_0xe3c6f3;if(!_0x11a1bb)return;const _0x203eeb=document[_0xbf1101(0x1e9)](_0xbf1101(0x203));_0x203eeb['width']=_0x40c70[_0xbf1101(0x24b)]*cellSize,_0x203eeb[_0xbf1101(0x1df)]=_0x40c70[_0xbf1101(0x1df)]*cellSize;const _0x3b2b56=_0x203eeb[_0xbf1101(0x213)]('2d');_0x3b2b56[_0xbf1101(0x25d)](0x0,0x0,_0x203eeb[_0xbf1101(0x24b)],_0x203eeb[_0xbf1101(0x1df)]);try{_0x3b2b56[_0xbf1101(0x227)](_0x11a1bb,0x0,0x0);}catch(_0x59d464){console[_0xbf1101(0x1fb)]('duplicateLayerAt\x20draw\x20error',_0x59d464);}const _0x37328f=_0x1f7d83+0x1;_0x55c5df[_0xbf1101(0x21a)][_0xbf1101(0x225)](_0x37328f,0x0,{'canvas':_0x203eeb,'visible':!![]});if(Array[_0xbf1101(0x201)](_0x55c5df[_0xbf1101(0x25c)]))_0x55c5df[_0xbf1101(0x25c)]['splice'](_0x37328f,0x0,[]);if(Array[_0xbf1101(0x201)](_0x55c5df['layerRedoStacks']))_0x55c5df[_0xbf1101(0x238)][_0xbf1101(0x225)](_0x37328f,0x0,[]);_0x55c5df[_0xbf1101(0x1fc)]=_0x37328f,saveHistory(),updateLayerUI(),redrawAll();if(typeof requestAutoSave===_0xbf1101(0x236))requestAutoSave();}function selectLayer(_0xc44830){const _0x468e66=_0x529c;getCurrentFrame()[_0x468e66(0x1fc)]=parseInt(_0xc44830),updateLayerUI();}function copyLayer(){const _0x7d8636=_0x529c,_0x5ef328=getCurrentFrame();if(!_0x5ef328)return;const _0x4928e1=_0x5ef328[_0x7d8636(0x1fc)];if(typeof _0x4928e1!=='number'||!_0x5ef328[_0x7d8636(0x21a)][_0x4928e1])return;const _0x117897=_0x5ef328[_0x7d8636(0x21a)][_0x4928e1],_0x2e8a86=_0x117897&&_0x117897[_0x7d8636(0x203)]?_0x117897[_0x7d8636(0x203)]:_0x117897;if(!_0x2e8a86||typeof _0x2e8a86[_0x7d8636(0x20f)]!==_0x7d8636(0x236))return;copiedLayerDataUrl=_0x2e8a86[_0x7d8636(0x20f)]();const _0x5f3493=document[_0x7d8636(0x242)](_0x7d8636(0x23d));if(_0x5f3493)_0x5f3493[_0x7d8636(0x243)]=![];}function pasteLayer(){const _0x3600cd=_0x529c;if(!copiedLayerDataUrl)return;const _0x7a89d4=getCurrentProject(),_0xce3ff0=getCurrentFrame();if(!_0x7a89d4||!_0xce3ff0)return;const _0x3bd4ef=document[_0x3600cd(0x1e9)]('canvas');_0x3bd4ef[_0x3600cd(0x24b)]=_0x7a89d4[_0x3600cd(0x24b)]*cellSize,_0x3bd4ef[_0x3600cd(0x1df)]=_0x7a89d4[_0x3600cd(0x1df)]*cellSize;const _0xd20e56=_0x3bd4ef[_0x3600cd(0x213)]('2d'),_0x59ce6c=new Image();_0x59ce6c[_0x3600cd(0x1f0)]=()=>{const _0x523000=_0x3600cd;_0xd20e56['clearRect'](0x0,0x0,_0x3bd4ef['width'],_0x3bd4ef['height']),_0xd20e56['drawImage'](_0x59ce6c,0x0,0x0),_0xce3ff0[_0x523000(0x21a)][_0x523000(0x232)]({'canvas':_0x3bd4ef,'visible':!![]}),_0xce3ff0[_0x523000(0x25c)][_0x523000(0x232)]([]),_0xce3ff0[_0x523000(0x238)][_0x523000(0x232)]([]),_0xce3ff0[_0x523000(0x1fc)]=_0xce3ff0[_0x523000(0x21a)][_0x523000(0x250)]-0x1,saveHistory(),updateLayerUI(),redrawAll();},_0x59ce6c['src']=copiedLayerDataUrl;}async function exportLayersAsGif(){const _0x3e66af=_0x529c,_0x4db3fb=document['getElementById'](_0x3e66af(0x1d2));if(_0x4db3fb)_0x4db3fb[_0x3e66af(0x1fd)]='処理中...';const _0x476f8f=getCurrentProject();if(!_0x476f8f){if(_0x4db3fb)_0x4db3fb['textContent']='';return;}const _0x26250e=_0x476f8f[_0x3e66af(0x214)],_0x282ec9=_0x476f8f[_0x3e66af(0x24b)]*cellSize,_0x2f136c=_0x476f8f[_0x3e66af(0x1df)]*cellSize;let _0x5f3a75=0x0;_0x26250e[_0x3e66af(0x256)](_0x4efb0a=>{const _0x141931=_0x3e66af;_0x5f3a75=Math[_0x141931(0x202)](_0x5f3a75,_0x4efb0a['layers'][_0x141931(0x250)]);});for(let _0x5cc5d7=0x0;_0x5cc5d7<_0x5f3a75;_0x5cc5d7++){const _0x81c808=await Promise[_0x3e66af(0x24a)](_0x26250e[_0x3e66af(0x241)](_0x51a9c0=>{return new Promise(_0x275977=>{const _0x344cc0=_0x529c,_0x11ef33=document[_0x344cc0(0x1e9)](_0x344cc0(0x203));_0x11ef33[_0x344cc0(0x24b)]=_0x282ec9,_0x11ef33['height']=_0x2f136c;const _0x3712ac=_0x11ef33[_0x344cc0(0x213)]('2d'),_0x54188a=_0x51a9c0[_0x344cc0(0x21a)][_0x5cc5d7]&&_0x51a9c0['layers'][_0x5cc5d7]['canvas']?_0x51a9c0[_0x344cc0(0x21a)][_0x5cc5d7][_0x344cc0(0x203)]:_0x51a9c0[_0x344cc0(0x21a)][_0x5cc5d7];if(_0x54188a)_0x3712ac[_0x344cc0(0x227)](_0x54188a,0x0,0x0);const _0x5a14b2=new Image();_0x5a14b2['onload']=()=>_0x275977(_0x5a14b2),_0x5a14b2[_0x344cc0(0x240)]=_0x11ef33['toDataURL']('image/png');});})),_0x7e9950=_0x81c808['some'](_0x4d380a=>{const _0x5d8ee2=_0x3e66af,_0x118ad9=document[_0x5d8ee2(0x1e9)](_0x5d8ee2(0x203));_0x118ad9[_0x5d8ee2(0x24b)]=_0x282ec9,_0x118ad9['height']=_0x2f136c;const _0x17d5d0=_0x118ad9[_0x5d8ee2(0x213)]('2d');_0x17d5d0[_0x5d8ee2(0x227)](_0x4d380a,0x0,0x0);const _0x532e5d=_0x17d5d0['getImageData'](0x0,0x0,_0x282ec9,_0x2f136c)[_0x5d8ee2(0x244)];for(let _0x3f6bf5=0x3;_0x3f6bf5<_0x532e5d[_0x5d8ee2(0x250)];_0x3f6bf5+=0x4)if(_0x532e5d[_0x3f6bf5]!==0x0)return!![];return![];});if(!_0x7e9950)continue;const _0x1b78e7=(_0x476f8f['name']||_0x3e66af(0x252))[_0x3e66af(0x23a)](/[\\/:*?"<>|]/g,'_')+(_0x3e66af(0x226)+(_0x5cc5d7+0x1)+_0x3e66af(0x1ed));convertToGIF(_0x81c808,animationDelay,_0x1b78e7),await new Promise(_0x2b73a4=>setTimeout(_0x2b73a4,0x78));}if(_0x4db3fb)_0x4db3fb['textContent']='';}async function exportLayersAsApng(){const _0x38a005=_0x529c,_0x260b5a=document[_0x38a005(0x242)](_0x38a005(0x1d2));if(_0x260b5a)_0x260b5a[_0x38a005(0x1fd)]=_0x38a005(0x221);const _0x2083b5=getCurrentProject();if(!_0x2083b5){if(_0x260b5a)_0x260b5a[_0x38a005(0x1fd)]='';return;}const _0x240a99=_0x2083b5['frames'],_0x3d5ae7=_0x2083b5['width']*cellSize,_0x16e9b1=_0x2083b5[_0x38a005(0x1df)]*cellSize;let _0x20ba39=0x0;_0x240a99[_0x38a005(0x256)](_0x46a899=>{const _0x26c5ff=_0x38a005;_0x20ba39=Math[_0x26c5ff(0x202)](_0x20ba39,_0x46a899['layers'][_0x26c5ff(0x250)]);});for(let _0x31e8f2=0x0;_0x31e8f2<_0x20ba39;_0x31e8f2++){const _0x7115e9=await Promise[_0x38a005(0x24a)](_0x240a99['map'](_0x1f03dc=>{return new Promise(_0x3fc842=>{const _0x4a291d=_0x529c,_0x521bc4=document[_0x4a291d(0x1e9)](_0x4a291d(0x203));_0x521bc4[_0x4a291d(0x24b)]=_0x3d5ae7,_0x521bc4[_0x4a291d(0x1df)]=_0x16e9b1;const _0x3ce853=_0x521bc4[_0x4a291d(0x213)]('2d'),_0x1008a0=_0x1f03dc[_0x4a291d(0x21a)][_0x31e8f2]&&_0x1f03dc[_0x4a291d(0x21a)][_0x31e8f2]['canvas']?_0x1f03dc[_0x4a291d(0x21a)][_0x31e8f2][_0x4a291d(0x203)]:_0x1f03dc[_0x4a291d(0x21a)][_0x31e8f2];if(_0x1008a0)_0x3ce853[_0x4a291d(0x227)](_0x1008a0,0x0,0x0);const _0x31ee95=new Image();_0x31ee95[_0x4a291d(0x1f0)]=()=>_0x3fc842(_0x31ee95),_0x31ee95[_0x4a291d(0x240)]=_0x521bc4[_0x4a291d(0x20f)](_0x4a291d(0x1e3));});})),_0xbac181=_0x7115e9[_0x38a005(0x1d8)](_0xaff592=>{const _0x49fc56=_0x38a005,_0x49c9b6=document['createElement']('canvas');_0x49c9b6[_0x49fc56(0x24b)]=_0x3d5ae7,_0x49c9b6['height']=_0x16e9b1;const _0x39083f=_0x49c9b6[_0x49fc56(0x213)]('2d');_0x39083f[_0x49fc56(0x227)](_0xaff592,0x0,0x0);const _0x1fd4e8=_0x39083f[_0x49fc56(0x22d)](0x0,0x0,_0x3d5ae7,_0x16e9b1)[_0x49fc56(0x244)];for(let _0x33a6ba=0x3;_0x33a6ba<_0x1fd4e8['length'];_0x33a6ba+=0x4)if(_0x1fd4e8[_0x33a6ba]!==0x0)return!![];return![];});if(!_0xbac181)continue;const _0x511f44=(_0x2083b5[_0x38a005(0x1d4)]||_0x38a005(0x252))['replace'](/[\\/:*?"<>|]/g,'_')+(_0x38a005(0x226)+(_0x31e8f2+0x1)+_0x38a005(0x206));convertToAPNG(_0x7115e9,_0x3d5ae7,_0x16e9b1,animationDelay,_0x511f44),await new Promise(_0x4c793b=>setTimeout(_0x4c793b,0x78));}if(_0x260b5a)_0x260b5a[_0x38a005(0x1fd)]='';}async function exportFramesLayersZip(){const _0x4a5940=_0x529c,_0x5c23b6=document[_0x4a5940(0x242)](_0x4a5940(0x1d2));if(_0x5c23b6)_0x5c23b6['textContent']='ZIP作成中...';const _0x4893f1=getCurrentProject();if(!_0x4893f1){if(_0x5c23b6)_0x5c23b6[_0x4a5940(0x1fd)]='';return;}const _0x4045cc=_0x4893f1['frames'],_0x4925f0=_0x4893f1[_0x4a5940(0x24b)]*cellSize,_0x1c3766=_0x4893f1[_0x4a5940(0x1df)]*cellSize,_0x44b9ff=new JSZip();for(let _0x267ee2=0x0;_0x267ee2<_0x4045cc[_0x4a5940(0x250)];_0x267ee2++){const _0x15f6bb=_0x4045cc[_0x267ee2],_0x2b3813=_0x44b9ff[_0x4a5940(0x1ec)](_0x4a5940(0x1fe)+(_0x267ee2+0x1));for(let _0x25eaff=0x0;_0x25eaff<_0x15f6bb[_0x4a5940(0x21a)]['length'];_0x25eaff++){const _0x57b218=document[_0x4a5940(0x1e9)](_0x4a5940(0x203));_0x57b218[_0x4a5940(0x24b)]=_0x4925f0,_0x57b218[_0x4a5940(0x1df)]=_0x1c3766;const _0x42b55e=_0x57b218[_0x4a5940(0x213)]('2d');_0x42b55e[_0x4a5940(0x25d)](0x0,0x0,_0x4925f0,_0x1c3766);const _0x12b2e9=_0x15f6bb[_0x4a5940(0x21a)][_0x25eaff];if(_0x12b2e9){const _0x6fdd11=_0x12b2e9[_0x4a5940(0x203)]?_0x12b2e9['canvas']:_0x12b2e9;if(_0x6fdd11)_0x42b55e['drawImage'](_0x6fdd11,0x0,0x0);}const _0x59dd12=_0x57b218[_0x4a5940(0x20f)](_0x4a5940(0x1e3)),_0x5952ee=_0x59dd12[_0x4a5940(0x22c)](',')[0x1],_0x35a30c=atob(_0x5952ee),_0x297e58=new Uint8Array(_0x35a30c[_0x4a5940(0x250)]);for(let _0x2637c5=0x0;_0x2637c5<_0x35a30c[_0x4a5940(0x250)];_0x2637c5++)_0x297e58[_0x2637c5]=_0x35a30c[_0x4a5940(0x1db)](_0x2637c5);_0x2b3813[_0x4a5940(0x245)](_0x4a5940(0x1dc)+(_0x25eaff+0x1)+_0x4a5940(0x1f4),_0x297e58);}}const _0x4a1c6b=await _0x44b9ff[_0x4a5940(0x237)]({'type':_0x4a5940(0x20e)}),_0x2b8019=(_0x4893f1['name']||_0x4a5940(0x258))[_0x4a5940(0x23a)](/[\\/:*?"<>|]/g,'_'),_0x597076=document[_0x4a5940(0x1e9)]('a');_0x597076[_0x4a5940(0x260)]=URL['createObjectURL'](_0x4a1c6b),_0x597076['download']=_0x2b8019+_0x4a5940(0x21c),document[_0x4a5940(0x1d7)][_0x4a5940(0x219)](_0x597076),_0x597076[_0x4a5940(0x20a)](),setTimeout(()=>{const _0x4450c6=_0x4a5940;URL[_0x4450c6(0x234)](_0x597076[_0x4450c6(0x260)]),document['body'][_0x4450c6(0x1f6)](_0x597076);if(_0x5c23b6)_0x5c23b6[_0x4450c6(0x1fd)]='';},0x4b0);}function saveProjectFile(){const _0xd6a353=_0x529c,_0x2af6aa=typeof getSavePayload==='function'?getSavePayload():{'projects':projects[_0xd6a353(0x241)](_0x57ecf6=>({'width':_0x57ecf6[_0xd6a353(0x24b)],'height':_0x57ecf6[_0xd6a353(0x1df)],'name':_0x57ecf6[_0xd6a353(0x1d4)]||'','activeFrame':_0x57ecf6[_0xd6a353(0x22a)],'frames':_0x57ecf6[_0xd6a353(0x214)][_0xd6a353(0x241)](_0x443eee=>({'activeLayer':_0x443eee[_0xd6a353(0x1fc)],'layers':_0x443eee[_0xd6a353(0x21a)][_0xd6a353(0x241)](_0x56da25=>_0x56da25&&_0x56da25[_0xd6a353(0x203)]?_0x56da25[_0xd6a353(0x203)][_0xd6a353(0x20f)]():_0x56da25&&_0x56da25[_0xd6a353(0x20f)]?_0x56da25[_0xd6a353(0x20f)]():null)}))})),'activeProject':activeProject},_0x216eed=new Blob([JSON[_0xd6a353(0x210)](_0x2af6aa)],{'type':'application/json'}),_0x17245c=document[_0xd6a353(0x1e9)]('a');_0x17245c[_0xd6a353(0x22e)]=_0xd6a353(0x1ef),_0x17245c[_0xd6a353(0x260)]=URL[_0xd6a353(0x233)](_0x216eed),_0x17245c[_0xd6a353(0x20a)]();}function getSavePayload(){const _0x12e58b=_0x529c;return{'projects':projects[_0x12e58b(0x241)](_0x2a5931=>({'width':_0x2a5931['width'],'height':_0x2a5931['height'],'name':_0x2a5931[_0x12e58b(0x1d4)]||'','activeFrame':_0x2a5931[_0x12e58b(0x22a)],'frames':_0x2a5931[_0x12e58b(0x214)][_0x12e58b(0x241)](_0xb21ee2=>({'activeLayer':_0xb21ee2['activeLayer'],'layers':_0xb21ee2['layers'][_0x12e58b(0x241)](_0x446d0f=>_0x446d0f&&_0x446d0f[_0x12e58b(0x203)]?_0x446d0f[_0x12e58b(0x203)][_0x12e58b(0x20f)]():_0x446d0f&&_0x446d0f[_0x12e58b(0x20f)]?_0x446d0f[_0x12e58b(0x20f)]():null)}))})),'activeProject':activeProject};}async function saveProjectToIDB(){const _0x4cdc31=_0x529c,_0x16b61f=getSavePayload();try{await idbSet(_0x4cdc31(0x25f),_0x16b61f),console['log']('プロジェクトをIndexedDBに保存したチュー！');}catch(_0x17cba4){console['error'](_0x4cdc31(0x25e),_0x17cba4);}}function flushQuickSaveToLocalStorage(){const _0x4d809a=_0x529c;try{const _0x18d634=getSavePayload();localStorage[_0x4d809a(0x23c)](_0x4d809a(0x208),JSON[_0x4d809a(0x210)](_0x18d634)),console[_0x4d809a(0x207)](_0x4d809a(0x1d6));}catch(_0x3c9672){console[_0x4d809a(0x24e)](_0x4d809a(0x1dd),_0x3c9672);}}function _0x3083(){const _0xd115f3=['createObjectURL','revokeObjectURL','value','function','generateAsync','layerRedoStacks','constructor','replace','32622469YzYZMH','setItem','pasteLayerBtn','className','Enter','src','map','getElementById','disabled','data','file','746qkWFSa','text','log','4DItmDl','all','width','auto-save:\x20saved','toString','error','6115165yHFRZG','length','replaceWith','nezumi-animation','parse','IndexedDBからプロジェクトを読み込んだチュー！','undefined','forEach','startAutoSaveInterval','nezumi-export','onblur','IndexedDBからの読み込みに失敗したチュー…','addEventListener','layerHistories','clearRect','保存に失敗したチュー:','nezumi-sketch-save','href','project-name-edit','select','layerExportStatus','10XPZScT','name','onerror','flushQuickSaveToLocalStorage:\x20saved\x20quick\x20snapshot','body','some','auto-save\x20failed','apply','charCodeAt','layer-','flushQuickSaveToLocalStorage\x20failed','(((.+)+)+)+$','height','activeProject','startAutoSaveInterval:\x20starting\x20interval\x20','auto-save\x20(interval)\x20failed','image/png','ファイルを読み込み中...','info','loadProjectFromIDB:\x20DB\x20に保存が見つかりませんでした。localStorage\x20のクイック保存を確認します。','projects','startCell','createElement','」を削除しますか？','floor','folder','.gif','active','nezumi-sketch.msketch','onload','2594346VAWStU','loadProjectFromIDB:\x20localStorage\x20quick\x20load\x20failed','onkeydown','.png','isFinite','removeChild','input','1657960FBXntE','beforeunload','35mVYIuX','warn','activeLayer','textContent','frame-','requestAutoSave:\x20scheduling\x20save\x20in\x20','複製できないレイヤーがありますチュー','isArray','max','canvas','674262WVERJz','942Pnbaqo','.apng','debug','nezumi-sketch-save-quick','type','click','startsWith','80px','readAsText','blob','toDataURL','stringify','visible','trim','getContext','frames','style','auto-save\x20(interval):\x20saved','blur','catch','appendChild','layers','ファイルにプロジェクトメタデータが見つかりませんでした。読み込みできません。','-frames-layers.zip','number','ファイルの読み込みに失敗しました。','focus','11878164ZoUqqd','処理中...','スタンドアロン形式のプロジェクトを読み込みました:\x20','cloneLayer\x20draw\x20error','nudgeActiveLayer:\x20対象レイヤーのキャンバスが見つかりません','splice','-layer','drawImage','target','visibilitychange','activeFrame','offsetCells','split','getImageData','download','getItem','search','hidden','push'];_0x3083=function(){return _0xd115f3;};return _0x3083();}window[_0x174762(0x25b)](_0x174762(0x229),()=>{const _0x53d335=_0x174762;if(document[_0x53d335(0x231)]&&autosaveDirty){flushQuickSaveToLocalStorage();if(typeof saveProjectToIDB==='function')saveProjectToIDB();}}),window['addEventListener'](_0x174762(0x1f9),()=>{if(autosaveDirty){flushQuickSaveToLocalStorage();if(typeof saveProjectToIDB==='function')saveProjectToIDB();}});let autosaveDirty=![],autosaveTimer=null;const AUTOSAVE_DELAY=0x1388,AUTOSAVE_INTERVAL=0xea60;function requestAutoSave(){const _0x57c986=_0x174762;autosaveDirty=!![];if(autosaveTimer)clearTimeout(autosaveTimer);console[_0x57c986(0x207)](_0x57c986(0x1ff)+AUTOSAVE_DELAY+'ms'),autosaveTimer=setTimeout(async()=>{const _0xdf08e8=_0x57c986;console[_0xdf08e8(0x207)]('requestAutoSave:\x20timer\x20fired');if(!autosaveDirty)return;try{await saveProjectToIDB(),autosaveDirty=![],console[_0xdf08e8(0x248)](_0xdf08e8(0x24c));}catch(_0x261c6c){console[_0xdf08e8(0x24e)](_0xdf08e8(0x1d9),_0x261c6c);}},AUTOSAVE_DELAY);}function startAutoSaveInterval(){const _0x2fb487=_0x174762;console[_0x2fb487(0x207)](_0x2fb487(0x1e1)+AUTOSAVE_INTERVAL+'ms'),setInterval(async()=>{const _0x54f9d7=_0x2fb487;if(!autosaveDirty)return;try{await saveProjectToIDB(),autosaveDirty=![],console[_0x54f9d7(0x248)](_0x54f9d7(0x216));}catch(_0x4d17f8){console[_0x54f9d7(0x24e)](_0x54f9d7(0x1e2),_0x4d17f8);}},AUTOSAVE_INTERVAL);}window['requestAutoSave']=requestAutoSave,window[_0x174762(0x257)]=startAutoSaveInterval;function _0x529c(_0x4d2e74,_0x379ce2){_0x4d2e74=_0x4d2e74-0x1d0;const _0x2338cb=_0x3083();let _0x399457=_0x2338cb[_0x4d2e74];return _0x399457;}function loadProjectFile(_0x233513){const _0x298258=_0x174762,_0x5b7d00=_0x233513['target']['files'][0x0];if(!_0x5b7d00)return;if(_0x5b7d00[_0x298258(0x209)]&&_0x5b7d00[_0x298258(0x209)][_0x298258(0x20b)]('image')){loadStandaloneFromFile(_0x5b7d00)['then'](_0x316286=>{const _0x193f16=_0x298258;alert(_0x193f16(0x222)+(_0x316286[_0x193f16(0x1d4)]||'画像'));})[_0x298258(0x218)](_0x5d0b75=>{const _0x25e049=_0x298258;console[_0x25e049(0x1fb)](_0x5d0b75),alert(_0x25e049(0x21b));});return;}const _0x2eba6b=new FileReader();try{showLoading(_0x298258(0x1e4));}catch(_0x2a3282){}_0x2eba6b[_0x298258(0x1f0)]=function(_0x58ce22){const _0x1f0e3b=_0x298258;try{const _0x79b3d5=JSON['parse'](_0x58ce22[_0x1f0e3b(0x228)]['result']);projects=_0x79b3d5['projects'][_0x1f0e3b(0x241)]((_0x1023be,_0x58b774)=>{const _0x424eb6=_0x1f0e3b;let _0x455f37=createProject(_0x1023be[_0x424eb6(0x24b)],_0x1023be[_0x424eb6(0x1df)],_0x1023be[_0x424eb6(0x1d4)]||'画像'+(_0x58b774+0x1));return _0x455f37[_0x424eb6(0x214)]=_0x1023be['frames'][_0x424eb6(0x241)](_0x598441=>{const _0x2b4e6e=_0x424eb6;let _0x1c753f={'layers':[],'activeLayer':_0x598441[_0x2b4e6e(0x1fc)],'layerHistories':[],'layerRedoStacks':[]};for(let _0x41eb9d=0x0;_0x41eb9d<_0x598441[_0x2b4e6e(0x21a)]['length'];_0x41eb9d++){let _0x1a49a5=new Image();_0x1a49a5[_0x2b4e6e(0x240)]=_0x598441[_0x2b4e6e(0x21a)][_0x41eb9d];let _0x18557d=document[_0x2b4e6e(0x1e9)](_0x2b4e6e(0x203));_0x18557d['width']=_0x1023be[_0x2b4e6e(0x24b)]*cellSize,_0x18557d[_0x2b4e6e(0x1df)]=_0x1023be[_0x2b4e6e(0x1df)]*cellSize,_0x1a49a5['onload']=()=>{const _0x5e0bd4=_0x2b4e6e;let _0x2ef750=_0x18557d[_0x5e0bd4(0x213)]('2d');_0x2ef750['clearRect'](0x0,0x0,_0x18557d['width'],_0x18557d[_0x5e0bd4(0x1df)]),_0x2ef750[_0x5e0bd4(0x227)](_0x1a49a5,0x0,0x0);try{redrawAll();}catch(_0x34f6ea){}},_0x1c753f['layers'][_0x2b4e6e(0x232)](_0x18557d),_0x1c753f[_0x2b4e6e(0x25c)][_0x2b4e6e(0x232)]([]),_0x1c753f['layerRedoStacks'][_0x2b4e6e(0x232)]([]);}return _0x1c753f;}),_0x455f37[_0x424eb6(0x22a)]=_0x1023be[_0x424eb6(0x22a)],_0x455f37[_0x424eb6(0x1d4)]=_0x1023be[_0x424eb6(0x1d4)]||'画像'+(_0x58b774+0x1),_0x455f37;}),activeProject=_0x79b3d5[_0x1f0e3b(0x1e0)]||0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();}catch(_0x5aba8d){alert(_0x1f0e3b(0x21e));}finally{try{hideLoading();}catch(_0x46064c){}}},_0x2eba6b[_0x298258(0x1d5)]=function(){try{hideLoading();}catch(_0x437577){}},_0x2eba6b[_0x298258(0x20d)](_0x5b7d00);}async function loadProjectFromIDB(){const _0x22535e=_0x174762;try{let _0x2eaa2b=await idbGet(_0x22535e(0x25f));if(!_0x2eaa2b){console[_0x22535e(0x1e5)](_0x22535e(0x1e6));try{const _0xbe9b16=localStorage[_0x22535e(0x22f)](_0x22535e(0x208));if(_0xbe9b16){const _0x203678=JSON[_0x22535e(0x253)](_0xbe9b16);_0x203678&&_0x203678[_0x22535e(0x1e7)]&&(console['info']('loadProjectFromIDB:\x20localStorage\x20のクイック保存を復元します'),_0x2eaa2b=_0x203678);}}catch(_0x484797){console[_0x22535e(0x1fb)](_0x22535e(0x1f2),_0x484797);}if(!_0x2eaa2b){if(typeof requestAutoSave===_0x22535e(0x236))requestAutoSave();return;}}console['log']('loadProjectFromIDB:\x20データ確認',{'projects':Array[_0x22535e(0x201)](_0x2eaa2b[_0x22535e(0x1e7)])?_0x2eaa2b[_0x22535e(0x1e7)]['length']:0x0,'activeProject':_0x2eaa2b['activeProject']}),projects=_0x2eaa2b['projects'][_0x22535e(0x241)]((_0x5c8cc0,_0x481d2e)=>{const _0x255fc0=_0x22535e;let _0x1c66d9=createProject(_0x5c8cc0[_0x255fc0(0x24b)],_0x5c8cc0[_0x255fc0(0x1df)],_0x5c8cc0['name']||'画像'+(_0x481d2e+0x1));return _0x1c66d9['frames']=_0x5c8cc0[_0x255fc0(0x214)]['map'](_0x2b8d13=>{const _0x300e81=_0x255fc0;let _0x279445={'layers':[],'activeLayer':_0x2b8d13[_0x300e81(0x1fc)],'layerHistories':[],'layerRedoStacks':[]};for(let _0x495ea8=0x0;_0x495ea8<_0x2b8d13[_0x300e81(0x21a)][_0x300e81(0x250)];_0x495ea8++){let _0x459644=new Image();_0x459644['src']=_0x2b8d13['layers'][_0x495ea8];let _0x389614=document[_0x300e81(0x1e9)](_0x300e81(0x203));_0x389614['width']=_0x5c8cc0[_0x300e81(0x24b)]*cellSize,_0x389614[_0x300e81(0x1df)]=_0x5c8cc0['height']*cellSize,_0x459644['onload']=()=>{const _0x32e85b=_0x300e81;let _0x3675b1=_0x389614[_0x32e85b(0x213)]('2d');_0x3675b1[_0x32e85b(0x25d)](0x0,0x0,_0x389614[_0x32e85b(0x24b)],_0x389614[_0x32e85b(0x1df)]),_0x3675b1[_0x32e85b(0x227)](_0x459644,0x0,0x0);try{redrawAll();}catch(_0xafc624){}},_0x279445[_0x300e81(0x21a)][_0x300e81(0x232)]({'canvas':_0x389614,'visible':!![]}),_0x279445['layerHistories'][_0x300e81(0x232)]([]),_0x279445[_0x300e81(0x238)][_0x300e81(0x232)]([]);}return _0x279445;}),_0x1c66d9['activeFrame']=_0x5c8cc0[_0x255fc0(0x22a)],_0x1c66d9[_0x255fc0(0x1d4)]=_0x5c8cc0[_0x255fc0(0x1d4)]||'画像'+(_0x481d2e+0x1),_0x1c66d9;}),activeProject=_0x2eaa2b[_0x22535e(0x1e0)]||0x0,await wait(0x64),updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();try{if(typeof updateUndoRedoButtons==='function')updateUndoRedoButtons();}catch(_0x1e681c){}setTool('pen'),console[_0x22535e(0x248)](_0x22535e(0x254));}catch(_0x2266d3){alert(_0x22535e(0x25a)),console[_0x22535e(0x24e)](_0x2266d3);}}function shiftLayerCanvas(_0x16ff93,_0x11d233,_0x142a8d){const _0xe324ad=_0x174762;if(!_0x16ff93)return;const _0x92a57a=_0x16ff93[_0xe324ad(0x24b)],_0x49a97a=_0x16ff93[_0xe324ad(0x1df)],_0x5f2de4=document[_0xe324ad(0x1e9)](_0xe324ad(0x203));_0x5f2de4[_0xe324ad(0x24b)]=_0x92a57a,_0x5f2de4[_0xe324ad(0x1df)]=_0x49a97a;const _0x2f0a1c=_0x5f2de4[_0xe324ad(0x213)]('2d');_0x2f0a1c['clearRect'](0x0,0x0,_0x92a57a,_0x49a97a),_0x2f0a1c[_0xe324ad(0x227)](_0x16ff93,0x0,0x0);const _0x22c36=_0x16ff93[_0xe324ad(0x213)]('2d');_0x22c36[_0xe324ad(0x25d)](0x0,0x0,_0x92a57a,_0x49a97a),_0x22c36[_0xe324ad(0x227)](_0x5f2de4,_0x11d233,_0x142a8d);}function nudgeActiveLayer(_0x40c49c,_0x5f21c9){const _0x33334f=_0x174762,_0x173d72=getCurrentProject();if(!_0x173d72)return;const _0xffb282=getCurrentFrame();if(!_0xffb282)return;const _0x31f566=_0xffb282[_0x33334f(0x1fc)];if(_0x31f566==null)return;const _0x4469da=(_0x40c49c||0x0)*cellSize,_0x3bcba4=(_0x5f21c9||0x0)*cellSize;if(_0x4469da===0x0&&_0x3bcba4===0x0)return;saveHistory();const _0x2e3edd=_0xffb282[_0x33334f(0x21a)][_0x31f566],_0x526cce=_0x2e3edd&&_0x2e3edd[_0x33334f(0x203)]?_0x2e3edd[_0x33334f(0x203)]:_0x2e3edd;_0x526cce?(shiftLayerCanvas(_0x526cce,_0x4469da,_0x3bcba4),redrawAll()):console[_0x33334f(0x1fb)](_0x33334f(0x224),_0x2e3edd);}function startLayerMove(_0x96fd6d){const _0x4438e9=_0x174762;layerMoveState[_0x4438e9(0x1ee)]=!![];const _0x5daf2f=getCanvasCoords(_0x96fd6d);layerMoveState[_0x4438e9(0x1e8)]={'x':Math['floor'](_0x5daf2f['x']/cellSize),'y':Math[_0x4438e9(0x1eb)](_0x5daf2f['y']/cellSize)},layerMoveState['offsetCells']={'x':0x0,'y':0x0};}function endLayerMove(_0x4422f5){const _0x1aab5b=_0x174762;if(!layerMoveState[_0x1aab5b(0x1ee)])return;const _0x148267=layerMoveState[_0x1aab5b(0x22b)]['x']*cellSize,_0x3aba47=layerMoveState[_0x1aab5b(0x22b)]['y']*cellSize;if(_0x148267!==0x0||_0x3aba47!==0x0){saveHistory();const _0x163244=getCurrentFrame();if(_0x163244&&typeof _0x163244[_0x1aab5b(0x1fc)]===_0x1aab5b(0x21d)){const _0x184bd8=_0x163244[_0x1aab5b(0x21a)][_0x163244[_0x1aab5b(0x1fc)]],_0x29d7e2=_0x184bd8&&_0x184bd8['canvas']?_0x184bd8['canvas']:_0x184bd8;if(_0x29d7e2)shiftLayerCanvas(_0x29d7e2,_0x148267,_0x3aba47);}}layerMoveState['active']=![],layerMoveState[_0x1aab5b(0x1e8)]=null,layerMoveState['offsetCells']={'x':0x0,'y':0x0},redrawAll();}