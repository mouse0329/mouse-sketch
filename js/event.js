function _0x554e(){const _0x59c1ec=['#000000','bottom','clientY','onmouseleave','onmousemove','58668hzuoQy','onclick','toggle','map','warn','getItem','grabbing','min','hypot','input','nudgeRightBtn','2496970HyukWe','自動復元中...','apply','search','getBoundingClientRect','penSize','toUpperCase','Shift','round','preventDefault','canvas-container','querySelector','nudgeLeftBtn','clientX','select','footer','textarea','toString','parentElement','width','value','0\x202px\x2010px\x20rgba(0,0,0,0.15)','copyLayer\x20error','copyLayerBtn','number','color\x20picker\x20onChange\x20error','remove','floor','then','canvas\x20要素が見つからないチュー','24SXswxI','nudgeDownBtn','showAboutDialog','right-toolbar','MAC','none','6qluiCu','toolbar-mobile','indexOf','light','1782085wiWTdv','redo\x20shortcut\x20error','isContentEditable','appendChild','50344vGAvBP','div','position','startAutoSaveInterval','center','alignItems','2464ovleKv','isFinite','(((.+)+)+)+$','auto','transparent','pasteLayer\x20error','touchend','abs','parentNode','nudgeStep','background','openColorPickerBtn','8px','resize','default','ontouchcancel','zoomSlider','right-panel','pan','touches','onload','classList','rgba(0,0,0,0.35)','max','padStart','left','activeElement','key','data','onchange','penMode','setAttribute','function','posY','keydown','error','312saqvVC','length','fixed','createElement','zIndex','61660AfoBep','top','currentColorSwatch','display','onmouseup','143UPSCNk','\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22background:var(--surface);padding:18px\x2022px;border-radius:10px;min-width:280px;max-width:720px;text-align:left;box-shadow:0\x202px\x2024px\x20rgba(0,0,0,0.25);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:0;\x22>ネズミスケッチについて</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ネズミスケッチは、簡単にドット絵アニメーションを作成できるツールです。</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>バージョン:\x20<b>','inline-block','toLowerCase','colorPicker','onCanvasColorPick\x20error','frontDimBtn','click','fill','posX','254tXWiuO','penAlphaMode','addEventListener','target','offsetHeight','shiftKey','nextSibling','removeAttribute','nudgeUpBtn','pasteLayerBtn','oninput','height','justifyContent','693PRKTus','getAttribute','canvas','ontouchstart','block','getImageData','constructor','innerHTML','finally','about-dialog','ctrlKey','getElementById','touchstart','right','nezumi-theme','#aboutCloseBtn','</b>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20バージョンID:\x20','body','insertBefore','ontouchmove','cursor','add','Picked\x20color','.tool-btn-container','onmousedown','ontouchend','style','56212ENagVb','platform','DOMContentLoaded','keyup','tagName'];_0x554e=function(){return _0x59c1ec;};return _0x554e();}const _0x23da54=_0x5a72;(function(_0x35a2eb,_0x493007){const _0x4a8632=_0x5a72,_0x2deb20=_0x35a2eb();while(!![]){try{const _0x261a7c=-parseInt(_0x4a8632(0x178))/0x1*(parseInt(_0x4a8632(0x1b0))/0x2)+parseInt(_0x4a8632(0x20b))/0x3*(-parseInt(_0x4a8632(0x1d8))/0x4)+parseInt(_0x4a8632(0x16e))/0x5+-parseInt(_0x4a8632(0x16a))/0x6*(parseInt(_0x4a8632(0x1ed))/0x7)+-parseInt(_0x4a8632(0x172))/0x8*(-parseInt(_0x4a8632(0x1bd))/0x9)+-parseInt(_0x4a8632(0x1a1))/0xa*(-parseInt(_0x4a8632(0x1a6))/0xb)+parseInt(_0x4a8632(0x1e2))/0xc*(parseInt(_0x4a8632(0x19c))/0xd);if(_0x261a7c===_0x493007)break;else _0x2deb20['push'](_0x2deb20['shift']());}catch(_0x33f028){_0x2deb20['push'](_0x2deb20['shift']());}}}(_0x554e,0x3e99a));const _0x34194b=(function(){let _0x7d5847=!![];return function(_0x2f47e4,_0x527b71){const _0x416902=_0x7d5847?function(){const _0x128419=_0x5a72;if(_0x527b71){const _0x2c7af8=_0x527b71[_0x128419(0x1ef)](_0x2f47e4,arguments);return _0x527b71=null,_0x2c7af8;}}:function(){};return _0x7d5847=![],_0x416902;};}()),_0x5977ca=_0x34194b(this,function(){const _0x12de78=_0x5a72;return _0x5977ca['toString']()[_0x12de78(0x1f0)](_0x12de78(0x17a))[_0x12de78(0x1fe)]()[_0x12de78(0x1c3)](_0x5977ca)[_0x12de78(0x1f0)](_0x12de78(0x17a));});_0x5977ca(),window[_0x23da54(0x1b2)](_0x23da54(0x1da),()=>{const _0x3642cc=_0x23da54,_0x25b921=document[_0x3642cc(0x1c8)](_0x3642cc(0x1b1));_0x25b921&&(_0x25b921[_0x3642cc(0x201)]=penAlphaMode,_0x25b921[_0x3642cc(0x195)]=_0x4615db=>{const _0x430dcc=_0x3642cc;penAlphaMode=_0x4615db[_0x430dcc(0x1b3)][_0x430dcc(0x201)];});const _0x118ded=document['getElementById']('themeToggleBtn');if(_0x118ded){const _0x2685ff=localStorage[_0x3642cc(0x1e7)](_0x3642cc(0x1cb))||_0x3642cc(0x16d);applyTheme(_0x2685ff),_0x118ded[_0x3642cc(0x1b2)](_0x3642cc(0x1ad),()=>{toggleTheme();});}window[_0x3642cc(0x1b2)](_0x3642cc(0x185),updateMenuBtnDisplay),updateMenuBtnDisplay();const _0x3f192a=document[_0x3642cc(0x1c8)]('toolsToggleBtn'),_0x252f8d=document[_0x3642cc(0x1c8)](_0x3642cc(0x189)),_0x55e4e9=document[_0x3642cc(0x1c8)](_0x3642cc(0x20e)),_0x2493e3=document[_0x3642cc(0x1f8)](_0x3642cc(0x1d4)),_0x41d15b=document[_0x3642cc(0x1f8)](_0x3642cc(0x1fc)),_0x272b84=_0x55e4e9?_0x55e4e9[_0x3642cc(0x180)]:null,_0x2eeace=_0x55e4e9?_0x55e4e9[_0x3642cc(0x1b6)]:null;let _0x458a80=null;function _0x236c4b(){const _0x5d15f8=_0x3642cc;try{if(!_0x55e4e9)return;const _0x15dfc7=window['innerWidth'],_0x27b541=_0x15dfc7<=0x384;if(_0x27b541&&_0x2493e3&&_0x55e4e9[_0x5d15f8(0x180)]!==_0x2493e3){if(_0x458a80===null)_0x458a80=_0x55e4e9[_0x5d15f8(0x1be)](_0x5d15f8(0x1d7))||'';_0x2493e3['appendChild'](_0x55e4e9),_0x55e4e9[_0x5d15f8(0x18d)][_0x5d15f8(0x1d2)](_0x5d15f8(0x16b));const _0x528297=_0x41d15b?_0x41d15b['offsetHeight']:0x38;_0x55e4e9[_0x5d15f8(0x1d7)][_0x5d15f8(0x174)]=_0x5d15f8(0x19e),_0x55e4e9[_0x5d15f8(0x1d7)][_0x5d15f8(0x191)]=_0x5d15f8(0x184),_0x55e4e9['style'][_0x5d15f8(0x1ca)]=_0x5d15f8(0x184),_0x55e4e9[_0x5d15f8(0x1d7)][_0x5d15f8(0x1de)]=_0x528297+0x8+'px',_0x55e4e9['style'][_0x5d15f8(0x1a0)]=0x1770,_0x55e4e9[_0x5d15f8(0x1d7)][_0x5d15f8(0x200)]=_0x5d15f8(0x17b),_0x55e4e9['style']['boxShadow']=_0x5d15f8(0x202),_0x55e4e9['style'][_0x5d15f8(0x1a4)]=_0x5d15f8(0x210);}else{if(!_0x27b541&&_0x272b84&&_0x55e4e9[_0x5d15f8(0x180)]!==_0x272b84){_0x2eeace&&_0x2eeace['parentNode']===_0x272b84?_0x272b84[_0x5d15f8(0x1cf)](_0x55e4e9,_0x2eeace):_0x272b84[_0x5d15f8(0x171)](_0x55e4e9);_0x55e4e9[_0x5d15f8(0x18d)]['remove']('toolbar-mobile');if(_0x458a80!==null){if(_0x458a80==='')_0x55e4e9[_0x5d15f8(0x1b7)](_0x5d15f8(0x1d7));else _0x55e4e9[_0x5d15f8(0x197)](_0x5d15f8(0x1d7),_0x458a80);_0x458a80=null;}}else{if(_0x27b541&&_0x55e4e9[_0x5d15f8(0x180)]===_0x2493e3){const _0x3d9859=_0x41d15b?_0x41d15b[_0x5d15f8(0x1b4)]:0x38;_0x55e4e9[_0x5d15f8(0x1d7)][_0x5d15f8(0x1de)]=_0x3d9859+0x8+'px';}}}}catch(_0x53514d){console['error']('relocateRightToolbar\x20error',_0x53514d);}}_0x3f192a&&(_0x3f192a[_0x3642cc(0x1d7)][_0x3642cc(0x1a4)]=_0x3642cc(0x1a8),_0x3f192a[_0x3642cc(0x1b2)](_0x3642cc(0x1ad),()=>{const _0x159f5b=_0x3642cc;if(window['innerWidth']<=0x384&&_0x55e4e9){const _0x3b4097=_0x55e4e9['style'][_0x159f5b(0x1a4)]!=='none';_0x55e4e9[_0x159f5b(0x1d7)][_0x159f5b(0x1a4)]=_0x3b4097?_0x159f5b(0x210):_0x159f5b(0x1c1),_0x55e4e9[_0x159f5b(0x18d)][_0x159f5b(0x1e4)]('mobile-open',!_0x3b4097);}else _0x252f8d&&_0x252f8d[_0x159f5b(0x18d)][_0x159f5b(0x1e4)]('open');}));window[_0x3642cc(0x1b2)](_0x3642cc(0x185),_0x236c4b),_0x236c4b();const _0x2f50bb=document[_0x3642cc(0x1c8)](_0x3642cc(0x188));_0x2f50bb&&(_0x2f50bb[_0x3642cc(0x1ba)]=_0x8ff8b0=>setZoomValue(_0x8ff8b0['target'][_0x3642cc(0x201)]));const _0x43bb2f=document[_0x3642cc(0x1c8)](_0x3642cc(0x183)),_0x17fa63=document[_0x3642cc(0x1c8)](_0x3642cc(0x1a3));function _0x6a515b(){const _0xa24102=_0x3642cc;if(typeof showColorPickerDialog!=='function')return;const _0x31c09b=currentColor===_0xa24102(0x17c)||!currentColor?_0xa24102(0x1dd):currentColor;showColorPickerDialog({'color':_0x31c09b,'alpha':typeof currentAlpha===_0xa24102(0x205)?currentAlpha:0x1,'onChange':({hex:_0x19ea4b,rgba:_0x3db279,a:_0x1dbfa5})=>{const _0x16dbf9=_0xa24102;try{_0x3db279&&_0x3db279[0x3]===0x0?(currentColor=_0x16dbf9(0x17c),currentAlpha=0x0):(currentColor=_0x19ea4b||(_0x3db279?rgbToHex(_0x3db279[0x0],_0x3db279[0x1],_0x3db279[0x2]):_0x31c09b),currentAlpha=_0x3db279&&typeof _0x3db279[0x3]===_0x16dbf9(0x205)?_0x3db279[0x3]:_0x1dbfa5||0x1);updateCurrentColorSwatch();const _0x1fb1bb=document[_0x16dbf9(0x1c8)](_0x16dbf9(0x1aa));if(_0x1fb1bb&&currentColor!==_0x16dbf9(0x17c))_0x1fb1bb[_0x16dbf9(0x201)]=currentColor;}catch(_0x50cebc){console['error'](_0x16dbf9(0x206),_0x50cebc);}},'onOk':({hex:_0x12ece7,rgba:_0x9dc258,a:_0x499aed})=>{const _0x2c44f3=_0xa24102;_0x9dc258&&_0x9dc258[0x3]===0x0?(currentColor=_0x2c44f3(0x17c),currentAlpha=0x0):(currentColor=_0x12ece7||(_0x9dc258?rgbToHex(_0x9dc258[0x0],_0x9dc258[0x1],_0x9dc258[0x2]):_0x31c09b),currentAlpha=_0x9dc258&&typeof _0x9dc258[0x3]===_0x2c44f3(0x205)?_0x9dc258[0x3]:_0x499aed||0x1);updateCurrentColorSwatch();const _0x3d03f9=document['getElementById'](_0x2c44f3(0x1aa));if(_0x3d03f9&&currentColor!==_0x2c44f3(0x17c))_0x3d03f9[_0x2c44f3(0x201)]=currentColor;}});}if(_0x43bb2f)_0x43bb2f[_0x3642cc(0x1b2)](_0x3642cc(0x1ad),_0x6a515b);if(_0x17fa63)_0x17fa63[_0x3642cc(0x1b2)](_0x3642cc(0x1ad),_0x6a515b);const _0x4cb3e0=document['getElementById'](_0x3642cc(0x204)),_0x33aecf=document[_0x3642cc(0x1c8)](_0x3642cc(0x1b9));if(_0x4cb3e0)_0x4cb3e0[_0x3642cc(0x1b2)]('click',()=>{const _0x41dd21=_0x3642cc;try{copyLayer();}catch(_0x3e4eb1){console[_0x41dd21(0x19b)](_0x41dd21(0x203),_0x3e4eb1);}});_0x33aecf&&(_0x33aecf[_0x3642cc(0x1b2)](_0x3642cc(0x1ad),()=>{const _0x3150fb=_0x3642cc;try{pasteLayer();}catch(_0x9cc318){console[_0x3150fb(0x19b)](_0x3150fb(0x17d),_0x9cc318);}}),_0x33aecf['disabled']=!copiedLayerDataUrl);let _0x5a94c2=![],_0x3e7e7b=null;function _0x30ff2a(_0x2be876){const _0x54f6d6=_0x3642cc;if(!_0x2be876)return![];const _0x118fd0=_0x2be876['tagName']&&_0x2be876[_0x54f6d6(0x1dc)][_0x54f6d6(0x1a9)]();if(_0x118fd0===_0x54f6d6(0x1eb)||_0x118fd0===_0x54f6d6(0x1fd)||_0x118fd0===_0x54f6d6(0x1fb))return!![];if(_0x2be876[_0x54f6d6(0x170)])return!![];return![];}window[_0x3642cc(0x1b2)](_0x3642cc(0x19a),_0x1a4e3f=>{const _0x1a50c0=_0x3642cc;_0x1a4e3f[_0x1a50c0(0x193)]===_0x1a50c0(0x1f4)&&!_0x5a94c2&&!_0x30ff2a(document[_0x1a50c0(0x192)])&&(_0x3e7e7b=currentTool,setTool(_0x1a50c0(0x18a)),_0x5a94c2=!![]);},{'passive':!![]}),window[_0x3642cc(0x1b2)](_0x3642cc(0x1db),_0x424eea=>{const _0x1943e2=_0x3642cc;if(_0x424eea['key']==='Shift'&&_0x5a94c2){if(currentTool===_0x1943e2(0x18a)&&_0x3e7e7b)setTool(_0x3e7e7b);_0x3e7e7b=null,_0x5a94c2=![];}},{'passive':!![]}),window[_0x3642cc(0x1b2)](_0x3642cc(0x19a),_0x3f14db=>{const _0x49b074=_0x3642cc;if(_0x30ff2a(document['activeElement']))return;const _0x4054d2=navigator[_0x49b074(0x1d9)]&&navigator[_0x49b074(0x1d9)][_0x49b074(0x1f3)]()[_0x49b074(0x16c)](_0x49b074(0x20f))>=0x0,_0x135d88=_0x4054d2?_0x3f14db['metaKey']:_0x3f14db[_0x49b074(0x1c7)];if(!_0x135d88)return;const _0x5e4f99=(_0x3f14db[_0x49b074(0x193)]||'')[_0x49b074(0x1a9)]();if(_0x5e4f99==='z'&&!_0x3f14db['shiftKey']){_0x3f14db[_0x49b074(0x1f6)]();try{undo();}catch(_0x4f39fc){console[_0x49b074(0x19b)]('undo\x20shortcut\x20error',_0x4f39fc);}}else{if(_0x5e4f99==='z'&&_0x3f14db[_0x49b074(0x1b5)]||_0x5e4f99==='y'){_0x3f14db['preventDefault']();try{redo();}catch(_0x2f95fe){console[_0x49b074(0x19b)](_0x49b074(0x16f),_0x2f95fe);}}}},{'passive':![]}),window[_0x3642cc(0x20d)]=function(){const _0x103a57=_0x3642cc;if(document[_0x103a57(0x1c8)](_0x103a57(0x1c6)))return;const _0x24e4e4=document[_0x103a57(0x19f)](_0x103a57(0x173));_0x24e4e4['id']=_0x103a57(0x1c6),_0x24e4e4[_0x103a57(0x1d7)]['position']='fixed',_0x24e4e4[_0x103a57(0x1d7)][_0x103a57(0x191)]='0',_0x24e4e4[_0x103a57(0x1d7)][_0x103a57(0x1a2)]='0',_0x24e4e4[_0x103a57(0x1d7)][_0x103a57(0x200)]='100vw',_0x24e4e4[_0x103a57(0x1d7)][_0x103a57(0x1bb)]='100vh',_0x24e4e4[_0x103a57(0x1d7)][_0x103a57(0x1a4)]='flex',_0x24e4e4[_0x103a57(0x1d7)][_0x103a57(0x177)]=_0x103a57(0x176),_0x24e4e4[_0x103a57(0x1d7)][_0x103a57(0x1bc)]=_0x103a57(0x176),_0x24e4e4[_0x103a57(0x1d7)][_0x103a57(0x1a0)]=0x2710,_0x24e4e4[_0x103a57(0x1d7)][_0x103a57(0x182)]=_0x103a57(0x18e);const _0x29ac9b=window['NEZUMI_BUILD_META']||{},_0x39b076=_0x29ac9b['version']||'不明',_0xaf229b=_0x29ac9b['id']||'不明';_0x24e4e4[_0x103a57(0x1c4)]=_0x103a57(0x1a7)+_0x39b076+_0x103a57(0x1cd)+_0xaf229b+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>©\x202025\x20nezumi-sketch\x20<a\x20href=\x22https://github.com/mouse0329\x22\x20rel=\x22noopener\x20noreferrer\x22>github\x20mouse0329</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><a\x20href=\x22/terms\x22>利用規約</a>\u3000<a\x20href=\x22/license\x22>ライセンス</a>\u3000<a\x20href=\x22/about\x22>紹介ページ</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:right;margin-top:10px;\x22><button\x20id=\x22aboutCloseBtn\x22>閉じる</button></div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',document[_0x103a57(0x1ce)][_0x103a57(0x171)](_0x24e4e4),_0x24e4e4[_0x103a57(0x1f8)](_0x103a57(0x1cc))[_0x103a57(0x1e3)]=()=>_0x24e4e4[_0x103a57(0x207)](),_0x24e4e4[_0x103a57(0x1b2)](_0x103a57(0x1ad),_0x288b9a=>{const _0x374df3=_0x103a57;if(_0x288b9a[_0x374df3(0x1b3)]===_0x24e4e4)_0x24e4e4['remove']();});};const _0x134b4a=document['getElementById'](_0x3642cc(0x1b8)),_0x40aaf0=document[_0x3642cc(0x1c8)](_0x3642cc(0x20c)),_0x346302=document[_0x3642cc(0x1c8)](_0x3642cc(0x1f9)),_0x357347=document[_0x3642cc(0x1c8)](_0x3642cc(0x1ec)),_0x4dab53=document['getElementById'](_0x3642cc(0x181));function _0x450d95(){const _0x241099=_0x3642cc;let _0x18cec2=0x1;if(_0x4dab53){_0x18cec2=parseInt(_0x4dab53[_0x241099(0x201)],0xa)||0x1;if(_0x18cec2<0x1)_0x18cec2=0x1;}return _0x18cec2;}if(_0x134b4a)_0x134b4a[_0x3642cc(0x1b2)](_0x3642cc(0x1ad),()=>nudgeActiveLayer(0x0,-_0x450d95()));if(_0x40aaf0)_0x40aaf0[_0x3642cc(0x1b2)](_0x3642cc(0x1ad),()=>nudgeActiveLayer(0x0,_0x450d95()));if(_0x346302)_0x346302[_0x3642cc(0x1b2)](_0x3642cc(0x1ad),()=>nudgeActiveLayer(-_0x450d95(),0x0));if(_0x357347)_0x357347['addEventListener'](_0x3642cc(0x1ad),()=>nudgeActiveLayer(_0x450d95(),0x0));const _0x3f7ead=document[_0x3642cc(0x1c8)](_0x3642cc(0x1ac));_0x3f7ead&&_0x3f7ead['addEventListener']('click',()=>toggleFrontLayerDim());try{toggleGrid(showGrid);}catch(_0x4a0a50){}try{toggleFrontLayerDim(dimFrontLayers);}catch(_0x4ddb8a){}try{updateAnimUi(![]);}catch(_0x57c236){}}),window[_0x23da54(0x18c)]=()=>{const _0xba461e=_0x23da54;canvas=document['getElementById'](_0xba461e(0x1bf)),wrapper=document[_0xba461e(0x1c8)](_0xba461e(0x1f7))||canvas?.[_0xba461e(0x1ff)]||null;if(!canvas){console['error'](_0xba461e(0x20a));return;}ctx=canvas['getContext']('2d'),projects=[createProject()],activeProject=0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),initCanvas(),setTool('pen'),updateCurrentColorSwatch(),loadPaletteFromDB()[_0xba461e(0x209)](()=>createPalette());const _0x4cbed7=document['getElementById'](_0xba461e(0x1f2));if(_0x4cbed7)_0x4cbed7[_0xba461e(0x201)]=penSize;const _0x188a67=document['getElementById'](_0xba461e(0x196));if(_0x188a67)_0x188a67[_0xba461e(0x201)]=penMode;const _0x1af8a1=document[_0xba461e(0x1c8)]('exportWidthPx'),_0x12c8b2=document[_0xba461e(0x1c8)]('exportHeightPx');if(_0x1af8a1)_0x1af8a1['value']=canvas[_0xba461e(0x200)];if(_0x12c8b2)_0x12c8b2[_0xba461e(0x201)]=canvas['height'];const _0x1c8351=document[_0xba461e(0x1c8)]('animSpeedRange'),_0x4789c8=document[_0xba461e(0x1c8)]('animSpeedValue');_0x1c8351&&_0x4789c8&&((!Number[_0xba461e(0x179)](animationDelay)||animationDelay<=0x0)&&(animationDelay=0x12c),_0x1c8351[_0xba461e(0x201)]=animationDelay,_0x4789c8[_0xba461e(0x201)]=animationDelay,_0x1c8351[_0xba461e(0x1ba)]=_0x2e4a59=>{const _0x32479a=_0xba461e;_0x4789c8[_0x32479a(0x201)]=_0x2e4a59['target'][_0x32479a(0x201)],setAnimationDelay(_0x2e4a59['target'][_0x32479a(0x201)]);},_0x4789c8[_0xba461e(0x195)]=_0xc28965=>{const _0x128ef9=_0xba461e;let _0x2817c8=Math[_0x128ef9(0x18f)](0xa,Math[_0x128ef9(0x1e9)](0x1388,parseInt(_0xc28965[_0x128ef9(0x1b3)][_0x128ef9(0x201)],0xa)||animationDelay));_0x1c8351['value']=_0x2817c8,_0x4789c8['value']=_0x2817c8,setAnimationDelay(_0x2817c8);});canvas[_0xba461e(0x1d5)]=handleMouseDown,canvas[_0xba461e(0x1e1)]=handleMouseMove,canvas[_0xba461e(0x1a5)]=handleMouseUp,canvas[_0xba461e(0x1e0)]=handleMouseUp,canvas[_0xba461e(0x1c0)]=handleTouchStart,canvas[_0xba461e(0x1d0)]=handleTouchMove,canvas[_0xba461e(0x1d6)]=handleTouchEnd,canvas[_0xba461e(0x187)]=handleTouchEnd,canvas[_0xba461e(0x1b2)](_0xba461e(0x1c9),handleTouchStart,{'passive':![]}),canvas['addEventListener']('touchmove',handleTouchMove,{'passive':![]}),canvas[_0xba461e(0x1b2)](_0xba461e(0x17e),handleTouchEnd,{'passive':![]}),canvas['addEventListener']('touchcancel',handleTouchEnd,{'passive':![]});try{showLoading(_0xba461e(0x1ee));}catch(_0x3f6239){}loadProjectFromIDB()['catch'](_0x194010=>{const _0x16ffc8=_0xba461e;console[_0x16ffc8(0x1e6)]('IndexedDB\x20からの読み込みに失敗したチュー',_0x194010);})[_0xba461e(0x1c5)](()=>{const _0x3cc333=_0xba461e;try{hideLoading();}catch(_0x4d7a2c){}if(typeof window[_0x3cc333(0x175)]===_0x3cc333(0x198))window[_0x3cc333(0x175)]();});};function handleMouseDown(_0xa7395){const _0x3af446=_0x23da54;if(currentTool==='pan'){isDrawing=!![],panStart={'x':_0xa7395['clientX'],'y':_0xa7395[_0x3af446(0x1df)],'posX':posX,'posY':posY},canvas['style'][_0x3af446(0x1d1)]=_0x3af446(0x1e8);return;}isDrawing=!![],saveHistory();const _0x23ca28=getCanvasCoords(_0xa7395),_0x348f51=Math[_0x3af446(0x208)](_0x23ca28['x']/cellSize),_0x5547fa=Math[_0x3af446(0x208)](_0x23ca28['y']/cellSize);currentTool===_0x3af446(0x1ae)?(fillAt(_0x348f51,_0x5547fa),saveHistory(),isDrawing=![],lastMouse=null):(drawDotXY(_0x348f51,_0x5547fa),lastMouse={'x':_0x348f51,'y':_0x5547fa});}function handleMouseMove(_0x13220b){const _0x523b17=_0x23da54;if(!isDrawing)return;if(currentTool===_0x523b17(0x18a)&&panStart){const _0x1bcb1b=_0x13220b['clientX']-panStart['x'],_0x1234a8=_0x13220b['clientY']-panStart['y'];posX=panStart[_0x523b17(0x1af)]+_0x1bcb1b,posY=panStart['posY']+_0x1234a8,updateTransform();return;}const _0xca4c56=getCanvasCoords(_0x13220b),_0x2630f4=Math[_0x523b17(0x208)](_0xca4c56['x']/cellSize),_0x293ac0=Math[_0x523b17(0x208)](_0xca4c56['y']/cellSize);if(!lastMouse){drawDotXY(_0x2630f4,_0x293ac0),lastMouse={'x':_0x2630f4,'y':_0x293ac0};return;}const _0x5d5ff9=_0x2630f4-lastMouse['x'],_0x16ffaf=_0x293ac0-lastMouse['y'],_0xf37786=Math[_0x523b17(0x18f)](Math[_0x523b17(0x17f)](_0x5d5ff9),Math[_0x523b17(0x17f)](_0x16ffaf));if(_0xf37786<=0x1)drawDotXY(_0x2630f4,_0x293ac0);else for(let _0x4275f0=0x1;_0x4275f0<=_0xf37786;_0x4275f0++){const _0x319a32=Math[_0x523b17(0x1f5)](lastMouse['x']+_0x5d5ff9*_0x4275f0/_0xf37786),_0x423fae=Math[_0x523b17(0x1f5)](lastMouse['y']+_0x16ffaf*_0x4275f0/_0xf37786);drawDotXY(_0x319a32,_0x423fae);}lastMouse={'x':_0x2630f4,'y':_0x293ac0};}function handleMouseUp(_0x11174c){const _0x126e55=_0x23da54;if(currentTool===_0x126e55(0x18a)){isDrawing=![],panStart=null,canvas[_0x126e55(0x1d7)][_0x126e55(0x1d1)]='grab';return;}isDrawing&&saveHistory(),isDrawing=![],lastMouse=null;}function handleTouchStart(_0x503385){const _0xd6daaf=_0x23da54;if(_0x503385[_0xd6daaf(0x18b)][_0xd6daaf(0x19d)]===0x2){_0x503385[_0xd6daaf(0x1f6)](),isPinching=!![],isDrawing=![],lastTouch=null;const _0x80fd1c=_0x503385[_0xd6daaf(0x18b)][0x0],_0x41c687=_0x503385[_0xd6daaf(0x18b)][0x1];pinchStartDistance=Math[_0xd6daaf(0x1ea)](_0x41c687[_0xd6daaf(0x1fa)]-_0x80fd1c['clientX'],_0x41c687[_0xd6daaf(0x1df)]-_0x80fd1c[_0xd6daaf(0x1df)]),pinchStartMid={'clientX':(_0x80fd1c[_0xd6daaf(0x1fa)]+_0x41c687[_0xd6daaf(0x1fa)])/0x2,'clientY':(_0x80fd1c[_0xd6daaf(0x1df)]+_0x41c687[_0xd6daaf(0x1df)])/0x2},pinchStartScale=scale,pinchStartPosX=posX,pinchStartPosY=posY,pinchRect=canvas[_0xd6daaf(0x1f1)]();}else{if(_0x503385[_0xd6daaf(0x18b)][_0xd6daaf(0x19d)]===0x1){if(colorPickMode){_0x503385[_0xd6daaf(0x1f6)]();const _0x3227e2=_0x503385[_0xd6daaf(0x18b)][0x0];onCanvasColorPick({'clientX':_0x3227e2[_0xd6daaf(0x1fa)],'clientY':_0x3227e2[_0xd6daaf(0x1df)]});return;}_0x503385[_0xd6daaf(0x1f6)]();if(isPinching)return;const _0x5bc7ae=_0x503385[_0xd6daaf(0x18b)][0x0];if(currentTool===_0xd6daaf(0x18a)){isDrawing=!![],panStart={'x':_0x5bc7ae[_0xd6daaf(0x1fa)],'y':_0x5bc7ae['clientY'],'posX':posX,'posY':posY};if(canvas)canvas[_0xd6daaf(0x1d7)][_0xd6daaf(0x1d1)]=_0xd6daaf(0x1e8);return;}isDrawing=!![],saveHistory();let _0x1d8d8c=getTouchPos(_0x503385);lastTouch=_0x1d8d8c,currentTool==='fill'?(fillAt(_0x1d8d8c['x'],_0x1d8d8c['y']),saveHistory(),isDrawing=![]):drawDotTouch(_0x1d8d8c['x'],_0x1d8d8c['y']);}}}function handleTouchMove(_0xbfcdc7){const _0x420882=_0x23da54;if(!_0xbfcdc7)return;if(isPinching||_0xbfcdc7[_0x420882(0x18b)]&&_0xbfcdc7[_0x420882(0x18b)][_0x420882(0x19d)]===0x2){_0xbfcdc7[_0x420882(0x1f6)](),isDrawing=![],lastTouch=null;const _0x265a92=_0xbfcdc7['touches'][0x0],_0x413d60=_0xbfcdc7[_0x420882(0x18b)][0x1],_0x5cea57=Math['hypot'](_0x413d60['clientX']-_0x265a92['clientX'],_0x413d60[_0x420882(0x1df)]-_0x265a92[_0x420882(0x1df)]),_0x2be1f4={'clientX':(_0x265a92[_0x420882(0x1fa)]+_0x413d60[_0x420882(0x1fa)])/0x2,'clientY':(_0x265a92[_0x420882(0x1df)]+_0x413d60[_0x420882(0x1df)])/0x2};if(!pinchStartDistance)pinchStartDistance=_0x5cea57||0x1;let _0x3da781=_0x5cea57/pinchStartDistance||0x1,_0x281821=pinchStartScale*_0x3da781;_0x281821=Math['min'](Math[_0x420882(0x18f)](_0x281821,0.2),0x5);const _0x49187c=pinchRect||canvas[_0x420882(0x1f1)](),_0x5b87ec=(pinchStartMid['clientX']-_0x49187c[_0x420882(0x191)]-pinchStartPosX)/pinchStartScale,_0x5c72c2=(pinchStartMid[_0x420882(0x1df)]-_0x49187c[_0x420882(0x1a2)]-pinchStartPosY)/pinchStartScale;posX=_0x2be1f4[_0x420882(0x1fa)]-_0x49187c[_0x420882(0x191)]-_0x5b87ec*_0x281821,posY=_0x2be1f4[_0x420882(0x1df)]-_0x49187c['top']-_0x5c72c2*_0x281821,scale=_0x281821,updateTransform();return;}if(currentTool===_0x420882(0x18a)&&panStart&&_0xbfcdc7[_0x420882(0x18b)]&&_0xbfcdc7[_0x420882(0x18b)][0x0]){_0xbfcdc7[_0x420882(0x1f6)]();const _0x4aabe5=_0xbfcdc7[_0x420882(0x18b)][0x0],_0x252a2b=_0x4aabe5['clientX']-panStart['x'],_0x26206e=_0x4aabe5[_0x420882(0x1df)]-panStart['y'];posX=panStart[_0x420882(0x1af)]+_0x252a2b,posY=panStart[_0x420882(0x199)]+_0x26206e,updateTransform();return;}if(!isDrawing)return;if(_0xbfcdc7[_0x420882(0x18b)]&&_0xbfcdc7['touches']['length']>0x1)return;_0xbfcdc7[_0x420882(0x1f6)]();const _0x225a97=getTouchPos(_0xbfcdc7);if(!_0x225a97)return;if(lastTouch){const _0x509a5d=Math[_0x420882(0x17f)]((_0x225a97['x']-lastTouch['x'])*cellSize),_0x5b772d=Math[_0x420882(0x17f)]((_0x225a97['y']-lastTouch['y'])*cellSize);if(_0x509a5d>=PAN_CANCEL_DISTANCE||_0x5b772d>=PAN_CANCEL_DISTANCE){if(currentTool!=='pen'){isDrawing=![];return;}}}if(lastTouch){const _0x49e31e=_0x225a97['x']-lastTouch['x'],_0x110132=_0x225a97['y']-lastTouch['y'],_0x4249ca=Math['max'](Math[_0x420882(0x17f)](_0x49e31e),Math[_0x420882(0x17f)](_0x110132));for(let _0xaf4e63=0x1;_0xaf4e63<=_0x4249ca;_0xaf4e63++){const _0x1896ee=Math['round'](lastTouch['x']+_0x49e31e*_0xaf4e63/_0x4249ca),_0x2a00b5=Math[_0x420882(0x1f5)](lastTouch['y']+_0x110132*_0xaf4e63/_0x4249ca);drawDotTouch(_0x1896ee,_0x2a00b5);}}else drawDotTouch(_0x225a97['x'],_0x225a97['y']);lastTouch=_0x225a97;}function _0x5a72(_0x1aafe2,_0x2dc744){_0x1aafe2=_0x1aafe2-0x16a;const _0x47cdac=_0x554e();let _0x5977ca=_0x47cdac[_0x1aafe2];return _0x5977ca;}function handleTouchEnd(_0x300e2d){const _0x2d4706=_0x23da54;isPinching&&_0x300e2d['touches']&&_0x300e2d[_0x2d4706(0x18b)]['length']<0x2&&(isPinching=![],pinchStartDistance=0x0,pinchStartMid=null,pinchRect=null);isDrawing&&(!_0x300e2d[_0x2d4706(0x18b)]||_0x300e2d['touches'][_0x2d4706(0x19d)]===0x0)&&saveHistory();if(_0x300e2d[_0x2d4706(0x18b)]&&_0x300e2d['touches'][_0x2d4706(0x19d)]===0x1){let _0x1bb23d=_0x300e2d[_0x2d4706(0x18b)][0x0];lastTouch=getTouchPos({'touches':[_0x1bb23d]}),isDrawing=!![];if(currentTool===_0x2d4706(0x18a)){panStart={'x':_0x1bb23d[_0x2d4706(0x1fa)],'y':_0x1bb23d['clientY'],'posX':posX,'posY':posY};if(canvas)canvas[_0x2d4706(0x1d7)][_0x2d4706(0x1d1)]='grabbing';}}else{isDrawing=![],lastTouch=null;if(currentTool===_0x2d4706(0x18a)){panStart=null;if(canvas)canvas[_0x2d4706(0x1d7)][_0x2d4706(0x1d1)]='grab';}}}function onCanvasColorPick(_0x9ef190){const _0x3daee2=_0x23da54;try{const _0x579ae2=getCanvasCoords(_0x9ef190),_0x5f46d5=Math['floor'](_0x579ae2['x']),_0xc72295=Math['floor'](_0x579ae2['y']),_0x11ea90=ctx[_0x3daee2(0x1c2)](_0x5f46d5,_0xc72295,0x1,0x1)[_0x3daee2(0x194)],_0x15e0f8=_0x11ea90[0x0],_0x73831=_0x11ea90[0x1],_0x13355b=_0x11ea90[0x2],_0x5b0a3c=_0x11ea90[0x3];if(_0x5b0a3c===0x0){currentColor=_0x3daee2(0x17c);const _0x440750=document['getElementById'](_0x3daee2(0x1aa));if(_0x440750)_0x440750[_0x3daee2(0x201)]=_0x3daee2(0x1dd);console['info']('Picked\x20transparent');}else{const _0x8ec1d8='#'+[_0x15e0f8,_0x73831,_0x13355b][_0x3daee2(0x1e5)](_0x1e782d=>_0x1e782d['toString'](0x10)[_0x3daee2(0x190)](0x2,'0'))['join']('');currentColor=_0x8ec1d8;const _0x28081e=document[_0x3daee2(0x1c8)](_0x3daee2(0x1aa));if(_0x28081e)_0x28081e[_0x3daee2(0x201)]=_0x8ec1d8;console['info'](_0x3daee2(0x1d3),_0x8ec1d8);}}catch(_0xce9481){console['error'](_0x3daee2(0x1ab),_0xce9481);}colorPickMode=![];if(canvas)canvas['style'][_0x3daee2(0x1d1)]=_0x3daee2(0x186);}