const _0x5dc0d2=_0xea2e;(function(_0x25a094,_0x9025cf){const _0x4bb843=_0xea2e,_0x15f4af=_0x25a094();while(!![]){try{const _0x56eb89=parseInt(_0x4bb843(0x181))/0x1+parseInt(_0x4bb843(0x165))/0x2+-parseInt(_0x4bb843(0x19a))/0x3+parseInt(_0x4bb843(0x162))/0x4+parseInt(_0x4bb843(0x170))/0x5*(parseInt(_0x4bb843(0x132))/0x6)+parseInt(_0x4bb843(0x17e))/0x7*(parseInt(_0x4bb843(0x145))/0x8)+-parseInt(_0x4bb843(0x137))/0x9;if(_0x56eb89===_0x9025cf)break;else _0x15f4af['push'](_0x15f4af['shift']());}catch(_0x42565a){_0x15f4af['push'](_0x15f4af['shift']());}}}(_0x231b,0x7c569));const _0x498897=(function(){let _0x478b4f=!![];return function(_0x3ea7ce,_0x3c42c3){const _0x313367=_0x478b4f?function(){const _0x5a3504=_0xea2e;if(_0x3c42c3){const _0x1503c5=_0x3c42c3[_0x5a3504(0x1c2)](_0x3ea7ce,arguments);return _0x3c42c3=null,_0x1503c5;}}:function(){};return _0x478b4f=![],_0x313367;};}()),_0x348ebe=_0x498897(this,function(){const _0x4fea50=_0xea2e;return _0x348ebe['toString']()[_0x4fea50(0x1af)]('(((.+)+)+)+$')[_0x4fea50(0x161)]()[_0x4fea50(0x1c0)](_0x348ebe)['search'](_0x4fea50(0x18d));});_0x348ebe(),window['addEventListener'](_0x5dc0d2(0x1be),()=>{const _0x10baae=_0x5dc0d2,_0x2d9f1d=document['getElementById'](_0x10baae(0x139));_0x2d9f1d&&(_0x2d9f1d[_0x10baae(0x13f)]=penAlphaMode,_0x2d9f1d[_0x10baae(0x176)]=_0x87ca48=>{const _0xcb91be=_0x10baae;penAlphaMode=_0x87ca48[_0xcb91be(0x17f)][_0xcb91be(0x13f)];});const _0x49a950=document['getElementById']('themeToggleBtn');if(_0x49a950){const _0x4f3a99=localStorage[_0x10baae(0x189)]('nezumi-theme')||_0x10baae(0x171);applyTheme(_0x4f3a99),_0x49a950[_0x10baae(0x1c6)](_0x10baae(0x1a2),()=>{toggleTheme();});}window[_0x10baae(0x1c6)](_0x10baae(0x1b6),updateMenuBtnDisplay),updateMenuBtnDisplay();const _0x27ea50=document[_0x10baae(0x160)]('toolsToggleBtn'),_0x4ff898=document[_0x10baae(0x160)]('right-panel'),_0x5d5cf6=document[_0x10baae(0x160)](_0x10baae(0x135)),_0x354bfd=document[_0x10baae(0x16b)]('.tool-btn-container'),_0xab4c87=document['querySelector']('footer'),_0x5509cd=_0x5d5cf6?_0x5d5cf6[_0x10baae(0x12c)]:null,_0x58eea4=_0x5d5cf6?_0x5d5cf6[_0x10baae(0x1a8)]:null;let _0x3ef2c6=null;function _0x482bfe(){const _0x55dd5d=_0x10baae;try{if(!_0x5d5cf6)return;const _0x245671=window[_0x55dd5d(0x17c)],_0x3a5d43=_0x245671<=0x384;if(_0x3a5d43&&_0x354bfd&&_0x5d5cf6[_0x55dd5d(0x12c)]!==_0x354bfd){if(_0x3ef2c6===null)_0x3ef2c6=_0x5d5cf6[_0x55dd5d(0x175)](_0x55dd5d(0x163))||'';_0x354bfd[_0x55dd5d(0x136)](_0x5d5cf6),_0x5d5cf6['classList'][_0x55dd5d(0x180)](_0x55dd5d(0x13c));const _0x4d0be6=_0xab4c87?_0xab4c87['offsetHeight']:0x38;_0x5d5cf6[_0x55dd5d(0x163)][_0x55dd5d(0x152)]=_0x55dd5d(0x1c5),_0x5d5cf6[_0x55dd5d(0x163)][_0x55dd5d(0x18a)]=_0x55dd5d(0x19e),_0x5d5cf6[_0x55dd5d(0x163)][_0x55dd5d(0x134)]='8px',_0x5d5cf6[_0x55dd5d(0x163)][_0x55dd5d(0x17d)]=_0x4d0be6+0x8+'px',_0x5d5cf6[_0x55dd5d(0x163)][_0x55dd5d(0x1c4)]=0x1770,_0x5d5cf6['style'][_0x55dd5d(0x193)]='auto',_0x5d5cf6[_0x55dd5d(0x163)]['boxShadow']=_0x55dd5d(0x1a0),_0x5d5cf6[_0x55dd5d(0x163)]['display']=_0x55dd5d(0x169);}else{if(!_0x3a5d43&&_0x5509cd&&_0x5d5cf6[_0x55dd5d(0x12c)]!==_0x5509cd){_0x58eea4&&_0x58eea4['parentNode']===_0x5509cd?_0x5509cd[_0x55dd5d(0x13b)](_0x5d5cf6,_0x58eea4):_0x5509cd[_0x55dd5d(0x136)](_0x5d5cf6);_0x5d5cf6[_0x55dd5d(0x1b1)][_0x55dd5d(0x195)](_0x55dd5d(0x13c));if(_0x3ef2c6!==null){if(_0x3ef2c6==='')_0x5d5cf6[_0x55dd5d(0x1c7)](_0x55dd5d(0x163));else _0x5d5cf6['setAttribute'](_0x55dd5d(0x163),_0x3ef2c6);_0x3ef2c6=null;}}else{if(_0x3a5d43&&_0x5d5cf6[_0x55dd5d(0x12c)]===_0x354bfd){const _0x4cf5f3=_0xab4c87?_0xab4c87[_0x55dd5d(0x12d)]:0x38;_0x5d5cf6['style']['bottom']=_0x4cf5f3+0x8+'px';}}}}catch(_0x2967d6){console[_0x55dd5d(0x179)](_0x55dd5d(0x1ab),_0x2967d6);}}_0x27ea50&&(_0x27ea50[_0x10baae(0x163)]['display']=_0x10baae(0x16e),_0x27ea50[_0x10baae(0x1c6)](_0x10baae(0x1a2),()=>{const _0x1b6ba5=_0x10baae;if(window[_0x1b6ba5(0x17c)]<=0x384&&_0x5d5cf6){const _0x576527=_0x5d5cf6[_0x1b6ba5(0x163)]['display']!==_0x1b6ba5(0x169);_0x5d5cf6[_0x1b6ba5(0x163)][_0x1b6ba5(0x167)]=_0x576527?_0x1b6ba5(0x169):_0x1b6ba5(0x147),_0x5d5cf6[_0x1b6ba5(0x1b1)]['toggle'](_0x1b6ba5(0x1c3),!_0x576527);}else _0x4ff898&&_0x4ff898[_0x1b6ba5(0x1b1)][_0x1b6ba5(0x172)](_0x1b6ba5(0x1b7));}));window[_0x10baae(0x1c6)](_0x10baae(0x1b6),_0x482bfe),_0x482bfe();const _0x5f4b9a=document['getElementById'](_0x10baae(0x192));_0x5f4b9a&&(_0x5f4b9a[_0x10baae(0x140)]=_0x601985=>setZoomValue(_0x601985[_0x10baae(0x17f)][_0x10baae(0x13f)]));const _0x43f5c0=document[_0x10baae(0x160)]('openColorPickerBtn'),_0x4ece9e=document['getElementById'](_0x10baae(0x14b));function _0x5cf27f(){const _0x5b51c6=_0x10baae;if(typeof showColorPickerDialog!=='function')return;const _0x16d920=currentColor===_0x5b51c6(0x157)||!currentColor?_0x5b51c6(0x186):currentColor;showColorPickerDialog({'color':_0x16d920,'alpha':typeof currentAlpha==='number'?currentAlpha:0x1,'onChange':({hex:_0x2a0786,rgba:_0x6cbdf1,a:_0x23df1b})=>{const _0x4d27e7=_0x5b51c6;try{_0x6cbdf1&&_0x6cbdf1[0x3]===0x0?(currentColor=_0x4d27e7(0x157),currentAlpha=0x0):(currentColor=_0x2a0786||(_0x6cbdf1?rgbToHex(_0x6cbdf1[0x0],_0x6cbdf1[0x1],_0x6cbdf1[0x2]):_0x16d920),currentAlpha=_0x6cbdf1&&typeof _0x6cbdf1[0x3]===_0x4d27e7(0x146)?_0x6cbdf1[0x3]:_0x23df1b||0x1);updateCurrentColorSwatch();const _0x1f9e0b=document[_0x4d27e7(0x160)](_0x4d27e7(0x19d));if(_0x1f9e0b&&currentColor!==_0x4d27e7(0x157))_0x1f9e0b[_0x4d27e7(0x13f)]=currentColor;}catch(_0x120143){console['error']('color\x20picker\x20onChange\x20error',_0x120143);}},'onOk':({hex:_0x437094,rgba:_0xba3a44,a:_0x285113})=>{const _0x158137=_0x5b51c6;_0xba3a44&&_0xba3a44[0x3]===0x0?(currentColor=_0x158137(0x157),currentAlpha=0x0):(currentColor=_0x437094||(_0xba3a44?rgbToHex(_0xba3a44[0x0],_0xba3a44[0x1],_0xba3a44[0x2]):_0x16d920),currentAlpha=_0xba3a44&&typeof _0xba3a44[0x3]===_0x158137(0x146)?_0xba3a44[0x3]:_0x285113||0x1);updateCurrentColorSwatch();const _0x24fd51=document['getElementById']('colorPicker');if(_0x24fd51&&currentColor!==_0x158137(0x157))_0x24fd51[_0x158137(0x13f)]=currentColor;}});}if(_0x43f5c0)_0x43f5c0[_0x10baae(0x1c6)](_0x10baae(0x1a2),_0x5cf27f);if(_0x4ece9e)_0x4ece9e[_0x10baae(0x1c6)]('click',_0x5cf27f);const _0x236dda=document['getElementById']('copyLayerBtn'),_0x60607a=document[_0x10baae(0x160)](_0x10baae(0x1a7));if(_0x236dda)_0x236dda[_0x10baae(0x1c6)]('click',()=>{const _0x474931=_0x10baae;try{copyLayer();}catch(_0x391ad4){console['error'](_0x474931(0x1bb),_0x391ad4);}});_0x60607a&&(_0x60607a['addEventListener'](_0x10baae(0x1a2),()=>{const _0x2ec267=_0x10baae;try{pasteLayer();}catch(_0x2a8a6e){console['error'](_0x2ec267(0x159),_0x2a8a6e);}}),_0x60607a[_0x10baae(0x16f)]=!copiedLayerDataUrl);let _0x203d66=![],_0x5983e7=null;function _0x1af223(_0x3daee1){const _0x1e6105=_0x10baae;if(!_0x3daee1)return![];const _0x18b69a=_0x3daee1[_0x1e6105(0x131)]&&_0x3daee1['tagName'][_0x1e6105(0x16c)]();if(_0x18b69a===_0x1e6105(0x15c)||_0x18b69a===_0x1e6105(0x18e)||_0x18b69a===_0x1e6105(0x15f))return!![];if(_0x3daee1[_0x1e6105(0x1b5)])return!![];return![];}window[_0x10baae(0x1c6)](_0x10baae(0x185),_0x3de5e0=>{const _0x54fad0=_0x10baae;_0x3de5e0[_0x54fad0(0x194)]===_0x54fad0(0x16a)&&!_0x203d66&&!_0x1af223(document[_0x54fad0(0x14c)])&&(_0x5983e7=currentTool,setTool(_0x54fad0(0x130)),_0x203d66=!![]);},{'passive':!![]}),window[_0x10baae(0x1c6)]('keyup',_0x1da0d2=>{const _0x441c5d=_0x10baae;if(_0x1da0d2[_0x441c5d(0x194)]===_0x441c5d(0x16a)&&_0x203d66){if(currentTool===_0x441c5d(0x130)&&_0x5983e7)setTool(_0x5983e7);_0x5983e7=null,_0x203d66=![];}},{'passive':!![]}),window[_0x10baae(0x1c6)](_0x10baae(0x185),_0x58032f=>{const _0x51bcd0=_0x10baae;if(_0x1af223(document[_0x51bcd0(0x14c)]))return;const _0x2b2c93=navigator[_0x51bcd0(0x14d)]&&navigator[_0x51bcd0(0x14d)][_0x51bcd0(0x183)]()[_0x51bcd0(0x148)](_0x51bcd0(0x1b0))>=0x0,_0x5c366f=_0x2b2c93?_0x58032f[_0x51bcd0(0x1b4)]:_0x58032f['ctrlKey'];if(!_0x5c366f)return;const _0xca4607=(_0x58032f[_0x51bcd0(0x194)]||'')[_0x51bcd0(0x16c)]();if(_0xca4607==='z'&&!_0x58032f['shiftKey']){_0x58032f[_0x51bcd0(0x156)]();try{undo();}catch(_0x35bb92){console[_0x51bcd0(0x179)](_0x51bcd0(0x15e),_0x35bb92);}}else{if(_0xca4607==='z'&&_0x58032f[_0x51bcd0(0x1a9)]||_0xca4607==='y'){_0x58032f['preventDefault']();try{redo();}catch(_0x564c1b){console[_0x51bcd0(0x179)](_0x51bcd0(0x173),_0x564c1b);}}}},{'passive':![]}),window[_0x10baae(0x199)]=function(){const _0x4ee1b1=_0x10baae;if(document[_0x4ee1b1(0x160)](_0x4ee1b1(0x1bc)))return;const _0x2e4603=document[_0x4ee1b1(0x154)](_0x4ee1b1(0x18f));_0x2e4603['id']=_0x4ee1b1(0x1bc),_0x2e4603[_0x4ee1b1(0x163)][_0x4ee1b1(0x152)]=_0x4ee1b1(0x1c5),_0x2e4603[_0x4ee1b1(0x163)][_0x4ee1b1(0x18a)]='0',_0x2e4603[_0x4ee1b1(0x163)][_0x4ee1b1(0x1a5)]='0',_0x2e4603[_0x4ee1b1(0x163)]['width']=_0x4ee1b1(0x153),_0x2e4603[_0x4ee1b1(0x163)]['height']=_0x4ee1b1(0x177),_0x2e4603['style']['display']='flex',_0x2e4603[_0x4ee1b1(0x163)]['alignItems']=_0x4ee1b1(0x142),_0x2e4603[_0x4ee1b1(0x163)][_0x4ee1b1(0x133)]=_0x4ee1b1(0x142),_0x2e4603[_0x4ee1b1(0x163)][_0x4ee1b1(0x1c4)]=0x2710,_0x2e4603[_0x4ee1b1(0x163)][_0x4ee1b1(0x178)]=_0x4ee1b1(0x1ac);const _0x180634=window[_0x4ee1b1(0x19f)]||{},_0x5cf8f5=_0x180634[_0x4ee1b1(0x197)]||'不明',_0x5e30c9=_0x180634['id']||'不明';_0x2e4603[_0x4ee1b1(0x15b)]=_0x4ee1b1(0x198)+_0x5cf8f5+_0x4ee1b1(0x1ba)+_0x5e30c9+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>©\x202025\x20nezumi-sketch\x20<a\x20href=\x22https://github.com/mouse0329\x22\x20rel=\x22noopener\x20noreferrer\x22>github\x20mouse0329</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><a\x20href=\x22/terms\x22>利用規約</a>\u3000<a\x20href=\x22/license\x22>ライセンス</a>\u3000<a\x20href=\x22/about\x22>紹介ページ</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:right;margin-top:10px;\x22><button\x20id=\x22aboutCloseBtn\x22>閉じる</button></div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',document[_0x4ee1b1(0x155)][_0x4ee1b1(0x136)](_0x2e4603),_0x2e4603[_0x4ee1b1(0x16b)]('#aboutCloseBtn')[_0x4ee1b1(0x188)]=()=>_0x2e4603['remove'](),_0x2e4603[_0x4ee1b1(0x1c6)](_0x4ee1b1(0x1a2),_0x582d4f=>{const _0x5750a4=_0x4ee1b1;if(_0x582d4f[_0x5750a4(0x17f)]===_0x2e4603)_0x2e4603[_0x5750a4(0x195)]();});};const _0x3ea3cf=document[_0x10baae(0x160)](_0x10baae(0x15d)),_0x204252=document[_0x10baae(0x160)]('nudgeDownBtn'),_0x36f2bb=document[_0x10baae(0x160)]('nudgeLeftBtn'),_0x393011=document[_0x10baae(0x160)](_0x10baae(0x151)),_0x26ccb7=document[_0x10baae(0x160)](_0x10baae(0x1a4));function _0x32e356(){const _0x2e4373=_0x10baae;let _0x4dd834=0x1;if(_0x26ccb7){_0x4dd834=parseInt(_0x26ccb7[_0x2e4373(0x13f)],0xa)||0x1;if(_0x4dd834<0x1)_0x4dd834=0x1;}return _0x4dd834;}if(_0x3ea3cf)_0x3ea3cf[_0x10baae(0x1c6)]('click',()=>nudgeActiveLayer(0x0,-_0x32e356()));if(_0x204252)_0x204252[_0x10baae(0x1c6)](_0x10baae(0x1a2),()=>nudgeActiveLayer(0x0,_0x32e356()));if(_0x36f2bb)_0x36f2bb[_0x10baae(0x1c6)](_0x10baae(0x1a2),()=>nudgeActiveLayer(-_0x32e356(),0x0));if(_0x393011)_0x393011[_0x10baae(0x1c6)](_0x10baae(0x1a2),()=>nudgeActiveLayer(_0x32e356(),0x0));}),window[_0x5dc0d2(0x1bd)]=()=>{const _0x1438cf=_0x5dc0d2;canvas=document['getElementById']('canvas'),wrapper=document['getElementById'](_0x1438cf(0x149))||canvas?.[_0x1438cf(0x1ad)]||null;if(!canvas){console[_0x1438cf(0x179)]('canvas\x20要素が見つからないチュー');return;}ctx=canvas['getContext']('2d'),projects=[createProject()],activeProject=0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),initCanvas(),setTool(_0x1438cf(0x1b9)),updateCurrentColorSwatch(),loadPaletteFromDB()[_0x1438cf(0x174)](()=>createPalette());const _0x1904b0=document['getElementById'](_0x1438cf(0x15a));if(_0x1904b0)_0x1904b0[_0x1438cf(0x13f)]=penSize;const _0x32f440=document[_0x1438cf(0x160)](_0x1438cf(0x17a));if(_0x32f440)_0x32f440[_0x1438cf(0x13f)]=penMode;const _0x2ded2b=document[_0x1438cf(0x160)](_0x1438cf(0x14e)),_0x1b45df=document[_0x1438cf(0x160)](_0x1438cf(0x196));_0x2ded2b&&_0x1b45df&&((!Number[_0x1438cf(0x1b8)](animationDelay)||animationDelay<=0x0)&&(animationDelay=0x12c),_0x2ded2b[_0x1438cf(0x13f)]=animationDelay,_0x1b45df[_0x1438cf(0x13f)]=animationDelay,_0x2ded2b[_0x1438cf(0x140)]=_0x185015=>{const _0x41b8f0=_0x1438cf;_0x1b45df[_0x41b8f0(0x13f)]=_0x185015[_0x41b8f0(0x17f)][_0x41b8f0(0x13f)],setAnimationDelay(_0x185015[_0x41b8f0(0x17f)]['value']);},_0x1b45df[_0x1438cf(0x176)]=_0x4e4a43=>{const _0x490fb3=_0x1438cf;let _0x554dff=Math[_0x490fb3(0x19c)](0xa,Math['min'](0x1388,parseInt(_0x4e4a43[_0x490fb3(0x17f)]['value'],0xa)||animationDelay));_0x2ded2b[_0x490fb3(0x13f)]=_0x554dff,_0x1b45df[_0x490fb3(0x13f)]=_0x554dff,setAnimationDelay(_0x554dff);});canvas['onmousedown']=handleMouseDown,canvas[_0x1438cf(0x143)]=handleMouseMove,canvas[_0x1438cf(0x1b2)]=handleMouseUp,canvas[_0x1438cf(0x184)]=handleMouseUp,canvas[_0x1438cf(0x1aa)]=handleTouchStart,canvas[_0x1438cf(0x164)]=handleTouchMove,canvas[_0x1438cf(0x166)]=handleTouchEnd,canvas[_0x1438cf(0x17b)]=handleTouchEnd,canvas['addEventListener']('touchstart',handleTouchStart,{'passive':![]}),canvas[_0x1438cf(0x1c6)]('touchmove',handleTouchMove,{'passive':![]}),canvas[_0x1438cf(0x1c6)]('touchend',handleTouchEnd,{'passive':![]}),canvas['addEventListener'](_0x1438cf(0x141),handleTouchEnd,{'passive':![]});try{showLoading(_0x1438cf(0x1a3));}catch(_0x65961c){}loadProjectFromIDB()[_0x1438cf(0x12f)](_0x3abd9b=>{const _0x482404=_0x1438cf;console['warn'](_0x482404(0x158),_0x3abd9b);})[_0x1438cf(0x12e)](()=>{const _0x252201=_0x1438cf;try{hideLoading();}catch(_0x2f4c25){}if(typeof window[_0x252201(0x16d)]===_0x252201(0x18b))window['startAutoSaveInterval']();});};function handleMouseDown(_0x317f63){const _0x4e7885=_0x5dc0d2;if(currentTool===_0x4e7885(0x130)){isDrawing=!![],panStart={'x':_0x317f63['clientX'],'y':_0x317f63[_0x4e7885(0x19b)],'posX':posX,'posY':posY},canvas[_0x4e7885(0x163)][_0x4e7885(0x138)]=_0x4e7885(0x190);return;}isDrawing=!![],saveHistory();const _0x38211e=getCanvasCoords(_0x317f63),_0x45fcdd=Math[_0x4e7885(0x144)](_0x38211e['x']/cellSize),_0x1deb12=Math['floor'](_0x38211e['y']/cellSize);currentTool===_0x4e7885(0x1c1)?(fillAt(_0x45fcdd,_0x1deb12),saveHistory(),isDrawing=![],lastMouse=null):(drawDotXY(_0x45fcdd,_0x1deb12),lastMouse={'x':_0x45fcdd,'y':_0x1deb12});}function handleMouseMove(_0x10b405){const _0x1b6b64=_0x5dc0d2;if(!isDrawing)return;if(currentTool===_0x1b6b64(0x130)&&panStart){const _0x95c5ea=_0x10b405[_0x1b6b64(0x150)]-panStart['x'],_0x310573=_0x10b405[_0x1b6b64(0x19b)]-panStart['y'];posX=panStart[_0x1b6b64(0x1bf)]+_0x95c5ea,posY=panStart[_0x1b6b64(0x13a)]+_0x310573,updateTransform();return;}const _0x3270f5=getCanvasCoords(_0x10b405),_0x355d46=Math[_0x1b6b64(0x144)](_0x3270f5['x']/cellSize),_0x547ea3=Math[_0x1b6b64(0x144)](_0x3270f5['y']/cellSize);if(!lastMouse){drawDotXY(_0x355d46,_0x547ea3),lastMouse={'x':_0x355d46,'y':_0x547ea3};return;}const _0x97ac2d=_0x355d46-lastMouse['x'],_0x41eec5=_0x547ea3-lastMouse['y'],_0x2ebe91=Math[_0x1b6b64(0x19c)](Math['abs'](_0x97ac2d),Math[_0x1b6b64(0x14a)](_0x41eec5));if(_0x2ebe91<=0x1)drawDotXY(_0x355d46,_0x547ea3);else for(let _0x5a8f5a=0x1;_0x5a8f5a<=_0x2ebe91;_0x5a8f5a++){const _0x30dee7=Math['round'](lastMouse['x']+_0x97ac2d*_0x5a8f5a/_0x2ebe91),_0x4655e4=Math['round'](lastMouse['y']+_0x41eec5*_0x5a8f5a/_0x2ebe91);drawDotXY(_0x30dee7,_0x4655e4);}lastMouse={'x':_0x355d46,'y':_0x547ea3};}function handleMouseUp(_0x3d9fcd){const _0x871be4=_0x5dc0d2;if(currentTool===_0x871be4(0x130)){isDrawing=![],panStart=null,canvas['style'][_0x871be4(0x138)]=_0x871be4(0x1b3);return;}isDrawing&&saveHistory(),isDrawing=![],lastMouse=null;}function handleTouchStart(_0x55b37f){const _0x1e2574=_0x5dc0d2;if(_0x55b37f[_0x1e2574(0x14f)]['length']===0x2){_0x55b37f['preventDefault'](),isPinching=!![],isDrawing=![],lastTouch=null;const _0x1b5cec=_0x55b37f['touches'][0x0],_0x1edd86=_0x55b37f[_0x1e2574(0x14f)][0x1];pinchStartDistance=Math[_0x1e2574(0x13e)](_0x1edd86[_0x1e2574(0x150)]-_0x1b5cec[_0x1e2574(0x150)],_0x1edd86[_0x1e2574(0x19b)]-_0x1b5cec[_0x1e2574(0x19b)]),pinchStartMid={'clientX':(_0x1b5cec[_0x1e2574(0x150)]+_0x1edd86[_0x1e2574(0x150)])/0x2,'clientY':(_0x1b5cec[_0x1e2574(0x19b)]+_0x1edd86[_0x1e2574(0x19b)])/0x2},pinchStartScale=scale,pinchStartPosX=posX,pinchStartPosY=posY,pinchRect=canvas[_0x1e2574(0x18c)]();}else{if(_0x55b37f['touches'][_0x1e2574(0x13d)]===0x1){if(colorPickMode){_0x55b37f[_0x1e2574(0x156)]();const _0x4a9d3f=_0x55b37f[_0x1e2574(0x14f)][0x0];onCanvasColorPick({'clientX':_0x4a9d3f['clientX'],'clientY':_0x4a9d3f[_0x1e2574(0x19b)]});return;}_0x55b37f[_0x1e2574(0x156)]();if(isPinching)return;const _0x986764=_0x55b37f[_0x1e2574(0x14f)][0x0];if(currentTool==='pan'){isDrawing=!![],panStart={'x':_0x986764[_0x1e2574(0x150)],'y':_0x986764[_0x1e2574(0x19b)],'posX':posX,'posY':posY};if(canvas)canvas[_0x1e2574(0x163)][_0x1e2574(0x138)]=_0x1e2574(0x190);return;}isDrawing=!![],saveHistory();let _0x22f2d6=getTouchPos(_0x55b37f);lastTouch=_0x22f2d6,currentTool===_0x1e2574(0x1c1)?(fillAt(_0x22f2d6['x'],_0x22f2d6['y']),saveHistory(),isDrawing=![]):drawDotTouch(_0x22f2d6['x'],_0x22f2d6['y']);}}}function _0x231b(){const _0x4b2abe=['NEZUMI_BUILD_META','0\x202px\x2010px\x20rgba(0,0,0,0.15)','min','click','自動復元中...','nudgeStep','top','Picked\x20transparent','pasteLayerBtn','nextSibling','shiftKey','ontouchstart','relocateRightToolbar\x20error','rgba(0,0,0,0.35)','parentElement','info','search','MAC','classList','onmouseup','grab','metaKey','isContentEditable','resize','open','isFinite','pen','</b>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20バージョンID:\x20','copyLayer\x20error','about-dialog','onload','DOMContentLoaded','posX','constructor','fill','apply','mobile-open','zIndex','fixed','addEventListener','removeAttribute','parentNode','offsetHeight','finally','catch','pan','tagName','389784QWDbeU','justifyContent','right','right-toolbar','appendChild','8645859uaKfgk','cursor','penAlphaMode','posY','insertBefore','toolbar-mobile','length','hypot','value','oninput','touchcancel','center','onmousemove','floor','4171144HlsNoJ','number','block','indexOf','canvas-container','abs','currentColorSwatch','activeElement','platform','animSpeedRange','touches','clientX','nudgeRightBtn','position','100vw','createElement','body','preventDefault','transparent','IndexedDB\x20からの読み込みに失敗したチュー','pasteLayer\x20error','penSize','innerHTML','input','nudgeUpBtn','undo\x20shortcut\x20error','select','getElementById','toString','619820fRydbb','style','ontouchmove','267190vfscrN','ontouchend','display','padStart','none','Shift','querySelector','toLowerCase','startAutoSaveInterval','inline-block','disabled','55TNkSKg','light','toggle','redo\x20shortcut\x20error','then','getAttribute','onchange','100vh','background','error','penMode','ontouchcancel','innerWidth','bottom','7RUSVMJ','target','add','515278rTrSRy','round','toUpperCase','onmouseleave','keydown','#000000','map','onclick','getItem','left','function','getBoundingClientRect','(((.+)+)+)+$','textarea','div','grabbing','getImageData','zoomSlider','width','key','remove','animSpeedValue','version','\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22background:var(--surface);padding:18px\x2022px;border-radius:10px;min-width:280px;max-width:720px;text-align:left;box-shadow:0\x202px\x2024px\x20rgba(0,0,0,0.25);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:0;\x22>ネズミスケッチについて</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ネズミスケッチは、簡単にドット絵アニメーションを作成できるツールです。</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>バージョン:\x20<b>','showAboutDialog','1709655wzRugl','clientY','max','colorPicker','8px'];_0x231b=function(){return _0x4b2abe;};return _0x231b();}function handleTouchMove(_0x1348e0){const _0x4cd9a7=_0x5dc0d2;if(!_0x1348e0)return;if(isPinching||_0x1348e0['touches']&&_0x1348e0['touches'][_0x4cd9a7(0x13d)]===0x2){_0x1348e0[_0x4cd9a7(0x156)](),isDrawing=![],lastTouch=null;const _0x4a41b1=_0x1348e0['touches'][0x0],_0x204d41=_0x1348e0['touches'][0x1],_0x50b996=Math[_0x4cd9a7(0x13e)](_0x204d41['clientX']-_0x4a41b1[_0x4cd9a7(0x150)],_0x204d41[_0x4cd9a7(0x19b)]-_0x4a41b1['clientY']),_0x58b819={'clientX':(_0x4a41b1[_0x4cd9a7(0x150)]+_0x204d41['clientX'])/0x2,'clientY':(_0x4a41b1[_0x4cd9a7(0x19b)]+_0x204d41[_0x4cd9a7(0x19b)])/0x2};if(!pinchStartDistance)pinchStartDistance=_0x50b996||0x1;let _0x44ca9f=_0x50b996/pinchStartDistance||0x1,_0x436a66=pinchStartScale*_0x44ca9f;_0x436a66=Math[_0x4cd9a7(0x1a1)](Math[_0x4cd9a7(0x19c)](_0x436a66,0.2),0x5);const _0x2fd7f0=pinchRect||canvas[_0x4cd9a7(0x18c)](),_0x34c2c8=(pinchStartMid['clientX']-_0x2fd7f0[_0x4cd9a7(0x18a)]-pinchStartPosX)/pinchStartScale,_0x5d70ca=(pinchStartMid[_0x4cd9a7(0x19b)]-_0x2fd7f0[_0x4cd9a7(0x1a5)]-pinchStartPosY)/pinchStartScale;posX=_0x58b819['clientX']-_0x2fd7f0[_0x4cd9a7(0x18a)]-_0x34c2c8*_0x436a66,posY=_0x58b819['clientY']-_0x2fd7f0[_0x4cd9a7(0x1a5)]-_0x5d70ca*_0x436a66,scale=_0x436a66,updateTransform();return;}if(currentTool===_0x4cd9a7(0x130)&&panStart&&_0x1348e0[_0x4cd9a7(0x14f)]&&_0x1348e0[_0x4cd9a7(0x14f)][0x0]){_0x1348e0[_0x4cd9a7(0x156)]();const _0x5eebb9=_0x1348e0['touches'][0x0],_0x3fbd36=_0x5eebb9[_0x4cd9a7(0x150)]-panStart['x'],_0x1595c9=_0x5eebb9[_0x4cd9a7(0x19b)]-panStart['y'];posX=panStart[_0x4cd9a7(0x1bf)]+_0x3fbd36,posY=panStart[_0x4cd9a7(0x13a)]+_0x1595c9,updateTransform();return;}if(!isDrawing)return;if(_0x1348e0[_0x4cd9a7(0x14f)]&&_0x1348e0['touches'][_0x4cd9a7(0x13d)]>0x1)return;_0x1348e0[_0x4cd9a7(0x156)]();const _0x3c0498=getTouchPos(_0x1348e0);if(!_0x3c0498)return;if(lastTouch){const _0xdfd7a6=Math[_0x4cd9a7(0x14a)]((_0x3c0498['x']-lastTouch['x'])*cellSize),_0xdefc0c=Math[_0x4cd9a7(0x14a)]((_0x3c0498['y']-lastTouch['y'])*cellSize);if(_0xdfd7a6>=PAN_CANCEL_DISTANCE||_0xdefc0c>=PAN_CANCEL_DISTANCE){if(currentTool!==_0x4cd9a7(0x1b9)){isDrawing=![];return;}}}if(lastTouch){const _0x364688=_0x3c0498['x']-lastTouch['x'],_0x4e6f60=_0x3c0498['y']-lastTouch['y'],_0x1e1095=Math[_0x4cd9a7(0x19c)](Math[_0x4cd9a7(0x14a)](_0x364688),Math[_0x4cd9a7(0x14a)](_0x4e6f60));for(let _0x1d5d0d=0x1;_0x1d5d0d<=_0x1e1095;_0x1d5d0d++){const _0x172e15=Math[_0x4cd9a7(0x182)](lastTouch['x']+_0x364688*_0x1d5d0d/_0x1e1095),_0x2339d6=Math[_0x4cd9a7(0x182)](lastTouch['y']+_0x4e6f60*_0x1d5d0d/_0x1e1095);drawDotTouch(_0x172e15,_0x2339d6);}}else drawDotTouch(_0x3c0498['x'],_0x3c0498['y']);lastTouch=_0x3c0498;}function handleTouchEnd(_0x12cd60){const _0x3f26c8=_0x5dc0d2;isPinching&&_0x12cd60[_0x3f26c8(0x14f)]&&_0x12cd60['touches'][_0x3f26c8(0x13d)]<0x2&&(isPinching=![],pinchStartDistance=0x0,pinchStartMid=null,pinchRect=null);isDrawing&&(!_0x12cd60[_0x3f26c8(0x14f)]||_0x12cd60[_0x3f26c8(0x14f)][_0x3f26c8(0x13d)]===0x0)&&saveHistory();if(_0x12cd60[_0x3f26c8(0x14f)]&&_0x12cd60[_0x3f26c8(0x14f)][_0x3f26c8(0x13d)]===0x1){let _0x42fd33=_0x12cd60[_0x3f26c8(0x14f)][0x0];lastTouch=getTouchPos({'touches':[_0x42fd33]}),isDrawing=!![];if(currentTool==='pan'){panStart={'x':_0x42fd33[_0x3f26c8(0x150)],'y':_0x42fd33['clientY'],'posX':posX,'posY':posY};if(canvas)canvas['style']['cursor']=_0x3f26c8(0x190);}}else{isDrawing=![],lastTouch=null;if(currentTool==='pan'){panStart=null;if(canvas)canvas[_0x3f26c8(0x163)][_0x3f26c8(0x138)]='grab';}}}function _0xea2e(_0x304e1f,_0x4b7442){_0x304e1f=_0x304e1f-0x12c;const _0x296c3a=_0x231b();let _0x348ebe=_0x296c3a[_0x304e1f];return _0x348ebe;}function onCanvasColorPick(_0x29ef5f){const _0x387a16=_0x5dc0d2;try{const _0x4d76bf=getCanvasCoords(_0x29ef5f),_0x53df5d=Math[_0x387a16(0x144)](_0x4d76bf['x']),_0x216be7=Math[_0x387a16(0x144)](_0x4d76bf['y']),_0x537616=ctx[_0x387a16(0x191)](_0x53df5d,_0x216be7,0x1,0x1)['data'],_0x1a0d8f=_0x537616[0x0],_0x173c62=_0x537616[0x1],_0x1fa245=_0x537616[0x2],_0x379359=_0x537616[0x3];if(_0x379359===0x0){currentColor=_0x387a16(0x157);const _0x3bb2ae=document[_0x387a16(0x160)](_0x387a16(0x19d));if(_0x3bb2ae)_0x3bb2ae[_0x387a16(0x13f)]=_0x387a16(0x186);console[_0x387a16(0x1ae)](_0x387a16(0x1a6));}else{const _0x18e522='#'+[_0x1a0d8f,_0x173c62,_0x1fa245][_0x387a16(0x187)](_0x595cc2=>_0x595cc2[_0x387a16(0x161)](0x10)[_0x387a16(0x168)](0x2,'0'))['join']('');currentColor=_0x18e522;const _0x1b4173=document[_0x387a16(0x160)]('colorPicker');if(_0x1b4173)_0x1b4173[_0x387a16(0x13f)]=_0x18e522;console[_0x387a16(0x1ae)]('Picked\x20color',_0x18e522);}}catch(_0x1bb471){console[_0x387a16(0x179)]('onCanvasColorPick\x20error',_0x1bb471);}colorPickMode=![];if(canvas)canvas[_0x387a16(0x163)][_0x387a16(0x138)]='default';}