const _0x26e9a9=_0x515b;(function(_0x10f954,_0x294ba7){const _0x2f7332=_0x515b,_0x481186=_0x10f954();while(!![]){try{const _0xc5dc13=-parseInt(_0x2f7332(0xb6))/0x1*(-parseInt(_0x2f7332(0xd7))/0x2)+parseInt(_0x2f7332(0x10d))/0x3*(parseInt(_0x2f7332(0xd1))/0x4)+parseInt(_0x2f7332(0xce))/0x5+parseInt(_0x2f7332(0xbe))/0x6*(-parseInt(_0x2f7332(0x104))/0x7)+parseInt(_0x2f7332(0xef))/0x8*(-parseInt(_0x2f7332(0xe0))/0x9)+-parseInt(_0x2f7332(0xb7))/0xa*(parseInt(_0x2f7332(0xca))/0xb)+parseInt(_0x2f7332(0x126))/0xc;if(_0xc5dc13===_0x294ba7)break;else _0x481186['push'](_0x481186['shift']());}catch(_0xdcd04d){_0x481186['push'](_0x481186['shift']());}}}(_0x57e6,0xaf2cd));function _0x515b(_0x4fa764,_0x114338){_0x4fa764=_0x4fa764-0xa1;const _0x4707fb=_0x57e6();let _0x5e181d=_0x4707fb[_0x4fa764];return _0x5e181d;}const _0x4e1d17=(function(){let _0x1e86b4=!![];return function(_0xf0e580,_0x3e8996){const _0x263f81=_0x1e86b4?function(){if(_0x3e8996){const _0x2be468=_0x3e8996['apply'](_0xf0e580,arguments);return _0x3e8996=null,_0x2be468;}}:function(){};return _0x1e86b4=![],_0x263f81;};}()),_0x5e181d=_0x4e1d17(this,function(){const _0x241567=_0x515b;return _0x5e181d[_0x241567(0xae)]()['search'](_0x241567(0x132))[_0x241567(0xae)]()['constructor'](_0x5e181d)[_0x241567(0xa7)](_0x241567(0x132));});_0x5e181d(),window[_0x26e9a9(0xa3)](_0x26e9a9(0xd5),()=>{const _0x4d9256=_0x26e9a9,_0x591202=document['getElementById'](_0x4d9256(0x102));_0x591202&&(_0x591202['value']=penAlphaMode,_0x591202['onchange']=_0x676f06=>{const _0x3295e2=_0x4d9256;penAlphaMode=_0x676f06[_0x3295e2(0xf6)][_0x3295e2(0xea)];});const _0x45b4aa=document[_0x4d9256(0xfe)](_0x4d9256(0x10f));if(_0x45b4aa){const _0x4aa5c8=localStorage[_0x4d9256(0x120)](_0x4d9256(0xbc))||_0x4d9256(0x118);applyTheme(_0x4aa5c8),_0x45b4aa['addEventListener'](_0x4d9256(0xcb),()=>{toggleTheme();});}window[_0x4d9256(0xa3)](_0x4d9256(0xa2),updateMenuBtnDisplay),updateMenuBtnDisplay();const _0x125d3d=document[_0x4d9256(0xfe)]('toolsToggleBtn'),_0x210d3e=document[_0x4d9256(0xfe)](_0x4d9256(0xe6)),_0x5d1cac=document[_0x4d9256(0xfe)]('right-toolbar'),_0x1759f6=document['querySelector'](_0x4d9256(0x12d)),_0xe245dc=document['querySelector']('footer'),_0x4d910f=_0x5d1cac?_0x5d1cac[_0x4d9256(0x10c)]:null,_0x254d9d=_0x5d1cac?_0x5d1cac[_0x4d9256(0xb4)]:null;let _0x38642d=null;function _0x5e29ee(){const _0x5eb389=_0x4d9256;try{if(!_0x5d1cac)return;const _0xad4f47=window[_0x5eb389(0xd4)],_0x573c6d=_0xad4f47<=0x384;if(_0x573c6d&&_0x1759f6&&_0x5d1cac[_0x5eb389(0x10c)]!==_0x1759f6){if(_0x38642d===null)_0x38642d=_0x5d1cac['getAttribute'](_0x5eb389(0xc7))||'';_0x1759f6[_0x5eb389(0x11d)](_0x5d1cac),_0x5d1cac['classList']['add'](_0x5eb389(0xde));const _0x31e6d4=_0xe245dc?_0xe245dc['offsetHeight']:0x38;_0x5d1cac['style']['position']=_0x5eb389(0xfd),_0x5d1cac[_0x5eb389(0xc7)][_0x5eb389(0x11b)]='8px',_0x5d1cac[_0x5eb389(0xc7)][_0x5eb389(0xdd)]=_0x5eb389(0xc2),_0x5d1cac[_0x5eb389(0xc7)][_0x5eb389(0xb8)]=_0x31e6d4+0x8+'px',_0x5d1cac[_0x5eb389(0xc7)][_0x5eb389(0xad)]=0x1770,_0x5d1cac['style']['width']=_0x5eb389(0x109),_0x5d1cac[_0x5eb389(0xc7)][_0x5eb389(0x12f)]=_0x5eb389(0xf3),_0x5d1cac['style'][_0x5eb389(0x110)]=_0x5eb389(0xe4);}else{if(!_0x573c6d&&_0x4d910f&&_0x5d1cac[_0x5eb389(0x10c)]!==_0x4d910f){_0x254d9d&&_0x254d9d[_0x5eb389(0x10c)]===_0x4d910f?_0x4d910f[_0x5eb389(0xc8)](_0x5d1cac,_0x254d9d):_0x4d910f['appendChild'](_0x5d1cac);_0x5d1cac[_0x5eb389(0xcd)][_0x5eb389(0x12a)](_0x5eb389(0xde));if(_0x38642d!==null){if(_0x38642d==='')_0x5d1cac[_0x5eb389(0x115)]('style');else _0x5d1cac[_0x5eb389(0x138)](_0x5eb389(0xc7),_0x38642d);_0x38642d=null;}}else{if(_0x573c6d&&_0x5d1cac[_0x5eb389(0x10c)]===_0x1759f6){const _0x23299b=_0xe245dc?_0xe245dc[_0x5eb389(0x10a)]:0x38;_0x5d1cac[_0x5eb389(0xc7)][_0x5eb389(0xb8)]=_0x23299b+0x8+'px';}}}}catch(_0xd33ff0){console[_0x5eb389(0x11f)](_0x5eb389(0xed),_0xd33ff0);}}_0x125d3d&&(_0x125d3d[_0x4d9256(0xc7)][_0x4d9256(0x110)]=_0x4d9256(0xcf),_0x125d3d[_0x4d9256(0xa3)](_0x4d9256(0xcb),()=>{const _0x4da04e=_0x4d9256;if(window[_0x4da04e(0xd4)]<=0x384&&_0x5d1cac){const _0xf436a2=_0x5d1cac['style'][_0x4da04e(0x110)]!==_0x4da04e(0xe4);_0x5d1cac[_0x4da04e(0xc7)][_0x4da04e(0x110)]=_0xf436a2?_0x4da04e(0xe4):_0x4da04e(0x130),_0x5d1cac[_0x4da04e(0xcd)][_0x4da04e(0xba)](_0x4da04e(0x139),!_0xf436a2);}else _0x210d3e&&_0x210d3e[_0x4da04e(0xcd)][_0x4da04e(0xba)](_0x4da04e(0x121));}));window[_0x4d9256(0xa3)](_0x4d9256(0xa2),_0x5e29ee),_0x5e29ee();const _0x43aa1b=document[_0x4d9256(0xfe)](_0x4d9256(0x106));_0x43aa1b&&(_0x43aa1b[_0x4d9256(0xa9)]=_0x102df0=>setZoomValue(_0x102df0[_0x4d9256(0xf6)][_0x4d9256(0xea)]));const _0x367fc8=document['getElementById']('openColorPickerBtn'),_0x455baf=document[_0x4d9256(0xfe)](_0x4d9256(0x114));function _0x30cc3b(){const _0x153fdd=_0x4d9256;if(typeof showColorPickerDialog!=='function')return;const _0xd299db=currentColor==='transparent'||!currentColor?_0x153fdd(0xe1):currentColor;showColorPickerDialog({'color':_0xd299db,'alpha':typeof currentAlpha===_0x153fdd(0x124)?currentAlpha:0x1,'onChange':({hex:_0x4e4a59,rgba:_0x5a884a,a:_0x5ab767})=>{const _0x522523=_0x153fdd;try{_0x5a884a&&_0x5a884a[0x3]===0x0?(currentColor=_0x522523(0x116),currentAlpha=0x0):(currentColor=_0x4e4a59||(_0x5a884a?rgbToHex(_0x5a884a[0x0],_0x5a884a[0x1],_0x5a884a[0x2]):_0xd299db),currentAlpha=_0x5a884a&&typeof _0x5a884a[0x3]===_0x522523(0x124)?_0x5a884a[0x3]:_0x5ab767||0x1);updateCurrentColorSwatch();const _0x26b6d8=document[_0x522523(0xfe)](_0x522523(0xc0));if(_0x26b6d8&&currentColor!=='transparent')_0x26b6d8[_0x522523(0xea)]=currentColor;}catch(_0x4d73c5){console[_0x522523(0x11f)]('color\x20picker\x20onChange\x20error',_0x4d73c5);}},'onOk':({hex:_0x3b50fe,rgba:_0x410fd1,a:_0x21f370})=>{const _0x1f01bb=_0x153fdd;_0x410fd1&&_0x410fd1[0x3]===0x0?(currentColor=_0x1f01bb(0x116),currentAlpha=0x0):(currentColor=_0x3b50fe||(_0x410fd1?rgbToHex(_0x410fd1[0x0],_0x410fd1[0x1],_0x410fd1[0x2]):_0xd299db),currentAlpha=_0x410fd1&&typeof _0x410fd1[0x3]==='number'?_0x410fd1[0x3]:_0x21f370||0x1);updateCurrentColorSwatch();const _0xa2b5e3=document[_0x1f01bb(0xfe)](_0x1f01bb(0xc0));if(_0xa2b5e3&&currentColor!==_0x1f01bb(0x116))_0xa2b5e3[_0x1f01bb(0xea)]=currentColor;}});}if(_0x367fc8)_0x367fc8[_0x4d9256(0xa3)](_0x4d9256(0xcb),_0x30cc3b);if(_0x455baf)_0x455baf[_0x4d9256(0xa3)](_0x4d9256(0xcb),_0x30cc3b);let _0x41ecc9=![],_0xb77926=null;function _0x349f38(_0x5fd5cc){const _0x56bc2e=_0x4d9256;if(!_0x5fd5cc)return![];const _0xf94d4e=_0x5fd5cc[_0x56bc2e(0x137)]&&_0x5fd5cc['tagName']['toLowerCase']();if(_0xf94d4e===_0x56bc2e(0xe7)||_0xf94d4e===_0x56bc2e(0xf5)||_0xf94d4e===_0x56bc2e(0x12c))return!![];if(_0x5fd5cc['isContentEditable'])return!![];return![];}window[_0x4d9256(0xa3)](_0x4d9256(0x127),_0x2f0ba5=>{const _0x3196aa=_0x4d9256;_0x2f0ba5[_0x3196aa(0xec)]==='Shift'&&!_0x41ecc9&&!_0x349f38(document[_0x3196aa(0x136)])&&(_0xb77926=currentTool,setTool(_0x3196aa(0xc5)),_0x41ecc9=!![]);},{'passive':!![]}),window[_0x4d9256(0xa3)](_0x4d9256(0x10b),_0x1efa40=>{const _0x951144=_0x4d9256;if(_0x1efa40['key']===_0x951144(0x12e)&&_0x41ecc9){if(currentTool===_0x951144(0xc5)&&_0xb77926)setTool(_0xb77926);_0xb77926=null,_0x41ecc9=![];}},{'passive':!![]}),window[_0x4d9256(0xa3)](_0x4d9256(0x127),_0x59775a=>{const _0x4ffcc2=_0x4d9256;if(_0x349f38(document[_0x4ffcc2(0x136)]))return;const _0x2e158a=navigator[_0x4ffcc2(0x122)]&&navigator[_0x4ffcc2(0x122)]['toUpperCase']()[_0x4ffcc2(0xa6)]('MAC')>=0x0,_0x1a5400=_0x2e158a?_0x59775a[_0x4ffcc2(0x123)]:_0x59775a['ctrlKey'];if(!_0x1a5400)return;const _0x2c9d71=(_0x59775a[_0x4ffcc2(0xec)]||'')[_0x4ffcc2(0xe3)]();if(_0x2c9d71==='z'&&!_0x59775a[_0x4ffcc2(0xff)]){_0x59775a[_0x4ffcc2(0x133)]();try{undo();}catch(_0x384ed3){console[_0x4ffcc2(0x11f)](_0x4ffcc2(0xfc),_0x384ed3);}}else{if(_0x2c9d71==='z'&&_0x59775a[_0x4ffcc2(0xff)]||_0x2c9d71==='y'){_0x59775a[_0x4ffcc2(0x133)]();try{redo();}catch(_0x274cde){console[_0x4ffcc2(0x11f)](_0x4ffcc2(0xb2),_0x274cde);}}}},{'passive':![]}),window[_0x4d9256(0xf7)]=function(){const _0x249cc0=_0x4d9256;if(document['getElementById']('about-dialog'))return;const _0x466ec2=document[_0x249cc0(0xb1)](_0x249cc0(0xc9));_0x466ec2['id']='about-dialog',_0x466ec2['style']['position']=_0x249cc0(0xfd),_0x466ec2['style'][_0x249cc0(0x11b)]='0',_0x466ec2[_0x249cc0(0xc7)][_0x249cc0(0x11c)]='0',_0x466ec2['style']['width']=_0x249cc0(0x134),_0x466ec2[_0x249cc0(0xc7)][_0x249cc0(0xb3)]=_0x249cc0(0x128),_0x466ec2[_0x249cc0(0xc7)][_0x249cc0(0x110)]=_0x249cc0(0xaf),_0x466ec2[_0x249cc0(0xc7)]['alignItems']=_0x249cc0(0x113),_0x466ec2[_0x249cc0(0xc7)][_0x249cc0(0xbb)]=_0x249cc0(0x113),_0x466ec2[_0x249cc0(0xc7)][_0x249cc0(0xad)]=0x2710,_0x466ec2[_0x249cc0(0xc7)][_0x249cc0(0xe8)]='rgba(0,0,0,0.35)',_0x466ec2[_0x249cc0(0xf1)]='\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22background:var(--surface);padding:18px\x2022px;border-radius:10px;min-width:280px;max-width:720px;text-align:left;box-shadow:0\x202px\x2024px\x20rgba(0,0,0,0.25);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:0;\x22>ネズミスケッチについて</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ネズミスケッチは、簡単にドット絵アニメーションを作成できるツールです。</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>©\x202025\x20nezumi-sketch\x20<a\x20href=\x22https://github.com/mouse0329\x22\x20rel=\x22noopener\x20noreferrer\x22>github\x20mouse0329</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><a\x20href=\x22/terms\x22>利用規約</a>\u3000<a\x20href=\x22/license\x22>ライセンス</a>\u3000<a\x20href=\x22/about\x22>紹介ページ</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:right;margin-top:10px;\x22><button\x20id=\x22aboutCloseBtn\x22>閉じる</button></div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',document[_0x249cc0(0xa5)][_0x249cc0(0x11d)](_0x466ec2),_0x466ec2[_0x249cc0(0xf8)]('#aboutCloseBtn')[_0x249cc0(0x125)]=()=>_0x466ec2['remove'](),_0x466ec2[_0x249cc0(0xa3)](_0x249cc0(0xcb),_0xa2101d=>{const _0x2cba8c=_0x249cc0;if(_0xa2101d[_0x2cba8c(0xf6)]===_0x466ec2)_0x466ec2[_0x2cba8c(0x12a)]();});};const _0x45d0cd=document[_0x4d9256(0xfe)](_0x4d9256(0xcc)),_0x8f3e56=document[_0x4d9256(0xfe)](_0x4d9256(0xe9)),_0x483998=document[_0x4d9256(0xfe)](_0x4d9256(0x105)),_0x167a7d=document[_0x4d9256(0xfe)](_0x4d9256(0x12b)),_0x761b9e=document[_0x4d9256(0xfe)]('nudgeStep');function _0x315c82(){const _0x20dadb=_0x4d9256;let _0x367f7e=0x1;if(_0x761b9e){_0x367f7e=parseInt(_0x761b9e[_0x20dadb(0xea)],0xa)||0x1;if(_0x367f7e<0x1)_0x367f7e=0x1;}return _0x367f7e;}if(_0x45d0cd)_0x45d0cd['addEventListener'](_0x4d9256(0xcb),()=>nudgeActiveLayer(0x0,-_0x315c82()));if(_0x8f3e56)_0x8f3e56['addEventListener'](_0x4d9256(0xcb),()=>nudgeActiveLayer(0x0,_0x315c82()));if(_0x483998)_0x483998[_0x4d9256(0xa3)](_0x4d9256(0xcb),()=>nudgeActiveLayer(-_0x315c82(),0x0));if(_0x167a7d)_0x167a7d[_0x4d9256(0xa3)](_0x4d9256(0xcb),()=>nudgeActiveLayer(_0x315c82(),0x0));}),window[_0x26e9a9(0xdc)]=()=>{const _0x4fb3c3=_0x26e9a9;canvas=document[_0x4fb3c3(0xfe)](_0x4fb3c3(0xb0)),wrapper=document[_0x4fb3c3(0xfe)](_0x4fb3c3(0xc3))||canvas?.[_0x4fb3c3(0x11e)]||null;if(!canvas){console[_0x4fb3c3(0x11f)](_0x4fb3c3(0xc1));return;}ctx=canvas['getContext']('2d'),projects=[createProject()],activeProject=0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),initCanvas(),setTool(_0x4fb3c3(0x100)),updateCurrentColorSwatch(),loadPaletteFromDB()['then'](()=>createPalette());const _0x1a3f82=document[_0x4fb3c3(0xfe)](_0x4fb3c3(0xdf));if(_0x1a3f82)_0x1a3f82[_0x4fb3c3(0xea)]=penSize;const _0x384e4b=document[_0x4fb3c3(0xfe)](_0x4fb3c3(0xc6));if(_0x384e4b)_0x384e4b['value']=penMode;const _0x38ef09=document['getElementById'](_0x4fb3c3(0x112)),_0xdacd5=document[_0x4fb3c3(0xfe)](_0x4fb3c3(0xda));_0x38ef09&&_0xdacd5&&((!Number[_0x4fb3c3(0xe2)](animationDelay)||animationDelay<=0x0)&&(animationDelay=0x12c),_0x38ef09['value']=animationDelay,_0xdacd5[_0x4fb3c3(0xea)]=animationDelay,_0x38ef09['oninput']=_0x381b70=>{const _0xd4377d=_0x4fb3c3;_0xdacd5[_0xd4377d(0xea)]=_0x381b70[_0xd4377d(0xf6)]['value'],setAnimationDelay(_0x381b70[_0xd4377d(0xf6)][_0xd4377d(0xea)]);},_0xdacd5[_0x4fb3c3(0xbf)]=_0x3d51a8=>{const _0x2178cc=_0x4fb3c3;let _0xd8095=Math[_0x2178cc(0xf2)](0xa,Math[_0x2178cc(0xa1)](0x1388,parseInt(_0x3d51a8[_0x2178cc(0xf6)][_0x2178cc(0xea)],0xa)||animationDelay));_0x38ef09[_0x2178cc(0xea)]=_0xd8095,_0xdacd5[_0x2178cc(0xea)]=_0xd8095,setAnimationDelay(_0xd8095);});canvas[_0x4fb3c3(0xac)]=handleMouseDown,canvas[_0x4fb3c3(0x103)]=handleMouseMove,canvas['onmouseup']=handleMouseUp,canvas[_0x4fb3c3(0x10e)]=handleMouseUp,canvas[_0x4fb3c3(0xab)]=handleTouchStart,canvas[_0x4fb3c3(0xd2)]=handleTouchMove,canvas['ontouchend']=handleTouchEnd,canvas[_0x4fb3c3(0x131)]=handleTouchEnd,canvas['addEventListener'](_0x4fb3c3(0xf9),handleTouchStart,{'passive':![]}),canvas[_0x4fb3c3(0xa3)]('touchmove',handleTouchMove,{'passive':![]}),canvas[_0x4fb3c3(0xa3)](_0x4fb3c3(0xd0),handleTouchEnd,{'passive':![]}),canvas[_0x4fb3c3(0xa3)](_0x4fb3c3(0xf0),handleTouchEnd,{'passive':![]});try{showLoading(_0x4fb3c3(0xd3));}catch(_0x37c9e6){}loadProjectFromIDB()[_0x4fb3c3(0xa8)](_0x5790c7=>{const _0x340b34=_0x4fb3c3;console[_0x340b34(0x101)](_0x340b34(0xbd),_0x5790c7);})[_0x4fb3c3(0xd6)](()=>{const _0x412ec8=_0x4fb3c3;try{hideLoading();}catch(_0x3ec2cb){}if(typeof window['startAutoSaveInterval']===_0x412ec8(0x111))window['startAutoSaveInterval']();});};function handleMouseDown(_0x387481){const _0xac8171=_0x26e9a9;if(currentTool===_0xac8171(0xc5)){isDrawing=!![],panStart={'x':_0x387481[_0xac8171(0x107)],'y':_0x387481[_0xac8171(0xb5)],'posX':posX,'posY':posY},canvas[_0xac8171(0xc7)]['cursor']=_0xac8171(0xd9);return;}isDrawing=!![],saveHistory();const _0x133440=getCanvasCoords(_0x387481),_0x378b89=Math[_0xac8171(0x119)](_0x133440['x']/cellSize),_0x276571=Math[_0xac8171(0x119)](_0x133440['y']/cellSize);currentTool===_0xac8171(0xdb)?(fillAt(_0x378b89,_0x276571),saveHistory(),isDrawing=![],lastMouse=null):(drawDotXY(_0x378b89,_0x276571),lastMouse={'x':_0x378b89,'y':_0x276571});}function handleMouseMove(_0x328def){const _0x210e74=_0x26e9a9;if(!isDrawing)return;if(currentTool==='pan'&&panStart){const _0x4a9f2b=_0x328def[_0x210e74(0x107)]-panStart['x'],_0x3c67a7=_0x328def[_0x210e74(0xb5)]-panStart['y'];posX=panStart[_0x210e74(0x11a)]+_0x4a9f2b,posY=panStart['posY']+_0x3c67a7,updateTransform();return;}const _0x2c8529=getCanvasCoords(_0x328def),_0x39fab5=Math[_0x210e74(0x119)](_0x2c8529['x']/cellSize),_0x4b2ad3=Math['floor'](_0x2c8529['y']/cellSize);if(!lastMouse){drawDotXY(_0x39fab5,_0x4b2ad3),lastMouse={'x':_0x39fab5,'y':_0x4b2ad3};return;}const _0x2457f9=_0x39fab5-lastMouse['x'],_0x9686c=_0x4b2ad3-lastMouse['y'],_0x2e81ce=Math['max'](Math[_0x210e74(0x135)](_0x2457f9),Math[_0x210e74(0x135)](_0x9686c));if(_0x2e81ce<=0x1)drawDotXY(_0x39fab5,_0x4b2ad3);else for(let _0x36dfd5=0x1;_0x36dfd5<=_0x2e81ce;_0x36dfd5++){const _0x53a2d0=Math[_0x210e74(0xd8)](lastMouse['x']+_0x2457f9*_0x36dfd5/_0x2e81ce),_0x158795=Math[_0x210e74(0xd8)](lastMouse['y']+_0x9686c*_0x36dfd5/_0x2e81ce);drawDotXY(_0x53a2d0,_0x158795);}lastMouse={'x':_0x39fab5,'y':_0x4b2ad3};}function handleMouseUp(_0x5491d6){const _0x40189f=_0x26e9a9;if(currentTool===_0x40189f(0xc5)){isDrawing=![],panStart=null,canvas[_0x40189f(0xc7)][_0x40189f(0xeb)]=_0x40189f(0xb9);return;}isDrawing&&saveHistory(),isDrawing=![],lastMouse=null;}function handleTouchStart(_0x58682e){const _0x381828=_0x26e9a9;if(_0x58682e['touches'][_0x381828(0xa4)]===0x2){_0x58682e['preventDefault'](),isPinching=!![],isDrawing=![],lastTouch=null;const _0x1bd098=_0x58682e[_0x381828(0xe5)][0x0],_0x1e9c69=_0x58682e['touches'][0x1];pinchStartDistance=Math[_0x381828(0xaa)](_0x1e9c69['clientX']-_0x1bd098[_0x381828(0x107)],_0x1e9c69[_0x381828(0xb5)]-_0x1bd098[_0x381828(0xb5)]),pinchStartMid={'clientX':(_0x1bd098[_0x381828(0x107)]+_0x1e9c69[_0x381828(0x107)])/0x2,'clientY':(_0x1bd098[_0x381828(0xb5)]+_0x1e9c69['clientY'])/0x2},pinchStartScale=scale,pinchStartPosX=posX,pinchStartPosY=posY,pinchRect=canvas[_0x381828(0x117)]();}else{if(_0x58682e['touches']['length']===0x1){if(colorPickMode){_0x58682e[_0x381828(0x133)]();const _0x41f2c3=_0x58682e[_0x381828(0xe5)][0x0];onCanvasColorPick({'clientX':_0x41f2c3[_0x381828(0x107)],'clientY':_0x41f2c3[_0x381828(0xb5)]});return;}_0x58682e[_0x381828(0x133)]();if(isPinching)return;isDrawing=!![],saveHistory();let _0x1b1e58=getTouchPos(_0x58682e);lastTouch=_0x1b1e58,currentTool===_0x381828(0xdb)?(fillAt(_0x1b1e58['x'],_0x1b1e58['y']),saveHistory(),isDrawing=![]):drawDotTouch(_0x1b1e58['x'],_0x1b1e58['y']);}}}function handleTouchMove(_0x80e4ae){const _0x6b69b7=_0x26e9a9;if(isPinching||_0x80e4ae[_0x6b69b7(0xe5)]&&_0x80e4ae[_0x6b69b7(0xe5)][_0x6b69b7(0xa4)]===0x2){_0x80e4ae['preventDefault'](),isDrawing=![],lastTouch=null;const _0x47dbac=_0x80e4ae['touches'][0x0],_0xe96c36=_0x80e4ae[_0x6b69b7(0xe5)][0x1],_0x2565e5=Math['hypot'](_0xe96c36[_0x6b69b7(0x107)]-_0x47dbac['clientX'],_0xe96c36[_0x6b69b7(0xb5)]-_0x47dbac['clientY']),_0x563f84={'clientX':(_0x47dbac[_0x6b69b7(0x107)]+_0xe96c36[_0x6b69b7(0x107)])/0x2,'clientY':(_0x47dbac[_0x6b69b7(0xb5)]+_0xe96c36[_0x6b69b7(0xb5)])/0x2};if(!pinchStartDistance)pinchStartDistance=_0x2565e5||0x1;const _0x39e67a=_0x2565e5/pinchStartDistance||0x1;let _0xb65a6a=pinchStartScale*_0x39e67a;_0xb65a6a=Math[_0x6b69b7(0xa1)](Math[_0x6b69b7(0xf2)](_0xb65a6a,0.2),0x5);const _0x2048da=pinchRect||canvas['getBoundingClientRect'](),_0x5d2ebe=(pinchStartMid[_0x6b69b7(0x107)]-_0x2048da[_0x6b69b7(0x11b)]-pinchStartPosX)/pinchStartScale,_0x2a1786=(pinchStartMid[_0x6b69b7(0xb5)]-_0x2048da[_0x6b69b7(0x11c)]-pinchStartPosY)/pinchStartScale;posX=_0x563f84[_0x6b69b7(0x107)]-_0x2048da[_0x6b69b7(0x11b)]-_0x5d2ebe*_0xb65a6a,posY=_0x563f84['clientY']-_0x2048da[_0x6b69b7(0x11c)]-_0x2a1786*_0xb65a6a,scale=_0xb65a6a,updateTransform();return;}if(!isDrawing)return;if(_0x80e4ae['touches']&&_0x80e4ae['touches'][_0x6b69b7(0xa4)]>0x1)return;_0x80e4ae[_0x6b69b7(0x133)]();let _0x5c1165=getTouchPos(_0x80e4ae);if(lastTouch){let _0x543e53=Math[_0x6b69b7(0x135)]((_0x5c1165['x']-lastTouch['x'])*cellSize),_0x1f1df6=Math['abs']((_0x5c1165['y']-lastTouch['y'])*cellSize);if(_0x543e53>=PAN_CANCEL_DISTANCE||_0x1f1df6>=PAN_CANCEL_DISTANCE){if(currentTool!==_0x6b69b7(0x100)){isDrawing=![];return;}}}if(lastTouch){let _0x2401e1=_0x5c1165['x']-lastTouch['x'],_0x4e76e4=_0x5c1165['y']-lastTouch['y'],_0x2a8d44=Math[_0x6b69b7(0xf2)](Math[_0x6b69b7(0x135)](_0x2401e1),Math[_0x6b69b7(0x135)](_0x4e76e4));for(let _0x2b7540=0x1;_0x2b7540<=_0x2a8d44;_0x2b7540++){let _0x53a795=Math[_0x6b69b7(0xd8)](lastTouch['x']+_0x2401e1*_0x2b7540/_0x2a8d44),_0x4230c5=Math[_0x6b69b7(0xd8)](lastTouch['y']+_0x4e76e4*_0x2b7540/_0x2a8d44);drawDotTouch(_0x53a795,_0x4230c5);}}else drawDotTouch(_0x5c1165['x'],_0x5c1165['y']);lastTouch=_0x5c1165;}function handleTouchEnd(_0x58c39f){const _0x3767ce=_0x26e9a9;isPinching&&_0x58c39f[_0x3767ce(0xe5)]&&_0x58c39f[_0x3767ce(0xe5)][_0x3767ce(0xa4)]<0x2&&(isPinching=![],pinchStartDistance=0x0,pinchStartMid=null,pinchRect=null);isDrawing&&(!_0x58c39f[_0x3767ce(0xe5)]||_0x58c39f[_0x3767ce(0xe5)][_0x3767ce(0xa4)]===0x0)&&saveHistory();if(_0x58c39f[_0x3767ce(0xe5)]&&_0x58c39f[_0x3767ce(0xe5)][_0x3767ce(0xa4)]===0x1){let _0x4c5715=_0x58c39f[_0x3767ce(0xe5)][0x0];lastTouch=getTouchPos({'touches':[_0x4c5715]}),isDrawing=!![];}else isDrawing=![],lastTouch=null;}function onCanvasColorPick(_0x5447f7){const _0xb880b7=_0x26e9a9;try{const _0x388dc5=getCanvasCoords(_0x5447f7),_0x158cc8=Math[_0xb880b7(0x119)](_0x388dc5['x']),_0xf94497=Math[_0xb880b7(0x119)](_0x388dc5['y']),_0x2ce9a2=ctx[_0xb880b7(0xfa)](_0x158cc8,_0xf94497,0x1,0x1)[_0xb880b7(0xf4)],_0x183bb0=_0x2ce9a2[0x0],_0x120a26=_0x2ce9a2[0x1],_0xfa19ed=_0x2ce9a2[0x2],_0x54ccad=_0x2ce9a2[0x3];if(_0x54ccad===0x0){currentColor=_0xb880b7(0x116);const _0x5b95e4=document['getElementById'](_0xb880b7(0xc0));if(_0x5b95e4)_0x5b95e4[_0xb880b7(0xea)]=_0xb880b7(0xe1);console[_0xb880b7(0xc4)](_0xb880b7(0x129));}else{const _0x1abc66='#'+[_0x183bb0,_0x120a26,_0xfa19ed]['map'](_0x369c1d=>_0x369c1d[_0xb880b7(0xae)](0x10)['padStart'](0x2,'0'))[_0xb880b7(0x108)]('');currentColor=_0x1abc66;const _0x49aa0e=document[_0xb880b7(0xfe)](_0xb880b7(0xc0));if(_0x49aa0e)_0x49aa0e[_0xb880b7(0xea)]=_0x1abc66;console[_0xb880b7(0xc4)]('Picked\x20color',_0x1abc66);}}catch(_0x685dca){console[_0xb880b7(0x11f)](_0xb880b7(0xee),_0x685dca);}colorPickMode=![];if(canvas)canvas['style'][_0xb880b7(0xeb)]=_0xb880b7(0xfb);}function _0x57e6(){const _0x2dcb93=['div','11EFAXwh','click','nudgeUpBtn','classList','5671185YYsHrM','inline-block','touchend','6608iRQFaj','ontouchmove','自動復元中...','innerWidth','DOMContentLoaded','finally','4RsKTNa','round','grabbing','animSpeedValue','fill','onload','right','toolbar-mobile','penSize','18xjdOhp','#000000','isFinite','toLowerCase','none','touches','right-panel','input','background','nudgeDownBtn','value','cursor','key','relocateRightToolbar\x20error','onCanvasColorPick\x20error','4710968EkAXoi','touchcancel','innerHTML','max','0\x202px\x2010px\x20rgba(0,0,0,0.15)','data','textarea','target','showAboutDialog','querySelector','touchstart','getImageData','default','undo\x20shortcut\x20error','fixed','getElementById','shiftKey','pen','warn','penAlphaMode','onmousemove','148239BahjxD','nudgeLeftBtn','zoomSlider','clientX','join','auto','offsetHeight','keyup','parentNode','1659bkNXKV','onmouseleave','themeToggleBtn','display','function','animSpeedRange','center','currentColorSwatch','removeAttribute','transparent','getBoundingClientRect','light','floor','posX','left','top','appendChild','parentElement','error','getItem','open','platform','metaKey','number','onclick','9453012iUJkNx','keydown','100vh','Picked\x20transparent','remove','nudgeRightBtn','select','.tool-btn-container','Shift','boxShadow','block','ontouchcancel','(((.+)+)+)+$','preventDefault','100vw','abs','activeElement','tagName','setAttribute','mobile-open','min','resize','addEventListener','length','body','indexOf','search','catch','oninput','hypot','ontouchstart','onmousedown','zIndex','toString','flex','canvas','createElement','redo\x20shortcut\x20error','height','nextSibling','clientY','238679HOWEAp','7823330jLSRfF','bottom','grab','toggle','justifyContent','nezumi-theme','IndexedDB\x20からの読み込みに失敗したチュー','180deUEqo','onchange','colorPicker','canvas\x20要素が見つからないチュー','8px','canvas-container','info','pan','penMode','style','insertBefore'];_0x57e6=function(){return _0x2dcb93;};return _0x57e6();}