const _0x4a4a78=_0x1d13;(function(_0x221e01,_0x44a36c){const _0x67afb5=_0x1d13,_0x1010b4=_0x221e01();while(!![]){try{const _0x152cff=-parseInt(_0x67afb5(0x193))/0x1*(-parseInt(_0x67afb5(0x145))/0x2)+parseInt(_0x67afb5(0x1a0))/0x3+-parseInt(_0x67afb5(0x198))/0x4+-parseInt(_0x67afb5(0x16f))/0x5+-parseInt(_0x67afb5(0x17e))/0x6*(-parseInt(_0x67afb5(0x164))/0x7)+-parseInt(_0x67afb5(0x18e))/0x8*(parseInt(_0x67afb5(0x199))/0x9)+parseInt(_0x67afb5(0x152))/0xa;if(_0x152cff===_0x44a36c)break;else _0x1010b4['push'](_0x1010b4['shift']());}catch(_0x126a97){_0x1010b4['push'](_0x1010b4['shift']());}}}(_0x2fdf,0x1d4da));const _0x7ebab8=(function(){let _0x549b40=!![];return function(_0x1eb031,_0x388bad){const _0xcfb61c=_0x549b40?function(){const _0x1d76fe=_0x1d13;if(_0x388bad){const _0x58f0ad=_0x388bad[_0x1d76fe(0x17b)](_0x1eb031,arguments);return _0x388bad=null,_0x58f0ad;}}:function(){};return _0x549b40=![],_0xcfb61c;};}()),_0x1dc18a=_0x7ebab8(this,function(){const _0xcaed6f=_0x1d13;return _0x1dc18a[_0xcaed6f(0x142)]()[_0xcaed6f(0x153)](_0xcaed6f(0x188))[_0xcaed6f(0x142)]()[_0xcaed6f(0x184)](_0x1dc18a)[_0xcaed6f(0x153)](_0xcaed6f(0x188));});_0x1dc18a();function setPenSize(_0x370f2f){const _0x42220f=_0x1d13;penSize=parseInt(_0x370f2f)||0x1;let _0x1bf2b6=document[_0x42220f(0x175)](_0x42220f(0x18b));if(_0x1bf2b6)_0x1bf2b6[_0x42220f(0x173)]=penSize;let _0x148916=document[_0x42220f(0x175)](_0x42220f(0x169));if(_0x148916)_0x148916['value']=penSize;}function setPenMode(_0x593712){const _0xb29810=_0x1d13;penMode=_0x593712;let _0x17c9ac=document[_0xb29810(0x175)](_0xb29810(0x174));if(_0x17c9ac)_0x17c9ac[_0xb29810(0x173)]=penMode;let _0x44309a=document['getElementById'](_0xb29810(0x16e));if(_0x44309a)_0x44309a[_0xb29810(0x173)]=penMode;}function isDrawableCanvas(_0x4a063a){const _0x59131e=_0x1d13;if(!_0x4a063a)return![];const _0x2d577d=_0x4a063a[_0x59131e(0x17f)],_0x399bdf=_0x4a063a[_0x59131e(0x172)];return Number[_0x59131e(0x196)](_0x2d577d)&&Number[_0x59131e(0x196)](_0x399bdf)&&_0x2d577d>0x0&&_0x399bdf>0x0;}function _0x1d13(_0x302bf3,_0x44b18b){_0x302bf3=_0x302bf3-0x141;const _0x17b889=_0x2fdf();let _0x1dc18a=_0x17b889[_0x302bf3];return _0x1dc18a;}function fillAt(_0x485daf,_0x539fe1){const _0x4bfda7=_0x1d13;let _0x90ac59=getCurrentProject(),_0x148e0c=getCurrentFrame();if(!_0x90ac59||!_0x148e0c||typeof _0x148e0c['activeLayer']!==_0x4bfda7(0x183)||!_0x148e0c[_0x4bfda7(0x14d)][_0x148e0c[_0x4bfda7(0x19d)]])return;const _0x85363b=_0x148e0c[_0x4bfda7(0x14d)][_0x148e0c[_0x4bfda7(0x19d)]],_0x470ea1=_0x85363b&&_0x85363b['canvas']?_0x85363b[_0x4bfda7(0x144)]:_0x85363b;if(!_0x470ea1||!_0x470ea1['getContext'])return;let _0x2c5b80=_0x470ea1['getContext']('2d',{'willReadFrequently':!![]}),_0x2a57fb=_0x2c5b80[_0x4bfda7(0x167)](0x0,0x0,_0x90ac59[_0x4bfda7(0x17f)]*cellSize,_0x90ac59[_0x4bfda7(0x172)]*cellSize),_0x5a2e86=_0x485daf*cellSize,_0x5bf6b1=_0x539fe1*cellSize,_0x383833=getPixel(_0x2a57fb,_0x5a2e86,_0x5bf6b1),_0x435fa2=currentAlpha===0x0?[0x0,0x0,0x0,0x0]:hexToRgba(currentColor,currentAlpha);if(colorsMatch(_0x383833,_0x435fa2))return;let _0x29aa8=[[_0x485daf,_0x539fe1]],_0x5b2c38=new Set();while(_0x29aa8[_0x4bfda7(0x19a)]){let [_0x35800f,_0x489b8e]=_0x29aa8[_0x4bfda7(0x14c)]();if(_0x35800f<0x0||_0x489b8e<0x0||_0x35800f>=_0x90ac59[_0x4bfda7(0x17f)]||_0x489b8e>=_0x90ac59['height'])continue;let _0x3ce9cd=_0x35800f+','+_0x489b8e;if(_0x5b2c38[_0x4bfda7(0x16b)](_0x3ce9cd))continue;_0x5b2c38[_0x4bfda7(0x1a2)](_0x3ce9cd);let _0x2d68c4=_0x35800f*cellSize,_0x5eab88=_0x489b8e*cellSize,_0xefeb64=getPixel(_0x2a57fb,_0x2d68c4,_0x5eab88);if(!colorsMatch(_0xefeb64,_0x383833))continue;for(let _0x5e1444=0x0;_0x5e1444<cellSize;_0x5e1444++){for(let _0x34d6af=0x0;_0x34d6af<cellSize;_0x34d6af++){setPixel(_0x2a57fb,_0x2d68c4+_0x34d6af,_0x5eab88+_0x5e1444,_0x435fa2);}}_0x29aa8[_0x4bfda7(0x16a)]([_0x35800f+0x1,_0x489b8e]),_0x29aa8[_0x4bfda7(0x16a)]([_0x35800f-0x1,_0x489b8e]),_0x29aa8[_0x4bfda7(0x16a)]([_0x35800f,_0x489b8e+0x1]),_0x29aa8[_0x4bfda7(0x16a)]([_0x35800f,_0x489b8e-0x1]);}_0x2c5b80['putImageData'](_0x2a57fb,0x0,0x0),redrawAll();}function getPixel(_0x1ce6ff,_0x4a88b2,_0x4caa29){const _0xde63c6=_0x1d13;let _0x2ad593=(_0x4caa29*_0x1ce6ff[_0xde63c6(0x17f)]+_0x4a88b2)*0x4;return[_0x1ce6ff[_0xde63c6(0x19f)][_0x2ad593],_0x1ce6ff[_0xde63c6(0x19f)][_0x2ad593+0x1],_0x1ce6ff[_0xde63c6(0x19f)][_0x2ad593+0x2],_0x1ce6ff[_0xde63c6(0x19f)][_0x2ad593+0x3]];}function setPixel(_0x37bf8b,_0x5448b5,_0x56ae9b,_0x2d8be4){const _0x4183e3=_0x1d13;let _0x1404aa=(_0x56ae9b*_0x37bf8b[_0x4183e3(0x17f)]+_0x5448b5)*0x4;_0x37bf8b[_0x4183e3(0x19f)][_0x1404aa]=_0x2d8be4[0x0],_0x37bf8b['data'][_0x1404aa+0x1]=_0x2d8be4[0x1],_0x37bf8b['data'][_0x1404aa+0x2]=_0x2d8be4[0x2],_0x37bf8b[_0x4183e3(0x19f)][_0x1404aa+0x3]=_0x2d8be4[0x3];}function drawDotXY(_0x534062,_0x98a38f){const _0x171dd6=_0x1d13;let _0x56e347=getCurrentProject(),_0x1dabf3=getCurrentFrame();if(!_0x1dabf3||!_0x56e347)return;if(typeof _0x534062!==_0x171dd6(0x183)||typeof _0x98a38f!==_0x171dd6(0x183)||_0x534062<0x0||_0x98a38f<0x0||!Number[_0x171dd6(0x196)](_0x56e347[_0x171dd6(0x17f)])||!Number['isFinite'](_0x56e347[_0x171dd6(0x172)])||_0x534062>=_0x56e347['width']||_0x98a38f>=_0x56e347['height']||!Array[_0x171dd6(0x178)](_0x1dabf3[_0x171dd6(0x14d)])||typeof _0x1dabf3[_0x171dd6(0x19d)]!==_0x171dd6(0x183)||!_0x1dabf3[_0x171dd6(0x14d)][_0x1dabf3[_0x171dd6(0x19d)]])return;const _0x50606d=_0x1dabf3['layers'][_0x1dabf3[_0x171dd6(0x19d)]],_0x2dffec=_0x50606d&&_0x50606d['canvas']?_0x50606d['canvas']:_0x50606d;if(!_0x2dffec||!_0x2dffec['getContext'])return;let _0x4a53e7=_0x2dffec[_0x171dd6(0x150)]('2d');if(!_0x4a53e7)return;if(currentTool===_0x171dd6(0x15e)||currentAlpha===0x0)drawPenShape(_0x4a53e7,_0x534062,_0x98a38f,null,!![]);else{let _0x1bd5ec=hexToRgba(currentColor,currentAlpha);_0x4a53e7[_0x171dd6(0x157)](),penAlphaMode==='flat'&&currentAlpha<0x1?(drawPenShape(_0x4a53e7,_0x534062,_0x98a38f,null,!![]),drawPenShape(_0x4a53e7,_0x534062,_0x98a38f,_0x1bd5ec,![])):drawPenShape(_0x4a53e7,_0x534062,_0x98a38f,_0x1bd5ec,![]),_0x4a53e7[_0x171dd6(0x19c)]();}blitLayerArea(_0x2dffec,_0x534062,_0x98a38f,penSize);}function parseColorToRGBA(_0x1e8836,_0x582dd1){const _0x4da25f=_0x1d13;if(Array[_0x4da25f(0x178)](_0x1e8836)&&_0x1e8836[_0x4da25f(0x19a)]>=0x4)return _0x1e8836[_0x4da25f(0x17c)](0x0,0x4);if(!_0x1e8836||typeof _0x1e8836!==_0x4da25f(0x181))return _0x582dd1||[0x0,0x0,0x0,0xff];if(_0x1e8836===_0x4da25f(0x165)||_0x1e8836[_0x4da25f(0x160)]()==='transparent')return[0x0,0x0,0x0,0x0];const _0x11b045=_0x1e8836[_0x4da25f(0x147)](/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([0-9.]+))?\)/i);if(_0x11b045){const _0x347596=parseInt(_0x11b045[0x1],0xa),_0x569b15=parseInt(_0x11b045[0x2],0xa),_0x308d05=parseInt(_0x11b045[0x3],0xa),_0x50b683=typeof _0x11b045[0x4]!==_0x4da25f(0x141)?Math[_0x4da25f(0x17d)](parseFloat(_0x11b045[0x4])*0xff):0xff;return[_0x347596,_0x569b15,_0x308d05,_0x50b683];}try{return hexToRgba(_0x1e8836);}catch(_0x23f09d){return _0x582dd1||[0x0,0x0,0x0,0xff];}}function fillCellCircle(_0x3ba094,_0x45b897,_0x3a28f1,_0x9f258e,_0x31362f,_0x5a4cad){const _0x2da0be=_0x1d13,_0x4e100c=Math['max'](0x1,Math[_0x2da0be(0x17d)](_0x9f258e/cellSize)),_0x412479=_0x45b897+_0x9f258e/0x2,_0x2f6cc4=_0x3a28f1+_0x9f258e/0x2,_0x2b2c03=_0x9f258e/0x2;for(let _0x26d38b=0x0;_0x26d38b<_0x4e100c;_0x26d38b++){for(let _0xaaf417=0x0;_0xaaf417<_0x4e100c;_0xaaf417++){const _0x36b192=_0x45b897+_0xaaf417*cellSize,_0x3806d6=_0x3a28f1+_0x26d38b*cellSize,_0x20403e=_0x36b192+cellSize/0x2,_0x16cfa6=_0x3806d6+cellSize/0x2,_0x102e7c=_0x20403e-_0x412479,_0x1a2b9d=_0x16cfa6-_0x2f6cc4,_0x2fb7a8=Math[_0x2da0be(0x176)](_0x102e7c*_0x102e7c+_0x1a2b9d*_0x1a2b9d);if(_0x2fb7a8<=_0x2b2c03+0.0001){if(_0x5a4cad)_0x3ba094[_0x2da0be(0x191)](_0x36b192,_0x3806d6,cellSize,cellSize);else _0x31362f&&(_0x3ba094['save'](),_0x3ba094[_0x2da0be(0x158)]=(_0x31362f[0x3]||0xff)/0xff,_0x3ba094[_0x2da0be(0x19e)]=_0x2da0be(0x14b)+_0x31362f[0x0]+','+_0x31362f[0x1]+','+_0x31362f[0x2]+')',_0x3ba094['fillRect'](_0x36b192,_0x3806d6,cellSize,cellSize),_0x3ba094['restore']());}}}}function drawPenShape(_0x31ef5a,_0x3323eb,_0x29e1af,_0x3d25fe,_0x1de91e){const _0x2023d8=_0x1d13,_0x3b1247=_0x3323eb*cellSize,_0x27f0b8=_0x29e1af*cellSize,_0x22c3b3=penSize*cellSize;if(_0x1de91e)penMode==='circle'?fillCellCircle(_0x31ef5a,_0x3b1247,_0x27f0b8,_0x22c3b3,null,!![]):_0x31ef5a['clearRect'](_0x3b1247-Math[_0x2023d8(0x16c)]((penSize-0x1)/0x2)*cellSize,_0x27f0b8-Math['floor']((penSize-0x1)/0x2)*cellSize,_0x22c3b3,_0x22c3b3);else{if(penMode==='circle'){const _0x5c61e4=parseColorToRGBA(_0x3d25fe,[0x0,0x0,0x0,0xff]);fillCellCircle(_0x31ef5a,_0x3b1247,_0x27f0b8,_0x22c3b3,_0x5c61e4,![]);}else _0x31ef5a['save'](),Array[_0x2023d8(0x178)](_0x3d25fe)&&_0x3d25fe[_0x2023d8(0x19a)]>=0x4?(_0x31ef5a[_0x2023d8(0x19e)]=_0x2023d8(0x18a)+_0x3d25fe[0x0]+','+_0x3d25fe[0x1]+','+_0x3d25fe[0x2]+_0x2023d8(0x15c),_0x31ef5a['globalAlpha']=(_0x3d25fe[0x3]||0xff)/0xff):_0x31ef5a['fillStyle']=_0x3d25fe,_0x31ef5a[_0x2023d8(0x156)](_0x3b1247-Math[_0x2023d8(0x16c)]((penSize-0x1)/0x2)*cellSize,_0x27f0b8-Math[_0x2023d8(0x16c)]((penSize-0x1)/0x2)*cellSize,_0x22c3b3,_0x22c3b3),_0x31ef5a[_0x2023d8(0x19c)]();}}function blitLayerArea(_0x5b239d,_0x145b06,_0x3e93ce,_0x15d6b9,_0x45f5fb){const _0x1350ff=_0x1d13,_0x5995b1=getCurrentProject(),_0x429353=getCurrentFrame();if(!_0x5995b1||!_0x429353)return;if(!_0x5b239d||!_0x5b239d[_0x1350ff(0x150)]||!isDrawableCanvas(_0x5b239d))return;const _0x12ffcf=_0x15d6b9*cellSize,_0x5af887=Math[_0x1350ff(0x16c)]((_0x15d6b9-0x1)/0x2)*cellSize,_0x56a358=_0x145b06*cellSize-_0x5af887,_0xb3f4be=_0x3e93ce*cellSize-_0x5af887,_0x580f9a=Math[_0x1350ff(0x177)](0x0,_0x56a358),_0x169896=Math[_0x1350ff(0x177)](0x0,_0xb3f4be),_0x3c207b=Math[_0x1350ff(0x18f)](canvas[_0x1350ff(0x17f)],_0x56a358+_0x12ffcf),_0x156bac=Math[_0x1350ff(0x18f)](canvas['height'],_0xb3f4be+_0x12ffcf),_0x290b55=_0x3c207b-_0x580f9a,_0x1f453f=_0x156bac-_0x169896;if(_0x290b55<=0x0||_0x1f453f<=0x0)return;try{ctx[_0x1350ff(0x157)](),ctx['beginPath'](),ctx[_0x1350ff(0x162)](_0x580f9a,_0x169896,_0x290b55,_0x1f453f),ctx[_0x1350ff(0x148)](),ctx[_0x1350ff(0x191)](_0x580f9a,_0x169896,_0x290b55,_0x1f453f);for(let _0x3d79bc=0x0;_0x3d79bc<_0x429353[_0x1350ff(0x14d)][_0x1350ff(0x19a)];_0x3d79bc++){const _0x97499e=_0x429353[_0x1350ff(0x14d)][_0x3d79bc];if(!_0x97499e)continue;const _0x3f55a1=typeof _0x97499e[_0x1350ff(0x180)]!==_0x1350ff(0x141)?_0x97499e[_0x1350ff(0x180)]:!![];if(!_0x3f55a1)continue;const _0xbda7f6=_0x97499e[_0x1350ff(0x144)]?_0x97499e['canvas']:_0x97499e;if(!isDrawableCanvas(_0xbda7f6))continue;ctx[_0x1350ff(0x157)](),dimFrontLayers&&typeof _0x429353[_0x1350ff(0x19d)]==='number'&&_0x3d79bc>_0x429353['activeLayer']?ctx[_0x1350ff(0x158)]=FRONT_LAYER_DIM_ALPHA:ctx[_0x1350ff(0x158)]=0x1,ctx[_0x1350ff(0x18d)](_0xbda7f6,_0x580f9a,_0x169896,_0x290b55,_0x1f453f,_0x580f9a,_0x169896,_0x290b55,_0x1f453f),ctx['restore']();}ctx[_0x1350ff(0x19c)]();}catch(_0x409135){redrawAll();return;}const _0x428f2c=document['getElementById'](_0x1350ff(0x14a));if(_0x428f2c){const _0x1ce84b=performance['now']();if(!lastColorScanAt||_0x1ce84b-lastColorScanAt>=COLOR_SCAN_INTERVAL_MS){const _0x18918e=scanImageColors();renderScanPanel(_0x18918e),_0x428f2c['style'][_0x1350ff(0x15d)]='',lastColorScanAt=_0x1ce84b;}}drawGridArea(_0x580f9a,_0x169896,_0x290b55,_0x1f453f);}function drawGridArea(_0x3be3b3,_0x14c069,_0x33a8f4,_0x105ffb){const _0x22b6ed=_0x1d13;if(!showGrid||!_0x33a8f4||!_0x105ffb)return;ctx['save'](),ctx[_0x22b6ed(0x194)]='#ccc',ctx[_0x22b6ed(0x170)]=0x1,ctx[_0x22b6ed(0x186)]=_0x22b6ed(0x15b);const _0x1a9c8e=0x1,_0x23e3df=Math[_0x22b6ed(0x177)](0x0,Math['floor']((_0x3be3b3-_0x1a9c8e)/cellSize)*cellSize),_0x1a787b=Math['min'](canvas['width'],Math[_0x22b6ed(0x161)]((_0x3be3b3+_0x33a8f4+_0x1a9c8e)/cellSize)*cellSize),_0x55e3ea=Math[_0x22b6ed(0x177)](0x0,Math['floor']((_0x14c069-_0x1a9c8e)/cellSize)*cellSize),_0x50126a=Math[_0x22b6ed(0x18f)](canvas[_0x22b6ed(0x172)],Math[_0x22b6ed(0x161)]((_0x14c069+_0x105ffb+_0x1a9c8e)/cellSize)*cellSize);for(let _0x330071=_0x23e3df;_0x330071<=_0x1a787b;_0x330071+=cellSize){const _0x3eef9b=_0x330071+0.5;ctx[_0x22b6ed(0x182)](),ctx[_0x22b6ed(0x18c)](_0x3eef9b,_0x55e3ea),ctx['lineTo'](_0x3eef9b,_0x50126a),ctx['stroke']();}for(let _0x453cc7=_0x55e3ea;_0x453cc7<=_0x50126a;_0x453cc7+=cellSize){const _0x48a18a=_0x453cc7+0.5;ctx[_0x22b6ed(0x182)](),ctx[_0x22b6ed(0x18c)](_0x23e3df,_0x48a18a),ctx[_0x22b6ed(0x187)](_0x1a787b,_0x48a18a),ctx[_0x22b6ed(0x195)]();}ctx[_0x22b6ed(0x19c)]();}function drawDotTouch(_0x5dc533,_0x1afc86){const _0x1d360b=_0x1d13;let _0x2b5684=getCurrentProject(),_0x4943c9=getCurrentFrame();if(!_0x2b5684||!_0x4943c9)return;if(_0x5dc533<0x0||_0x1afc86<0x0||_0x5dc533>=_0x2b5684[_0x1d360b(0x17f)]||_0x1afc86>=_0x2b5684[_0x1d360b(0x172)])return;const _0x39eb3e=_0x4943c9[_0x1d360b(0x14d)][_0x4943c9[_0x1d360b(0x19d)]],_0x59cd03=_0x39eb3e&&_0x39eb3e[_0x1d360b(0x144)]?_0x39eb3e['canvas']:_0x39eb3e;if(!_0x59cd03||!_0x59cd03[_0x1d360b(0x150)])return;let _0x174dfb=_0x59cd03[_0x1d360b(0x150)]('2d');if(currentTool==='eraser'||currentAlpha===0x0)drawPenShape(_0x174dfb,_0x5dc533,_0x1afc86,null,!![]);else{let _0x1fe022=hexToRgba(currentColor,currentAlpha);_0x174dfb[_0x1d360b(0x157)](),penAlphaMode===_0x1d360b(0x190)&&currentAlpha<0x1?(_0x174dfb[_0x1d360b(0x158)]=0x1,_0x174dfb[_0x1d360b(0x15f)]='destination-out',drawPenShape(_0x174dfb,_0x5dc533,_0x1afc86,null,!![]),_0x174dfb[_0x1d360b(0x15f)]=_0x1d360b(0x143),drawPenShape(_0x174dfb,_0x5dc533,_0x1afc86,_0x1fe022,![])):drawPenShape(_0x174dfb,_0x5dc533,_0x1afc86,_0x1fe022,![]),_0x174dfb[_0x1d360b(0x19c)]();}blitLayerArea(_0x59cd03,_0x5dc533,_0x1afc86,penSize);}function drawGrid(_0x288534,_0x865c7e){const _0x2b22d1=_0x1d13;if(!showGrid)return;ctx[_0x2b22d1(0x157)](),ctx[_0x2b22d1(0x194)]=_0x2b22d1(0x146),ctx[_0x2b22d1(0x170)]=0x1,ctx['lineCap']=_0x2b22d1(0x15b);for(let _0x6479a3=0x0;_0x6479a3<=_0x288534;_0x6479a3++){const _0x23ed29=_0x6479a3*cellSize+0.5;ctx[_0x2b22d1(0x182)](),ctx[_0x2b22d1(0x18c)](_0x23ed29,0x0),ctx[_0x2b22d1(0x187)](_0x23ed29,_0x865c7e*cellSize),ctx[_0x2b22d1(0x195)]();}for(let _0x38878a=0x0;_0x38878a<=_0x865c7e;_0x38878a++){const _0x3f35f5=_0x38878a*cellSize+0.5;ctx[_0x2b22d1(0x182)](),ctx[_0x2b22d1(0x18c)](0x0,_0x3f35f5),ctx['lineTo'](_0x288534*cellSize,_0x3f35f5),ctx[_0x2b22d1(0x195)]();}ctx[_0x2b22d1(0x19c)]();}function redrawAll(){const _0x721493=_0x1d13;let _0x271064=getCurrentProject(),_0x1908e6=getCurrentFrame();canvas[_0x721493(0x17f)]=_0x271064[_0x721493(0x17f)]*cellSize,canvas['height']=_0x271064[_0x721493(0x172)]*cellSize,ctx[_0x721493(0x191)](0x0,0x0,canvas[_0x721493(0x17f)],canvas[_0x721493(0x172)]);for(let _0x52d138=0x0;_0x52d138<(Array[_0x721493(0x178)](_0x1908e6[_0x721493(0x14d)])?_0x1908e6[_0x721493(0x14d)][_0x721493(0x19a)]:0x0);_0x52d138++){const _0x483981=_0x1908e6['layers'][_0x52d138];if(!_0x483981)continue;const _0x3c1a31=typeof _0x483981[_0x721493(0x180)]!==_0x721493(0x141)?_0x483981['visible']:!![];if(!_0x3c1a31)continue;const _0x127913=_0x483981['canvas']?_0x483981[_0x721493(0x144)]:_0x483981;if(!_0x127913)continue;try{ctx[_0x721493(0x157)]();dimFrontLayers&&typeof _0x1908e6[_0x721493(0x19d)]===_0x721493(0x183)&&_0x52d138>_0x1908e6[_0x721493(0x19d)]?ctx['globalAlpha']=FRONT_LAYER_DIM_ALPHA:ctx[_0x721493(0x158)]=0x1;if(typeof HTMLCanvasElement!==_0x721493(0x141)&&_0x127913 instanceof HTMLCanvasElement){if(isDrawableCanvas(_0x127913))ctx[_0x721493(0x18d)](_0x127913,0x0,0x0);}else{if(typeof HTMLImageElement!==_0x721493(0x141)&&_0x127913 instanceof HTMLImageElement){if(_0x127913['complete'])ctx[_0x721493(0x18d)](_0x127913,0x0,0x0);}else{if(typeof OffscreenCanvas!==_0x721493(0x141)&&_0x127913 instanceof OffscreenCanvas){if(isDrawableCanvas(_0x127913))ctx['drawImage'](_0x127913,0x0,0x0);}else try{if(isDrawableCanvas(_0x127913))ctx[_0x721493(0x18d)](_0x127913,0x0,0x0);}catch(_0x167bce){}}}ctx[_0x721493(0x19c)]();}catch(_0x20f871){console[_0x721493(0x17a)]('redrawAll:\x20failed\x20drawing\x20layer',_0x20f871);}}drawGrid(_0x271064[_0x721493(0x17f)],_0x271064[_0x721493(0x172)]);wrapper&&(wrapper[_0x721493(0x163)][_0x721493(0x17f)]='100%',wrapper[_0x721493(0x163)][_0x721493(0x172)]=_0x721493(0x171));const _0x1f2833=document[_0x721493(0x175)](_0x721493(0x14a));if(_0x1f2833){const _0x405b78=performance[_0x721493(0x1a1)]();if(!lastColorScanAt||_0x405b78-lastColorScanAt>=COLOR_SCAN_INTERVAL_MS){const _0x499e21=scanImageColors();renderScanPanel(_0x499e21),_0x1f2833[_0x721493(0x163)]['display']='',lastColorScanAt=_0x405b78;}}}function uuidv4(){const _0x5ec1c0=_0x1d13;if(typeof crypto!==_0x5ec1c0(0x141)&&typeof crypto['randomUUID']===_0x5ec1c0(0x192))try{return crypto[_0x5ec1c0(0x16d)]();}catch(_0x4594d7){}return _0x5ec1c0(0x189)['replace'](/[xy]/g,_0x35013c=>{const _0x5ab91f=_0x5ec1c0,_0x4567f2=Math[_0x5ab91f(0x185)]()*0x10|0x0,_0x371730=_0x35013c==='x'?_0x4567f2:_0x4567f2&0x3|0x8;return _0x371730[_0x5ab91f(0x142)](0x10);});}function generateVersionFromNow(){const _0x266080=_0x1d13,_0x8073c0=new Date(),_0x11f2f4=_0x8073c0[_0x266080(0x197)](),_0x354db8=String(_0x8073c0[_0x266080(0x14f)]()+0x1)[_0x266080(0x155)](0x2,'0'),_0x24fb6f=String(_0x8073c0[_0x266080(0x168)]())[_0x266080(0x155)](0x2,'0'),_0x2a0893=String(_0x8073c0[_0x266080(0x15a)]())[_0x266080(0x155)](0x2,'0'),_0x20d5d8=String(_0x8073c0['getMinutes']())[_0x266080(0x155)](0x2,'0'),_0x2d9c42=String(_0x8073c0[_0x266080(0x159)]())[_0x266080(0x155)](0x2,'0');return _0x11f2f4+'.'+_0x354db8+'.'+_0x24fb6f+'.'+_0x2a0893+_0x20d5d8+_0x2d9c42;}function ensureMetadata(_0xe9067e){const _0x5786d6=_0x1d13,_0x4e4b51=Object['assign']({},_0xe9067e||{});if(!_0x4e4b51['id'])_0x4e4b51['id']=uuidv4();if(!_0x4e4b51[_0x5786d6(0x154)])_0x4e4b51[_0x5786d6(0x154)]=generateVersionFromNow();if(!_0x4e4b51[_0x5786d6(0x179)])_0x4e4b51[_0x5786d6(0x179)]=new Date()[_0x5786d6(0x151)]();return _0x4e4b51;}function appendMetadataToBlob(_0x411a96,_0x42a4f3){const _0x286c58=_0x1d13,_0x1d1748=ensureMetadata(_0x42a4f3),_0x373707=new TextEncoder(),_0x3b15b1=_0x373707[_0x286c58(0x19b)](NEZUMI_METADATA_SIG),_0x11000e=_0x373707[_0x286c58(0x19b)](JSON['stringify'](_0x1d1748));return new Blob([_0x411a96,_0x3b15b1,_0x11000e],{'type':_0x411a96['type']||_0x286c58(0x14e)});}function _0x2fdf(){const _0x57b9a1=['restore','activeLayer','fillStyle','data','467721WlnbAc','now','add','undefined','toString','source-over','canvas','95308oKsvoO','#ccc','match','clip','uuidv4','scanColorsPanel','rgb(','pop','layers','application/octet-stream','getMonth','getContext','toISOString','2714020qdAnaX','search','version','padStart','fillRect','save','globalAlpha','getSeconds','getHours','butt',',1)','display','eraser','globalCompositeOperation','toLowerCase','ceil','rect','style','28RzEvcV','#00000000','generateVersionFromNow','getImageData','getDate','palette-penSize','push','has','floor','randomUUID','palette-penMode','1051945rnPhsh','lineWidth','auto','height','value','penMode','getElementById','sqrt','max','isArray','timestamp','warn','apply','slice','round','316320WZmsZw','width','visible','string','beginPath','number','constructor','random','lineCap','lineTo','(((.+)+)+)+$','xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx','rgba(','penSize','moveTo','drawImage','1899032hkeqmG','min','flat','clearRect','function','2YYBzth','strokeStyle','stroke','isFinite','getFullYear','662812xOiKug','9EzxXKo','length','encode'];_0x2fdf=function(){return _0x57b9a1;};return _0x2fdf();}typeof window!==_0x4a4a78(0x141)&&(window[_0x4a4a78(0x166)]=generateVersionFromNow,window[_0x4a4a78(0x149)]=uuidv4,window['ensureMetadata']=ensureMetadata);