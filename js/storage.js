(function(_0x3053e4,_0x156bbe){const _0x353ebc=_0x152e,_0x1cc08c=_0x3053e4();while(!![]){try{const _0x27cd2f=-parseInt(_0x353ebc(0x89))/0x1+parseInt(_0x353ebc(0x8a))/0x2*(-parseInt(_0x353ebc(0x77))/0x3)+-parseInt(_0x353ebc(0x78))/0x4*(parseInt(_0x353ebc(0x9b))/0x5)+parseInt(_0x353ebc(0x92))/0x6*(parseInt(_0x353ebc(0x8e))/0x7)+parseInt(_0x353ebc(0x81))/0x8+-parseInt(_0x353ebc(0xa0))/0x9*(-parseInt(_0x353ebc(0x9a))/0xa)+-parseInt(_0x353ebc(0x94))/0xb;if(_0x27cd2f===_0x156bbe)break;else _0x1cc08c['push'](_0x1cc08c['shift']());}catch(_0xf6664){_0x1cc08c['push'](_0x1cc08c['shift']());}}}(_0x5009,0x46117));const _0x24fbbf=(function(){let _0x268489=!![];return function(_0x3ff49b,_0xdb7ca3){const _0x1b820b=_0x268489?function(){const _0x1c0609=_0x152e;if(_0xdb7ca3){const _0x504894=_0xdb7ca3[_0x1c0609(0x86)](_0x3ff49b,arguments);return _0xdb7ca3=null,_0x504894;}}:function(){};return _0x268489=![],_0x1b820b;};}()),_0x3bb976=_0x24fbbf(this,function(){const _0x1aeb0f=_0x152e;return _0x3bb976[_0x1aeb0f(0x93)]()['search'](_0x1aeb0f(0x6e))[_0x1aeb0f(0x93)]()[_0x1aeb0f(0x95)](_0x3bb976)[_0x1aeb0f(0x9e)](_0x1aeb0f(0x6e));});function _0x5009(){const _0x2fc34c=['readonly','anonymous','forEach','clearRect','apply','isArray','name','292279KVJSPw','10QQflJP','readAsArrayBuffer','nezumi-palette','layers','574pGoApZ','onsuccess','メタデータが見つかりませんでした','map','22290NfHQwv','toString','960707zoynlI','constructor','crossOrigin','onerror','includes','target','4488360VykTWY','70cMdhFO','result','number','search','clear','9LyGTVC','push','width','createElement','frames','error','canvas','length','saveHistory\x20error','保存エラー','onload','layerHistories','all','objectStore','(((.+)+)+)+$','function','drawImage','delete','slice','readwrite','oncomplete','undefined','layerRedoStacks','47907qRkANy','153028BXrdrI','height','requestAutoSave','getContext','activeLayer','transaction','project','toDataURL','src','4228736fptdeC'];_0x5009=function(){return _0x2fc34c;};return _0x5009();}_0x3bb976();function _0x152e(_0x5a8781,_0x4ee972){_0x5a8781=_0x5a8781-0x69;const _0x54e840=_0x5009();let _0x3bb976=_0x54e840[_0x5a8781];return _0x3bb976;}function saveHistory(){const _0x2cb4fb=_0x152e;let _0x42e224=getCurrentFrame();if(!_0x42e224)return;if(!Array['isArray'](_0x42e224[_0x2cb4fb(0x6b)]))_0x42e224[_0x2cb4fb(0x6b)]=[];if(!Array[_0x2cb4fb(0x87)](_0x42e224['layerRedoStacks']))_0x42e224[_0x2cb4fb(0x76)]=[];const _0x43764c=typeof _0x42e224['activeLayer']===_0x2cb4fb(0x9d)?_0x42e224[_0x2cb4fb(0x7c)]:-0x1;if(_0x43764c<0x0)return;if(!_0x42e224[_0x2cb4fb(0x6b)][_0x43764c])_0x42e224[_0x2cb4fb(0x6b)][_0x43764c]=[];if(!_0x42e224['layerRedoStacks'][_0x43764c])_0x42e224['layerRedoStacks'][_0x43764c]=[];const _0x39429d=_0x42e224[_0x2cb4fb(0x8d)]&&_0x42e224['layers'][_0x43764c]?_0x42e224[_0x2cb4fb(0x8d)][_0x43764c]:null,_0x5c75cd=_0x39429d&&_0x39429d['canvas']?_0x39429d[_0x2cb4fb(0xa6)]:_0x39429d;if(!_0x5c75cd||typeof _0x5c75cd[_0x2cb4fb(0x7f)]!==_0x2cb4fb(0x6f))return;try{_0x42e224['layerHistories'][_0x43764c][_0x2cb4fb(0xa1)](_0x5c75cd[_0x2cb4fb(0x7f)]());if(_0x42e224[_0x2cb4fb(0x6b)][_0x43764c]['length']>0x32)_0x42e224['layerHistories'][_0x43764c]['shift']();_0x42e224[_0x2cb4fb(0x76)][_0x43764c]=[];try{if(typeof updateUndoRedoButtons===_0x2cb4fb(0x6f))updateUndoRedoButtons();}catch(_0x37dd3c){}if(typeof window[_0x2cb4fb(0x7a)]===_0x2cb4fb(0x6f))window[_0x2cb4fb(0x7a)]();}catch(_0xb7949a){console[_0x2cb4fb(0xa5)](_0x2cb4fb(0xa8),_0xb7949a);}}async function idbSet(_0x570099,_0x268408){const _0xc406c3=await openDB();return new Promise((_0x5dc9d8,_0x200875)=>{const _0x1d872c=_0x152e,_0x19b4ad=_0xc406c3[_0x1d872c(0x7d)](storeName,'readwrite');_0x19b4ad[_0x1d872c(0x6d)](storeName)['put'](_0x268408,_0x570099),_0x19b4ad[_0x1d872c(0x74)]=()=>_0x5dc9d8(),_0x19b4ad[_0x1d872c(0x97)]=()=>_0x200875(_0x19b4ad[_0x1d872c(0xa5)]);});}async function idbGet(_0x5359cd){const _0x44afd6=await openDB();return new Promise((_0x1c924a,_0x3c2f21)=>{const _0x2c7a02=_0x152e,_0x10cee5=_0x44afd6[_0x2c7a02(0x7d)](storeName,_0x2c7a02(0x82)),_0x575430=_0x10cee5[_0x2c7a02(0x6d)](storeName)['get'](_0x5359cd);_0x575430[_0x2c7a02(0x8f)]=()=>_0x1c924a(_0x575430[_0x2c7a02(0x9c)]),_0x575430[_0x2c7a02(0x97)]=()=>_0x3c2f21(_0x575430[_0x2c7a02(0xa5)]);});}async function idbDelete(_0x42dbc6){const _0x6d649=await openDB();return new Promise((_0x31591e,_0x27c431)=>{const _0x44a115=_0x152e,_0x256322=_0x6d649[_0x44a115(0x7d)](storeName,'readwrite');_0x256322[_0x44a115(0x6d)](storeName)[_0x44a115(0x71)](_0x42dbc6),_0x256322[_0x44a115(0x74)]=()=>_0x31591e(),_0x256322[_0x44a115(0x97)]=()=>_0x27c431(_0x256322['error']);});}async function idbClear(){const _0x27e123=await openDB();return new Promise((_0x157a00,_0x1a1e53)=>{const _0xf1a8ba=_0x152e,_0x421702=_0x27e123[_0xf1a8ba(0x7d)](storeName,_0xf1a8ba(0x73));_0x421702[_0xf1a8ba(0x6d)](storeName)[_0xf1a8ba(0x9f)](),_0x421702[_0xf1a8ba(0x74)]=()=>_0x157a00(),_0x421702[_0xf1a8ba(0x97)]=()=>_0x1a1e53(_0x421702[_0xf1a8ba(0xa5)]);});}async function savePaletteToDB(){const _0x2e2669=_0x152e;try{await idbSet(_0x2e2669(0x8c),PALETTE_COLORS);}catch(_0x1df947){console['error'](_0x2e2669(0x69),_0x1df947);}}async function loadPaletteFromDB(){const _0x1d7e11=_0x152e;try{const _0x131dfd=await idbGet(_0x1d7e11(0x8c));if(Array[_0x1d7e11(0x87)](_0x131dfd)&&_0x131dfd[_0x1d7e11(0xa7)]){const _0x476004=[];_0x131dfd[_0x1d7e11(0x84)](_0x587e70=>{const _0x5e6583=_0x1d7e11;if(typeof _0x587e70==='string'&&!_0x476004[_0x5e6583(0x98)](_0x587e70))_0x476004['push'](_0x587e70);});for(const _0x140bea of typeof DEFAULT_PALETTE!==_0x1d7e11(0x75)?DEFAULT_PALETTE:[]){if(!_0x476004[_0x1d7e11(0x98)](_0x140bea))_0x476004[_0x1d7e11(0xa1)](_0x140bea);}PALETTE_COLORS=_0x476004[_0x1d7e11(0x72)](0x0,0x18);}}catch(_0x2fd29d){console[_0x1d7e11(0xa5)]('読込エラー',_0x2fd29d);}}async function loadImages(_0x112111){const _0x57b07f=_0x152e,_0x18f96a=await Promise[_0x57b07f(0x6c)](_0x112111[_0x57b07f(0x91)](_0x24f768=>{return new Promise(_0x50ac35=>{const _0xe67c3d=_0x152e,_0x7b47c4=new Image();_0x7b47c4[_0xe67c3d(0x96)]=_0xe67c3d(0x83),_0x7b47c4['src']=_0x24f768,_0x7b47c4[_0xe67c3d(0x6a)]=()=>_0x50ac35(_0x7b47c4);});}));return _0x18f96a;}function loadStandaloneFromFile(_0x1a1de3){return new Promise((_0x78eb1d,_0x438e57)=>{const _0x2e20be=_0x152e;try{showLoading('画像ファイルを読み込み中...');}catch(_0x4b8e37){}const _0x191e36=new FileReader();_0x191e36[_0x2e20be(0x6a)]=_0x326a48=>{const _0x301057=_0x2e20be,_0x4bda32=_0x326a48[_0x301057(0x99)]['result'],_0x2462ff=extractMetadataFromArrayBuffer(_0x4bda32);if(!_0x2462ff||!_0x2462ff['project']){try{hideLoading();}catch(_0xbb4ce){}_0x438e57(new Error(_0x301057(0x90)));return;}const _0x11d7d5=_0x2462ff[_0x301057(0x7e)];try{const _0x1ce2f4=createProject(_0x11d7d5[_0x301057(0xa2)],_0x11d7d5['height'],_0x11d7d5[_0x301057(0x88)]||'画像');_0x1ce2f4[_0x301057(0xa4)]=_0x11d7d5[_0x301057(0xa4)]['map'](_0x2c3a49=>{const _0xe7ecff=_0x301057;let _0x3a099f={'layers':[],'activeLayer':_0x2c3a49[_0xe7ecff(0x7c)],'layerHistories':[],'layerRedoStacks':[]};for(let _0x712d22=0x0;_0x712d22<_0x2c3a49['layers'][_0xe7ecff(0xa7)];_0x712d22++){let _0x2e6a60=new Image();_0x2e6a60[_0xe7ecff(0x80)]=_0x2c3a49[_0xe7ecff(0x8d)][_0x712d22];let _0x5241b9=document[_0xe7ecff(0xa3)]('canvas');_0x5241b9['width']=_0x11d7d5['width']*cellSize,_0x5241b9[_0xe7ecff(0x79)]=_0x11d7d5['height']*cellSize,_0x2e6a60[_0xe7ecff(0x6a)]=()=>{const _0x4aa6c7=_0xe7ecff;let _0x3b98a0=_0x5241b9[_0x4aa6c7(0x7b)]('2d');_0x3b98a0[_0x4aa6c7(0x85)](0x0,0x0,_0x5241b9[_0x4aa6c7(0xa2)],_0x5241b9[_0x4aa6c7(0x79)]),_0x3b98a0[_0x4aa6c7(0x70)](_0x2e6a60,0x0,0x0);},_0x3a099f['layers'][_0xe7ecff(0xa1)](_0x5241b9);}return _0x3a099f;}),projects[_0x301057(0xa1)](_0x1ce2f4),activeProject=projects[_0x301057(0xa7)]-0x1,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();try{hideLoading();}catch(_0x289486){}_0x78eb1d(_0x1ce2f4);}catch(_0x38a3c2){try{hideLoading();}catch(_0x250587){}_0x438e57(_0x38a3c2);}},_0x191e36[_0x2e20be(0x97)]=_0xe45e73=>{try{hideLoading();}catch(_0xbb8b6c){};_0x438e57(_0xe45e73);},_0x191e36[_0x2e20be(0x8b)](_0x1a1de3);});}