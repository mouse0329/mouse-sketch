(function(_0x3bc0d6,_0x945336){const _0x2b1b54=_0x53cb,_0x287570=_0x3bc0d6();while(!![]){try{const _0x5e8145=parseInt(_0x2b1b54(0x136))/0x1+parseInt(_0x2b1b54(0x14f))/0x2*(parseInt(_0x2b1b54(0x146))/0x3)+parseInt(_0x2b1b54(0x13c))/0x4*(-parseInt(_0x2b1b54(0x14c))/0x5)+parseInt(_0x2b1b54(0x127))/0x6+-parseInt(_0x2b1b54(0x149))/0x7*(-parseInt(_0x2b1b54(0x124))/0x8)+parseInt(_0x2b1b54(0x12a))/0x9+-parseInt(_0x2b1b54(0x120))/0xa;if(_0x5e8145===_0x945336)break;else _0x287570['push'](_0x287570['shift']());}catch(_0xf7ce19){_0x287570['push'](_0x287570['shift']());}}}(_0x5f2d,0xab343));const _0x4bfbab=(function(){let _0x1e6189=!![];return function(_0x2daa24,_0xbbbac3){const _0x22d748=_0x1e6189?function(){const _0x52ce67=_0x53cb;if(_0xbbbac3){const _0x1065a0=_0xbbbac3[_0x52ce67(0x12b)](_0x2daa24,arguments);return _0xbbbac3=null,_0x1065a0;}}:function(){};return _0x1e6189=![],_0x22d748;};}()),_0x3acb75=_0x4bfbab(this,function(){const _0x514b3a=_0x53cb;return _0x3acb75[_0x514b3a(0x156)]()['search']('(((.+)+)+)+$')[_0x514b3a(0x156)]()[_0x514b3a(0x158)](_0x3acb75)['search'](_0x514b3a(0x13e));});_0x3acb75();function _0x5f2d(){const _0x3a0bc4=['画像ファイルを読み込み中...','error','getElementById','requestAutoSave','idle','value','layerRedoStacks','1065731vhJiTh','width','onsuccess','height','保存エラー','saveHistory\x20error','4569020hqimwq','animationDelay','(((.+)+)+)+$','drawImage','transaction','all','読込エラー','now','createElement','undefined','3238008DWjZXO','canvas','delete','4137pZcopp','result','objectStore','5hwJNxA','readwrite','put','2qJqpOp','isFinite','isArray','nezumi-palette','push','frames','animSpeedValue','toString','readonly','constructor','data','function','slice','clear','toDataURL','getContext','oncomplete','includes','onload','length','project','layers','object','src','layerHistories','30889050grVmQz','string','readAsArrayBuffer','メタデータが見つかりませんでした','17128sAvepS','onerror','name','7047588XSvklk','activeLayer','get','3126735pnxSWw','apply','map','crossOrigin','target'];_0x5f2d=function(){return _0x3a0bc4;};return _0x5f2d();}function saveHistory(){const _0xf3cfcf=_0x53cb;let _0x577638=getCurrentFrame();if(!_0x577638)return;if(!Array[_0xf3cfcf(0x151)](_0x577638[_0xf3cfcf(0x11f)]))_0x577638[_0xf3cfcf(0x11f)]=[];if(!Array['isArray'](_0x577638[_0xf3cfcf(0x135)]))_0x577638[_0xf3cfcf(0x135)]=[];const _0x4579f1=typeof _0x577638[_0xf3cfcf(0x128)]==='number'?_0x577638['activeLayer']:-0x1;if(_0x4579f1<0x0)return;if(!_0x577638[_0xf3cfcf(0x11f)][_0x4579f1])_0x577638[_0xf3cfcf(0x11f)][_0x4579f1]=[];if(!_0x577638[_0xf3cfcf(0x135)][_0x4579f1])_0x577638['layerRedoStacks'][_0x4579f1]=[];const _0x36357f=_0x577638[_0xf3cfcf(0x11c)]&&_0x577638[_0xf3cfcf(0x11c)][_0x4579f1]?_0x577638[_0xf3cfcf(0x11c)][_0x4579f1]:null,_0x36624c=_0x36357f&&_0x36357f[_0xf3cfcf(0x147)]?_0x36357f[_0xf3cfcf(0x147)]:_0x36357f;if(!_0x36624c||typeof _0x36624c[_0xf3cfcf(0x15d)]!=='function')return;try{_0x577638[_0xf3cfcf(0x11f)][_0x4579f1][_0xf3cfcf(0x153)](_0x36624c[_0xf3cfcf(0x15d)]());if(_0x577638['layerHistories'][_0x4579f1][_0xf3cfcf(0x162)]>0x32)_0x577638[_0xf3cfcf(0x11f)][_0x4579f1]['shift']();_0x577638[_0xf3cfcf(0x135)][_0x4579f1]=[];try{if(typeof updateUndoRedoButtons===_0xf3cfcf(0x15a))updateUndoRedoButtons();}catch(_0x28fc7c){}if(typeof window[_0xf3cfcf(0x132)]===_0xf3cfcf(0x15a))window[_0xf3cfcf(0x132)]();}catch(_0xfbba86){console[_0xf3cfcf(0x130)](_0xf3cfcf(0x13b),_0xfbba86);}}async function idbSet(_0x53597e,_0x44e444){const _0x42c0a7=await openDB();return new Promise((_0x41c948,_0x4ddbf2)=>{const _0x241ab1=_0x53cb,_0x3543df=_0x42c0a7[_0x241ab1(0x140)](storeName,'readwrite');_0x3543df['objectStore'](storeName)[_0x241ab1(0x14e)](_0x44e444,_0x53597e),_0x3543df['oncomplete']=()=>_0x41c948(),_0x3543df['onerror']=()=>_0x4ddbf2(_0x3543df['error']);});}async function idbGet(_0x3d6ee4){const _0x30dc7c=await openDB();return new Promise((_0x3d05d5,_0x4a6823)=>{const _0x27215d=_0x53cb,_0x4091b3=_0x30dc7c[_0x27215d(0x140)](storeName,_0x27215d(0x157)),_0x5c4489=_0x4091b3[_0x27215d(0x14b)](storeName)[_0x27215d(0x129)](_0x3d6ee4);_0x5c4489[_0x27215d(0x138)]=()=>_0x3d05d5(_0x5c4489['result']),_0x5c4489[_0x27215d(0x125)]=()=>_0x4a6823(_0x5c4489[_0x27215d(0x130)]);});}async function idbDelete(_0x45675d){const _0x2ccc98=await openDB();return new Promise((_0xb19c85,_0x123d22)=>{const _0x56c062=_0x53cb,_0x437de2=_0x2ccc98['transaction'](storeName,_0x56c062(0x14d));_0x437de2[_0x56c062(0x14b)](storeName)[_0x56c062(0x148)](_0x45675d),_0x437de2[_0x56c062(0x15f)]=()=>_0xb19c85(),_0x437de2['onerror']=()=>_0x123d22(_0x437de2[_0x56c062(0x130)]);});}async function idbClear(){const _0x3e6078=await openDB();return new Promise((_0x1a6900,_0x33c3c4)=>{const _0x399d56=_0x53cb,_0x84a61f=_0x3e6078[_0x399d56(0x140)](storeName,'readwrite');_0x84a61f[_0x399d56(0x14b)](storeName)[_0x399d56(0x15c)](),_0x84a61f[_0x399d56(0x15f)]=()=>_0x1a6900(),_0x84a61f[_0x399d56(0x125)]=()=>_0x33c3c4(_0x84a61f['error']);});}async function savePaletteToDB(){const _0xaf6f6a=_0x53cb;try{await idbSet('nezumi-palette',PALETTE_COLORS);}catch(_0x3ccf9a){console['error'](_0xaf6f6a(0x13a),_0x3ccf9a);}}async function loadPaletteFromDB(){const _0x22e22c=_0x53cb;try{const _0x49a1a4=await idbGet(_0x22e22c(0x152));if(Array[_0x22e22c(0x151)](_0x49a1a4)&&_0x49a1a4['length']){const _0x495d75=[];_0x49a1a4['forEach'](_0x22b77b=>{const _0x3df10e=_0x22e22c;if(typeof _0x22b77b==='string'&&!_0x495d75[_0x3df10e(0x160)](_0x22b77b))_0x495d75[_0x3df10e(0x153)](_0x22b77b);});for(const _0x396fdd of typeof DEFAULT_PALETTE!==_0x22e22c(0x145)?DEFAULT_PALETTE:[]){if(!_0x495d75[_0x22e22c(0x160)](_0x396fdd))_0x495d75[_0x22e22c(0x153)](_0x396fdd);}PALETTE_COLORS=_0x495d75[_0x22e22c(0x15b)](0x0,0x18);}}catch(_0x4a0873){console[_0x22e22c(0x130)](_0x22e22c(0x142),_0x4a0873);}}function _0x53cb(_0x3605f0,_0x416493){_0x3605f0=_0x3605f0-0x11b;const _0x4804dd=_0x5f2d();let _0x3acb75=_0x4804dd[_0x3605f0];return _0x3acb75;}async function loadImages(_0x231cae){const _0x4b3ce7=_0x53cb,_0x3c29ae=await Promise[_0x4b3ce7(0x141)](_0x231cae[_0x4b3ce7(0x12c)](_0x3c8db8=>{return new Promise(_0x4bd27c=>{const _0x16fde0=_0x53cb,_0xbf7cd0=new Image();_0xbf7cd0[_0x16fde0(0x12d)]='anonymous',_0xbf7cd0[_0x16fde0(0x11e)]=_0x3c8db8,_0xbf7cd0[_0x16fde0(0x161)]=()=>_0x4bd27c(_0xbf7cd0);});}));return _0x3c29ae;}function loadStandaloneFromFile(_0x2299bf){return new Promise((_0xc8f692,_0x4a718a)=>{const _0x35b1d0=_0x53cb;try{showLoading(_0x35b1d0(0x12f));}catch(_0x355281){}const _0x2b3eb0=new FileReader();_0x2b3eb0[_0x35b1d0(0x161)]=_0x136434=>{const _0xbc7525=_0x35b1d0,_0x2259b3=_0x136434[_0xbc7525(0x12e)][_0xbc7525(0x14a)],_0x3c2da5=extractMetadataFromArrayBuffer(_0x2259b3);if(!_0x3c2da5||!_0x3c2da5[_0xbc7525(0x11b)]){try{hideLoading();}catch(_0xb7270){}_0x4a718a(new Error(_0xbc7525(0x123)));return;}const _0x413a84=_0x3c2da5[_0xbc7525(0x11b)];try{const _0x5b64da=createProject(_0x413a84['width'],_0x413a84['height'],_0x413a84[_0xbc7525(0x126)]||'画像');_0x5b64da['frames']=_0x413a84[_0xbc7525(0x154)][_0xbc7525(0x12c)](_0x4f88ac=>{const _0x2829fa=_0xbc7525;let _0x40f916={'layers':[],'activeLayer':_0x4f88ac[_0x2829fa(0x128)],'layerHistories':[],'layerRedoStacks':[]};for(let _0x325c12=0x0;_0x325c12<_0x4f88ac[_0x2829fa(0x11c)][_0x2829fa(0x162)];_0x325c12++){const _0x1ad365=_0x4f88ac[_0x2829fa(0x11c)][_0x325c12];let _0x183ac7=null,_0x5baabd='';if(typeof _0x1ad365===_0x2829fa(0x121))_0x183ac7=_0x1ad365;else _0x1ad365&&typeof _0x1ad365===_0x2829fa(0x11d)&&(_0x183ac7=_0x1ad365[_0x2829fa(0x159)]||_0x1ad365[_0x2829fa(0x11e)]||null,_0x5baabd=_0x1ad365[_0x2829fa(0x126)]||'');let _0x2cbfa5=new Image();_0x2cbfa5[_0x2829fa(0x11e)]=_0x183ac7;let _0x482438=document[_0x2829fa(0x144)](_0x2829fa(0x147));_0x482438[_0x2829fa(0x137)]=_0x413a84[_0x2829fa(0x137)]*cellSize,_0x482438[_0x2829fa(0x139)]=_0x413a84[_0x2829fa(0x139)]*cellSize,_0x2cbfa5[_0x2829fa(0x161)]=()=>{const _0x41ac05=_0x2829fa;let _0x589ea2=_0x482438[_0x41ac05(0x15e)]('2d');_0x589ea2['clearRect'](0x0,0x0,_0x482438[_0x41ac05(0x137)],_0x482438['height']),_0x589ea2[_0x41ac05(0x13f)](_0x2cbfa5,0x0,0x0);try{redrawAll();}catch(_0x5c343a){}},_0x40f916['layers'][_0x2829fa(0x153)]({'canvas':_0x482438,'name':_0x5baabd,'visible':!![]});}return _0x40f916;}),projects[_0xbc7525(0x153)](_0x5b64da),activeProject=projects[_0xbc7525(0x162)]-0x1,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();if(Number[_0xbc7525(0x150)](_0x413a84[_0xbc7525(0x13d)])){try{if(typeof setAnimationDelay===_0xbc7525(0x15a))setAnimationDelay(_0x413a84[_0xbc7525(0x13d)]);}catch(_0x265c46){}const _0xcc28a5=document[_0xbc7525(0x131)]('animSpeedRange'),_0x4130f2=document[_0xbc7525(0x131)](_0xbc7525(0x155));if(_0xcc28a5)_0xcc28a5[_0xbc7525(0x134)]=_0x413a84[_0xbc7525(0x13d)];if(_0x4130f2)_0x4130f2[_0xbc7525(0x134)]=_0x413a84[_0xbc7525(0x13d)];}if(typeof setExportInputsFromProject==='function')setExportInputsFromProject();try{_lastSavedAt=Date[_0xbc7525(0x143)]();if(typeof setAutosaveStatus===_0xbc7525(0x15a))setAutosaveStatus(_0xbc7525(0x133));}catch(_0x11ab20){}try{hideLoading();}catch(_0x30381b){}_0xc8f692(_0x5b64da);}catch(_0x176606){try{hideLoading();}catch(_0x5584d8){}_0x4a718a(_0x176606);}},_0x2b3eb0['onerror']=_0x194a35=>{try{hideLoading();}catch(_0x10a504){};_0x4a718a(_0x194a35);},_0x2b3eb0[_0x35b1d0(0x122)](_0x2299bf);});}