const _0x4e610d=_0x2b26;(function(_0x5da851,_0x35c1b3){const _0x32121e=_0x2b26,_0x17b1f7=_0x5da851();while(!![]){try{const _0x57d327=parseInt(_0x32121e(0x1e9))/0x1+-parseInt(_0x32121e(0x1f1))/0x2*(parseInt(_0x32121e(0x1b7))/0x3)+-parseInt(_0x32121e(0x1f5))/0x4*(parseInt(_0x32121e(0x1a7))/0x5)+-parseInt(_0x32121e(0x1c6))/0x6*(-parseInt(_0x32121e(0x193))/0x7)+-parseInt(_0x32121e(0x22a))/0x8+-parseInt(_0x32121e(0x22c))/0x9+parseInt(_0x32121e(0x1be))/0xa*(parseInt(_0x32121e(0x215))/0xb);if(_0x57d327===_0x35c1b3)break;else _0x17b1f7['push'](_0x17b1f7['shift']());}catch(_0x27ab95){_0x17b1f7['push'](_0x17b1f7['shift']());}}}(_0x465c,0x83943));function _0x465c(){const _0x1254ea=['activeElement','1584234KGNlie','penAlphaMode','light','justifyContent','onmousedown','getItem','cursor','flex','resize','bottom','penSize','right','#000000','display','826868KpDvoi','right-toolbar','left','zoomSlider','pan','themeToggleBtn','ontouchcancel','top','onmouseleave','center','touchcancel','IndexedDB\x20からの読み込みに失敗したチュー','appendChild','remove','parentNode','disabled','pen','onCanvasColorPick\x20error','getElementById','floor','1165qzJsiR','relocateRightToolbar\x20error','#aboutCloseBtn','clientX','redo\x20shortcut\x20error','alignItems','grabbing','startAutoSaveInterval','padStart','toolsToggleBtn','preventDefault','touchstart','position','undo\x20shortcut\x20error','block','version','6ZujuVm','canvas\x20要素が見つからないチュー','onmouseup','colorPicker','toLowerCase','none','addEventListener','3856040FzrXtW','copyLayerBtn','style','error','number','toggle','getAttribute','Picked\x20transparent','6LbEUth','transparent','fill','posY','textarea','about-dialog','toUpperCase','\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22background:var(--surface);padding:18px\x2022px;border-radius:10px;min-width:280px;max-width:720px;text-align:left;box-shadow:0\x202px\x2024px\x20rgba(0,0,0,0.25);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:0;\x22>ネズミスケッチについて</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ネズミスケッチは、簡単にドット絵アニメーションを作成できるツールです。</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>バージョン:\x20<b>','insertBefore','inline-block','zIndex','grab','apply','mobile-open','background','setAttribute','0\x202px\x2010px\x20rgba(0,0,0,0.15)','openColorPickerBtn','nextSibling','innerWidth','clientY','Picked\x20color','abs','canvas-container','getImageData','nudgeLeftBtn','canvas','info','parentElement','click','ontouchend','tagName','touchmove','onchange','ontouchstart','942604IyysfQ','Shift','</b>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20バージョンID:\x20','join','copyLayer\x20error','getContext','isContentEditable','div','383940TaxxqX','platform','constructor','toolbar-mobile','8380fjoZwm','animSpeedRange','ontouchmove','footer','touches','metaKey','pasteLayerBtn','toString','onmousemove','function','animSpeedValue','round','ctrlKey','removeAttribute','frontDimBtn','nudgeDownBtn','value','keydown','width','input','nudgeRightBtn','penMode','currentColorSwatch','search','min','map','max','8px','classList','touchend','自動復元中...','getBoundingClientRect','22kQJGxQ','target','shiftKey','querySelector','nudgeUpBtn','open','posX','offsetHeight','oninput','length','right-panel','indexOf','catch','MAC','select','100vh','nudgeStep','nezumi-theme','onclick','key','(((.+)+)+)+$','1959104rxLcNP'];_0x465c=function(){return _0x1254ea;};return _0x465c();}const _0x3c470c=(function(){let _0x9a022f=!![];return function(_0xaa52ff,_0x200803){const _0x136f8a=_0x9a022f?function(){const _0x496615=_0x2b26;if(_0x200803){const _0x28dae8=_0x200803[_0x496615(0x1d2)](_0xaa52ff,arguments);return _0x200803=null,_0x28dae8;}}:function(){};return _0x9a022f=![],_0x136f8a;};}()),_0x33a8e1=_0x3c470c(this,function(){const _0x3ee9c4=_0x2b26;return _0x33a8e1[_0x3ee9c4(0x1fc)]()['search'](_0x3ee9c4(0x229))[_0x3ee9c4(0x1fc)]()[_0x3ee9c4(0x1f3)](_0x33a8e1)[_0x3ee9c4(0x20c)](_0x3ee9c4(0x229));});_0x33a8e1(),window[_0x4e610d(0x1bd)]('DOMContentLoaded',()=>{const _0x5ea830=_0x4e610d,_0x40e16a=document[_0x5ea830(0x1a5)](_0x5ea830(0x22d));_0x40e16a&&(_0x40e16a[_0x5ea830(0x205)]=penAlphaMode,_0x40e16a[_0x5ea830(0x1e7)]=_0x4a955e=>{penAlphaMode=_0x4a955e['target']['value'];});const _0x20599d=document[_0x5ea830(0x1a5)](_0x5ea830(0x198));if(_0x20599d){const _0x4a2521=localStorage[_0x5ea830(0x18a)](_0x5ea830(0x226))||_0x5ea830(0x187);applyTheme(_0x4a2521),_0x20599d['addEventListener'](_0x5ea830(0x1e3),()=>{toggleTheme();});}window[_0x5ea830(0x1bd)](_0x5ea830(0x18d),updateMenuBtnDisplay),updateMenuBtnDisplay();const _0x28522a=document[_0x5ea830(0x1a5)](_0x5ea830(0x1b0)),_0x4d6135=document['getElementById'](_0x5ea830(0x21f)),_0x345c0e=document[_0x5ea830(0x1a5)](_0x5ea830(0x194)),_0x7f7509=document[_0x5ea830(0x218)]('.tool-btn-container'),_0x2b145f=document[_0x5ea830(0x218)](_0x5ea830(0x1f8)),_0x3a5278=_0x345c0e?_0x345c0e['parentNode']:null,_0xcf91c5=_0x345c0e?_0x345c0e[_0x5ea830(0x1d8)]:null;let _0x1f7bea=null;function _0x54e280(){const _0x3e4684=_0x5ea830;try{if(!_0x345c0e)return;const _0x317725=window[_0x3e4684(0x1d9)],_0x1bb8c3=_0x317725<=0x384;if(_0x1bb8c3&&_0x7f7509&&_0x345c0e[_0x3e4684(0x1a1)]!==_0x7f7509){if(_0x1f7bea===null)_0x1f7bea=_0x345c0e[_0x3e4684(0x1c4)](_0x3e4684(0x1c0))||'';_0x7f7509[_0x3e4684(0x19f)](_0x345c0e),_0x345c0e['classList']['add'](_0x3e4684(0x1f4));const _0x1e851f=_0x2b145f?_0x2b145f[_0x3e4684(0x21c)]:0x38;_0x345c0e[_0x3e4684(0x1c0)][_0x3e4684(0x1b3)]='fixed',_0x345c0e[_0x3e4684(0x1c0)][_0x3e4684(0x195)]='8px',_0x345c0e['style'][_0x3e4684(0x190)]=_0x3e4684(0x210),_0x345c0e[_0x3e4684(0x1c0)][_0x3e4684(0x18e)]=_0x1e851f+0x8+'px',_0x345c0e[_0x3e4684(0x1c0)][_0x3e4684(0x1d0)]=0x1770,_0x345c0e[_0x3e4684(0x1c0)]['width']='auto',_0x345c0e[_0x3e4684(0x1c0)]['boxShadow']=_0x3e4684(0x1d6),_0x345c0e[_0x3e4684(0x1c0)][_0x3e4684(0x192)]=_0x3e4684(0x1bc);}else{if(!_0x1bb8c3&&_0x3a5278&&_0x345c0e[_0x3e4684(0x1a1)]!==_0x3a5278){_0xcf91c5&&_0xcf91c5[_0x3e4684(0x1a1)]===_0x3a5278?_0x3a5278[_0x3e4684(0x1ce)](_0x345c0e,_0xcf91c5):_0x3a5278[_0x3e4684(0x19f)](_0x345c0e);_0x345c0e[_0x3e4684(0x211)][_0x3e4684(0x1a0)](_0x3e4684(0x1f4));if(_0x1f7bea!==null){if(_0x1f7bea==='')_0x345c0e[_0x3e4684(0x202)](_0x3e4684(0x1c0));else _0x345c0e[_0x3e4684(0x1d5)](_0x3e4684(0x1c0),_0x1f7bea);_0x1f7bea=null;}}else{if(_0x1bb8c3&&_0x345c0e[_0x3e4684(0x1a1)]===_0x7f7509){const _0x1c864f=_0x2b145f?_0x2b145f[_0x3e4684(0x21c)]:0x38;_0x345c0e[_0x3e4684(0x1c0)][_0x3e4684(0x18e)]=_0x1c864f+0x8+'px';}}}}catch(_0x5f1713){console[_0x3e4684(0x1c1)](_0x3e4684(0x1a8),_0x5f1713);}}_0x28522a&&(_0x28522a[_0x5ea830(0x1c0)][_0x5ea830(0x192)]=_0x5ea830(0x1cf),_0x28522a[_0x5ea830(0x1bd)](_0x5ea830(0x1e3),()=>{const _0xeefa6c=_0x5ea830;if(window[_0xeefa6c(0x1d9)]<=0x384&&_0x345c0e){const _0xa2b259=_0x345c0e[_0xeefa6c(0x1c0)]['display']!==_0xeefa6c(0x1bc);_0x345c0e[_0xeefa6c(0x1c0)][_0xeefa6c(0x192)]=_0xa2b259?'none':_0xeefa6c(0x1b5),_0x345c0e[_0xeefa6c(0x211)][_0xeefa6c(0x1c3)](_0xeefa6c(0x1d3),!_0xa2b259);}else _0x4d6135&&_0x4d6135[_0xeefa6c(0x211)][_0xeefa6c(0x1c3)](_0xeefa6c(0x21a));}));window[_0x5ea830(0x1bd)](_0x5ea830(0x18d),_0x54e280),_0x54e280();const _0x3ecc14=document[_0x5ea830(0x1a5)](_0x5ea830(0x196));_0x3ecc14&&(_0x3ecc14[_0x5ea830(0x21d)]=_0x4f63d=>setZoomValue(_0x4f63d[_0x5ea830(0x216)]['value']));const _0x4ac2c6=document['getElementById'](_0x5ea830(0x1d7)),_0xb190=document[_0x5ea830(0x1a5)](_0x5ea830(0x20b));function _0x288b4c(){const _0x122b17=_0x5ea830;if(typeof showColorPickerDialog!=='function')return;const _0x9def9=currentColor==='transparent'||!currentColor?_0x122b17(0x191):currentColor;showColorPickerDialog({'color':_0x9def9,'alpha':typeof currentAlpha===_0x122b17(0x1c2)?currentAlpha:0x1,'onChange':({hex:_0x26a209,rgba:_0x16b38c,a:_0x1b90e1})=>{const _0x2442ba=_0x122b17;try{_0x16b38c&&_0x16b38c[0x3]===0x0?(currentColor=_0x2442ba(0x1c7),currentAlpha=0x0):(currentColor=_0x26a209||(_0x16b38c?rgbToHex(_0x16b38c[0x0],_0x16b38c[0x1],_0x16b38c[0x2]):_0x9def9),currentAlpha=_0x16b38c&&typeof _0x16b38c[0x3]==='number'?_0x16b38c[0x3]:_0x1b90e1||0x1);updateCurrentColorSwatch();const _0x3f5d0f=document[_0x2442ba(0x1a5)](_0x2442ba(0x1ba));if(_0x3f5d0f&&currentColor!==_0x2442ba(0x1c7))_0x3f5d0f[_0x2442ba(0x205)]=currentColor;}catch(_0x38bca5){console[_0x2442ba(0x1c1)]('color\x20picker\x20onChange\x20error',_0x38bca5);}},'onOk':({hex:_0x1c1f49,rgba:_0x17c97f,a:_0x413ad0})=>{const _0x1c1d4a=_0x122b17;_0x17c97f&&_0x17c97f[0x3]===0x0?(currentColor=_0x1c1d4a(0x1c7),currentAlpha=0x0):(currentColor=_0x1c1f49||(_0x17c97f?rgbToHex(_0x17c97f[0x0],_0x17c97f[0x1],_0x17c97f[0x2]):_0x9def9),currentAlpha=_0x17c97f&&typeof _0x17c97f[0x3]==='number'?_0x17c97f[0x3]:_0x413ad0||0x1);updateCurrentColorSwatch();const _0x41da33=document[_0x1c1d4a(0x1a5)]('colorPicker');if(_0x41da33&&currentColor!==_0x1c1d4a(0x1c7))_0x41da33[_0x1c1d4a(0x205)]=currentColor;}});}if(_0x4ac2c6)_0x4ac2c6[_0x5ea830(0x1bd)]('click',_0x288b4c);if(_0xb190)_0xb190['addEventListener']('click',_0x288b4c);const _0x528e17=document['getElementById'](_0x5ea830(0x1bf)),_0x2392e1=document[_0x5ea830(0x1a5)](_0x5ea830(0x1fb));if(_0x528e17)_0x528e17['addEventListener'](_0x5ea830(0x1e3),()=>{const _0x2f4df8=_0x5ea830;try{copyLayer();}catch(_0x4ca60c){console[_0x2f4df8(0x1c1)](_0x2f4df8(0x1ed),_0x4ca60c);}});_0x2392e1&&(_0x2392e1['addEventListener']('click',()=>{const _0x4e5657=_0x5ea830;try{pasteLayer();}catch(_0x568ee8){console[_0x4e5657(0x1c1)]('pasteLayer\x20error',_0x568ee8);}}),_0x2392e1[_0x5ea830(0x1a2)]=!copiedLayerDataUrl);let _0x30cdc3=![],_0x52c288=null;function _0x21095b(_0x200c03){const _0x28d2d2=_0x5ea830;if(!_0x200c03)return![];const _0x12503c=_0x200c03['tagName']&&_0x200c03[_0x28d2d2(0x1e5)][_0x28d2d2(0x1bb)]();if(_0x12503c===_0x28d2d2(0x208)||_0x12503c===_0x28d2d2(0x1ca)||_0x12503c===_0x28d2d2(0x223))return!![];if(_0x200c03[_0x28d2d2(0x1ef)])return!![];return![];}window[_0x5ea830(0x1bd)](_0x5ea830(0x206),_0x56be4a=>{const _0x147163=_0x5ea830;_0x56be4a['key']===_0x147163(0x1ea)&&!_0x30cdc3&&!_0x21095b(document[_0x147163(0x22b)])&&(_0x52c288=currentTool,setTool(_0x147163(0x197)),_0x30cdc3=!![]);},{'passive':!![]}),window[_0x5ea830(0x1bd)]('keyup',_0x5ced86=>{const _0x574e9b=_0x5ea830;if(_0x5ced86[_0x574e9b(0x228)]===_0x574e9b(0x1ea)&&_0x30cdc3){if(currentTool===_0x574e9b(0x197)&&_0x52c288)setTool(_0x52c288);_0x52c288=null,_0x30cdc3=![];}},{'passive':!![]}),window[_0x5ea830(0x1bd)](_0x5ea830(0x206),_0xc353de=>{const _0x4cd7b3=_0x5ea830;if(_0x21095b(document[_0x4cd7b3(0x22b)]))return;const _0x2f3b1d=navigator[_0x4cd7b3(0x1f2)]&&navigator['platform'][_0x4cd7b3(0x1cc)]()[_0x4cd7b3(0x220)](_0x4cd7b3(0x222))>=0x0,_0x46e137=_0x2f3b1d?_0xc353de[_0x4cd7b3(0x1fa)]:_0xc353de[_0x4cd7b3(0x201)];if(!_0x46e137)return;const _0x5b29b1=(_0xc353de[_0x4cd7b3(0x228)]||'')[_0x4cd7b3(0x1bb)]();if(_0x5b29b1==='z'&&!_0xc353de[_0x4cd7b3(0x217)]){_0xc353de[_0x4cd7b3(0x1b1)]();try{undo();}catch(_0x8ddc25){console['error'](_0x4cd7b3(0x1b4),_0x8ddc25);}}else{if(_0x5b29b1==='z'&&_0xc353de['shiftKey']||_0x5b29b1==='y'){_0xc353de['preventDefault']();try{redo();}catch(_0x4de3e8){console[_0x4cd7b3(0x1c1)](_0x4cd7b3(0x1ab),_0x4de3e8);}}}},{'passive':![]}),window['showAboutDialog']=function(){const _0xf4354=_0x5ea830;if(document[_0xf4354(0x1a5)]('about-dialog'))return;const _0x380252=document['createElement'](_0xf4354(0x1f0));_0x380252['id']=_0xf4354(0x1cb),_0x380252[_0xf4354(0x1c0)]['position']='fixed',_0x380252[_0xf4354(0x1c0)][_0xf4354(0x195)]='0',_0x380252['style'][_0xf4354(0x19a)]='0',_0x380252[_0xf4354(0x1c0)][_0xf4354(0x207)]='100vw',_0x380252[_0xf4354(0x1c0)]['height']=_0xf4354(0x224),_0x380252['style']['display']=_0xf4354(0x18c),_0x380252[_0xf4354(0x1c0)][_0xf4354(0x1ac)]=_0xf4354(0x19c),_0x380252[_0xf4354(0x1c0)][_0xf4354(0x188)]='center',_0x380252['style'][_0xf4354(0x1d0)]=0x2710,_0x380252['style'][_0xf4354(0x1d4)]='rgba(0,0,0,0.35)';const _0x437aa7=window['NEZUMI_BUILD_META']||{},_0x48e7d=_0x437aa7[_0xf4354(0x1b6)]||'不明',_0x4e9366=_0x437aa7['id']||'不明';_0x380252['innerHTML']=_0xf4354(0x1cd)+_0x48e7d+_0xf4354(0x1eb)+_0x4e9366+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>©\x202025\x20nezumi-sketch\x20<a\x20href=\x22https://github.com/mouse0329\x22\x20rel=\x22noopener\x20noreferrer\x22>github\x20mouse0329</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><a\x20href=\x22/terms\x22>利用規約</a>\u3000<a\x20href=\x22/license\x22>ライセンス</a>\u3000<a\x20href=\x22/about\x22>紹介ページ</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:right;margin-top:10px;\x22><button\x20id=\x22aboutCloseBtn\x22>閉じる</button></div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',document['body'][_0xf4354(0x19f)](_0x380252),_0x380252[_0xf4354(0x218)](_0xf4354(0x1a9))[_0xf4354(0x227)]=()=>_0x380252['remove'](),_0x380252[_0xf4354(0x1bd)](_0xf4354(0x1e3),_0x51b855=>{const _0x33eec5=_0xf4354;if(_0x51b855[_0x33eec5(0x216)]===_0x380252)_0x380252[_0x33eec5(0x1a0)]();});};const _0x4fba54=document['getElementById'](_0x5ea830(0x219)),_0x20cbfb=document['getElementById'](_0x5ea830(0x204)),_0x39c565=document[_0x5ea830(0x1a5)](_0x5ea830(0x1df)),_0x1b87ec=document[_0x5ea830(0x1a5)](_0x5ea830(0x209)),_0x9f21f=document['getElementById'](_0x5ea830(0x225));function _0x2ce15d(){const _0x290223=_0x5ea830;let _0xc2083a=0x1;if(_0x9f21f){_0xc2083a=parseInt(_0x9f21f[_0x290223(0x205)],0xa)||0x1;if(_0xc2083a<0x1)_0xc2083a=0x1;}return _0xc2083a;}if(_0x4fba54)_0x4fba54[_0x5ea830(0x1bd)](_0x5ea830(0x1e3),()=>nudgeActiveLayer(0x0,-_0x2ce15d()));if(_0x20cbfb)_0x20cbfb[_0x5ea830(0x1bd)](_0x5ea830(0x1e3),()=>nudgeActiveLayer(0x0,_0x2ce15d()));if(_0x39c565)_0x39c565[_0x5ea830(0x1bd)](_0x5ea830(0x1e3),()=>nudgeActiveLayer(-_0x2ce15d(),0x0));if(_0x1b87ec)_0x1b87ec[_0x5ea830(0x1bd)](_0x5ea830(0x1e3),()=>nudgeActiveLayer(_0x2ce15d(),0x0));const _0x2269a7=document[_0x5ea830(0x1a5)](_0x5ea830(0x203));_0x2269a7&&_0x2269a7['addEventListener'](_0x5ea830(0x1e3),()=>toggleFrontLayerDim());try{toggleGrid(showGrid);}catch(_0x2294f7){}try{toggleFrontLayerDim(dimFrontLayers);}catch(_0x39a832){}try{updateAnimUi(![]);}catch(_0x450393){}}),window['onload']=()=>{const _0x559a4c=_0x4e610d;canvas=document[_0x559a4c(0x1a5)](_0x559a4c(0x1e0)),wrapper=document[_0x559a4c(0x1a5)](_0x559a4c(0x1dd))||canvas?.[_0x559a4c(0x1e2)]||null;if(!canvas){console[_0x559a4c(0x1c1)](_0x559a4c(0x1b8));return;}ctx=canvas[_0x559a4c(0x1ee)]('2d'),projects=[createProject()],activeProject=0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),initCanvas(),setTool(_0x559a4c(0x1a3)),updateCurrentColorSwatch(),loadPaletteFromDB()['then'](()=>createPalette());const _0x31b005=document[_0x559a4c(0x1a5)](_0x559a4c(0x18f));if(_0x31b005)_0x31b005['value']=penSize;const _0x1147d2=document['getElementById'](_0x559a4c(0x20a));if(_0x1147d2)_0x1147d2[_0x559a4c(0x205)]=penMode;const _0x34ff43=document[_0x559a4c(0x1a5)](_0x559a4c(0x1f6)),_0x3d6d7a=document['getElementById'](_0x559a4c(0x1ff));_0x34ff43&&_0x3d6d7a&&((!Number['isFinite'](animationDelay)||animationDelay<=0x0)&&(animationDelay=0x12c),_0x34ff43['value']=animationDelay,_0x3d6d7a[_0x559a4c(0x205)]=animationDelay,_0x34ff43[_0x559a4c(0x21d)]=_0x2708bc=>{const _0x298abf=_0x559a4c;_0x3d6d7a['value']=_0x2708bc['target'][_0x298abf(0x205)],setAnimationDelay(_0x2708bc[_0x298abf(0x216)]['value']);},_0x3d6d7a[_0x559a4c(0x1e7)]=_0x15e2d6=>{const _0xe1f8a5=_0x559a4c;let _0x28f867=Math[_0xe1f8a5(0x20f)](0xa,Math[_0xe1f8a5(0x20d)](0x1388,parseInt(_0x15e2d6[_0xe1f8a5(0x216)][_0xe1f8a5(0x205)],0xa)||animationDelay));_0x34ff43['value']=_0x28f867,_0x3d6d7a[_0xe1f8a5(0x205)]=_0x28f867,setAnimationDelay(_0x28f867);});canvas[_0x559a4c(0x189)]=handleMouseDown,canvas[_0x559a4c(0x1fd)]=handleMouseMove,canvas[_0x559a4c(0x1b9)]=handleMouseUp,canvas[_0x559a4c(0x19b)]=handleMouseUp,canvas[_0x559a4c(0x1e8)]=handleTouchStart,canvas[_0x559a4c(0x1f7)]=handleTouchMove,canvas[_0x559a4c(0x1e4)]=handleTouchEnd,canvas[_0x559a4c(0x199)]=handleTouchEnd,canvas[_0x559a4c(0x1bd)](_0x559a4c(0x1b2),handleTouchStart,{'passive':![]}),canvas[_0x559a4c(0x1bd)](_0x559a4c(0x1e6),handleTouchMove,{'passive':![]}),canvas[_0x559a4c(0x1bd)](_0x559a4c(0x212),handleTouchEnd,{'passive':![]}),canvas['addEventListener'](_0x559a4c(0x19d),handleTouchEnd,{'passive':![]});try{showLoading(_0x559a4c(0x213));}catch(_0x100a58){}loadProjectFromIDB()[_0x559a4c(0x221)](_0x522c58=>{const _0x119eef=_0x559a4c;console['warn'](_0x119eef(0x19e),_0x522c58);})['finally'](()=>{const _0xe5537c=_0x559a4c;try{hideLoading();}catch(_0x1c866d){}if(typeof window[_0xe5537c(0x1ae)]===_0xe5537c(0x1fe))window[_0xe5537c(0x1ae)]();});};function handleMouseDown(_0x8c7399){const _0x599b93=_0x4e610d;if(currentTool===_0x599b93(0x197)){isDrawing=!![],panStart={'x':_0x8c7399[_0x599b93(0x1aa)],'y':_0x8c7399[_0x599b93(0x1da)],'posX':posX,'posY':posY},canvas[_0x599b93(0x1c0)][_0x599b93(0x18b)]=_0x599b93(0x1ad);return;}isDrawing=!![],saveHistory();const _0x2de174=getCanvasCoords(_0x8c7399),_0x313f8f=Math['floor'](_0x2de174['x']/cellSize),_0x291749=Math[_0x599b93(0x1a6)](_0x2de174['y']/cellSize);currentTool===_0x599b93(0x1c8)?(fillAt(_0x313f8f,_0x291749),saveHistory(),isDrawing=![],lastMouse=null):(drawDotXY(_0x313f8f,_0x291749),lastMouse={'x':_0x313f8f,'y':_0x291749});}function handleMouseMove(_0x3e0234){const _0x452269=_0x4e610d;if(!isDrawing)return;if(currentTool==='pan'&&panStart){const _0x35787a=_0x3e0234[_0x452269(0x1aa)]-panStart['x'],_0x19f89e=_0x3e0234[_0x452269(0x1da)]-panStart['y'];posX=panStart[_0x452269(0x21b)]+_0x35787a,posY=panStart[_0x452269(0x1c9)]+_0x19f89e,updateTransform();return;}const _0x597e5a=getCanvasCoords(_0x3e0234),_0x30d6a5=Math['floor'](_0x597e5a['x']/cellSize),_0x29d808=Math[_0x452269(0x1a6)](_0x597e5a['y']/cellSize);if(!lastMouse){drawDotXY(_0x30d6a5,_0x29d808),lastMouse={'x':_0x30d6a5,'y':_0x29d808};return;}const _0x173223=_0x30d6a5-lastMouse['x'],_0x4e7510=_0x29d808-lastMouse['y'],_0x37f011=Math[_0x452269(0x20f)](Math[_0x452269(0x1dc)](_0x173223),Math[_0x452269(0x1dc)](_0x4e7510));if(_0x37f011<=0x1)drawDotXY(_0x30d6a5,_0x29d808);else for(let _0x36f351=0x1;_0x36f351<=_0x37f011;_0x36f351++){const _0x5ad2df=Math[_0x452269(0x200)](lastMouse['x']+_0x173223*_0x36f351/_0x37f011),_0x4e1e2e=Math[_0x452269(0x200)](lastMouse['y']+_0x4e7510*_0x36f351/_0x37f011);drawDotXY(_0x5ad2df,_0x4e1e2e);}lastMouse={'x':_0x30d6a5,'y':_0x29d808};}function handleMouseUp(_0x3afecd){const _0x2967bc=_0x4e610d;if(currentTool===_0x2967bc(0x197)){isDrawing=![],panStart=null,canvas[_0x2967bc(0x1c0)][_0x2967bc(0x18b)]='grab';return;}isDrawing&&saveHistory(),isDrawing=![],lastMouse=null;}function handleTouchStart(_0x28ea5b){const _0x4fd89c=_0x4e610d;if(_0x28ea5b[_0x4fd89c(0x1f9)]['length']===0x2){_0x28ea5b['preventDefault'](),isPinching=!![],isDrawing=![],lastTouch=null;const _0x23642e=_0x28ea5b[_0x4fd89c(0x1f9)][0x0],_0x3006b3=_0x28ea5b['touches'][0x1];pinchStartDistance=Math['hypot'](_0x3006b3[_0x4fd89c(0x1aa)]-_0x23642e['clientX'],_0x3006b3[_0x4fd89c(0x1da)]-_0x23642e[_0x4fd89c(0x1da)]),pinchStartMid={'clientX':(_0x23642e[_0x4fd89c(0x1aa)]+_0x3006b3['clientX'])/0x2,'clientY':(_0x23642e['clientY']+_0x3006b3[_0x4fd89c(0x1da)])/0x2},pinchStartScale=scale,pinchStartPosX=posX,pinchStartPosY=posY,pinchRect=canvas[_0x4fd89c(0x214)]();}else{if(_0x28ea5b[_0x4fd89c(0x1f9)][_0x4fd89c(0x21e)]===0x1){if(colorPickMode){_0x28ea5b[_0x4fd89c(0x1b1)]();const _0x342e10=_0x28ea5b[_0x4fd89c(0x1f9)][0x0];onCanvasColorPick({'clientX':_0x342e10['clientX'],'clientY':_0x342e10[_0x4fd89c(0x1da)]});return;}_0x28ea5b['preventDefault']();if(isPinching)return;const _0x506fb3=_0x28ea5b[_0x4fd89c(0x1f9)][0x0];if(currentTool===_0x4fd89c(0x197)){isDrawing=!![],panStart={'x':_0x506fb3['clientX'],'y':_0x506fb3[_0x4fd89c(0x1da)],'posX':posX,'posY':posY};if(canvas)canvas['style']['cursor']=_0x4fd89c(0x1ad);return;}isDrawing=!![],saveHistory();let _0x522f85=getTouchPos(_0x28ea5b);lastTouch=_0x522f85,currentTool==='fill'?(fillAt(_0x522f85['x'],_0x522f85['y']),saveHistory(),isDrawing=![]):drawDotTouch(_0x522f85['x'],_0x522f85['y']);}}}function _0x2b26(_0x5824d3,_0xbe1fd9){_0x5824d3=_0x5824d3-0x187;const _0x5cdffc=_0x465c();let _0x33a8e1=_0x5cdffc[_0x5824d3];return _0x33a8e1;}function handleTouchMove(_0xc6630f){const _0x43e976=_0x4e610d;if(!_0xc6630f)return;if(isPinching||_0xc6630f['touches']&&_0xc6630f[_0x43e976(0x1f9)][_0x43e976(0x21e)]===0x2){_0xc6630f[_0x43e976(0x1b1)](),isDrawing=![],lastTouch=null;const _0x5edf19=_0xc6630f['touches'][0x0],_0x16aca0=_0xc6630f[_0x43e976(0x1f9)][0x1],_0x323772=Math['hypot'](_0x16aca0[_0x43e976(0x1aa)]-_0x5edf19[_0x43e976(0x1aa)],_0x16aca0['clientY']-_0x5edf19[_0x43e976(0x1da)]),_0xe9892f={'clientX':(_0x5edf19[_0x43e976(0x1aa)]+_0x16aca0[_0x43e976(0x1aa)])/0x2,'clientY':(_0x5edf19['clientY']+_0x16aca0[_0x43e976(0x1da)])/0x2};if(!pinchStartDistance)pinchStartDistance=_0x323772||0x1;let _0xf7e538=_0x323772/pinchStartDistance||0x1,_0xc4d4ac=pinchStartScale*_0xf7e538;_0xc4d4ac=Math[_0x43e976(0x20d)](Math[_0x43e976(0x20f)](_0xc4d4ac,0.2),0x5);const _0x351509=pinchRect||canvas[_0x43e976(0x214)](),_0x583991=(pinchStartMid[_0x43e976(0x1aa)]-_0x351509[_0x43e976(0x195)]-pinchStartPosX)/pinchStartScale,_0x5de46c=(pinchStartMid[_0x43e976(0x1da)]-_0x351509[_0x43e976(0x19a)]-pinchStartPosY)/pinchStartScale;posX=_0xe9892f[_0x43e976(0x1aa)]-_0x351509['left']-_0x583991*_0xc4d4ac,posY=_0xe9892f['clientY']-_0x351509['top']-_0x5de46c*_0xc4d4ac,scale=_0xc4d4ac,updateTransform();return;}if(currentTool==='pan'&&panStart&&_0xc6630f['touches']&&_0xc6630f['touches'][0x0]){_0xc6630f[_0x43e976(0x1b1)]();const _0x58609b=_0xc6630f[_0x43e976(0x1f9)][0x0],_0x441b36=_0x58609b['clientX']-panStart['x'],_0x240115=_0x58609b[_0x43e976(0x1da)]-panStart['y'];posX=panStart['posX']+_0x441b36,posY=panStart['posY']+_0x240115,updateTransform();return;}if(!isDrawing)return;if(_0xc6630f[_0x43e976(0x1f9)]&&_0xc6630f[_0x43e976(0x1f9)]['length']>0x1)return;_0xc6630f[_0x43e976(0x1b1)]();const _0x453702=getTouchPos(_0xc6630f);if(!_0x453702)return;if(lastTouch){const _0x8c60d7=Math['abs']((_0x453702['x']-lastTouch['x'])*cellSize),_0x1725ed=Math[_0x43e976(0x1dc)]((_0x453702['y']-lastTouch['y'])*cellSize);if(_0x8c60d7>=PAN_CANCEL_DISTANCE||_0x1725ed>=PAN_CANCEL_DISTANCE){if(currentTool!==_0x43e976(0x1a3)){isDrawing=![];return;}}}if(lastTouch){const _0x4682b6=_0x453702['x']-lastTouch['x'],_0xb743d3=_0x453702['y']-lastTouch['y'],_0x30632f=Math[_0x43e976(0x20f)](Math[_0x43e976(0x1dc)](_0x4682b6),Math['abs'](_0xb743d3));for(let _0x3cddb1=0x1;_0x3cddb1<=_0x30632f;_0x3cddb1++){const _0x5e9fdb=Math[_0x43e976(0x200)](lastTouch['x']+_0x4682b6*_0x3cddb1/_0x30632f),_0x18bca0=Math[_0x43e976(0x200)](lastTouch['y']+_0xb743d3*_0x3cddb1/_0x30632f);drawDotTouch(_0x5e9fdb,_0x18bca0);}}else drawDotTouch(_0x453702['x'],_0x453702['y']);lastTouch=_0x453702;}function handleTouchEnd(_0x5251ea){const _0x33c447=_0x4e610d;isPinching&&_0x5251ea['touches']&&_0x5251ea[_0x33c447(0x1f9)][_0x33c447(0x21e)]<0x2&&(isPinching=![],pinchStartDistance=0x0,pinchStartMid=null,pinchRect=null);isDrawing&&(!_0x5251ea[_0x33c447(0x1f9)]||_0x5251ea[_0x33c447(0x1f9)][_0x33c447(0x21e)]===0x0)&&saveHistory();if(_0x5251ea[_0x33c447(0x1f9)]&&_0x5251ea[_0x33c447(0x1f9)][_0x33c447(0x21e)]===0x1){let _0x2dbda1=_0x5251ea[_0x33c447(0x1f9)][0x0];lastTouch=getTouchPos({'touches':[_0x2dbda1]}),isDrawing=!![];if(currentTool===_0x33c447(0x197)){panStart={'x':_0x2dbda1[_0x33c447(0x1aa)],'y':_0x2dbda1['clientY'],'posX':posX,'posY':posY};if(canvas)canvas['style']['cursor']=_0x33c447(0x1ad);}}else{isDrawing=![],lastTouch=null;if(currentTool===_0x33c447(0x197)){panStart=null;if(canvas)canvas[_0x33c447(0x1c0)][_0x33c447(0x18b)]=_0x33c447(0x1d1);}}}function onCanvasColorPick(_0x151438){const _0x5c02e0=_0x4e610d;try{const _0x43c3e2=getCanvasCoords(_0x151438),_0x1e9ac9=Math[_0x5c02e0(0x1a6)](_0x43c3e2['x']),_0x1caf53=Math['floor'](_0x43c3e2['y']),_0x1270ec=ctx[_0x5c02e0(0x1de)](_0x1e9ac9,_0x1caf53,0x1,0x1)['data'],_0x1cf87b=_0x1270ec[0x0],_0x9e6d77=_0x1270ec[0x1],_0x20ef13=_0x1270ec[0x2],_0x5ac13b=_0x1270ec[0x3];if(_0x5ac13b===0x0){currentColor='transparent';const _0x548b60=document[_0x5c02e0(0x1a5)](_0x5c02e0(0x1ba));if(_0x548b60)_0x548b60['value']=_0x5c02e0(0x191);console[_0x5c02e0(0x1e1)](_0x5c02e0(0x1c5));}else{const _0x1a545c='#'+[_0x1cf87b,_0x9e6d77,_0x20ef13][_0x5c02e0(0x20e)](_0x230994=>_0x230994[_0x5c02e0(0x1fc)](0x10)[_0x5c02e0(0x1af)](0x2,'0'))[_0x5c02e0(0x1ec)]('');currentColor=_0x1a545c;const _0x29dea1=document[_0x5c02e0(0x1a5)](_0x5c02e0(0x1ba));if(_0x29dea1)_0x29dea1['value']=_0x1a545c;console[_0x5c02e0(0x1e1)](_0x5c02e0(0x1db),_0x1a545c);}}catch(_0x3eafe3){console[_0x5c02e0(0x1c1)](_0x5c02e0(0x1a4),_0x3eafe3);}colorPickMode=![];if(canvas)canvas[_0x5c02e0(0x1c0)][_0x5c02e0(0x18b)]='default';}