const _0x5be304=_0x4c99;(function(_0x244641,_0x757f2a){const _0x36d706=_0x4c99,_0x1711a4=_0x244641();while(!![]){try{const _0x23faff=-parseInt(_0x36d706(0xea))/0x1+-parseInt(_0x36d706(0x12d))/0x2*(parseInt(_0x36d706(0x121))/0x3)+-parseInt(_0x36d706(0xc7))/0x4*(-parseInt(_0x36d706(0x110))/0x5)+parseInt(_0x36d706(0xf6))/0x6+parseInt(_0x36d706(0xd4))/0x7+-parseInt(_0x36d706(0xfe))/0x8*(parseInt(_0x36d706(0xae))/0x9)+parseInt(_0x36d706(0xb5))/0xa*(parseInt(_0x36d706(0x13e))/0xb);if(_0x23faff===_0x757f2a)break;else _0x1711a4['push'](_0x1711a4['shift']());}catch(_0x586520){_0x1711a4['push'](_0x1711a4['shift']());}}}(_0x2a41,0xf255d));const _0x249dba=(function(){let _0x40deb0=!![];return function(_0x29de04,_0x2d118f){const _0x22b995=_0x40deb0?function(){const _0x3030e0=_0x4c99;if(_0x2d118f){const _0x1440c6=_0x2d118f[_0x3030e0(0xed)](_0x29de04,arguments);return _0x2d118f=null,_0x1440c6;}}:function(){};return _0x40deb0=![],_0x22b995;};}()),_0x31cfa8=_0x249dba(this,function(){const _0x9d6cd7=_0x4c99;return _0x31cfa8[_0x9d6cd7(0x120)]()['search'](_0x9d6cd7(0xcf))[_0x9d6cd7(0x120)]()[_0x9d6cd7(0xdd)](_0x31cfa8)[_0x9d6cd7(0xf7)](_0x9d6cd7(0xcf));});_0x31cfa8(),window['addEventListener'](_0x5be304(0xe9),()=>{const _0x40dcc6=_0x5be304,_0x301ff0=document[_0x40dcc6(0x105)](_0x40dcc6(0x13b));_0x301ff0&&(_0x301ff0[_0x40dcc6(0xb6)]=penAlphaMode,_0x301ff0[_0x40dcc6(0xc8)]=_0x565b55=>{const _0x297bc1=_0x40dcc6;penAlphaMode=_0x565b55[_0x297bc1(0xaa)][_0x297bc1(0xb6)];});const _0x16a356=document['getElementById'](_0x40dcc6(0x106));if(_0x16a356){const _0x1d6078=localStorage[_0x40dcc6(0xda)]('nezumi-theme')||'light';applyTheme(_0x1d6078),_0x16a356[_0x40dcc6(0xb9)](_0x40dcc6(0xee),()=>{toggleTheme();});}window[_0x40dcc6(0xb9)]('resize',updateMenuBtnDisplay),updateMenuBtnDisplay();const _0x1f6a1b=document[_0x40dcc6(0x105)](_0x40dcc6(0x124)),_0x3bb670=document[_0x40dcc6(0x105)](_0x40dcc6(0x10d)),_0x38fdcb=document[_0x40dcc6(0x105)](_0x40dcc6(0xfa)),_0x5cc23e=document[_0x40dcc6(0x135)](_0x40dcc6(0xff)),_0x46a3d8=document[_0x40dcc6(0x135)]('footer'),_0x1107e5=_0x38fdcb?_0x38fdcb[_0x40dcc6(0xdc)]:null,_0x540043=_0x38fdcb?_0x38fdcb[_0x40dcc6(0x108)]:null;let _0x1f5d6c=null;function _0x5c00e4(){const _0x4d6cbb=_0x40dcc6;try{if(!_0x38fdcb)return;const _0x3eb411=window[_0x4d6cbb(0xd0)],_0x15186e=_0x3eb411<=0x384;if(_0x15186e&&_0x5cc23e&&_0x38fdcb[_0x4d6cbb(0xdc)]!==_0x5cc23e){if(_0x1f5d6c===null)_0x1f5d6c=_0x38fdcb[_0x4d6cbb(0xce)](_0x4d6cbb(0x134))||'';_0x5cc23e[_0x4d6cbb(0xd7)](_0x38fdcb),_0x38fdcb[_0x4d6cbb(0xf2)][_0x4d6cbb(0x132)](_0x4d6cbb(0xad));const _0xa13f65=_0x46a3d8?_0x46a3d8[_0x4d6cbb(0x131)]:0x38;_0x38fdcb['style'][_0x4d6cbb(0x112)]='fixed',_0x38fdcb[_0x4d6cbb(0x134)][_0x4d6cbb(0xbb)]=_0x4d6cbb(0xdb),_0x38fdcb[_0x4d6cbb(0x134)][_0x4d6cbb(0xb4)]=_0x4d6cbb(0xdb),_0x38fdcb[_0x4d6cbb(0x134)][_0x4d6cbb(0xe5)]=_0xa13f65+0x8+'px',_0x38fdcb[_0x4d6cbb(0x134)][_0x4d6cbb(0xf9)]=0x1770,_0x38fdcb[_0x4d6cbb(0x134)][_0x4d6cbb(0xf1)]='auto',_0x38fdcb['style'][_0x4d6cbb(0x12c)]=_0x4d6cbb(0xe6),_0x38fdcb[_0x4d6cbb(0x134)]['display']='none';}else{if(!_0x15186e&&_0x1107e5&&_0x38fdcb[_0x4d6cbb(0xdc)]!==_0x1107e5){_0x540043&&_0x540043[_0x4d6cbb(0xdc)]===_0x1107e5?_0x1107e5[_0x4d6cbb(0x113)](_0x38fdcb,_0x540043):_0x1107e5[_0x4d6cbb(0xd7)](_0x38fdcb);_0x38fdcb['classList'][_0x4d6cbb(0x115)](_0x4d6cbb(0xad));if(_0x1f5d6c!==null){if(_0x1f5d6c==='')_0x38fdcb['removeAttribute'](_0x4d6cbb(0x134));else _0x38fdcb[_0x4d6cbb(0xb8)](_0x4d6cbb(0x134),_0x1f5d6c);_0x1f5d6c=null;}}else{if(_0x15186e&&_0x38fdcb[_0x4d6cbb(0xdc)]===_0x5cc23e){const _0x1b520c=_0x46a3d8?_0x46a3d8['offsetHeight']:0x38;_0x38fdcb[_0x4d6cbb(0x134)][_0x4d6cbb(0xe5)]=_0x1b520c+0x8+'px';}}}}catch(_0x52eee6){console[_0x4d6cbb(0xe0)]('relocateRightToolbar\x20error',_0x52eee6);}}_0x1f6a1b&&(_0x1f6a1b[_0x40dcc6(0x134)][_0x40dcc6(0xc5)]='inline-block',_0x1f6a1b[_0x40dcc6(0xb9)](_0x40dcc6(0xee),()=>{const _0x585ac8=_0x40dcc6;if(window[_0x585ac8(0xd0)]<=0x384&&_0x38fdcb){const _0x56bc7e=_0x38fdcb['style']['display']!==_0x585ac8(0x122);_0x38fdcb[_0x585ac8(0x134)][_0x585ac8(0xc5)]=_0x56bc7e?'none':'block',_0x38fdcb[_0x585ac8(0xf2)][_0x585ac8(0xe8)]('mobile-open',!_0x56bc7e);}else _0x3bb670&&_0x3bb670[_0x585ac8(0xf2)][_0x585ac8(0xe8)]('open');}));window[_0x40dcc6(0xb9)](_0x40dcc6(0x116),_0x5c00e4),_0x5c00e4();const _0x3b5c2d=document[_0x40dcc6(0x105)](_0x40dcc6(0xf4));_0x3b5c2d&&(_0x3b5c2d['oninput']=_0x283720=>setZoomValue(_0x283720[_0x40dcc6(0xaa)][_0x40dcc6(0xb6)]));const _0x3e5c24=document[_0x40dcc6(0x105)](_0x40dcc6(0xac)),_0x529dcb=document[_0x40dcc6(0x105)](_0x40dcc6(0xf5));function _0x464e46(){const _0x47268a=_0x40dcc6;if(typeof showColorPickerDialog!=='function')return;const _0x4efe3f=currentColor===_0x47268a(0x140)||!currentColor?_0x47268a(0x143):currentColor;showColorPickerDialog({'color':_0x4efe3f,'alpha':typeof currentAlpha==='number'?currentAlpha:0x1,'onChange':({hex:_0x52d794,rgba:_0x26ba7e,a:_0x589584})=>{const _0x42aeff=_0x47268a;try{_0x26ba7e&&_0x26ba7e[0x3]===0x0?(currentColor=_0x42aeff(0x140),currentAlpha=0x0):(currentColor=_0x52d794||(_0x26ba7e?rgbToHex(_0x26ba7e[0x0],_0x26ba7e[0x1],_0x26ba7e[0x2]):_0x4efe3f),currentAlpha=_0x26ba7e&&typeof _0x26ba7e[0x3]==='number'?_0x26ba7e[0x3]:_0x589584||0x1);updateCurrentColorSwatch();const _0x2b088f=document[_0x42aeff(0x105)]('colorPicker');if(_0x2b088f&&currentColor!==_0x42aeff(0x140))_0x2b088f['value']=currentColor;}catch(_0x56ee1d){console[_0x42aeff(0xe0)](_0x42aeff(0xd6),_0x56ee1d);}},'onOk':({hex:_0x17bfb4,rgba:_0x1903f5,a:_0x3476e9})=>{const _0x5098e8=_0x47268a;_0x1903f5&&_0x1903f5[0x3]===0x0?(currentColor=_0x5098e8(0x140),currentAlpha=0x0):(currentColor=_0x17bfb4||(_0x1903f5?rgbToHex(_0x1903f5[0x0],_0x1903f5[0x1],_0x1903f5[0x2]):_0x4efe3f),currentAlpha=_0x1903f5&&typeof _0x1903f5[0x3]===_0x5098e8(0x10c)?_0x1903f5[0x3]:_0x3476e9||0x1);updateCurrentColorSwatch();const _0xc08029=document[_0x5098e8(0x105)](_0x5098e8(0x104));if(_0xc08029&&currentColor!=='transparent')_0xc08029[_0x5098e8(0xb6)]=currentColor;}});}if(_0x3e5c24)_0x3e5c24[_0x40dcc6(0xb9)]('click',_0x464e46);if(_0x529dcb)_0x529dcb[_0x40dcc6(0xb9)](_0x40dcc6(0xee),_0x464e46);const _0x28fc27=document[_0x40dcc6(0x105)](_0x40dcc6(0xec)),_0x51d976=document['getElementById'](_0x40dcc6(0xc0));if(_0x28fc27)_0x28fc27[_0x40dcc6(0xb9)]('click',()=>{const _0x4ecdfd=_0x40dcc6;try{copyLayer();}catch(_0x353cd0){console[_0x4ecdfd(0xe0)](_0x4ecdfd(0x11b),_0x353cd0);}});_0x51d976&&(_0x51d976[_0x40dcc6(0xb9)](_0x40dcc6(0xee),()=>{const _0x208c1c=_0x40dcc6;try{pasteLayer();}catch(_0x2c9124){console[_0x208c1c(0xe0)](_0x208c1c(0xd3),_0x2c9124);}}),_0x51d976[_0x40dcc6(0xe4)]=!copiedLayerDataUrl);let _0x3028c=![],_0x3230c1=null;function _0x5d65e8(_0x157679){const _0x3dce3b=_0x40dcc6;if(!_0x157679)return![];const _0x3922a2=_0x157679[_0x3dce3b(0xc2)]&&_0x157679[_0x3dce3b(0xc2)][_0x3dce3b(0xe7)]();if(_0x3922a2==='input'||_0x3922a2==='textarea'||_0x3922a2===_0x3dce3b(0xb3))return!![];if(_0x157679[_0x3dce3b(0x144)])return!![];return![];}window[_0x40dcc6(0xb9)](_0x40dcc6(0xf0),_0x5721b2=>{const _0x533d95=_0x40dcc6;_0x5721b2[_0x533d95(0x10e)]===_0x533d95(0x13d)&&!_0x3028c&&!_0x5d65e8(document[_0x533d95(0xba)])&&(_0x3230c1=currentTool,setTool(_0x533d95(0xb2)),_0x3028c=!![]);},{'passive':!![]}),window[_0x40dcc6(0xb9)](_0x40dcc6(0xc6),_0x10d333=>{if(_0x10d333['key']==='Shift'&&_0x3028c){if(currentTool==='pan'&&_0x3230c1)setTool(_0x3230c1);_0x3230c1=null,_0x3028c=![];}},{'passive':!![]}),window[_0x40dcc6(0xb9)]('keydown',_0x189942=>{const _0x1f8d4a=_0x40dcc6;if(_0x5d65e8(document['activeElement']))return;const _0x26ab8c=navigator['platform']&&navigator['platform'][_0x1f8d4a(0xbd)]()[_0x1f8d4a(0x10a)](_0x1f8d4a(0xd8))>=0x0,_0x59f06d=_0x26ab8c?_0x189942[_0x1f8d4a(0x133)]:_0x189942[_0x1f8d4a(0x13c)];if(!_0x59f06d)return;const _0x44bbb3=(_0x189942[_0x1f8d4a(0x10e)]||'')['toLowerCase']();if(_0x44bbb3==='z'&&!_0x189942[_0x1f8d4a(0xde)]){_0x189942['preventDefault']();try{undo();}catch(_0xfb1f42){console[_0x1f8d4a(0xe0)](_0x1f8d4a(0x145),_0xfb1f42);}}else{if(_0x44bbb3==='z'&&_0x189942['shiftKey']||_0x44bbb3==='y'){_0x189942[_0x1f8d4a(0x11d)]();try{redo();}catch(_0x3493b6){console['error'](_0x1f8d4a(0x109),_0x3493b6);}}}},{'passive':![]}),window[_0x40dcc6(0xd5)]=function(){const _0x1c59c9=_0x40dcc6;if(document['getElementById'](_0x1c59c9(0xbe)))return;const _0x15b7b3=document[_0x1c59c9(0x12a)](_0x1c59c9(0xb0));_0x15b7b3['id']=_0x1c59c9(0xbe),_0x15b7b3[_0x1c59c9(0x134)]['position']=_0x1c59c9(0x129),_0x15b7b3[_0x1c59c9(0x134)][_0x1c59c9(0xbb)]='0',_0x15b7b3[_0x1c59c9(0x134)][_0x1c59c9(0x11a)]='0',_0x15b7b3[_0x1c59c9(0x134)][_0x1c59c9(0xf1)]=_0x1c59c9(0xb1),_0x15b7b3['style'][_0x1c59c9(0xef)]='100vh',_0x15b7b3[_0x1c59c9(0x134)][_0x1c59c9(0xc5)]=_0x1c59c9(0xbc),_0x15b7b3[_0x1c59c9(0x134)]['alignItems']=_0x1c59c9(0xd2),_0x15b7b3[_0x1c59c9(0x134)][_0x1c59c9(0xbf)]=_0x1c59c9(0xd2),_0x15b7b3[_0x1c59c9(0x134)][_0x1c59c9(0xf9)]=0x2710,_0x15b7b3[_0x1c59c9(0x134)][_0x1c59c9(0x12e)]=_0x1c59c9(0xd9);const _0x36eeb7=window[_0x1c59c9(0xfb)]||{},_0xcf40df=_0x36eeb7['version']||'不明',_0x5dd28a=_0x36eeb7['id']||'不明';_0x15b7b3[_0x1c59c9(0xaf)]='\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22background:var(--surface);padding:18px\x2022px;border-radius:10px;min-width:280px;max-width:720px;text-align:left;box-shadow:0\x202px\x2024px\x20rgba(0,0,0,0.25);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:0;\x22>ネズミスケッチについて</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ネズミスケッチは、簡単にドット絵アニメーションを作成できるツールです。</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>バージョン:\x20<b>'+_0xcf40df+'</b>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20バージョンID:\x20'+_0x5dd28a+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>©\x202025\x20nezumi-sketch\x20<a\x20href=\x22https://github.com/mouse0329\x22\x20rel=\x22noopener\x20noreferrer\x22>github\x20mouse0329</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><a\x20href=\x22/terms\x22>利用規約</a>\u3000<a\x20href=\x22/license\x22>ライセンス</a>\u3000<a\x20href=\x22/about\x22>紹介ページ</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:right;margin-top:10px;\x22><button\x20id=\x22aboutCloseBtn\x22>閉じる</button></div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',document[_0x1c59c9(0x10b)][_0x1c59c9(0xd7)](_0x15b7b3),_0x15b7b3['querySelector'](_0x1c59c9(0xc9))[_0x1c59c9(0x103)]=()=>_0x15b7b3[_0x1c59c9(0x115)](),_0x15b7b3[_0x1c59c9(0xb9)]('click',_0x3072d7=>{const _0x542eea=_0x1c59c9;if(_0x3072d7[_0x542eea(0xaa)]===_0x15b7b3)_0x15b7b3[_0x542eea(0x115)]();});};const _0x11be27=document['getElementById'](_0x40dcc6(0xd1)),_0x552252=document['getElementById']('nudgeDownBtn'),_0x584f1f=document[_0x40dcc6(0x105)](_0x40dcc6(0x13f)),_0x2d9b18=document[_0x40dcc6(0x105)]('nudgeRightBtn'),_0x1a7062=document[_0x40dcc6(0x105)](_0x40dcc6(0x102));function _0x26b0c1(){const _0x924258=_0x40dcc6;let _0x32fe12=0x1;if(_0x1a7062){_0x32fe12=parseInt(_0x1a7062[_0x924258(0xb6)],0xa)||0x1;if(_0x32fe12<0x1)_0x32fe12=0x1;}return _0x32fe12;}if(_0x11be27)_0x11be27[_0x40dcc6(0xb9)]('click',()=>nudgeActiveLayer(0x0,-_0x26b0c1()));if(_0x552252)_0x552252[_0x40dcc6(0xb9)]('click',()=>nudgeActiveLayer(0x0,_0x26b0c1()));if(_0x584f1f)_0x584f1f['addEventListener'](_0x40dcc6(0xee),()=>nudgeActiveLayer(-_0x26b0c1(),0x0));if(_0x2d9b18)_0x2d9b18[_0x40dcc6(0xb9)](_0x40dcc6(0xee),()=>nudgeActiveLayer(_0x26b0c1(),0x0));const _0xe43f38=document[_0x40dcc6(0x105)]('frontDimBtn');_0xe43f38&&_0xe43f38[_0x40dcc6(0xb9)](_0x40dcc6(0xee),()=>toggleFrontLayerDim());try{toggleGrid(showGrid);}catch(_0x38b973){}try{toggleFrontLayerDim(dimFrontLayers);}catch(_0x173e6b){}try{updateAnimUi(![]);}catch(_0x35e2b){}}),window['onload']=()=>{const _0x2e1e70=_0x5be304;canvas=document['getElementById']('canvas'),wrapper=document[_0x2e1e70(0x105)]('canvas-container')||canvas?.[_0x2e1e70(0x13a)]||null;if(!canvas){console[_0x2e1e70(0xe0)](_0x2e1e70(0xcb));return;}ctx=canvas['getContext']('2d'),projects=[createProject()],activeProject=0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),initCanvas(),setTool(_0x2e1e70(0x125)),updateCurrentColorSwatch(),loadPaletteFromDB()[_0x2e1e70(0x100)](()=>createPalette());const _0x514c7f=document[_0x2e1e70(0x105)]('penSize');if(_0x514c7f)_0x514c7f[_0x2e1e70(0xb6)]=penSize;const _0x4a71d8=document['getElementById'](_0x2e1e70(0x11e));if(_0x4a71d8)_0x4a71d8['value']=penMode;const _0x4bbf74=document[_0x2e1e70(0x105)](_0x2e1e70(0xdf)),_0x1a9d47=document[_0x2e1e70(0x105)](_0x2e1e70(0xfc));if(_0x4bbf74)_0x4bbf74['value']=canvas[_0x2e1e70(0xf1)];if(_0x1a9d47)_0x1a9d47[_0x2e1e70(0xb6)]=canvas[_0x2e1e70(0xef)];const _0xc7e52b=document[_0x2e1e70(0x105)]('animSpeedRange'),_0x3a1f81=document[_0x2e1e70(0x105)]('animSpeedValue');_0xc7e52b&&_0x3a1f81&&((!Number['isFinite'](animationDelay)||animationDelay<=0x0)&&(animationDelay=0x12c),_0xc7e52b[_0x2e1e70(0xb6)]=animationDelay,_0x3a1f81['value']=animationDelay,_0xc7e52b[_0x2e1e70(0x137)]=_0x250245=>{const _0x31074b=_0x2e1e70;_0x3a1f81['value']=_0x250245[_0x31074b(0xaa)][_0x31074b(0xb6)],setAnimationDelay(_0x250245[_0x31074b(0xaa)]['value']);},_0x3a1f81['onchange']=_0x126b1a=>{const _0xe12660=_0x2e1e70;let _0x55f5e9=Math['max'](0xa,Math[_0xe12660(0xe2)](0x1388,parseInt(_0x126b1a[_0xe12660(0xaa)]['value'],0xa)||animationDelay));_0xc7e52b['value']=_0x55f5e9,_0x3a1f81['value']=_0x55f5e9,setAnimationDelay(_0x55f5e9);});canvas['onmousedown']=handleMouseDown,canvas[_0x2e1e70(0xe1)]=handleMouseMove,canvas[_0x2e1e70(0x10f)]=handleMouseUp,canvas['onmouseleave']=handleMouseUp,canvas['ontouchstart']=handleTouchStart,canvas['ontouchmove']=handleTouchMove,canvas[_0x2e1e70(0xcc)]=handleTouchEnd,canvas[_0x2e1e70(0xfd)]=handleTouchEnd,canvas[_0x2e1e70(0xb9)](_0x2e1e70(0x11c),handleTouchStart,{'passive':![]}),canvas['addEventListener']('touchmove',handleTouchMove,{'passive':![]}),canvas[_0x2e1e70(0xb9)](_0x2e1e70(0xcd),handleTouchEnd,{'passive':![]}),canvas[_0x2e1e70(0xb9)]('touchcancel',handleTouchEnd,{'passive':![]});try{showLoading(_0x2e1e70(0x119));}catch(_0x59e478){}loadProjectFromIDB()['catch'](_0x2e3913=>{const _0x2cd014=_0x2e1e70;console[_0x2cd014(0x139)](_0x2cd014(0xab),_0x2e3913);})[_0x2e1e70(0x11f)](()=>{const _0x5b8969=_0x2e1e70;try{hideLoading();}catch(_0x16f35e){}if(typeof window[_0x5b8969(0xb7)]==='function')window[_0x5b8969(0xb7)]();});};function handleMouseDown(_0xd6155e){const _0x2d698e=_0x5be304;if(currentTool===_0x2d698e(0xb2)){isDrawing=!![],panStart={'x':_0xd6155e[_0x2d698e(0x117)],'y':_0xd6155e[_0x2d698e(0x138)],'posX':posX,'posY':posY},canvas[_0x2d698e(0x134)][_0x2d698e(0xc3)]=_0x2d698e(0x114);return;}isDrawing=!![],saveHistory();const _0x452436=getCanvasCoords(_0xd6155e),_0x56bde9=Math[_0x2d698e(0x126)](_0x452436['x']/cellSize),_0x30874e=Math[_0x2d698e(0x126)](_0x452436['y']/cellSize);currentTool===_0x2d698e(0x12f)?(fillAt(_0x56bde9,_0x30874e),saveHistory(),isDrawing=![],lastMouse=null):(drawDotXY(_0x56bde9,_0x30874e),lastMouse={'x':_0x56bde9,'y':_0x30874e});}function _0x4c99(_0x2fc2e1,_0x177aa0){_0x2fc2e1=_0x2fc2e1-0xaa;const _0x1c08d7=_0x2a41();let _0x31cfa8=_0x1c08d7[_0x2fc2e1];return _0x31cfa8;}function handleMouseMove(_0x2339b6){const _0x2ab56e=_0x5be304;if(!isDrawing)return;if(currentTool===_0x2ab56e(0xb2)&&panStart){const _0x16427a=_0x2339b6[_0x2ab56e(0x117)]-panStart['x'],_0x5ac7a3=_0x2339b6['clientY']-panStart['y'];posX=panStart[_0x2ab56e(0x141)]+_0x16427a,posY=panStart[_0x2ab56e(0xeb)]+_0x5ac7a3,updateTransform();return;}const _0x2911fc=getCanvasCoords(_0x2339b6),_0x5d5ab9=Math['floor'](_0x2911fc['x']/cellSize),_0x1e50ba=Math[_0x2ab56e(0x126)](_0x2911fc['y']/cellSize);if(!lastMouse){drawDotXY(_0x5d5ab9,_0x1e50ba),lastMouse={'x':_0x5d5ab9,'y':_0x1e50ba};return;}const _0x45201d=_0x5d5ab9-lastMouse['x'],_0x23a34a=_0x1e50ba-lastMouse['y'],_0x3f1d19=Math[_0x2ab56e(0xc4)](Math[_0x2ab56e(0x118)](_0x45201d),Math[_0x2ab56e(0x118)](_0x23a34a));if(_0x3f1d19<=0x1)drawDotXY(_0x5d5ab9,_0x1e50ba);else for(let _0x4ad33f=0x1;_0x4ad33f<=_0x3f1d19;_0x4ad33f++){const _0x2e4e99=Math[_0x2ab56e(0xe3)](lastMouse['x']+_0x45201d*_0x4ad33f/_0x3f1d19),_0x104bcc=Math[_0x2ab56e(0xe3)](lastMouse['y']+_0x23a34a*_0x4ad33f/_0x3f1d19);drawDotXY(_0x2e4e99,_0x104bcc);}lastMouse={'x':_0x5d5ab9,'y':_0x1e50ba};}function handleMouseUp(_0x3d416c){const _0x2b7f53=_0x5be304;if(currentTool===_0x2b7f53(0xb2)){isDrawing=![],panStart=null,canvas[_0x2b7f53(0x134)][_0x2b7f53(0xc3)]=_0x2b7f53(0x107);return;}isDrawing&&saveHistory(),isDrawing=![],lastMouse=null;}function handleTouchStart(_0x23420e){const _0x35ddd4=_0x5be304;if(_0x23420e[_0x35ddd4(0x136)]['length']===0x2){_0x23420e[_0x35ddd4(0x11d)](),isPinching=!![],isDrawing=![],lastTouch=null;const _0x5cf70c=_0x23420e['touches'][0x0],_0x202abb=_0x23420e[_0x35ddd4(0x136)][0x1];pinchStartDistance=Math[_0x35ddd4(0xf3)](_0x202abb[_0x35ddd4(0x117)]-_0x5cf70c[_0x35ddd4(0x117)],_0x202abb['clientY']-_0x5cf70c[_0x35ddd4(0x138)]),pinchStartMid={'clientX':(_0x5cf70c[_0x35ddd4(0x117)]+_0x202abb['clientX'])/0x2,'clientY':(_0x5cf70c[_0x35ddd4(0x138)]+_0x202abb[_0x35ddd4(0x138)])/0x2},pinchStartScale=scale,pinchStartPosX=posX,pinchStartPosY=posY,pinchRect=canvas[_0x35ddd4(0x128)]();}else{if(_0x23420e[_0x35ddd4(0x136)][_0x35ddd4(0x123)]===0x1){if(colorPickMode){_0x23420e['preventDefault']();const _0x5b5584=_0x23420e[_0x35ddd4(0x136)][0x0];onCanvasColorPick({'clientX':_0x5b5584[_0x35ddd4(0x117)],'clientY':_0x5b5584['clientY']});return;}_0x23420e[_0x35ddd4(0x11d)]();if(isPinching)return;const _0x530d50=_0x23420e[_0x35ddd4(0x136)][0x0];if(currentTool===_0x35ddd4(0xb2)){isDrawing=!![],panStart={'x':_0x530d50[_0x35ddd4(0x117)],'y':_0x530d50[_0x35ddd4(0x138)],'posX':posX,'posY':posY};if(canvas)canvas['style'][_0x35ddd4(0xc3)]=_0x35ddd4(0x114);return;}isDrawing=!![],saveHistory();let _0x571866=getTouchPos(_0x23420e);lastTouch=_0x571866,currentTool===_0x35ddd4(0x12f)?(fillAt(_0x571866['x'],_0x571866['y']),saveHistory(),isDrawing=![]):drawDotTouch(_0x571866['x'],_0x571866['y']);}}}function handleTouchMove(_0x3e7492){const _0x2aa91b=_0x5be304;if(!_0x3e7492)return;if(isPinching||_0x3e7492[_0x2aa91b(0x136)]&&_0x3e7492[_0x2aa91b(0x136)][_0x2aa91b(0x123)]===0x2){_0x3e7492[_0x2aa91b(0x11d)](),isDrawing=![],lastTouch=null;const _0x38519f=_0x3e7492[_0x2aa91b(0x136)][0x0],_0x37c965=_0x3e7492[_0x2aa91b(0x136)][0x1],_0x52ce0a=Math[_0x2aa91b(0xf3)](_0x37c965['clientX']-_0x38519f[_0x2aa91b(0x117)],_0x37c965[_0x2aa91b(0x138)]-_0x38519f[_0x2aa91b(0x138)]),_0x1343f1={'clientX':(_0x38519f['clientX']+_0x37c965[_0x2aa91b(0x117)])/0x2,'clientY':(_0x38519f[_0x2aa91b(0x138)]+_0x37c965[_0x2aa91b(0x138)])/0x2};if(!pinchStartDistance)pinchStartDistance=_0x52ce0a||0x1;let _0x41a627=_0x52ce0a/pinchStartDistance||0x1,_0x53e754=pinchStartScale*_0x41a627;_0x53e754=Math['min'](Math['max'](_0x53e754,0.2),0x5);const _0x2af541=pinchRect||canvas[_0x2aa91b(0x128)](),_0x21400d=(pinchStartMid[_0x2aa91b(0x117)]-_0x2af541[_0x2aa91b(0xbb)]-pinchStartPosX)/pinchStartScale,_0x58cab8=(pinchStartMid[_0x2aa91b(0x138)]-_0x2af541[_0x2aa91b(0x11a)]-pinchStartPosY)/pinchStartScale;posX=_0x1343f1[_0x2aa91b(0x117)]-_0x2af541[_0x2aa91b(0xbb)]-_0x21400d*_0x53e754,posY=_0x1343f1['clientY']-_0x2af541[_0x2aa91b(0x11a)]-_0x58cab8*_0x53e754,scale=_0x53e754,updateTransform();return;}if(currentTool===_0x2aa91b(0xb2)&&panStart&&_0x3e7492[_0x2aa91b(0x136)]&&_0x3e7492[_0x2aa91b(0x136)][0x0]){_0x3e7492[_0x2aa91b(0x11d)]();const _0x263f2e=_0x3e7492['touches'][0x0],_0x52cef4=_0x263f2e[_0x2aa91b(0x117)]-panStart['x'],_0x8e5280=_0x263f2e[_0x2aa91b(0x138)]-panStart['y'];posX=panStart[_0x2aa91b(0x141)]+_0x52cef4,posY=panStart[_0x2aa91b(0xeb)]+_0x8e5280,updateTransform();return;}if(!isDrawing)return;if(_0x3e7492[_0x2aa91b(0x136)]&&_0x3e7492[_0x2aa91b(0x136)][_0x2aa91b(0x123)]>0x1)return;_0x3e7492['preventDefault']();const _0xfbbdad=getTouchPos(_0x3e7492);if(!_0xfbbdad)return;if(lastTouch){const _0x3d6011=Math[_0x2aa91b(0x118)]((_0xfbbdad['x']-lastTouch['x'])*cellSize),_0x5aa0ab=Math[_0x2aa91b(0x118)]((_0xfbbdad['y']-lastTouch['y'])*cellSize);if(_0x3d6011>=PAN_CANCEL_DISTANCE||_0x5aa0ab>=PAN_CANCEL_DISTANCE){if(currentTool!==_0x2aa91b(0x125)){isDrawing=![];return;}}}if(lastTouch){const _0x5f397a=_0xfbbdad['x']-lastTouch['x'],_0x43f9b3=_0xfbbdad['y']-lastTouch['y'],_0x341b1c=Math[_0x2aa91b(0xc4)](Math['abs'](_0x5f397a),Math[_0x2aa91b(0x118)](_0x43f9b3));for(let _0x5884fc=0x1;_0x5884fc<=_0x341b1c;_0x5884fc++){const _0xbe75b3=Math[_0x2aa91b(0xe3)](lastTouch['x']+_0x5f397a*_0x5884fc/_0x341b1c),_0x599d0b=Math['round'](lastTouch['y']+_0x43f9b3*_0x5884fc/_0x341b1c);drawDotTouch(_0xbe75b3,_0x599d0b);}}else drawDotTouch(_0xfbbdad['x'],_0xfbbdad['y']);lastTouch=_0xfbbdad;}function _0x2a41(){const _0x2bac14=['pan','select','right','3782840fqAqax','value','startAutoSaveInterval','setAttribute','addEventListener','activeElement','left','flex','toUpperCase','about-dialog','justifyContent','pasteLayerBtn','data','tagName','cursor','max','display','keyup','289228gEZLRY','onchange','#aboutCloseBtn','onCanvasColorPick\x20error','canvas\x20要素が見つからないチュー','ontouchend','touchend','getAttribute','(((.+)+)+)+$','innerWidth','nudgeUpBtn','center','pasteLayer\x20error','2661281tRyCdA','showAboutDialog','color\x20picker\x20onChange\x20error','appendChild','MAC','rgba(0,0,0,0.35)','getItem','8px','parentNode','constructor','shiftKey','exportWidthPx','error','onmousemove','min','round','disabled','bottom','0\x202px\x2010px\x20rgba(0,0,0,0.15)','toLowerCase','toggle','DOMContentLoaded','1044845wANAbn','posY','copyLayerBtn','apply','click','height','keydown','width','classList','hypot','zoomSlider','currentColorSwatch','1969158PxdIkv','search','info','zIndex','right-toolbar','NEZUMI_BUILD_META','exportHeightPx','ontouchcancel','309208yuyWVr','.tool-btn-container','then','map','nudgeStep','onclick','colorPicker','getElementById','themeToggleBtn','grab','nextSibling','redo\x20shortcut\x20error','indexOf','body','number','right-panel','key','onmouseup','75zgxUQC','Picked\x20color','position','insertBefore','grabbing','remove','resize','clientX','abs','自動復元中...','top','copyLayer\x20error','touchstart','preventDefault','penMode','finally','toString','882498fsqOZh','none','length','toolsToggleBtn','pen','floor','getImageData','getBoundingClientRect','fixed','createElement','Picked\x20transparent','boxShadow','2tqjyTW','background','fill','padStart','offsetHeight','add','metaKey','style','querySelector','touches','oninput','clientY','warn','parentElement','penAlphaMode','ctrlKey','Shift','55OARRhY','nudgeLeftBtn','transparent','posX','join','#000000','isContentEditable','undo\x20shortcut\x20error','target','IndexedDB\x20からの読み込みに失敗したチュー','openColorPickerBtn','toolbar-mobile','315xOjEwo','innerHTML','div','100vw'];_0x2a41=function(){return _0x2bac14;};return _0x2a41();}function handleTouchEnd(_0x24c5c2){const _0x1a3148=_0x5be304;isPinching&&_0x24c5c2[_0x1a3148(0x136)]&&_0x24c5c2[_0x1a3148(0x136)][_0x1a3148(0x123)]<0x2&&(isPinching=![],pinchStartDistance=0x0,pinchStartMid=null,pinchRect=null);isDrawing&&(!_0x24c5c2['touches']||_0x24c5c2['touches'][_0x1a3148(0x123)]===0x0)&&saveHistory();if(_0x24c5c2[_0x1a3148(0x136)]&&_0x24c5c2[_0x1a3148(0x136)]['length']===0x1){let _0x7c3cce=_0x24c5c2[_0x1a3148(0x136)][0x0];lastTouch=getTouchPos({'touches':[_0x7c3cce]}),isDrawing=!![];if(currentTool===_0x1a3148(0xb2)){panStart={'x':_0x7c3cce[_0x1a3148(0x117)],'y':_0x7c3cce['clientY'],'posX':posX,'posY':posY};if(canvas)canvas[_0x1a3148(0x134)][_0x1a3148(0xc3)]=_0x1a3148(0x114);}}else{isDrawing=![],lastTouch=null;if(currentTool===_0x1a3148(0xb2)){panStart=null;if(canvas)canvas[_0x1a3148(0x134)][_0x1a3148(0xc3)]=_0x1a3148(0x107);}}}function onCanvasColorPick(_0xe309a9){const _0x637e54=_0x5be304;try{const _0x151548=getCanvasCoords(_0xe309a9),_0x253837=Math['floor'](_0x151548['x']),_0x46c88e=Math[_0x637e54(0x126)](_0x151548['y']),_0x3b353f=ctx[_0x637e54(0x127)](_0x253837,_0x46c88e,0x1,0x1)[_0x637e54(0xc1)],_0x16415f=_0x3b353f[0x0],_0x23ede0=_0x3b353f[0x1],_0xb073f0=_0x3b353f[0x2],_0x28bc57=_0x3b353f[0x3];if(_0x28bc57===0x0){currentColor=_0x637e54(0x140);const _0x408520=document['getElementById'](_0x637e54(0x104));if(_0x408520)_0x408520[_0x637e54(0xb6)]=_0x637e54(0x143);console[_0x637e54(0xf8)](_0x637e54(0x12b));}else{const _0x2ea6d2='#'+[_0x16415f,_0x23ede0,_0xb073f0][_0x637e54(0x101)](_0x59a3d2=>_0x59a3d2[_0x637e54(0x120)](0x10)[_0x637e54(0x130)](0x2,'0'))[_0x637e54(0x142)]('');currentColor=_0x2ea6d2;const _0x11aea1=document[_0x637e54(0x105)]('colorPicker');if(_0x11aea1)_0x11aea1['value']=_0x2ea6d2;console['info'](_0x637e54(0x111),_0x2ea6d2);}}catch(_0x48acdd){console[_0x637e54(0xe0)](_0x637e54(0xca),_0x48acdd);}colorPickMode=![];if(canvas)canvas[_0x637e54(0x134)][_0x637e54(0xc3)]='default';}