const _0x11b173=_0x5db9;(function(_0x4a2aeb,_0x3a3c5f){const _0x19c521=_0x5db9,_0x44068d=_0x4a2aeb();while(!![]){try{const _0x23438e=-parseInt(_0x19c521(0x176))/0x1+parseInt(_0x19c521(0x1cf))/0x2*(-parseInt(_0x19c521(0x172))/0x3)+parseInt(_0x19c521(0x1a2))/0x4*(-parseInt(_0x19c521(0x19d))/0x5)+parseInt(_0x19c521(0x1c2))/0x6*(-parseInt(_0x19c521(0x194))/0x7)+-parseInt(_0x19c521(0x1f4))/0x8+parseInt(_0x19c521(0x15f))/0x9*(parseInt(_0x19c521(0x17a))/0xa)+parseInt(_0x19c521(0x15e))/0xb;if(_0x23438e===_0x3a3c5f)break;else _0x44068d['push'](_0x44068d['shift']());}catch(_0x25e07d){_0x44068d['push'](_0x44068d['shift']());}}}(_0x4728,0x33332));const _0x275c3c=(function(){let _0x22554b=!![];return function(_0xcd710,_0x3d853a){const _0x3bbf10=_0x22554b?function(){const _0xc62bd=_0x5db9;if(_0x3d853a){const _0x221aef=_0x3d853a[_0xc62bd(0x1df)](_0xcd710,arguments);return _0x3d853a=null,_0x221aef;}}:function(){};return _0x22554b=![],_0x3bbf10;};}()),_0x492062=_0x275c3c(this,function(){const _0x47b279=_0x5db9;return _0x492062[_0x47b279(0x187)]()['search'](_0x47b279(0x1e6))[_0x47b279(0x187)]()[_0x47b279(0x1eb)](_0x492062)[_0x47b279(0x19c)](_0x47b279(0x1e6));});_0x492062(),window[_0x11b173(0x183)]('DOMContentLoaded',()=>{const _0x581b18=_0x11b173,_0x1cb6ab=document[_0x581b18(0x15d)](_0x581b18(0x1de));_0x1cb6ab&&(_0x1cb6ab[_0x581b18(0x1a8)]=penAlphaMode,_0x1cb6ab[_0x581b18(0x1c4)]=_0x45a1dd=>{const _0x5c6446=_0x581b18;penAlphaMode=_0x45a1dd['target'][_0x5c6446(0x1a8)];});const _0x1d7891=document[_0x581b18(0x15d)](_0x581b18(0x19e));if(_0x1d7891){const _0x1f9b8b=localStorage[_0x581b18(0x17c)](_0x581b18(0x1ee))||_0x581b18(0x17b);applyTheme(_0x1f9b8b),_0x1d7891[_0x581b18(0x183)](_0x581b18(0x1ef),()=>{toggleTheme();});}window[_0x581b18(0x183)](_0x581b18(0x1f6),updateMenuBtnDisplay),updateMenuBtnDisplay();const _0x1fd164=document['getElementById'](_0x581b18(0x1ec)),_0x2e82f3=document[_0x581b18(0x15d)](_0x581b18(0x19f)),_0x2ef885=document['getElementById']('right-toolbar'),_0xd53b67=document[_0x581b18(0x1b9)]('.tool-btn-container'),_0xb817e0=document[_0x581b18(0x1b9)]('footer'),_0x28d1c6=_0x2ef885?_0x2ef885['parentNode']:null,_0x332ecd=_0x2ef885?_0x2ef885[_0x581b18(0x157)]:null;let _0x327f10=null;function _0x3179ce(){const _0x585088=_0x581b18;try{if(!_0x2ef885)return;const _0xf5c075=window[_0x585088(0x177)],_0x144d1a=_0xf5c075<=0x384;if(_0x144d1a&&_0xd53b67&&_0x2ef885['parentNode']!==_0xd53b67){if(_0x327f10===null)_0x327f10=_0x2ef885[_0x585088(0x1b3)](_0x585088(0x1c1))||'';_0xd53b67['appendChild'](_0x2ef885),_0x2ef885[_0x585088(0x1cb)][_0x585088(0x171)](_0x585088(0x1af));const _0x14d5c4=_0xb817e0?_0xb817e0[_0x585088(0x18c)]:0x38;_0x2ef885[_0x585088(0x1c1)][_0x585088(0x185)]=_0x585088(0x164),_0x2ef885[_0x585088(0x1c1)][_0x585088(0x1c7)]=_0x585088(0x16f),_0x2ef885[_0x585088(0x1c1)][_0x585088(0x1d3)]=_0x585088(0x16f),_0x2ef885[_0x585088(0x1c1)][_0x585088(0x18b)]=_0x14d5c4+0x8+'px',_0x2ef885[_0x585088(0x1c1)][_0x585088(0x19b)]=0x1770,_0x2ef885[_0x585088(0x1c1)]['width']=_0x585088(0x1e2),_0x2ef885[_0x585088(0x1c1)][_0x585088(0x1ce)]=_0x585088(0x1b0),_0x2ef885[_0x585088(0x1c1)][_0x585088(0x17f)]=_0x585088(0x195);}else{if(!_0x144d1a&&_0x28d1c6&&_0x2ef885[_0x585088(0x18a)]!==_0x28d1c6){_0x332ecd&&_0x332ecd['parentNode']===_0x28d1c6?_0x28d1c6[_0x585088(0x175)](_0x2ef885,_0x332ecd):_0x28d1c6[_0x585088(0x1d5)](_0x2ef885);_0x2ef885[_0x585088(0x1cb)][_0x585088(0x18f)](_0x585088(0x1af));if(_0x327f10!==null){if(_0x327f10==='')_0x2ef885['removeAttribute']('style');else _0x2ef885[_0x585088(0x15b)]('style',_0x327f10);_0x327f10=null;}}else{if(_0x144d1a&&_0x2ef885['parentNode']===_0xd53b67){const _0x5efefd=_0xb817e0?_0xb817e0[_0x585088(0x18c)]:0x38;_0x2ef885[_0x585088(0x1c1)][_0x585088(0x18b)]=_0x5efefd+0x8+'px';}}}}catch(_0x1cf67b){console[_0x585088(0x188)](_0x585088(0x1ae),_0x1cf67b);}}_0x1fd164&&(_0x1fd164['style'][_0x581b18(0x17f)]=_0x581b18(0x192),_0x1fd164['addEventListener'](_0x581b18(0x1ef),()=>{const _0x52cd3e=_0x581b18;if(window['innerWidth']<=0x384&&_0x2ef885){const _0x20e2fd=_0x2ef885[_0x52cd3e(0x1c1)][_0x52cd3e(0x17f)]!==_0x52cd3e(0x195);_0x2ef885['style']['display']=_0x20e2fd?'none':_0x52cd3e(0x1aa),_0x2ef885[_0x52cd3e(0x1cb)][_0x52cd3e(0x170)](_0x52cd3e(0x17d),!_0x20e2fd);}else _0x2e82f3&&_0x2e82f3[_0x52cd3e(0x1cb)][_0x52cd3e(0x170)]('open');}));window[_0x581b18(0x183)](_0x581b18(0x1f6),_0x3179ce),_0x3179ce();const _0x525a90=document[_0x581b18(0x15d)](_0x581b18(0x15c));_0x525a90&&(_0x525a90['oninput']=_0x1f1bc9=>setZoomValue(_0x1f1bc9['target'][_0x581b18(0x1a8)]));const _0x198303=document[_0x581b18(0x15d)](_0x581b18(0x1f2)),_0x391fe9=document[_0x581b18(0x15d)]('currentColorSwatch');function _0x13cd50(){const _0x20472d=_0x581b18;if(typeof showColorPickerDialog!=='function')return;const _0x33e85b=currentColor===_0x20472d(0x16b)||!currentColor?_0x20472d(0x1ad):currentColor;showColorPickerDialog({'color':_0x33e85b,'alpha':typeof currentAlpha===_0x20472d(0x1f0)?currentAlpha:0x1,'onChange':({hex:_0x2ee662,rgba:_0x47f0db,a:_0x1e02a0})=>{const _0x299262=_0x20472d;try{_0x47f0db&&_0x47f0db[0x3]===0x0?(currentColor=_0x299262(0x16b),currentAlpha=0x0):(currentColor=_0x2ee662||(_0x47f0db?rgbToHex(_0x47f0db[0x0],_0x47f0db[0x1],_0x47f0db[0x2]):_0x33e85b),currentAlpha=_0x47f0db&&typeof _0x47f0db[0x3]===_0x299262(0x1f0)?_0x47f0db[0x3]:_0x1e02a0||0x1);updateCurrentColorSwatch();const _0x3d0dac=document['getElementById']('colorPicker');if(_0x3d0dac&&currentColor!==_0x299262(0x16b))_0x3d0dac[_0x299262(0x1a8)]=currentColor;}catch(_0x1fa14b){console[_0x299262(0x188)]('color\x20picker\x20onChange\x20error',_0x1fa14b);}},'onOk':({hex:_0x290115,rgba:_0xe01b81,a:_0x1b5ecd})=>{const _0x4d9705=_0x20472d;_0xe01b81&&_0xe01b81[0x3]===0x0?(currentColor=_0x4d9705(0x16b),currentAlpha=0x0):(currentColor=_0x290115||(_0xe01b81?rgbToHex(_0xe01b81[0x0],_0xe01b81[0x1],_0xe01b81[0x2]):_0x33e85b),currentAlpha=_0xe01b81&&typeof _0xe01b81[0x3]===_0x4d9705(0x1f0)?_0xe01b81[0x3]:_0x1b5ecd||0x1);updateCurrentColorSwatch();const _0xb97390=document[_0x4d9705(0x15d)](_0x4d9705(0x1e4));if(_0xb97390&&currentColor!=='transparent')_0xb97390[_0x4d9705(0x1a8)]=currentColor;}});}if(_0x198303)_0x198303[_0x581b18(0x183)](_0x581b18(0x1ef),_0x13cd50);if(_0x391fe9)_0x391fe9['addEventListener'](_0x581b18(0x1ef),_0x13cd50);const _0x2cbcf7=document['getElementById'](_0x581b18(0x1bd)),_0x4545c4=document[_0x581b18(0x15d)](_0x581b18(0x16d));if(_0x2cbcf7)_0x2cbcf7[_0x581b18(0x183)]('click',()=>{try{copyLayer();}catch(_0x13a551){console['error']('copyLayer\x20error',_0x13a551);}});_0x4545c4&&(_0x4545c4['addEventListener'](_0x581b18(0x1ef),()=>{const _0x52ea31=_0x581b18;try{pasteLayer();}catch(_0x1d78a6){console[_0x52ea31(0x188)](_0x52ea31(0x173),_0x1d78a6);}}),_0x4545c4['disabled']=!copiedLayerDataUrl);let _0x4614b1=![],_0x1f9a43=null;function _0x5adcee(_0x2a404e){const _0x5d0ea0=_0x581b18;if(!_0x2a404e)return![];const _0x5d4a88=_0x2a404e[_0x5d0ea0(0x1a7)]&&_0x2a404e[_0x5d0ea0(0x1a7)][_0x5d0ea0(0x1ab)]();if(_0x5d4a88===_0x5d0ea0(0x1c8)||_0x5d4a88===_0x5d0ea0(0x165)||_0x5d4a88==='select')return!![];if(_0x2a404e['isContentEditable'])return!![];return![];}window[_0x581b18(0x183)](_0x581b18(0x196),_0x5dc728=>{const _0x506e67=_0x581b18;_0x5dc728[_0x506e67(0x1a5)]==='Shift'&&!_0x4614b1&&!_0x5adcee(document[_0x506e67(0x1bc)])&&(_0x1f9a43=currentTool,setTool(_0x506e67(0x1bb)),_0x4614b1=!![]);},{'passive':!![]}),window[_0x581b18(0x183)](_0x581b18(0x1b8),_0x4ec956=>{const _0x12623d=_0x581b18;if(_0x4ec956[_0x12623d(0x1a5)]===_0x12623d(0x1e0)&&_0x4614b1){if(currentTool===_0x12623d(0x1bb)&&_0x1f9a43)setTool(_0x1f9a43);_0x1f9a43=null,_0x4614b1=![];}},{'passive':!![]}),window[_0x581b18(0x183)](_0x581b18(0x196),_0x59b743=>{const _0x1b3f10=_0x581b18;if(_0x5adcee(document[_0x1b3f10(0x1bc)]))return;const _0x4bfb92=navigator[_0x1b3f10(0x16e)]&&navigator[_0x1b3f10(0x16e)][_0x1b3f10(0x167)]()[_0x1b3f10(0x1f5)](_0x1b3f10(0x166))>=0x0,_0x349e89=_0x4bfb92?_0x59b743[_0x1b3f10(0x1e5)]:_0x59b743['ctrlKey'];if(!_0x349e89)return;const _0x40f4a7=(_0x59b743[_0x1b3f10(0x1a5)]||'')[_0x1b3f10(0x1ab)]();if(_0x40f4a7==='z'&&!_0x59b743[_0x1b3f10(0x1b6)]){_0x59b743[_0x1b3f10(0x1a3)]();try{undo();}catch(_0x4be424){console['error'](_0x1b3f10(0x1c6),_0x4be424);}}else{if(_0x40f4a7==='z'&&_0x59b743[_0x1b3f10(0x1b6)]||_0x40f4a7==='y'){_0x59b743[_0x1b3f10(0x1a3)]();try{redo();}catch(_0x314123){console['error'](_0x1b3f10(0x1d4),_0x314123);}}}},{'passive':![]}),window['showAboutDialog']=function(){const _0x101080=_0x581b18;if(document[_0x101080(0x15d)](_0x101080(0x1b5)))return;const _0x3a304a=document[_0x101080(0x1d1)](_0x101080(0x181));_0x3a304a['id']=_0x101080(0x1b5),_0x3a304a[_0x101080(0x1c1)][_0x101080(0x185)]=_0x101080(0x164),_0x3a304a[_0x101080(0x1c1)]['left']='0',_0x3a304a['style']['top']='0',_0x3a304a['style'][_0x101080(0x1e8)]=_0x101080(0x1d7),_0x3a304a['style'][_0x101080(0x189)]='100vh',_0x3a304a[_0x101080(0x1c1)][_0x101080(0x17f)]=_0x101080(0x1b7),_0x3a304a[_0x101080(0x1c1)][_0x101080(0x179)]=_0x101080(0x186),_0x3a304a[_0x101080(0x1c1)][_0x101080(0x1e7)]=_0x101080(0x186),_0x3a304a['style'][_0x101080(0x19b)]=0x2710,_0x3a304a[_0x101080(0x1c1)][_0x101080(0x1ac)]='rgba(0,0,0,0.35)';const _0x1169d0=window['NEZUMI_BUILD_META']||{},_0x30ea5e=_0x1169d0[_0x101080(0x1a4)]||'不明',_0x5f010c=_0x1169d0['id']||'不明';_0x3a304a[_0x101080(0x1f1)]=_0x101080(0x1e9)+_0x30ea5e+_0x101080(0x1da)+_0x5f010c+_0x101080(0x1dd),document[_0x101080(0x1bf)][_0x101080(0x1d5)](_0x3a304a),_0x3a304a[_0x101080(0x1b9)](_0x101080(0x163))[_0x101080(0x1d6)]=()=>_0x3a304a[_0x101080(0x18f)](),_0x3a304a[_0x101080(0x183)](_0x101080(0x1ef),_0x5da63a=>{const _0x2a0006=_0x101080;if(_0x5da63a['target']===_0x3a304a)_0x3a304a[_0x2a0006(0x18f)]();});};const _0x409888=document[_0x581b18(0x15d)](_0x581b18(0x1a1)),_0x2709fd=document[_0x581b18(0x15d)]('nudgeDownBtn'),_0x5ca69d=document[_0x581b18(0x15d)]('nudgeLeftBtn'),_0xf4820=document[_0x581b18(0x15d)]('nudgeRightBtn'),_0x384f55=document[_0x581b18(0x15d)](_0x581b18(0x18d));function _0x3306af(){const _0x5f52ef=_0x581b18;let _0x2fd8f5=0x1;if(_0x384f55){_0x2fd8f5=parseInt(_0x384f55[_0x5f52ef(0x1a8)],0xa)||0x1;if(_0x2fd8f5<0x1)_0x2fd8f5=0x1;}return _0x2fd8f5;}if(_0x409888)_0x409888[_0x581b18(0x183)](_0x581b18(0x1ef),()=>nudgeActiveLayer(0x0,-_0x3306af()));if(_0x2709fd)_0x2709fd['addEventListener'](_0x581b18(0x1ef),()=>nudgeActiveLayer(0x0,_0x3306af()));if(_0x5ca69d)_0x5ca69d[_0x581b18(0x183)](_0x581b18(0x1ef),()=>nudgeActiveLayer(-_0x3306af(),0x0));if(_0xf4820)_0xf4820['addEventListener'](_0x581b18(0x1ef),()=>nudgeActiveLayer(_0x3306af(),0x0));const _0x33de86=document['getElementById'](_0x581b18(0x168));_0x33de86&&_0x33de86[_0x581b18(0x183)]('click',()=>toggleFrontLayerDim());try{toggleGrid(showGrid);}catch(_0x479e26){}try{toggleFrontLayerDim(dimFrontLayers);}catch(_0x1c4766){}try{updateAnimUi(![]);}catch(_0x1c501e){}}),window[_0x11b173(0x193)]=()=>{const _0xffcd4=_0x11b173;canvas=document[_0xffcd4(0x15d)]('canvas'),wrapper=document[_0xffcd4(0x15d)](_0xffcd4(0x1e3))||canvas?.[_0xffcd4(0x1d9)]||null;if(!canvas){console['error'](_0xffcd4(0x155));return;}ctx=canvas[_0xffcd4(0x1b2)]('2d'),projects=[createProject()],activeProject=0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),initCanvas(),setTool(_0xffcd4(0x184)),updateCurrentColorSwatch(),loadPaletteFromDB()['then'](()=>createPalette());const _0x53e32a=document['getElementById'](_0xffcd4(0x17e));if(_0x53e32a)_0x53e32a[_0xffcd4(0x1a8)]=penSize;const _0x7fbe50=document[_0xffcd4(0x15d)](_0xffcd4(0x152));if(_0x7fbe50)_0x7fbe50[_0xffcd4(0x1a8)]=penMode;const _0x36d167=document['getElementById'](_0xffcd4(0x1f3)),_0x2bb54e=document['getElementById'](_0xffcd4(0x1d2));_0x36d167&&_0x2bb54e&&((!Number[_0xffcd4(0x159)](animationDelay)||animationDelay<=0x0)&&(animationDelay=0x12c),_0x36d167['value']=animationDelay,_0x2bb54e[_0xffcd4(0x1a8)]=animationDelay,_0x36d167[_0xffcd4(0x1ea)]=_0xb92f5b=>{const _0x1ce442=_0xffcd4;_0x2bb54e[_0x1ce442(0x1a8)]=_0xb92f5b[_0x1ce442(0x1a6)][_0x1ce442(0x1a8)],setAnimationDelay(_0xb92f5b[_0x1ce442(0x1a6)][_0x1ce442(0x1a8)]);},_0x2bb54e[_0xffcd4(0x1c4)]=_0x4e2296=>{const _0x10c661=_0xffcd4;let _0x53a599=Math[_0x10c661(0x1c5)](0xa,Math[_0x10c661(0x158)](0x1388,parseInt(_0x4e2296[_0x10c661(0x1a6)][_0x10c661(0x1a8)],0xa)||animationDelay));_0x36d167[_0x10c661(0x1a8)]=_0x53a599,_0x2bb54e[_0x10c661(0x1a8)]=_0x53a599,setAnimationDelay(_0x53a599);});canvas[_0xffcd4(0x1be)]=handleMouseDown,canvas[_0xffcd4(0x191)]=handleMouseMove,canvas[_0xffcd4(0x1cc)]=handleMouseUp,canvas[_0xffcd4(0x162)]=handleMouseUp,canvas[_0xffcd4(0x1d0)]=handleTouchStart,canvas['ontouchmove']=handleTouchMove,canvas['ontouchend']=handleTouchEnd,canvas[_0xffcd4(0x1d8)]=handleTouchEnd,canvas[_0xffcd4(0x183)](_0xffcd4(0x19a),handleTouchStart,{'passive':![]}),canvas[_0xffcd4(0x183)](_0xffcd4(0x1ed),handleTouchMove,{'passive':![]}),canvas[_0xffcd4(0x183)](_0xffcd4(0x161),handleTouchEnd,{'passive':![]}),canvas[_0xffcd4(0x183)](_0xffcd4(0x1cd),handleTouchEnd,{'passive':![]});try{showLoading(_0xffcd4(0x1a9));}catch(_0x54485d){}loadProjectFromIDB()[_0xffcd4(0x1a0)](_0x3c4425=>{const _0x3ad358=_0xffcd4;console[_0x3ad358(0x1c9)](_0x3ad358(0x1b1),_0x3c4425);})[_0xffcd4(0x198)](()=>{const _0x109530=_0xffcd4;try{hideLoading();}catch(_0x49aa6d){}if(typeof window['startAutoSaveInterval']===_0x109530(0x1c0))window[_0x109530(0x197)]();});};function handleMouseDown(_0x59b27f){const _0x570492=_0x11b173;if(currentTool===_0x570492(0x1bb)){isDrawing=!![],panStart={'x':_0x59b27f[_0x570492(0x1e1)],'y':_0x59b27f[_0x570492(0x1c3)],'posX':posX,'posY':posY},canvas[_0x570492(0x1c1)][_0x570492(0x153)]='grabbing';return;}isDrawing=!![],saveHistory();const _0xf8e97e=getCanvasCoords(_0x59b27f),_0x2001ee=Math[_0x570492(0x160)](_0xf8e97e['x']/cellSize),_0x2fb131=Math[_0x570492(0x160)](_0xf8e97e['y']/cellSize);currentTool===_0x570492(0x174)?(fillAt(_0x2001ee,_0x2fb131),saveHistory(),isDrawing=![],lastMouse=null):(drawDotXY(_0x2001ee,_0x2fb131),lastMouse={'x':_0x2001ee,'y':_0x2fb131});}function handleMouseMove(_0x1f8168){const _0x27164c=_0x11b173;if(!isDrawing)return;if(currentTool===_0x27164c(0x1bb)&&panStart){const _0x4bfb23=_0x1f8168[_0x27164c(0x1e1)]-panStart['x'],_0x31b87f=_0x1f8168[_0x27164c(0x1c3)]-panStart['y'];posX=panStart['posX']+_0x4bfb23,posY=panStart['posY']+_0x31b87f,updateTransform();return;}const _0x3cb35b=getCanvasCoords(_0x1f8168),_0x3794d4=Math[_0x27164c(0x160)](_0x3cb35b['x']/cellSize),_0x493493=Math[_0x27164c(0x160)](_0x3cb35b['y']/cellSize);if(!lastMouse){drawDotXY(_0x3794d4,_0x493493),lastMouse={'x':_0x3794d4,'y':_0x493493};return;}const _0x40c1f6=_0x3794d4-lastMouse['x'],_0x25ff0c=_0x493493-lastMouse['y'],_0xd51583=Math['max'](Math['abs'](_0x40c1f6),Math[_0x27164c(0x180)](_0x25ff0c));if(_0xd51583<=0x1)drawDotXY(_0x3794d4,_0x493493);else for(let _0xc7e734=0x1;_0xc7e734<=_0xd51583;_0xc7e734++){const _0x4074b9=Math['round'](lastMouse['x']+_0x40c1f6*_0xc7e734/_0xd51583),_0x5218b1=Math[_0x27164c(0x1ba)](lastMouse['y']+_0x25ff0c*_0xc7e734/_0xd51583);drawDotXY(_0x4074b9,_0x5218b1);}lastMouse={'x':_0x3794d4,'y':_0x493493};}function handleMouseUp(_0x4b1bd6){if(currentTool==='pan'){isDrawing=![],panStart=null,canvas['style']['cursor']='grab';return;}isDrawing&&saveHistory(),isDrawing=![],lastMouse=null;}function handleTouchStart(_0x419561){const _0x1ab434=_0x11b173;if(_0x419561['touches'][_0x1ab434(0x190)]===0x2){_0x419561[_0x1ab434(0x1a3)](),isPinching=!![],isDrawing=![],lastTouch=null;const _0x56c2b4=_0x419561[_0x1ab434(0x156)][0x0],_0x5ee2c0=_0x419561['touches'][0x1];pinchStartDistance=Math[_0x1ab434(0x18e)](_0x5ee2c0['clientX']-_0x56c2b4[_0x1ab434(0x1e1)],_0x5ee2c0[_0x1ab434(0x1c3)]-_0x56c2b4[_0x1ab434(0x1c3)]),pinchStartMid={'clientX':(_0x56c2b4[_0x1ab434(0x1e1)]+_0x5ee2c0[_0x1ab434(0x1e1)])/0x2,'clientY':(_0x56c2b4[_0x1ab434(0x1c3)]+_0x5ee2c0[_0x1ab434(0x1c3)])/0x2},pinchStartScale=scale,pinchStartPosX=posX,pinchStartPosY=posY,pinchRect=canvas[_0x1ab434(0x178)]();}else{if(_0x419561[_0x1ab434(0x156)][_0x1ab434(0x190)]===0x1){if(colorPickMode){_0x419561[_0x1ab434(0x1a3)]();const _0x4e3aab=_0x419561[_0x1ab434(0x156)][0x0];onCanvasColorPick({'clientX':_0x4e3aab[_0x1ab434(0x1e1)],'clientY':_0x4e3aab[_0x1ab434(0x1c3)]});return;}_0x419561[_0x1ab434(0x1a3)]();if(isPinching)return;const _0x2a8d64=_0x419561['touches'][0x0];if(currentTool==='pan'){isDrawing=!![],panStart={'x':_0x2a8d64[_0x1ab434(0x1e1)],'y':_0x2a8d64[_0x1ab434(0x1c3)],'posX':posX,'posY':posY};if(canvas)canvas[_0x1ab434(0x1c1)][_0x1ab434(0x153)]=_0x1ab434(0x182);return;}isDrawing=!![],saveHistory();let _0xc0eafe=getTouchPos(_0x419561);lastTouch=_0xc0eafe,currentTool===_0x1ab434(0x174)?(fillAt(_0xc0eafe['x'],_0xc0eafe['y']),saveHistory(),isDrawing=![]):drawDotTouch(_0xc0eafe['x'],_0xc0eafe['y']);}}}function _0x4728(){const _0x1017fa=['onCanvasColorPick\x20error','setAttribute','zoomSlider','getElementById','12452022tKHlYO','505683YiKupM','floor','touchend','onmouseleave','#aboutCloseBtn','fixed','textarea','MAC','toUpperCase','frontDimBtn','Picked\x20color','map','transparent','padStart','pasteLayerBtn','platform','8px','toggle','add','249EHiRwD','pasteLayer\x20error','fill','insertBefore','24348mRoCxi','innerWidth','getBoundingClientRect','alignItems','30EMkctI','light','getItem','mobile-open','penSize','display','abs','div','grabbing','addEventListener','pen','position','center','toString','error','height','parentNode','bottom','offsetHeight','nudgeStep','hypot','remove','length','onmousemove','inline-block','onload','416570CFTleO','none','keydown','startAutoSaveInterval','finally','posY','touchstart','zIndex','search','597785igcSez','themeToggleBtn','right-panel','catch','nudgeUpBtn','12UoaJxu','preventDefault','version','key','target','tagName','value','自動復元中...','block','toLowerCase','background','#000000','relocateRightToolbar\x20error','toolbar-mobile','0\x202px\x2010px\x20rgba(0,0,0,0.15)','IndexedDB\x20からの読み込みに失敗したチュー','getContext','getAttribute','join','about-dialog','shiftKey','flex','keyup','querySelector','round','pan','activeElement','copyLayerBtn','onmousedown','body','function','style','24XameoA','clientY','onchange','max','undo\x20shortcut\x20error','left','input','warn','data','classList','onmouseup','touchcancel','boxShadow','3160JBBBzZ','ontouchstart','createElement','animSpeedValue','right','redo\x20shortcut\x20error','appendChild','onclick','100vw','ontouchcancel','parentElement','</b>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20バージョンID:\x20','grab','info','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>©\x202025\x20nezumi-sketch\x20<a\x20href=\x22https://github.com/mouse0329\x22\x20rel=\x22noopener\x20noreferrer\x22>github\x20mouse0329</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><a\x20href=\x22/terms\x22>利用規約</a>\u3000<a\x20href=\x22/license\x22>ライセンス</a>\u3000<a\x20href=\x22/about\x22>紹介ページ</a></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:right;margin-top:10px;\x22><button\x20id=\x22aboutCloseBtn\x22>閉じる</button></div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','penAlphaMode','apply','Shift','clientX','auto','canvas-container','colorPicker','metaKey','(((.+)+)+)+$','justifyContent','width','\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22background:var(--surface);padding:18px\x2022px;border-radius:10px;min-width:280px;max-width:720px;text-align:left;box-shadow:0\x202px\x2024px\x20rgba(0,0,0,0.25);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:0;\x22>ネズミスケッチについて</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ネズミスケッチは、簡単にドット絵アニメーションを作成できるツールです。</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>バージョン:\x20<b>','oninput','constructor','toolsToggleBtn','touchmove','nezumi-theme','click','number','innerHTML','openColorPickerBtn','animSpeedRange','2709200SHKRrL','indexOf','resize','penMode','cursor','top','canvas\x20要素が見つからないチュー','touches','nextSibling','min','isFinite'];_0x4728=function(){return _0x1017fa;};return _0x4728();}function _0x5db9(_0x20a170,_0x20a77c){_0x20a170=_0x20a170-0x152;const _0x3140ce=_0x4728();let _0x492062=_0x3140ce[_0x20a170];return _0x492062;}function handleTouchMove(_0x3c6a02){const _0x1f8271=_0x11b173;if(!_0x3c6a02)return;if(isPinching||_0x3c6a02[_0x1f8271(0x156)]&&_0x3c6a02[_0x1f8271(0x156)][_0x1f8271(0x190)]===0x2){_0x3c6a02['preventDefault'](),isDrawing=![],lastTouch=null;const _0x1aca88=_0x3c6a02[_0x1f8271(0x156)][0x0],_0x1b8c33=_0x3c6a02[_0x1f8271(0x156)][0x1],_0x944af2=Math[_0x1f8271(0x18e)](_0x1b8c33[_0x1f8271(0x1e1)]-_0x1aca88[_0x1f8271(0x1e1)],_0x1b8c33[_0x1f8271(0x1c3)]-_0x1aca88[_0x1f8271(0x1c3)]),_0x5aab0a={'clientX':(_0x1aca88[_0x1f8271(0x1e1)]+_0x1b8c33['clientX'])/0x2,'clientY':(_0x1aca88[_0x1f8271(0x1c3)]+_0x1b8c33[_0x1f8271(0x1c3)])/0x2};if(!pinchStartDistance)pinchStartDistance=_0x944af2||0x1;let _0x124369=_0x944af2/pinchStartDistance||0x1,_0x288ea7=pinchStartScale*_0x124369;_0x288ea7=Math[_0x1f8271(0x158)](Math[_0x1f8271(0x1c5)](_0x288ea7,0.2),0x5);const _0x53704a=pinchRect||canvas['getBoundingClientRect'](),_0x5d938d=(pinchStartMid[_0x1f8271(0x1e1)]-_0x53704a['left']-pinchStartPosX)/pinchStartScale,_0x5de31d=(pinchStartMid[_0x1f8271(0x1c3)]-_0x53704a['top']-pinchStartPosY)/pinchStartScale;posX=_0x5aab0a[_0x1f8271(0x1e1)]-_0x53704a['left']-_0x5d938d*_0x288ea7,posY=_0x5aab0a[_0x1f8271(0x1c3)]-_0x53704a[_0x1f8271(0x154)]-_0x5de31d*_0x288ea7,scale=_0x288ea7,updateTransform();return;}if(currentTool===_0x1f8271(0x1bb)&&panStart&&_0x3c6a02[_0x1f8271(0x156)]&&_0x3c6a02[_0x1f8271(0x156)][0x0]){_0x3c6a02[_0x1f8271(0x1a3)]();const _0x110276=_0x3c6a02['touches'][0x0],_0x59df3e=_0x110276[_0x1f8271(0x1e1)]-panStart['x'],_0x563c8f=_0x110276['clientY']-panStart['y'];posX=panStart['posX']+_0x59df3e,posY=panStart[_0x1f8271(0x199)]+_0x563c8f,updateTransform();return;}if(!isDrawing)return;if(_0x3c6a02['touches']&&_0x3c6a02[_0x1f8271(0x156)][_0x1f8271(0x190)]>0x1)return;_0x3c6a02['preventDefault']();const _0x5042f6=getTouchPos(_0x3c6a02);if(!_0x5042f6)return;if(lastTouch){const _0xf22e59=Math[_0x1f8271(0x180)]((_0x5042f6['x']-lastTouch['x'])*cellSize),_0x43b04b=Math[_0x1f8271(0x180)]((_0x5042f6['y']-lastTouch['y'])*cellSize);if(_0xf22e59>=PAN_CANCEL_DISTANCE||_0x43b04b>=PAN_CANCEL_DISTANCE){if(currentTool!=='pen'){isDrawing=![];return;}}}if(lastTouch){const _0x4db86c=_0x5042f6['x']-lastTouch['x'],_0x763d97=_0x5042f6['y']-lastTouch['y'],_0xe0b327=Math[_0x1f8271(0x1c5)](Math[_0x1f8271(0x180)](_0x4db86c),Math[_0x1f8271(0x180)](_0x763d97));for(let _0x3f9850=0x1;_0x3f9850<=_0xe0b327;_0x3f9850++){const _0x11f59b=Math[_0x1f8271(0x1ba)](lastTouch['x']+_0x4db86c*_0x3f9850/_0xe0b327),_0x372b0c=Math[_0x1f8271(0x1ba)](lastTouch['y']+_0x763d97*_0x3f9850/_0xe0b327);drawDotTouch(_0x11f59b,_0x372b0c);}}else drawDotTouch(_0x5042f6['x'],_0x5042f6['y']);lastTouch=_0x5042f6;}function handleTouchEnd(_0xeb3005){const _0x35e030=_0x11b173;isPinching&&_0xeb3005[_0x35e030(0x156)]&&_0xeb3005['touches'][_0x35e030(0x190)]<0x2&&(isPinching=![],pinchStartDistance=0x0,pinchStartMid=null,pinchRect=null);isDrawing&&(!_0xeb3005['touches']||_0xeb3005[_0x35e030(0x156)][_0x35e030(0x190)]===0x0)&&saveHistory();if(_0xeb3005['touches']&&_0xeb3005['touches'][_0x35e030(0x190)]===0x1){let _0x18967e=_0xeb3005[_0x35e030(0x156)][0x0];lastTouch=getTouchPos({'touches':[_0x18967e]}),isDrawing=!![];if(currentTool===_0x35e030(0x1bb)){panStart={'x':_0x18967e[_0x35e030(0x1e1)],'y':_0x18967e[_0x35e030(0x1c3)],'posX':posX,'posY':posY};if(canvas)canvas[_0x35e030(0x1c1)][_0x35e030(0x153)]=_0x35e030(0x182);}}else{isDrawing=![],lastTouch=null;if(currentTool===_0x35e030(0x1bb)){panStart=null;if(canvas)canvas[_0x35e030(0x1c1)]['cursor']=_0x35e030(0x1db);}}}function onCanvasColorPick(_0x3617d9){const _0x1c67d1=_0x11b173;try{const _0x41dd5c=getCanvasCoords(_0x3617d9),_0x46e01b=Math[_0x1c67d1(0x160)](_0x41dd5c['x']),_0x44898e=Math[_0x1c67d1(0x160)](_0x41dd5c['y']),_0x55e225=ctx['getImageData'](_0x46e01b,_0x44898e,0x1,0x1)[_0x1c67d1(0x1ca)],_0x237eb7=_0x55e225[0x0],_0x368937=_0x55e225[0x1],_0x5021bb=_0x55e225[0x2],_0x1fd29a=_0x55e225[0x3];if(_0x1fd29a===0x0){currentColor=_0x1c67d1(0x16b);const _0x444e0d=document[_0x1c67d1(0x15d)](_0x1c67d1(0x1e4));if(_0x444e0d)_0x444e0d[_0x1c67d1(0x1a8)]=_0x1c67d1(0x1ad);console[_0x1c67d1(0x1dc)]('Picked\x20transparent');}else{const _0x22e69d='#'+[_0x237eb7,_0x368937,_0x5021bb][_0x1c67d1(0x16a)](_0x4346ed=>_0x4346ed[_0x1c67d1(0x187)](0x10)[_0x1c67d1(0x16c)](0x2,'0'))[_0x1c67d1(0x1b4)]('');currentColor=_0x22e69d;const _0x1aff74=document[_0x1c67d1(0x15d)]('colorPicker');if(_0x1aff74)_0x1aff74[_0x1c67d1(0x1a8)]=_0x22e69d;console[_0x1c67d1(0x1dc)](_0x1c67d1(0x169),_0x22e69d);}}catch(_0x5525f1){console[_0x1c67d1(0x188)](_0x1c67d1(0x15a),_0x5525f1);}colorPickMode=![];if(canvas)canvas[_0x1c67d1(0x1c1)][_0x1c67d1(0x153)]='default';}