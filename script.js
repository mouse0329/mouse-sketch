const a0_0x545b5f=a0_0x45c9;(function(_0x385a84,_0x1c1cbb){const _0x3b4ca9=a0_0x45c9,_0x181227=_0x385a84();while(!![]){try{const _0x439260=parseInt(_0x3b4ca9(0x1b5))/0x1*(parseInt(_0x3b4ca9(0x298))/0x2)+-parseInt(_0x3b4ca9(0x2a0))/0x3+-parseInt(_0x3b4ca9(0x291))/0x4*(-parseInt(_0x3b4ca9(0x2cc))/0x5)+-parseInt(_0x3b4ca9(0x1e0))/0x6+parseInt(_0x3b4ca9(0x285))/0x7+-parseInt(_0x3b4ca9(0x22d))/0x8*(-parseInt(_0x3b4ca9(0x1cd))/0x9)+-parseInt(_0x3b4ca9(0x25f))/0xa;if(_0x439260===_0x1c1cbb)break;else _0x181227['push'](_0x181227['shift']());}catch(_0x58e5c3){_0x181227['push'](_0x181227['shift']());}}}(a0_0x36af,0x6fc87));const a0_0x4aeb04=(function(){let _0x3d51f0=!![];return function(_0x18ce0b,_0x51e324){const _0x162d06=_0x3d51f0?function(){const _0x129623=a0_0x45c9;if(_0x51e324){const _0x2d9572=_0x51e324[_0x129623(0x1cc)](_0x18ce0b,arguments);return _0x51e324=null,_0x2d9572;}}:function(){};return _0x3d51f0=![],_0x162d06;};}()),a0_0x4a7776=a0_0x4aeb04(this,function(){const _0x50e22e=a0_0x45c9;return a0_0x4a7776[_0x50e22e(0x2ac)]()['search']('(((.+)+)+)+$')[_0x50e22e(0x2ac)]()[_0x50e22e(0x266)](a0_0x4a7776)[_0x50e22e(0x21a)](_0x50e22e(0x1eb));});a0_0x4a7776();let canvas=document['getElementById'](a0_0x545b5f(0x297)),ctx=canvas[a0_0x545b5f(0x275)]('2d');const wrapper=document[a0_0x545b5f(0x1bf)]('canvas-container');let cellSize=0x14,currentColor=a0_0x545b5f(0x235),currentTool=a0_0x545b5f(0x283),penSize=0x1,penMode=a0_0x545b5f(0x255),layers=[],activeLayer=0x0,layerHistories=[],layerRedoStacks=[],currentWidth=0x10,currentHeight=0x10,projects=[],activeProject=0x0,isDrawing=![];function createProject(_0x55551e=0x10,_0x17ff14=0x10,_0x2e7de1=''){const _0x2179f2=a0_0x545b5f;let _0x149484=0x14,_0x59bea4=[],_0x436958=[],_0x55988e=[],_0x54c13b=document['createElement'](_0x2179f2(0x297));_0x54c13b[_0x2179f2(0x21e)]=_0x55551e*_0x149484,_0x54c13b[_0x2179f2(0x23e)]=_0x17ff14*_0x149484,_0x59bea4['push'](_0x54c13b),_0x436958['push']([]),_0x55988e[_0x2179f2(0x1b8)]([]);let _0x6b6d57={'layers':_0x59bea4,'activeLayer':0x0,'layerHistories':_0x436958,'layerRedoStacks':_0x55988e};return{'frames':[_0x6b6d57],'activeFrame':0x0,'width':_0x55551e,'height':_0x17ff14,'name':_0x2e7de1||'画像'+(projects[_0x2179f2(0x2d1)]+0x1)};}function updateProjectUI(){const _0xb67c62=a0_0x545b5f,_0x3d2b20=document['getElementById'](_0xb67c62(0x29a));_0x3d2b20['innerHTML']='';for(let _0x51e067=0x0;_0x51e067<projects[_0xb67c62(0x2d1)];_0x51e067++){const _0x112304=document['createElement'](_0xb67c62(0x2c7));_0x112304[_0xb67c62(0x25c)]='project-item'+(_0x51e067===activeProject?_0xb67c62(0x280):''),_0x112304[_0xb67c62(0x215)]=()=>{activeProject=_0x51e067,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();};const _0x1a59f3=document[_0xb67c62(0x23a)](_0xb67c62(0x2a6));_0x1a59f3[_0xb67c62(0x25c)]=_0xb67c62(0x2aa),_0x1a59f3[_0xb67c62(0x1c0)]=projects[_0x51e067][_0xb67c62(0x2cd)]||'画像'+(_0x51e067+0x1),_0x1a59f3['title']=_0xb67c62(0x2c6),_0x1a59f3[_0xb67c62(0x215)]=_0x29f61b=>{const _0x4f7dcb=_0xb67c62;_0x29f61b[_0x4f7dcb(0x1fc)](),editProjectName(_0x51e067,_0x1a59f3);},_0x112304[_0xb67c62(0x28c)](_0x1a59f3);const _0x3ea09e=document[_0xb67c62(0x23a)](_0xb67c62(0x29d));_0x3ea09e[_0xb67c62(0x1c0)]='削除',_0x3ea09e[_0xb67c62(0x25c)]=_0xb67c62(0x261),_0x3ea09e['disabled']=projects[_0xb67c62(0x2d1)]===0x1,_0x3ea09e[_0xb67c62(0x215)]=_0x260c8c=>{const _0x544bff=_0xb67c62;_0x260c8c[_0x544bff(0x1fc)](),removeProjectAt(_0x51e067);},_0x112304[_0xb67c62(0x28c)](_0x3ea09e),_0x3d2b20[_0xb67c62(0x28c)](_0x112304);}document[_0xb67c62(0x1bf)](_0xb67c62(0x1e1))[_0xb67c62(0x1c0)]='('+projects[_0xb67c62(0x2d1)]+'枚)';}function editProjectName(_0xe0863a,_0x39e817){const _0x36ad25=a0_0x545b5f,_0x25ab92=document[_0x36ad25(0x23a)]('input');_0x25ab92[_0x36ad25(0x21c)]=_0x36ad25(0x1ef),_0x25ab92[_0x36ad25(0x264)]=projects[_0xe0863a][_0x36ad25(0x2cd)]||'画像'+(_0xe0863a+0x1),_0x25ab92[_0x36ad25(0x25c)]='project-name-edit',_0x25ab92[_0x36ad25(0x1bd)][_0x36ad25(0x21e)]=_0x36ad25(0x287),_0x25ab92[_0x36ad25(0x240)]=()=>{const _0x1b63e4=_0x36ad25;projects[_0xe0863a][_0x1b63e4(0x2cd)]=_0x25ab92[_0x1b63e4(0x264)][_0x1b63e4(0x27d)]()||'画像'+(_0xe0863a+0x1),updateProjectUI();},_0x25ab92[_0x36ad25(0x210)]=_0x1feb09=>{const _0xab502c=_0x36ad25;if(_0x1feb09[_0xab502c(0x1ed)]===_0xab502c(0x25e))_0x25ab92[_0xab502c(0x20b)]();},_0x39e817[_0x36ad25(0x1e4)](_0x25ab92),_0x25ab92[_0x36ad25(0x278)](),_0x25ab92[_0x36ad25(0x27e)]();}function showNewProjectDialog(_0x26e910){const _0x4983fb=a0_0x545b5f;let _0x4ecd0c=document[_0x4983fb(0x1bf)](_0x4983fb(0x222));if(_0x4ecd0c)_0x4ecd0c[_0x4983fb(0x1ec)]();const _0x54abdd=document[_0x4983fb(0x23a)]('div');_0x54abdd['id']=_0x4983fb(0x222),_0x54abdd[_0x4983fb(0x1bd)][_0x4983fb(0x2ba)]='fixed',_0x54abdd[_0x4983fb(0x1bd)]['left']='0',_0x54abdd['style'][_0x4983fb(0x1a6)]='0',_0x54abdd[_0x4983fb(0x1bd)][_0x4983fb(0x21e)]=_0x4983fb(0x1de),_0x54abdd[_0x4983fb(0x1bd)]['height']='100vh',_0x54abdd[_0x4983fb(0x1bd)]['background']='rgba(0,0,0,0.3)',_0x54abdd['style'][_0x4983fb(0x20c)]='flex',_0x54abdd[_0x4983fb(0x1bd)][_0x4983fb(0x211)]='center',_0x54abdd['style']['justifyContent']=_0x4983fb(0x213),_0x54abdd['style']['zIndex']=_0x4983fb(0x269),_0x54abdd['innerHTML']=_0x4983fb(0x1e5)+(projects[_0x4983fb(0x2d1)]+0x1)+'\x22\x20style=\x22width:120px;\x22></label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:12px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>幅:\x20<input\x20id=\x22newProjW\x22\x20type=\x22number\x22\x20min=\x221\x22\x20max=\x22256\x22\x20value=\x2216\x22\x20style=\x22width:60px;\x22></label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22margin-left:12px;\x22>高さ:\x20<input\x20id=\x22newProjH\x22\x20type=\x22number\x22\x20min=\x221\x22\x20max=\x22256\x22\x20value=\x2216\x22\x20style=\x22width:60px;\x22></label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22newProjOkBtn\x22>作成</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22newProjCancelBtn\x22\x20style=\x22margin-left:12px;\x22>キャンセル</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',document[_0x4983fb(0x1ce)][_0x4983fb(0x28c)](_0x54abdd),_0x54abdd['querySelector']('#newProjOkBtn')['onclick']=()=>{const _0x28798f=_0x4983fb,_0x22e89a=parseInt(_0x54abdd[_0x28798f(0x267)]('#newProjW')[_0x28798f(0x264)],0xa),_0x21fbc7=parseInt(_0x54abdd[_0x28798f(0x267)](_0x28798f(0x29e))['value'],0xa),_0x56b025=_0x54abdd[_0x28798f(0x267)](_0x28798f(0x1b7))[_0x28798f(0x264)][_0x28798f(0x27d)]();_0x54abdd[_0x28798f(0x1ec)]();if(_0x26e910)_0x26e910(_0x22e89a,_0x21fbc7,_0x56b025);},_0x54abdd[_0x4983fb(0x267)](_0x4983fb(0x26b))[_0x4983fb(0x215)]=()=>{_0x54abdd['remove']();};}function addProject(){showNewProjectDialog((_0xb3889a,_0x5955ee,_0x2962e9)=>{const _0x3b352a=a0_0x45c9;if(!Number['isFinite'](_0xb3889a)||_0xb3889a<0x1)_0xb3889a=0x10;if(!Number[_0x3b352a(0x1ea)](_0x5955ee)||_0x5955ee<0x1)_0x5955ee=0x10;projects[_0x3b352a(0x1b8)](createProject(_0xb3889a,_0x5955ee,_0x2962e9)),activeProject=projects[_0x3b352a(0x2d1)]-0x1,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();});}function removeProjectAt(_0x29629f){const _0xa7a193=a0_0x545b5f;if(projects[_0xa7a193(0x2d1)]<=0x1)return;projects['splice'](_0x29629f,0x1);if(activeProject>=projects[_0xa7a193(0x2d1)])activeProject=projects[_0xa7a193(0x2d1)]-0x1;updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();}function getCurrentProject(){return projects[activeProject];}function updateFrameUI(){const _0xea0b2d=a0_0x545b5f,_0x55284a=document[_0xea0b2d(0x1bf)](_0xea0b2d(0x2a3)),_0x3d0da3=getCurrentProject();_0x55284a[_0xea0b2d(0x221)]='';for(let _0x3cbb08=0x0;_0x3cbb08<_0x3d0da3[_0xea0b2d(0x2bf)][_0xea0b2d(0x2d1)];_0x3cbb08++){const _0x2939be=document[_0xea0b2d(0x23a)](_0xea0b2d(0x2c7));_0x2939be['className']=_0xea0b2d(0x216)+(_0x3cbb08===_0x3d0da3[_0xea0b2d(0x1d6)]?'\x20active':''),_0x2939be[_0xea0b2d(0x215)]=()=>{const _0x3908bc=_0xea0b2d;_0x3d0da3[_0x3908bc(0x1d6)]=_0x3cbb08,updateFrameUI(),updateLayerUI(),redrawAll();};const _0x2d0ee0=document[_0xea0b2d(0x23a)]('canvas');_0x2d0ee0[_0xea0b2d(0x25c)]='frame-thumb',_0x2d0ee0[_0xea0b2d(0x21e)]=0x20,_0x2d0ee0[_0xea0b2d(0x23e)]=0x20;let _0x81f815=_0x2d0ee0[_0xea0b2d(0x275)]('2d');_0x81f815['clearRect'](0x0,0x0,0x20,0x20);for(let _0x602d8c=0x0;_0x602d8c<_0x3d0da3[_0xea0b2d(0x2bf)][_0x3cbb08][_0xea0b2d(0x2c5)]['length'];_0x602d8c++){_0x81f815[_0xea0b2d(0x246)](_0x3d0da3[_0xea0b2d(0x2bf)][_0x3cbb08]['layers'][_0x602d8c],0x0,0x0,_0x2d0ee0[_0xea0b2d(0x21e)],_0x2d0ee0[_0xea0b2d(0x23e)]);}_0x2939be['appendChild'](_0x2d0ee0);const _0x389ee4=document[_0xea0b2d(0x23a)](_0xea0b2d(0x2a6));_0x389ee4[_0xea0b2d(0x1c0)]='F'+(_0x3cbb08+0x1),_0x2939be[_0xea0b2d(0x28c)](_0x389ee4);const _0x26a313=document['createElement'](_0xea0b2d(0x29d));_0x26a313['textContent']='削除',_0x26a313[_0xea0b2d(0x25c)]=_0xea0b2d(0x23b),_0x26a313['disabled']=_0x3d0da3[_0xea0b2d(0x2bf)][_0xea0b2d(0x2d1)]===0x1,_0x26a313['onclick']=_0x4be0f4=>{const _0x5f29e5=_0xea0b2d;_0x4be0f4[_0x5f29e5(0x1fc)](),removeFrameAt(_0x3cbb08);},_0x2939be[_0xea0b2d(0x28c)](_0x26a313),_0x55284a[_0xea0b2d(0x28c)](_0x2939be);}document[_0xea0b2d(0x1bf)]('frameCount')['textContent']='('+_0x3d0da3[_0xea0b2d(0x2bf)][_0xea0b2d(0x2d1)]+_0xea0b2d(0x1d4);}function addFrame(){const _0x4502c0=a0_0x545b5f;let _0x577bfa=getCurrentProject(),_0x344bae=_0x577bfa[_0x4502c0(0x2bf)][_0x577bfa[_0x4502c0(0x1d6)]],_0x3c6817=_0x344bae[_0x4502c0(0x2c5)]['map'](_0x5a1e40=>{const _0x4b4e7e=_0x4502c0;let _0x32a799=document[_0x4b4e7e(0x23a)](_0x4b4e7e(0x297));return _0x32a799[_0x4b4e7e(0x21e)]=_0x5a1e40[_0x4b4e7e(0x21e)],_0x32a799[_0x4b4e7e(0x23e)]=_0x5a1e40['height'],_0x32a799[_0x4b4e7e(0x275)]('2d')[_0x4b4e7e(0x246)](_0x5a1e40,0x0,0x0),_0x32a799;}),_0xddcc86=_0x3c6817[_0x4502c0(0x1a5)](()=>[]),_0x3a8d25=_0x3c6817[_0x4502c0(0x1a5)](()=>[]),_0xfb9f72={'layers':_0x3c6817,'activeLayer':0x0,'layerHistories':_0xddcc86,'layerRedoStacks':_0x3a8d25};_0x577bfa[_0x4502c0(0x2bf)][_0x4502c0(0x26a)](_0x577bfa[_0x4502c0(0x1d6)]+0x1,0x0,_0xfb9f72),_0x577bfa[_0x4502c0(0x1d6)]++,updateFrameUI(),updateLayerUI(),redrawAll();}function removeFrameAt(_0x3f8807){const _0x5af323=a0_0x545b5f;let _0x45e9f7=getCurrentProject();if(_0x45e9f7[_0x5af323(0x2bf)][_0x5af323(0x2d1)]<=0x1)return;_0x45e9f7[_0x5af323(0x2bf)]['splice'](_0x3f8807,0x1);if(_0x45e9f7[_0x5af323(0x1d6)]>=_0x45e9f7[_0x5af323(0x2bf)][_0x5af323(0x2d1)])_0x45e9f7[_0x5af323(0x1d6)]=_0x45e9f7[_0x5af323(0x2bf)][_0x5af323(0x2d1)]-0x1;updateFrameUI(),updateLayerUI(),redrawAll();}function getCurrentFrame(){const _0x354ebd=a0_0x545b5f;return getCurrentProject()[_0x354ebd(0x2bf)][getCurrentProject()[_0x354ebd(0x1d6)]];}function updateLayerUI(){const _0x347a57=a0_0x545b5f;let {layers:_0x3520d8,activeLayer:_0x3b15e8}=getCurrentFrame();document[_0x347a57(0x1bf)]('layerCount')['textContent']='('+_0x3520d8[_0x347a57(0x2d1)]+'枚)';const _0x371466=document['getElementById']('layerList');_0x371466[_0x347a57(0x221)]='';for(let _0x37ed9d=_0x3520d8[_0x347a57(0x2d1)]-0x1;_0x37ed9d>=0x0;_0x37ed9d--){const _0x1e6327=document['createElement'](_0x347a57(0x2c7));_0x1e6327[_0x347a57(0x25c)]=_0x347a57(0x19b)+(_0x37ed9d===_0x3b15e8?_0x347a57(0x280):''),_0x1e6327[_0x347a57(0x215)]=_0x159547=>{const _0x2555d3=_0x347a57;if(_0x159547[_0x2555d3(0x1b2)][_0x2555d3(0x24f)][_0x2555d3(0x2cf)](_0x2555d3(0x2a2)))return;getCurrentFrame()[_0x2555d3(0x1c6)]=_0x37ed9d,updateLayerUI(),redrawAll();};const _0x37ad44=document[_0x347a57(0x23a)]('canvas');_0x37ad44[_0x347a57(0x25c)]=_0x347a57(0x2cb),_0x37ad44[_0x347a57(0x21e)]=0x20,_0x37ad44[_0x347a57(0x23e)]=0x20;let _0xb97ca0=_0x37ad44[_0x347a57(0x275)]('2d');_0xb97ca0[_0x347a57(0x1c1)](0x0,0x0,0x20,0x20),_0xb97ca0[_0x347a57(0x246)](_0x3520d8[_0x37ed9d],0x0,0x0,_0x37ad44[_0x347a57(0x21e)],_0x37ad44[_0x347a57(0x23e)]),_0x1e6327[_0x347a57(0x28c)](_0x37ad44);const _0x29fab4=document[_0x347a57(0x23a)]('span');_0x29fab4[_0x347a57(0x1c0)]=_0x347a57(0x1e8)+(_0x37ed9d+0x1),_0x1e6327[_0x347a57(0x28c)](_0x29fab4);const _0x5994db=document[_0x347a57(0x23a)](_0x347a57(0x29d));_0x5994db[_0x347a57(0x1c0)]='↑',_0x5994db[_0x347a57(0x25c)]='layer-btn',_0x5994db[_0x347a57(0x1a2)]=_0x347a57(0x274),_0x5994db[_0x347a57(0x2bc)]=_0x37ed9d===_0x3520d8[_0x347a57(0x2d1)]-0x1,_0x5994db[_0x347a57(0x215)]=_0x3c71fc=>{const _0x4b4d65=_0x347a57;_0x3c71fc[_0x4b4d65(0x1fc)](),_0x37ed9d<_0x3520d8['length']-0x1&&swapLayer(_0x37ed9d,_0x37ed9d+0x1);},_0x1e6327['appendChild'](_0x5994db);const _0x4e10b3=document[_0x347a57(0x23a)](_0x347a57(0x29d));_0x4e10b3[_0x347a57(0x1c0)]='↓',_0x4e10b3[_0x347a57(0x25c)]=_0x347a57(0x2a2),_0x4e10b3[_0x347a57(0x1a2)]=_0x347a57(0x2b0),_0x4e10b3['disabled']=_0x37ed9d===0x0,_0x4e10b3[_0x347a57(0x215)]=_0x2edc4c=>{_0x2edc4c['stopPropagation'](),_0x37ed9d>0x0&&swapLayer(_0x37ed9d,_0x37ed9d-0x1);},_0x1e6327[_0x347a57(0x28c)](_0x4e10b3);const _0x2acad4=document[_0x347a57(0x23a)]('button');_0x2acad4[_0x347a57(0x1c0)]='削除',_0x2acad4[_0x347a57(0x25c)]=_0x347a57(0x2a2),_0x2acad4['title']='このレイヤーを削除',_0x2acad4['disabled']=_0x3520d8[_0x347a57(0x2d1)]===0x1,_0x2acad4['onclick']=_0x1f99c6=>{const _0x57a114=_0x347a57;_0x1f99c6[_0x57a114(0x1fc)](),removeLayerAt(_0x37ed9d);},_0x1e6327['appendChild'](_0x2acad4),_0x371466[_0x347a57(0x28c)](_0x1e6327);}}function swapLayer(_0x21f53b,_0x49c3a0){const _0x3d129e=a0_0x545b5f;let _0x5265cc=getCurrentFrame();[_0x5265cc[_0x3d129e(0x2c5)][_0x21f53b],_0x5265cc[_0x3d129e(0x2c5)][_0x49c3a0]]=[_0x5265cc[_0x3d129e(0x2c5)][_0x49c3a0],_0x5265cc[_0x3d129e(0x2c5)][_0x21f53b]],[_0x5265cc[_0x3d129e(0x1d5)][_0x21f53b],_0x5265cc[_0x3d129e(0x1d5)][_0x49c3a0]]=[_0x5265cc[_0x3d129e(0x1d5)][_0x49c3a0],_0x5265cc['layerHistories'][_0x21f53b]],[_0x5265cc[_0x3d129e(0x230)][_0x21f53b],_0x5265cc[_0x3d129e(0x230)][_0x49c3a0]]=[_0x5265cc[_0x3d129e(0x230)][_0x49c3a0],_0x5265cc[_0x3d129e(0x230)][_0x21f53b]];if(_0x5265cc[_0x3d129e(0x1c6)]===_0x21f53b)_0x5265cc['activeLayer']=_0x49c3a0;else{if(_0x5265cc[_0x3d129e(0x1c6)]===_0x49c3a0)_0x5265cc[_0x3d129e(0x1c6)]=_0x21f53b;}updateLayerUI(),redrawAll();}function removeLayerAt(_0x1643a3){const _0x395bff=a0_0x545b5f;let _0x14a491=getCurrentFrame();if(_0x14a491[_0x395bff(0x2c5)]['length']<=0x1)return;_0x14a491[_0x395bff(0x2c5)][_0x395bff(0x26a)](_0x1643a3,0x1),_0x14a491['layerHistories'][_0x395bff(0x26a)](_0x1643a3,0x1),_0x14a491[_0x395bff(0x230)]['splice'](_0x1643a3,0x1);if(_0x14a491[_0x395bff(0x1c6)]>=_0x14a491[_0x395bff(0x2c5)][_0x395bff(0x2d1)])_0x14a491[_0x395bff(0x1c6)]=_0x14a491[_0x395bff(0x2c5)][_0x395bff(0x2d1)]-0x1;updateLayerUI(),redrawAll();}function addLayer(){const _0x35ea57=a0_0x545b5f;let _0x54ff65=getCurrentProject(),_0x2b9cf8=getCurrentFrame(),_0xd3c988=document['createElement'](_0x35ea57(0x297));_0xd3c988['width']=_0x54ff65[_0x35ea57(0x21e)]*cellSize,_0xd3c988[_0x35ea57(0x23e)]=_0x54ff65[_0x35ea57(0x23e)]*cellSize,_0x2b9cf8[_0x35ea57(0x2c5)]['push'](_0xd3c988),_0x2b9cf8[_0x35ea57(0x1d5)][_0x35ea57(0x1b8)]([]),_0x2b9cf8[_0x35ea57(0x230)]['push']([]),_0x2b9cf8[_0x35ea57(0x1c6)]=_0x2b9cf8[_0x35ea57(0x2c5)][_0x35ea57(0x2d1)]-0x1,saveHistory(),updateLayerUI(),redrawAll();}function removeLayer(){const _0x318cf0=a0_0x545b5f;let _0x58492a=getCurrentFrame();if(_0x58492a[_0x318cf0(0x2c5)][_0x318cf0(0x2d1)]<=0x1)return;_0x58492a['layers']['splice'](_0x58492a[_0x318cf0(0x1c6)],0x1),_0x58492a[_0x318cf0(0x1d5)][_0x318cf0(0x26a)](_0x58492a[_0x318cf0(0x1c6)],0x1),_0x58492a[_0x318cf0(0x230)]['splice'](_0x58492a[_0x318cf0(0x1c6)],0x1),_0x58492a[_0x318cf0(0x1c6)]=Math[_0x318cf0(0x238)](0x0,_0x58492a[_0x318cf0(0x1c6)]-0x1),updateLayerUI(),redrawAll();}function selectLayer(_0x1438c9){const _0x5e25f7=a0_0x545b5f;getCurrentFrame()[_0x5e25f7(0x1c6)]=parseInt(_0x1438c9),updateLayerUI();}let PALETTE_COLORS=[a0_0x545b5f(0x219),a0_0x545b5f(0x234),a0_0x545b5f(0x1fe),a0_0x545b5f(0x295),a0_0x545b5f(0x252),a0_0x545b5f(0x2ae),a0_0x545b5f(0x235),'#ffa500',a0_0x545b5f(0x1a9),a0_0x545b5f(0x263),a0_0x545b5f(0x1c3),a0_0x545b5f(0x204),'#ff00ff',a0_0x545b5f(0x2a1),'#808000',a0_0x545b5f(0x1fd),'#008080',a0_0x545b5f(0x1b6),'#800080',a0_0x545b5f(0x2b5),a0_0x545b5f(0x1cf)],currentAlpha=0x1;function setTool(_0x3120df){const _0x163f18=a0_0x545b5f;currentTool=_0x3120df,document['querySelectorAll'](_0x163f18(0x236))[_0x163f18(0x1e9)](_0x216032=>{const _0x22aabf=_0x163f18;_0x216032[_0x22aabf(0x24f)]['toggle']('active',_0x216032[_0x22aabf(0x1e6)]['tool']===_0x3120df);}),document[_0x163f18(0x1d8)](_0x163f18(0x296))[_0x163f18(0x1e9)](_0x2157bf=>{const _0x9fb6b4=_0x163f18;_0x2157bf[_0x9fb6b4(0x24f)][_0x9fb6b4(0x1b9)]('active',_0x2157bf[_0x9fb6b4(0x1e6)]['tool']===_0x3120df);});}function setPenSize(_0x56bf07){const _0x4af560=a0_0x545b5f;penSize=parseInt(_0x56bf07)||0x1;let _0x2aca8d=document[_0x4af560(0x1bf)](_0x4af560(0x2b3));if(_0x2aca8d)_0x2aca8d[_0x4af560(0x264)]=penSize;let _0x37b649=document[_0x4af560(0x1bf)](_0x4af560(0x277));if(_0x37b649)_0x37b649[_0x4af560(0x264)]=penSize;}function setPenMode(_0x543954){const _0x9ecbce=a0_0x545b5f;penMode=_0x543954;let _0x1481e4=document['getElementById'](_0x9ecbce(0x227));if(_0x1481e4)_0x1481e4['value']=penMode;let _0x358381=document[_0x9ecbce(0x1bf)](_0x9ecbce(0x243));if(_0x358381)_0x358381[_0x9ecbce(0x264)]=penMode;}function hexToRgba(_0x14ac95,_0xd968a6=0x1){const _0x4a36b3=a0_0x545b5f;if(_0x14ac95==='transparent'||_0x14ac95===_0x4a36b3(0x270))return[0x0,0x0,0x0,0x0];_0x14ac95=_0x14ac95[_0x4a36b3(0x195)]('#','');if(_0x14ac95[_0x4a36b3(0x2d1)]===0x3)_0x14ac95=_0x14ac95[_0x4a36b3(0x1b1)]('')[_0x4a36b3(0x1a5)](_0x43cb43=>_0x43cb43+_0x43cb43)[_0x4a36b3(0x22e)]('');let _0x57dac8=parseInt(_0x14ac95,0x10);return[_0x57dac8>>0x10&0xff,_0x57dac8>>0x8&0xff,_0x57dac8&0xff,Math[_0x4a36b3(0x2ca)](0xff*_0xd968a6)];}function fillAt(_0x3c2609,_0x710859){const _0x3bce97=a0_0x545b5f;let _0x6b47a6=getCurrentProject(),_0x5abdd2=getCurrentFrame(),_0x4bf9b1=_0x5abdd2['layers'][_0x5abdd2[_0x3bce97(0x1c6)]]['getContext']('2d'),_0xef17c6=_0x4bf9b1[_0x3bce97(0x1f1)](0x0,0x0,_0x6b47a6[_0x3bce97(0x21e)]*cellSize,_0x6b47a6[_0x3bce97(0x23e)]*cellSize),_0x2c2a8c=_0x3c2609*cellSize,_0xa75a12=_0x710859*cellSize,_0x4a4c89=getPixel(_0xef17c6,_0x2c2a8c,_0xa75a12),_0x2cfa6c=currentColor==='transparent'||currentColor===_0x3bce97(0x270)||currentAlpha===0x0?[0x0,0x0,0x0,0x0]:hexToRgba(currentColor,currentAlpha);if(colorsMatch(_0x4a4c89,_0x2cfa6c))return;let _0x29b777=[[_0x3c2609,_0x710859]],_0x31a8e1=new Set();while(_0x29b777[_0x3bce97(0x2d1)]){let [_0x38818a,_0x25cbd9]=_0x29b777[_0x3bce97(0x1a4)]();if(_0x38818a<0x0||_0x25cbd9<0x0||_0x38818a>=_0x6b47a6[_0x3bce97(0x21e)]||_0x25cbd9>=_0x6b47a6[_0x3bce97(0x23e)])continue;let _0x3e9bc9=_0x38818a+','+_0x25cbd9;if(_0x31a8e1[_0x3bce97(0x29c)](_0x3e9bc9))continue;_0x31a8e1[_0x3bce97(0x20f)](_0x3e9bc9);let _0x25f15c=_0x38818a*cellSize,_0x2f6d4b=_0x25cbd9*cellSize,_0x567ad6=getPixel(_0xef17c6,_0x25f15c,_0x2f6d4b);if(!colorsMatch(_0x567ad6,_0x4a4c89))continue;for(let _0x534c26=0x0;_0x534c26<cellSize;_0x534c26++){for(let _0x497368=0x0;_0x497368<cellSize;_0x497368++){setPixel(_0xef17c6,_0x25f15c+_0x497368,_0x2f6d4b+_0x534c26,_0x2cfa6c);}}_0x29b777[_0x3bce97(0x1b8)]([_0x38818a+0x1,_0x25cbd9]),_0x29b777['push']([_0x38818a-0x1,_0x25cbd9]),_0x29b777[_0x3bce97(0x1b8)]([_0x38818a,_0x25cbd9+0x1]),_0x29b777[_0x3bce97(0x1b8)]([_0x38818a,_0x25cbd9-0x1]);}_0x4bf9b1['putImageData'](_0xef17c6,0x0,0x0),redrawAll();}function getPixel(_0x495e64,_0x367c9a,_0x5818d1){const _0x13b238=a0_0x545b5f;let _0x351d08=(_0x5818d1*_0x495e64['width']+_0x367c9a)*0x4;return[_0x495e64[_0x13b238(0x2b7)][_0x351d08],_0x495e64['data'][_0x351d08+0x1],_0x495e64['data'][_0x351d08+0x2],_0x495e64[_0x13b238(0x2b7)][_0x351d08+0x3]];}function setPixel(_0x5042fd,_0x25f1d8,_0x409e3c,_0x35e240){const _0x12c7eb=a0_0x545b5f;let _0x50e4b6=(_0x409e3c*_0x5042fd[_0x12c7eb(0x21e)]+_0x25f1d8)*0x4;_0x5042fd[_0x12c7eb(0x2b7)][_0x50e4b6]=_0x35e240[0x0],_0x5042fd['data'][_0x50e4b6+0x1]=_0x35e240[0x1],_0x5042fd[_0x12c7eb(0x2b7)][_0x50e4b6+0x2]=_0x35e240[0x2],_0x5042fd[_0x12c7eb(0x2b7)][_0x50e4b6+0x3]=_0x35e240[0x3];}function colorsMatch(_0x1419d7,_0x193b49){return _0x1419d7[0x0]===_0x193b49[0x0]&&_0x1419d7[0x1]===_0x193b49[0x1]&&_0x1419d7[0x2]===_0x193b49[0x2]&&_0x1419d7[0x3]===_0x193b49[0x3];}function handleMouseDown(_0x4e56e6){const _0x5df639=a0_0x545b5f;isDrawing=!![];const _0x1e5bb3=canvas[_0x5df639(0x2ad)](),_0x5a5453=canvas['width']/_0x1e5bb3[_0x5df639(0x21e)],_0x182650=canvas[_0x5df639(0x23e)]/_0x1e5bb3[_0x5df639(0x23e)],_0x124bda=Math[_0x5df639(0x1c2)]((_0x4e56e6[_0x5df639(0x1f7)]-_0x1e5bb3['left'])*_0x5a5453/cellSize),_0x5c5064=Math[_0x5df639(0x1c2)]((_0x4e56e6[_0x5df639(0x2c9)]-_0x1e5bb3[_0x5df639(0x1a6)])*_0x182650/cellSize);currentTool===_0x5df639(0x21b)?(fillAt(_0x124bda,_0x5c5064),saveHistory(),isDrawing=![]):drawDotXY(_0x124bda,_0x5c5064);}function handleMouseMove(_0x386eb1){const _0x4ceaea=a0_0x545b5f;if(!isDrawing)return;const _0x2b4624=canvas['getBoundingClientRect'](),_0x50436c=canvas[_0x4ceaea(0x21e)]/_0x2b4624[_0x4ceaea(0x21e)],_0x46487c=canvas['height']/_0x2b4624['height'],_0x3760a9=Math[_0x4ceaea(0x1c2)]((_0x386eb1[_0x4ceaea(0x1f7)]-_0x2b4624['left'])*_0x50436c/cellSize),_0x28b5c0=Math[_0x4ceaea(0x1c2)]((_0x386eb1[_0x4ceaea(0x2c9)]-_0x2b4624[_0x4ceaea(0x1a6)])*_0x46487c/cellSize);drawDotXY(_0x3760a9,_0x28b5c0);}function handleMouseUp(_0x51f8c3){isDrawing&&saveHistory(),isDrawing=![];}let lastTouch=null;function getTouchPos(_0x5c7386){const _0x16b3fe=a0_0x545b5f,_0x96b314=canvas[_0x16b3fe(0x2ad)]();let _0x794c4d=_0x5c7386[_0x16b3fe(0x2ab)]&&_0x5c7386['touches'][0x0]?_0x5c7386[_0x16b3fe(0x2ab)][0x0]:_0x5c7386['changedTouches'][0x0];const _0x4b5a87=canvas[_0x16b3fe(0x21e)]/_0x96b314[_0x16b3fe(0x21e)],_0x22cad7=canvas[_0x16b3fe(0x23e)]/_0x96b314[_0x16b3fe(0x23e)];return{'x':Math[_0x16b3fe(0x1c2)]((_0x794c4d[_0x16b3fe(0x1f7)]-_0x96b314[_0x16b3fe(0x2a4)])*_0x4b5a87/cellSize),'y':Math[_0x16b3fe(0x1c2)]((_0x794c4d[_0x16b3fe(0x2c9)]-_0x96b314[_0x16b3fe(0x1a6)])*_0x22cad7/cellSize)};}function a0_0x45c9(_0x4adbfa,_0x57f01c){const _0x1a6ca0=a0_0x36af();return a0_0x45c9=function(_0x4a7776,_0x4aeb04){_0x4a7776=_0x4a7776-0x195;let _0x36af25=_0x1a6ca0[_0x4a7776];return _0x36af25;},a0_0x45c9(_0x4adbfa,_0x57f01c);}function handleTouchStart(_0x3f5064){const _0x4be7b7=a0_0x545b5f;if(_0x3f5064[_0x4be7b7(0x2ab)]['length']>0x1)return;_0x3f5064[_0x4be7b7(0x288)](),isDrawing=!![];let _0x4b0f5e=getTouchPos(_0x3f5064);lastTouch=_0x4b0f5e,currentTool===_0x4be7b7(0x21b)?(fillAt(_0x4b0f5e['x'],_0x4b0f5e['y']),saveHistory(),isDrawing=![]):drawDotTouch(_0x4b0f5e['x'],_0x4b0f5e['y']);}function handleTouchMove(_0x3bb264){const _0x7604e3=a0_0x545b5f;if(!isDrawing)return;if(_0x3bb264[_0x7604e3(0x2ab)][_0x7604e3(0x2d1)]>0x1)return;_0x3bb264[_0x7604e3(0x288)]();let _0x2a9191=getTouchPos(_0x3bb264);if(lastTouch){let _0x22935e=_0x2a9191['x']-lastTouch['x'],_0x2f3ff9=_0x2a9191['y']-lastTouch['y'],_0x4bc054=Math[_0x7604e3(0x238)](Math['abs'](_0x22935e),Math[_0x7604e3(0x20e)](_0x2f3ff9));for(let _0x4cfe4e=0x1;_0x4cfe4e<=_0x4bc054;_0x4cfe4e++){let _0x3fa2c0=Math[_0x7604e3(0x2ca)](lastTouch['x']+_0x22935e*_0x4cfe4e/_0x4bc054),_0x269ed9=Math[_0x7604e3(0x2ca)](lastTouch['y']+_0x2f3ff9*_0x4cfe4e/_0x4bc054);drawDotTouch(_0x3fa2c0,_0x269ed9);}}else drawDotTouch(_0x2a9191['x'],_0x2a9191['y']);lastTouch=_0x2a9191;}function handleTouchEnd(_0x4d92a8){isDrawing&&saveHistory(),isDrawing=![],lastTouch=null;}function drawDotXY(_0x2f68d9,_0x559064){const _0x2b064e=a0_0x545b5f;let _0xad2412=getCurrentProject(),_0x3b5027=getCurrentFrame();if(!_0x3b5027||!_0xad2412)return;if(typeof _0x2f68d9!==_0x2b064e(0x1f6)||typeof _0x559064!==_0x2b064e(0x1f6)||_0x2f68d9<0x0||_0x559064<0x0||!Number[_0x2b064e(0x1ea)](_0xad2412[_0x2b064e(0x21e)])||!Number['isFinite'](_0xad2412[_0x2b064e(0x23e)])||_0x2f68d9>=_0xad2412[_0x2b064e(0x21e)]||_0x559064>=_0xad2412[_0x2b064e(0x23e)]||!Array['isArray'](_0x3b5027['layers'])||typeof _0x3b5027[_0x2b064e(0x1c6)]!=='number'||!_0x3b5027['layers'][_0x3b5027[_0x2b064e(0x1c6)]])return;let _0x22e788=_0x3b5027['layers'][_0x3b5027[_0x2b064e(0x1c6)]]['getContext']('2d');if(!_0x22e788)return;if(currentTool==='eraser'||currentColor===_0x2b064e(0x219)||currentColor==='#00000000'||currentAlpha===0x0)drawPenShape(_0x22e788,_0x2f68d9,_0x559064,_0x2b064e(0x270),!![]);else{let _0x356aa7=hexToRgba(currentColor,currentAlpha);_0x22e788[_0x2b064e(0x19e)](),_0x22e788['globalAlpha']=_0x356aa7[0x3]/0xff,drawPenShape(_0x22e788,_0x2f68d9,_0x559064,_0x2b064e(0x1e2)+_0x356aa7[0x0]+','+_0x356aa7[0x1]+','+_0x356aa7[0x2]+','+_0x356aa7[0x3]/0xff+')',![]),_0x22e788[_0x2b064e(0x202)]();}redrawAll();}function drawPenShape(_0x268091,_0x447306,_0x2cda22,_0x109679,_0x1489cb){const _0x448c78=a0_0x545b5f,_0x4fc833=_0x447306*cellSize,_0x460bdd=_0x2cda22*cellSize,_0x457f7e=penSize*cellSize;_0x1489cb?(_0x268091['save'](),_0x268091[_0x448c78(0x205)]=_0x448c78(0x23c),penMode===_0x448c78(0x248)?(_0x268091[_0x448c78(0x226)](),_0x268091[_0x448c78(0x1ca)](_0x4fc833+cellSize/0x2,_0x460bdd+cellSize/0x2,_0x457f7e/0x2,0x0,Math['PI']*0x2),_0x268091[_0x448c78(0x21b)]()):_0x268091[_0x448c78(0x1c1)](_0x4fc833-Math[_0x448c78(0x1c2)]((penSize-0x1)/0x2)*cellSize,_0x460bdd-Math['floor']((penSize-0x1)/0x2)*cellSize,_0x457f7e,_0x457f7e),_0x268091[_0x448c78(0x202)]()):(_0x268091[_0x448c78(0x19e)](),_0x268091[_0x448c78(0x1b0)]=_0x109679,penMode===_0x448c78(0x248)?(_0x268091[_0x448c78(0x226)](),_0x268091[_0x448c78(0x1ca)](_0x4fc833+cellSize/0x2,_0x460bdd+cellSize/0x2,_0x457f7e/0x2,0x0,Math['PI']*0x2),_0x268091[_0x448c78(0x21b)]()):_0x268091[_0x448c78(0x289)](_0x4fc833-Math[_0x448c78(0x1c2)]((penSize-0x1)/0x2)*cellSize,_0x460bdd-Math[_0x448c78(0x1c2)]((penSize-0x1)/0x2)*cellSize,_0x457f7e,_0x457f7e),_0x268091[_0x448c78(0x202)]());}function drawDotTouch(_0x555c2b,_0x412c86){const _0x1fabe3=a0_0x545b5f;let _0x46a021=getCurrentProject(),_0x5ea6b9=getCurrentFrame();if(_0x555c2b<0x0||_0x412c86<0x0||_0x555c2b>=_0x46a021[_0x1fabe3(0x21e)]||_0x412c86>=_0x46a021['height'])return;let _0x1b9e97=_0x5ea6b9[_0x1fabe3(0x2c5)][_0x5ea6b9[_0x1fabe3(0x1c6)]][_0x1fabe3(0x275)]('2d');if(currentTool==='eraser'||currentColor===_0x1fabe3(0x219)||currentColor===_0x1fabe3(0x270)||currentAlpha===0x0)drawPenShape(_0x1b9e97,_0x555c2b,_0x412c86,'#00000000',!![]);else{let _0x36b966=hexToRgba(currentColor,currentAlpha);_0x1b9e97[_0x1fabe3(0x19e)](),_0x1b9e97[_0x1fabe3(0x196)]=_0x36b966[0x3]/0xff,drawPenShape(_0x1b9e97,_0x555c2b,_0x412c86,_0x1fabe3(0x1e2)+_0x36b966[0x0]+','+_0x36b966[0x1]+','+_0x36b966[0x2]+','+_0x36b966[0x3]/0xff+')',![]),_0x1b9e97['restore']();}redrawAll();}window[a0_0x545b5f(0x23d)]=()=>{const _0x562091=a0_0x545b5f;projects=[createProject()],activeProject=0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),initCanvas(),setTool(_0x562091(0x283)),createPalette(),document[_0x562091(0x1bf)](_0x562091(0x2b3))[_0x562091(0x264)]=penSize,document['getElementById'](_0x562091(0x227))[_0x562091(0x264)]=penMode,canvas['onmousemove']=handleMouseMove,canvas['onmouseup']=handleMouseUp,canvas[_0x562091(0x1a3)]=handleMouseUp,canvas[_0x562091(0x1f2)]=handleTouchStart,canvas['ontouchmove']=handleTouchMove,canvas['ontouchend']=handleTouchEnd,canvas['ontouchcancel']=handleTouchEnd,canvas[_0x562091(0x244)](_0x562091(0x1c9),handleTouchStart,{'passive':![]}),canvas[_0x562091(0x244)](_0x562091(0x1c4),handleTouchMove,{'passive':![]}),canvas[_0x562091(0x244)](_0x562091(0x26c),handleTouchEnd,{'passive':![]}),canvas[_0x562091(0x244)]('touchcancel',handleTouchEnd,{'passive':![]}),idbGet(_0x562091(0x242))&&loadProjectFromIDB();};function drawGrid(_0x416dd8,_0x9719c5){const _0x4fca84=a0_0x545b5f;ctx['save'](),ctx[_0x4fca84(0x2be)]=_0x4fca84(0x19d);for(let _0x4b18db=0x0;_0x4b18db<=_0x416dd8;_0x4b18db++){ctx['beginPath'](),ctx[_0x4fca84(0x19c)](_0x4b18db*cellSize,0x0),ctx[_0x4fca84(0x25d)](_0x4b18db*cellSize,_0x9719c5*cellSize),ctx[_0x4fca84(0x2c1)]();}for(let _0x2ef92c=0x0;_0x2ef92c<=_0x9719c5;_0x2ef92c++){ctx[_0x4fca84(0x226)](),ctx[_0x4fca84(0x19c)](0x0,_0x2ef92c*cellSize),ctx[_0x4fca84(0x25d)](_0x416dd8*cellSize,_0x2ef92c*cellSize),ctx[_0x4fca84(0x2c1)]();}ctx[_0x4fca84(0x202)]();}function redrawAll(){const _0x4bb7da=a0_0x545b5f;let _0x3f534c=getCurrentProject(),_0x24715c=getCurrentFrame();canvas[_0x4bb7da(0x21e)]=_0x3f534c[_0x4bb7da(0x21e)]*cellSize,canvas[_0x4bb7da(0x23e)]=_0x3f534c[_0x4bb7da(0x23e)]*cellSize,ctx[_0x4bb7da(0x1c1)](0x0,0x0,canvas[_0x4bb7da(0x21e)],canvas[_0x4bb7da(0x23e)]);for(let _0xd95533=0x0;_0xd95533<_0x24715c[_0x4bb7da(0x2c5)][_0x4bb7da(0x2d1)];_0xd95533++){ctx[_0x4bb7da(0x246)](_0x24715c[_0x4bb7da(0x2c5)][_0xd95533],0x0,0x0);}drawGrid(_0x3f534c[_0x4bb7da(0x21e)],_0x3f534c['height']),wrapper[_0x4bb7da(0x1bd)][_0x4bb7da(0x21e)]=_0x3f534c[_0x4bb7da(0x21e)]*cellSize+'px',wrapper['style'][_0x4bb7da(0x23e)]=_0x3f534c[_0x4bb7da(0x23e)]*cellSize+'px';}function saveHistory(){const _0x3447d5=a0_0x545b5f;let _0x5bf631=getCurrentFrame(),_0x42d9d9=_0x5bf631[_0x3447d5(0x1d5)][_0x5bf631[_0x3447d5(0x1c6)]];_0x42d9d9[_0x3447d5(0x1b8)](_0x5bf631[_0x3447d5(0x2c5)][_0x5bf631[_0x3447d5(0x1c6)]][_0x3447d5(0x2bb)]());if(_0x42d9d9[_0x3447d5(0x2d1)]>0x32)_0x42d9d9[_0x3447d5(0x1a1)]();_0x5bf631[_0x3447d5(0x230)][_0x5bf631[_0x3447d5(0x1c6)]]=[];}function undo(){const _0x1bd476=a0_0x545b5f;let _0x42d7eb=getCurrentFrame(),_0x3b1b9b=_0x42d7eb['layerHistories'][_0x42d7eb['activeLayer']],_0x58f429=_0x42d7eb[_0x1bd476(0x230)][_0x42d7eb[_0x1bd476(0x1c6)]];if(!_0x3b1b9b||_0x3b1b9b['length']<0x2)return;_0x58f429[_0x1bd476(0x1b8)](_0x3b1b9b[_0x1bd476(0x1a4)]());let _0x226532=new Image();_0x226532[_0x1bd476(0x23d)]=()=>{const _0x2a9c3c=_0x1bd476;let _0x120bbf=_0x42d7eb[_0x2a9c3c(0x2c5)][_0x42d7eb['activeLayer']][_0x2a9c3c(0x275)]('2d');_0x120bbf[_0x2a9c3c(0x1c1)](0x0,0x0,_0x42d7eb[_0x2a9c3c(0x2c5)][_0x42d7eb[_0x2a9c3c(0x1c6)]][_0x2a9c3c(0x21e)],_0x42d7eb[_0x2a9c3c(0x2c5)][_0x42d7eb['activeLayer']]['height']),_0x120bbf[_0x2a9c3c(0x246)](_0x226532,0x0,0x0),redrawAll();},_0x226532['src']=_0x3b1b9b[_0x3b1b9b[_0x1bd476(0x2d1)]-0x1];}function redo(){const _0x271bbe=a0_0x545b5f;let _0x4a829e=getCurrentFrame(),_0x11c749=_0x4a829e['layerHistories'][_0x4a829e[_0x271bbe(0x1c6)]],_0x950108=_0x4a829e['layerRedoStacks'][_0x4a829e[_0x271bbe(0x1c6)]];if(!_0x950108||_0x950108[_0x271bbe(0x2d1)]===0x0)return;let _0x43af13=_0x950108['pop']();_0x11c749['push'](_0x43af13);let _0x49c863=new Image();_0x49c863[_0x271bbe(0x23d)]=()=>{const _0x42e6d5=_0x271bbe;let _0x441f09=_0x4a829e[_0x42e6d5(0x2c5)][_0x4a829e[_0x42e6d5(0x1c6)]]['getContext']('2d');_0x441f09[_0x42e6d5(0x1c1)](0x0,0x0,_0x4a829e[_0x42e6d5(0x2c5)][_0x4a829e['activeLayer']][_0x42e6d5(0x21e)],_0x4a829e[_0x42e6d5(0x2c5)][_0x4a829e[_0x42e6d5(0x1c6)]][_0x42e6d5(0x23e)]),_0x441f09[_0x42e6d5(0x246)](_0x49c863,0x0,0x0),redrawAll();},_0x49c863['src']=_0x43af13;}function exportImage(_0x510055){const _0x7b4d46=a0_0x545b5f;let _0x53515d=getCurrentProject(),_0x33d088=_0x53515d[_0x7b4d46(0x2bf)],_0x14ed76=_0x510055===_0x7b4d46(0x273)||_0x510055==='jpeg'?_0x7b4d46(0x1f9):_0x7b4d46(0x2c8)+_0x510055,_0x37f7fb=_0x33d088['length']>0x1,_0xf0411f=(_0x53515d[_0x7b4d46(0x2cd)]||_0x7b4d46(0x200))['replace'](/[\\/:*?"<>|]/g,'_');if(!_0x37f7fb){let _0x5ec8fc=document[_0x7b4d46(0x23a)]('canvas');_0x5ec8fc['width']=_0x53515d[_0x7b4d46(0x21e)]*cellSize,_0x5ec8fc[_0x7b4d46(0x23e)]=_0x53515d[_0x7b4d46(0x23e)]*cellSize;let _0x5b881e=_0x5ec8fc[_0x7b4d46(0x275)]('2d'),_0x175d64=getCurrentFrame();for(let _0x568989=0x0;_0x568989<_0x175d64[_0x7b4d46(0x2c5)]['length'];_0x568989++){_0x5b881e[_0x7b4d46(0x246)](_0x175d64[_0x7b4d46(0x2c5)][_0x568989],0x0,0x0);}let _0x9350f3=document['createElement']('a');_0x9350f3[_0x7b4d46(0x19f)]=_0xf0411f+'.'+_0x510055,_0x510055===_0x7b4d46(0x273)||_0x510055===_0x7b4d46(0x26d)?_0x9350f3[_0x7b4d46(0x23f)]=_0x5ec8fc[_0x7b4d46(0x2bb)](_0x14ed76,0.92):_0x9350f3['href']=_0x5ec8fc[_0x7b4d46(0x2bb)](_0x14ed76),_0x9350f3['click']();}else{if(_0x510055==='webp'&&typeof window['WebCodecs']!==_0x7b4d46(0x21f))exportWebpAnimation(_0x33d088,_0x53515d['width']*cellSize,_0x53515d[_0x7b4d46(0x23e)]*cellSize,_0xf0411f);else for(let _0x15720a=0x0;_0x15720a<_0x33d088[_0x7b4d46(0x2d1)];_0x15720a++){let _0x34ef64=document[_0x7b4d46(0x23a)](_0x7b4d46(0x297));_0x34ef64[_0x7b4d46(0x21e)]=_0x53515d[_0x7b4d46(0x21e)]*cellSize,_0x34ef64[_0x7b4d46(0x23e)]=_0x53515d['height']*cellSize;let _0x32fbb1=_0x34ef64['getContext']('2d'),_0x30f772=_0x33d088[_0x15720a];for(let _0x564779=0x0;_0x564779<_0x30f772[_0x7b4d46(0x2c5)][_0x7b4d46(0x2d1)];_0x564779++){_0x32fbb1[_0x7b4d46(0x246)](_0x30f772['layers'][_0x564779],0x0,0x0);}let _0x326146=document[_0x7b4d46(0x23a)]('a');_0x326146['download']=_0xf0411f+'-f'+(_0x15720a+0x1)+'.'+_0x510055,_0x510055===_0x7b4d46(0x273)||_0x510055===_0x7b4d46(0x26d)?_0x326146[_0x7b4d46(0x23f)]=_0x34ef64[_0x7b4d46(0x2bb)](_0x14ed76,0.92):_0x326146[_0x7b4d46(0x23f)]=_0x34ef64[_0x7b4d46(0x2bb)](_0x14ed76),setTimeout(()=>_0x326146[_0x7b4d46(0x29f)](),_0x15720a*0x64);}}}async function exportWebpAnimation(_0x1fe4bb,_0x159b6b,_0x276b18,_0x52a11e='nezumi-animation'){const _0x3df9f5=a0_0x545b5f;if(!window[_0x3df9f5(0x229)]||!window[_0x3df9f5(0x29b)]){alert('このブラウザはWebCodecsによるWEBPアニメーションに対応していません。');return;}const _0x157b76=[],_0x36f81f=new VideoEncoder({'output':_0x4fadb5=>_0x157b76['push'](_0x4fadb5),'error':_0x55c30a=>console[_0x3df9f5(0x26f)](_0x55c30a)});_0x36f81f['configure']({'codec':_0x3df9f5(0x2a9),'width':_0x159b6b,'height':_0x276b18,'framerate':0x5});for(let _0x3d39ca=0x0;_0x3d39ca<_0x1fe4bb[_0x3df9f5(0x2d1)];_0x3d39ca++){let _0x57b78a=document[_0x3df9f5(0x23a)]('canvas');_0x57b78a[_0x3df9f5(0x21e)]=_0x159b6b,_0x57b78a[_0x3df9f5(0x23e)]=_0x276b18;let _0x4b0cac=_0x57b78a[_0x3df9f5(0x275)]('2d'),_0x35eec5=_0x1fe4bb[_0x3d39ca];for(let _0x506e08=0x0;_0x506e08<_0x35eec5[_0x3df9f5(0x2c5)]['length'];_0x506e08++){_0x4b0cac[_0x3df9f5(0x246)](_0x35eec5[_0x3df9f5(0x2c5)][_0x506e08],0x0,0x0);}let _0x1444ba=await createImageBitmap(_0x57b78a);_0x36f81f['encode'](_0x1444ba,{'keyFrame':!![],'duration':0xc8}),_0x1444ba['close']();}await _0x36f81f[_0x3df9f5(0x27b)](),_0x36f81f[_0x3df9f5(0x1f3)]();const _0x1a704c=new Blob(_0x157b76['map'](_0x31f0cf=>_0x31f0cf[_0x3df9f5(0x2a8)]?_0x31f0cf:_0x31f0cf[_0x3df9f5(0x2b7)]),{'type':_0x3df9f5(0x24e)}),_0x1ac560=document[_0x3df9f5(0x23a)]('a');_0x1ac560['download']=_0x52a11e+_0x3df9f5(0x1b3),_0x1ac560[_0x3df9f5(0x23f)]=URL[_0x3df9f5(0x251)](_0x1a704c),_0x1ac560[_0x3df9f5(0x29f)]();}function exportGif(){const _0x53da69=a0_0x545b5f;let _0x2205f9=getCurrentProject(),_0x13c833=_0x2205f9[_0x53da69(0x2bf)],_0x42e46d=_0x2205f9[_0x53da69(0x21e)]*cellSize,_0x4087e2=_0x2205f9['height']*cellSize;const _0x22e7ad=_0x13c833['map'](_0x4074db=>{const _0xb45965=_0x53da69;let _0x5a11ed=document[_0xb45965(0x23a)](_0xb45965(0x297));_0x5a11ed[_0xb45965(0x21e)]=_0x42e46d,_0x5a11ed[_0xb45965(0x23e)]=_0x4087e2;let _0x21e6b8=_0x5a11ed[_0xb45965(0x275)]('2d');for(let _0x310b80=0x0;_0x310b80<_0x4074db[_0xb45965(0x2c5)][_0xb45965(0x2d1)];_0x310b80++){_0x21e6b8[_0xb45965(0x246)](_0x4074db['layers'][_0x310b80],0x0,0x0);}return _0x5a11ed['toDataURL']('image/png');});Promise[_0x53da69(0x1c8)](_0x22e7ad[_0x53da69(0x1a5)](_0x1530a1=>{return new Promise(_0x4444c0=>{const _0x2d8034=a0_0x45c9,_0xf4ba0a=new Image();_0xf4ba0a['src']=_0x1530a1,_0xf4ba0a[_0x2d8034(0x23d)]=()=>_0x4444c0(_0xf4ba0a);});}))[_0x53da69(0x2af)](_0xb6126b=>{const _0x1ab775=_0x53da69,_0x49352a=_0xb6126b[_0x1ab775(0x1bc)](_0x46639e=>_0x46639e['width']>0x0&&_0x46639e[_0x1ab775(0x23e)]>0x0);if(_0x49352a[_0x1ab775(0x2d1)]===0x0){alert('GIFに変換できる画像がありません。');return;}const _0x20dfad=(_0x2205f9[_0x1ab775(0x2cd)]||'nezumi-animation')[_0x1ab775(0x195)](/[\\/:*?"<>|]/g,'_');convertToGIF(_0x49352a,0x12c,_0x20dfad+'.gif');});}function exportApng(){const _0x27f22b=a0_0x545b5f;let _0x30ec20=getCurrentProject(),_0xc162ce=_0x30ec20[_0x27f22b(0x2bf)],_0x4029f3=_0x30ec20[_0x27f22b(0x21e)]*cellSize,_0x38b42b=_0x30ec20['height']*cellSize;const _0x4c5bed=_0xc162ce[_0x27f22b(0x1a5)](_0xadf1bb=>{const _0x3209a3=_0x27f22b;let _0x16011e=document['createElement']('canvas');_0x16011e['width']=_0x4029f3,_0x16011e[_0x3209a3(0x23e)]=_0x38b42b;let _0x59379b=_0x16011e[_0x3209a3(0x275)]('2d');for(let _0x31bde0=0x0;_0x31bde0<_0xadf1bb[_0x3209a3(0x2c5)][_0x3209a3(0x2d1)];_0x31bde0++){_0x59379b[_0x3209a3(0x246)](_0xadf1bb[_0x3209a3(0x2c5)][_0x31bde0],0x0,0x0);}let _0x8fffb=new Image();return _0x8fffb[_0x3209a3(0x2a7)]=_0x16011e[_0x3209a3(0x2bb)](_0x3209a3(0x253)),_0x8fffb;}),_0x2f0540=(_0x30ec20['name']||_0x27f22b(0x231))['replace'](/[\\/:*?"<>|]/g,'_');convertToAPNG(_0x4c5bed,_0x4029f3,_0x38b42b,0x12c,_0x2f0540+_0x27f22b(0x1dc));}const dbName=a0_0x545b5f(0x1ad),storeName=a0_0x545b5f(0x258);function openDB(){return new Promise((_0x30c2c4,_0x30ed92)=>{const _0x290c5d=a0_0x45c9,_0xcda7fc=indexedDB[_0x290c5d(0x290)](dbName,0x1);_0xcda7fc[_0x290c5d(0x209)]=()=>{const _0x3f710b=_0x290c5d;_0xcda7fc[_0x3f710b(0x27c)]['createObjectStore'](storeName);},_0xcda7fc[_0x290c5d(0x271)]=()=>_0x30c2c4(_0xcda7fc[_0x290c5d(0x27c)]),_0xcda7fc[_0x290c5d(0x24c)]=()=>_0x30ed92(_0xcda7fc[_0x290c5d(0x26f)]);});}async function idbSet(_0xfb5852,_0x25e5e9){const _0x1d88d2=await openDB();return new Promise((_0x358c99,_0x2ee13e)=>{const _0x13ca1b=a0_0x45c9,_0x2d490a=_0x1d88d2[_0x13ca1b(0x22f)](storeName,_0x13ca1b(0x27f));_0x2d490a[_0x13ca1b(0x203)](storeName)[_0x13ca1b(0x1df)](_0x25e5e9,_0xfb5852),_0x2d490a['oncomplete']=()=>_0x358c99(),_0x2d490a[_0x13ca1b(0x24c)]=()=>_0x2ee13e(_0x2d490a[_0x13ca1b(0x26f)]);});}async function idbGet(_0x486d7e){const _0x2a4083=await openDB();return new Promise((_0xb5620c,_0x1a5ed3)=>{const _0x1a1829=a0_0x45c9,_0x1c7979=_0x2a4083['transaction'](storeName,_0x1a1829(0x232)),_0x589507=_0x1c7979[_0x1a1829(0x203)](storeName)[_0x1a1829(0x225)](_0x486d7e);_0x589507['onsuccess']=()=>_0xb5620c(_0x589507[_0x1a1829(0x27c)]),_0x589507[_0x1a1829(0x24c)]=()=>_0x1a5ed3(_0x589507[_0x1a1829(0x26f)]);});}async function idbDelete(_0xa97e96){const _0x5947cc=await openDB();return new Promise((_0x4e0006,_0x595cd4)=>{const _0x5b949d=a0_0x45c9,_0x1e1414=_0x5947cc[_0x5b949d(0x22f)](storeName,_0x5b949d(0x27f));_0x1e1414[_0x5b949d(0x203)](storeName)['delete'](_0xa97e96),_0x1e1414['oncomplete']=()=>_0x4e0006(),_0x1e1414[_0x5b949d(0x24c)]=()=>_0x595cd4(_0x1e1414['error']);});}async function idbClear(){const _0x163c31=await openDB();return new Promise((_0xd0f8b3,_0x5dbe0c)=>{const _0x39cef6=a0_0x45c9,_0x5175a2=_0x163c31[_0x39cef6(0x22f)](storeName,'readwrite');_0x5175a2[_0x39cef6(0x203)](storeName)[_0x39cef6(0x233)](),_0x5175a2[_0x39cef6(0x247)]=()=>_0xd0f8b3(),_0x5175a2['onerror']=()=>_0x5dbe0c(_0x5175a2['error']);});}function saveProjectFile(){const _0x5192f2=a0_0x545b5f,_0x1e85a5={'projects':projects[_0x5192f2(0x1a5)](_0x3d1a23=>({'width':_0x3d1a23['width'],'height':_0x3d1a23['height'],'name':_0x3d1a23[_0x5192f2(0x2cd)]||'','activeFrame':_0x3d1a23[_0x5192f2(0x1d6)],'frames':_0x3d1a23['frames']['map'](_0x18d1be=>({'activeLayer':_0x18d1be[_0x5192f2(0x1c6)],'layers':_0x18d1be[_0x5192f2(0x2c5)]['map'](_0x1be80a=>_0x1be80a['toDataURL']())}))})),'activeProject':activeProject},_0x13c27e=new Blob([JSON[_0x5192f2(0x292)](_0x1e85a5)],{'type':_0x5192f2(0x24d)}),_0x890bc9=document[_0x5192f2(0x23a)]('a');_0x890bc9[_0x5192f2(0x19f)]=_0x5192f2(0x1da),_0x890bc9[_0x5192f2(0x23f)]=URL[_0x5192f2(0x251)](_0x13c27e),_0x890bc9[_0x5192f2(0x29f)]();}function saveProjectFile(){const _0x3de809=a0_0x545b5f,_0x5db04e={'projects':projects[_0x3de809(0x1a5)](_0x4e044b=>({'width':_0x4e044b[_0x3de809(0x21e)],'height':_0x4e044b[_0x3de809(0x23e)],'name':_0x4e044b[_0x3de809(0x2cd)]||'','activeFrame':_0x4e044b[_0x3de809(0x1d6)],'frames':_0x4e044b['frames'][_0x3de809(0x1a5)](_0x256282=>({'activeLayer':_0x256282[_0x3de809(0x1c6)],'layers':_0x256282[_0x3de809(0x2c5)][_0x3de809(0x1a5)](_0x5e3d54=>_0x5e3d54[_0x3de809(0x2bb)]())}))})),'activeProject':activeProject},_0x555c59=new Blob([JSON[_0x3de809(0x292)](_0x5db04e)],{'type':_0x3de809(0x24d)}),_0x56a7c0=document['createElement']('a');_0x56a7c0[_0x3de809(0x19f)]=_0x3de809(0x1da),_0x56a7c0[_0x3de809(0x23f)]=URL[_0x3de809(0x251)](_0x555c59),_0x56a7c0[_0x3de809(0x29f)]();}async function saveProjectToIDB(){const _0x1dc26a=a0_0x545b5f,_0x571c89={'projects':projects['map'](_0x55978c=>({'width':_0x55978c[_0x1dc26a(0x21e)],'height':_0x55978c[_0x1dc26a(0x23e)],'name':_0x55978c[_0x1dc26a(0x2cd)]||'','activeFrame':_0x55978c[_0x1dc26a(0x1d6)],'frames':_0x55978c[_0x1dc26a(0x2bf)][_0x1dc26a(0x1a5)](_0xef39eb=>({'activeLayer':_0xef39eb['activeLayer'],'layers':_0xef39eb[_0x1dc26a(0x2c5)][_0x1dc26a(0x1a5)](_0x1455bb=>_0x1455bb[_0x1dc26a(0x2bb)]())}))})),'activeProject':activeProject};try{await idbSet('nezumi-sketch-save',_0x571c89),console[_0x1dc26a(0x1d2)]('プロジェクトをIndexedDBに保存したチュー！');}catch(_0x4a80be){console[_0x1dc26a(0x26f)](_0x1dc26a(0x239),_0x4a80be);}}setInterval(()=>{saveProjectToIDB();},0x2710),window[a0_0x545b5f(0x244)](a0_0x545b5f(0x201),_0x5dd329=>{saveProjectToIDB();});function loadProjectFile(_0x3b95d2){const _0x403abe=a0_0x545b5f,_0x378f49=_0x3b95d2['target'][_0x403abe(0x208)][0x0];if(!_0x378f49)return;const _0x378720=new FileReader();_0x378720[_0x403abe(0x23d)]=function(_0x51faaa){const _0x597fb3=_0x403abe;try{const _0x5356c5=JSON[_0x597fb3(0x28d)](_0x51faaa[_0x597fb3(0x1b2)][_0x597fb3(0x27c)]);projects=_0x5356c5['projects'][_0x597fb3(0x1a5)]((_0x18a7b4,_0x179f1f)=>{const _0x3fbd1c=_0x597fb3;let _0xd5604a=createProject(_0x18a7b4[_0x3fbd1c(0x21e)],_0x18a7b4[_0x3fbd1c(0x23e)],_0x18a7b4[_0x3fbd1c(0x2cd)]||'画像'+(_0x179f1f+0x1));return _0xd5604a[_0x3fbd1c(0x2bf)]=_0x18a7b4[_0x3fbd1c(0x2bf)]['map'](_0x3036a8=>{const _0x28f74d=_0x3fbd1c;let _0x94b6ad={'layers':[],'activeLayer':_0x3036a8['activeLayer'],'layerHistories':[],'layerRedoStacks':[]};for(let _0x5cae98=0x0;_0x5cae98<_0x3036a8[_0x28f74d(0x2c5)][_0x28f74d(0x2d1)];_0x5cae98++){let _0x1aec44=new Image();_0x1aec44['src']=_0x3036a8['layers'][_0x5cae98];let _0x23df51=document[_0x28f74d(0x23a)](_0x28f74d(0x297));_0x23df51[_0x28f74d(0x21e)]=_0x18a7b4[_0x28f74d(0x21e)]*cellSize,_0x23df51[_0x28f74d(0x23e)]=_0x18a7b4[_0x28f74d(0x23e)]*cellSize,_0x1aec44[_0x28f74d(0x23d)]=()=>{const _0x1f3776=_0x28f74d;let _0x2c7591=_0x23df51[_0x1f3776(0x275)]('2d');_0x2c7591[_0x1f3776(0x1c1)](0x0,0x0,_0x23df51[_0x1f3776(0x21e)],_0x23df51[_0x1f3776(0x23e)]),_0x2c7591['drawImage'](_0x1aec44,0x0,0x0);},_0x1aec44[_0x28f74d(0x23d)](),_0x94b6ad[_0x28f74d(0x2c5)][_0x28f74d(0x1b8)](_0x23df51),_0x94b6ad[_0x28f74d(0x1d5)][_0x28f74d(0x1b8)]([]),_0x94b6ad[_0x28f74d(0x230)]['push']([]);}return _0x94b6ad;}),_0xd5604a[_0x3fbd1c(0x1d6)]=_0x18a7b4[_0x3fbd1c(0x1d6)],_0xd5604a[_0x3fbd1c(0x2cd)]=_0x18a7b4[_0x3fbd1c(0x2cd)]||'画像'+(_0x179f1f+0x1),_0xd5604a;}),activeProject=_0x5356c5[_0x597fb3(0x223)]||0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();}catch(_0x3f5cdb){alert('ファイルの読み込みに失敗しました。');}},_0x378720[_0x403abe(0x2c3)](_0x378f49);}async function loadProjectFromIDB(){const _0x160a97=a0_0x545b5f;try{const _0x44f00b=await idbGet(_0x160a97(0x279));if(!_0x44f00b)return;projects=_0x44f00b[_0x160a97(0x1f4)][_0x160a97(0x1a5)]((_0x5bc72a,_0x364776)=>{const _0x50e76e=_0x160a97;let _0x362266=createProject(_0x5bc72a[_0x50e76e(0x21e)],_0x5bc72a['height'],_0x5bc72a[_0x50e76e(0x2cd)]||'画像'+(_0x364776+0x1));return _0x362266[_0x50e76e(0x2bf)]=_0x5bc72a['frames'][_0x50e76e(0x1a5)](_0x17e021=>{const _0xde74be=_0x50e76e;let _0x370add={'layers':[],'activeLayer':_0x17e021[_0xde74be(0x1c6)],'layerHistories':[],'layerRedoStacks':[]};for(let _0x498137=0x0;_0x498137<_0x17e021[_0xde74be(0x2c5)]['length'];_0x498137++){let _0x421c81=new Image();_0x421c81['src']=_0x17e021[_0xde74be(0x2c5)][_0x498137];let _0x390da1=document[_0xde74be(0x23a)](_0xde74be(0x297));_0x390da1['width']=_0x5bc72a[_0xde74be(0x21e)]*cellSize,_0x390da1[_0xde74be(0x23e)]=_0x5bc72a[_0xde74be(0x23e)]*cellSize,_0x421c81[_0xde74be(0x23d)]=()=>{const _0x8ed2ac=_0xde74be;let _0x25aaea=_0x390da1['getContext']('2d');_0x25aaea[_0x8ed2ac(0x1c1)](0x0,0x0,_0x390da1['width'],_0x390da1[_0x8ed2ac(0x23e)]),_0x25aaea[_0x8ed2ac(0x246)](_0x421c81,0x0,0x0);},_0x370add[_0xde74be(0x2c5)][_0xde74be(0x1b8)](_0x390da1),_0x370add[_0xde74be(0x1d5)][_0xde74be(0x1b8)]([]),_0x370add[_0xde74be(0x230)][_0xde74be(0x1b8)]([]);}return _0x370add;}),_0x362266[_0x50e76e(0x1d6)]=_0x5bc72a['activeFrame'],_0x362266[_0x50e76e(0x2cd)]=_0x5bc72a['name']||'画像'+(_0x364776+0x1),_0x362266;}),activeProject=_0x44f00b['activeProject']||0x0,await wait(0x64),updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll(),setTool('pen'),console[_0x160a97(0x1d2)](_0x160a97(0x1f0));}catch(_0x102e41){alert(_0x160a97(0x2b6)),console['error'](_0x102e41);}}function wait(_0x5c4e54){return new Promise(_0x3db8b2=>setTimeout(_0x3db8b2,_0x5c4e54));}function initCanvas(){const _0x4b52a3=a0_0x545b5f,_0x666b2f=parseInt(0x10),_0x493e97=parseInt(0x10);let _0x467f35=getCurrentProject();_0x467f35[_0x4b52a3(0x21e)]=_0x666b2f,_0x467f35['height']=_0x493e97,canvas[_0x4b52a3(0x21e)]=_0x666b2f*cellSize,canvas[_0x4b52a3(0x23e)]=_0x493e97*cellSize,_0x467f35[_0x4b52a3(0x2c5)]=[],_0x467f35[_0x4b52a3(0x1d5)]=[],_0x467f35['layerRedoStacks']=[];let _0x15fa4c=document[_0x4b52a3(0x23a)]('canvas');_0x15fa4c[_0x4b52a3(0x21e)]=_0x666b2f*cellSize,_0x15fa4c[_0x4b52a3(0x23e)]=_0x493e97*cellSize,_0x467f35[_0x4b52a3(0x2c5)][_0x4b52a3(0x1b8)](_0x15fa4c),_0x467f35[_0x4b52a3(0x1d5)][_0x4b52a3(0x1b8)]([]),_0x467f35[_0x4b52a3(0x230)]['push']([]),_0x467f35['activeLayer']=0x0,saveHistory(),updateFrameUI(),updateLayerUI(),redrawAll(),canvas[_0x4b52a3(0x19a)]=null,canvas[_0x4b52a3(0x1a7)]=null,canvas[_0x4b52a3(0x21d)]=null,canvas[_0x4b52a3(0x1a3)]=null,canvas[_0x4b52a3(0x1f2)]=null,canvas['ontouchmove']=null,canvas[_0x4b52a3(0x28f)]=null,canvas['ontouchcancel']=null,canvas[_0x4b52a3(0x299)]('touchstart',handleTouchStart),canvas[_0x4b52a3(0x299)](_0x4b52a3(0x1c4),handleTouchMove),canvas['removeEventListener'](_0x4b52a3(0x26c),handleTouchEnd),canvas[_0x4b52a3(0x299)](_0x4b52a3(0x1ab),handleTouchEnd),canvas[_0x4b52a3(0x19a)]=handleMouseDown,canvas[_0x4b52a3(0x1a7)]=handleMouseMove,canvas['onmouseup']=handleMouseUp,canvas[_0x4b52a3(0x1a3)]=handleMouseUp,canvas[_0x4b52a3(0x1f2)]=handleTouchStart,canvas[_0x4b52a3(0x2c4)]=handleTouchMove,canvas[_0x4b52a3(0x28f)]=handleTouchEnd,canvas[_0x4b52a3(0x250)]=handleTouchEnd,canvas[_0x4b52a3(0x244)](_0x4b52a3(0x1c9),handleTouchStart,{'passive':![]}),canvas['addEventListener'](_0x4b52a3(0x1c4),handleTouchMove,{'passive':![]}),canvas[_0x4b52a3(0x244)](_0x4b52a3(0x26c),handleTouchEnd,{'passive':![]}),canvas[_0x4b52a3(0x244)](_0x4b52a3(0x1ab),handleTouchEnd,{'passive':![]});}function createPalette(){const _0x309ff7=a0_0x545b5f,_0x5a53d4=document['getElementById'](_0x309ff7(0x1ac));if(!_0x5a53d4)return;_0x5a53d4['innerHTML']='',PALETTE_COLORS[_0x309ff7(0x1e9)]((_0x46e876,_0x4a7681)=>{const _0x5bdee2=_0x309ff7,_0x36d1ba=document[_0x5bdee2(0x23a)](_0x5bdee2(0x29d));_0x36d1ba[_0x5bdee2(0x25c)]=_0x5bdee2(0x1c7);_0x46e876==='transparent'||_0x46e876===_0x5bdee2(0x270)?(_0x36d1ba[_0x5bdee2(0x1bd)]['background']='repeating-conic-gradient(#eee\x200%\x2025%,\x20#fff\x200%\x2050%)\x2050%\x20/\x2016px\x2016px',_0x36d1ba[_0x5bdee2(0x1a2)]='透明',_0x36d1ba[_0x5bdee2(0x221)]=_0x5bdee2(0x2a5)):(_0x36d1ba[_0x5bdee2(0x1bd)]['background']=_0x46e876,_0x36d1ba['title']=_0x46e876);_0x36d1ba[_0x5bdee2(0x215)]=()=>{const _0x59cea7=_0x5bdee2;currentColor=_0x46e876,_0x46e876===_0x59cea7(0x219)||_0x46e876===_0x59cea7(0x270)?document['getElementById'](_0x59cea7(0x1be))['value']=_0x59cea7(0x234):document['getElementById'](_0x59cea7(0x1be))['value']=_0x46e876,document[_0x59cea7(0x1d8)](_0x59cea7(0x1ee))[_0x59cea7(0x1e9)](_0x1075fa=>_0x1075fa[_0x59cea7(0x24f)][_0x59cea7(0x1ec)](_0x59cea7(0x198))),_0x36d1ba['classList']['add'](_0x59cea7(0x198));};if(_0x4a7681!==0x0){const _0x3423a9=document[_0x5bdee2(0x23a)](_0x5bdee2(0x2a6));_0x3423a9[_0x5bdee2(0x1c0)]='×',_0x3423a9[_0x5bdee2(0x25c)]=_0x5bdee2(0x1fb),_0x3423a9[_0x5bdee2(0x1a2)]=_0x5bdee2(0x24b),_0x3423a9[_0x5bdee2(0x215)]=_0xf96254=>{const _0x37973f=_0x5bdee2;_0xf96254[_0x37973f(0x1fc)](),PALETTE_COLORS['length']>0x2&&(PALETTE_COLORS['splice'](_0x4a7681,0x1),createPalette());},_0x36d1ba[_0x5bdee2(0x28c)](_0x3423a9);}_0x5a53d4[_0x5bdee2(0x28c)](_0x36d1ba);});const _0x380240=document[_0x309ff7(0x23a)](_0x309ff7(0x29d));_0x380240[_0x309ff7(0x25c)]=_0x309ff7(0x2c2),_0x380240[_0x309ff7(0x1a2)]=_0x309ff7(0x1c5),_0x380240[_0x309ff7(0x221)]='+',_0x380240[_0x309ff7(0x215)]=_0xc1d911=>{const _0x3fc4cb=_0x309ff7;_0xc1d911[_0x3fc4cb(0x1fc)]();const _0x1ca238=document[_0x3fc4cb(0x23a)](_0x3fc4cb(0x28b));_0x1ca238['type']=_0x3fc4cb(0x20d),_0x1ca238[_0x3fc4cb(0x1bd)][_0x3fc4cb(0x20c)]=_0x3fc4cb(0x24a);let _0x5275c5=![];_0x1ca238[_0x3fc4cb(0x1ae)]=_0x59d3c0=>{const _0x5bfccc=_0x3fc4cb;!_0x5275c5&&(PALETTE_COLORS['push'](_0x59d3c0[_0x5bfccc(0x1b2)][_0x5bfccc(0x264)]),createPalette(),_0x5275c5=!![],_0x1ca238[_0x5bfccc(0x1ec)]());},_0x1ca238['addEventListener'](_0x3fc4cb(0x20b),()=>{if(!_0x5275c5)_0x1ca238['remove']();}),_0x1ca238[_0x3fc4cb(0x244)](_0x3fc4cb(0x29f),_0x4b3a3c=>_0x4b3a3c[_0x3fc4cb(0x1fc)]()),document[_0x3fc4cb(0x1ce)][_0x3fc4cb(0x28c)](_0x1ca238),_0x1ca238[_0x3fc4cb(0x278)](),_0x1ca238[_0x3fc4cb(0x29f)]();},_0x5a53d4[_0x309ff7(0x28c)](_0x380240);let _0x38f204=document[_0x309ff7(0x1bf)](_0x309ff7(0x245));!_0x38f204&&(_0x38f204=document[_0x309ff7(0x23a)](_0x309ff7(0x2c7)),_0x38f204['id']=_0x309ff7(0x245),_0x38f204[_0x309ff7(0x25c)]=_0x309ff7(0x245),_0x5a53d4[_0x309ff7(0x220)][_0x309ff7(0x28c)](_0x38f204)),_0x38f204[_0x309ff7(0x221)]=_0x309ff7(0x2b8)+(currentTool==='pen'?'\x20active':'')+_0x309ff7(0x237)+(currentTool==='eraser'?_0x309ff7(0x280):'')+_0x309ff7(0x1dd)+(currentTool==='fill'?_0x309ff7(0x280):'')+_0x309ff7(0x20a)+(penSize==0x1?_0x309ff7(0x218):'')+_0x309ff7(0x1b4)+(penSize==0x2?_0x309ff7(0x218):'')+_0x309ff7(0x1cb)+(penSize==0x3?_0x309ff7(0x218):'')+_0x309ff7(0x217)+(penSize==0x4?'\x20selected':'')+'>4</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22margin-left:8px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22palette-penMode\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22square\x22'+(penMode===_0x309ff7(0x255)?_0x309ff7(0x218):'')+_0x309ff7(0x294)+(penMode==='circle'?'\x20selected':'')+_0x309ff7(0x286)+Math[_0x309ff7(0x2ca)](currentAlpha*0x64)+_0x309ff7(0x241)+Math[_0x309ff7(0x2ca)](currentAlpha*0x64)+'%</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22undo()\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>undo</span>\x20戻す\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22redo()\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>redo</span>\x20戻すを戻す\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x38f204['querySelector'](_0x309ff7(0x214))['onchange']=_0x2d3e9e=>setPenSize(_0x2d3e9e[_0x309ff7(0x1b2)][_0x309ff7(0x264)]),_0x38f204[_0x309ff7(0x267)](_0x309ff7(0x28a))[_0x309ff7(0x262)]=_0x248a74=>setPenMode(_0x248a74[_0x309ff7(0x1b2)]['value']),_0x38f204[_0x309ff7(0x1d8)](_0x309ff7(0x236))[_0x309ff7(0x1e9)](_0x467159=>{const _0x7bccd1=_0x309ff7;_0x467159['onclick']=()=>setTool(_0x467159[_0x7bccd1(0x1e6)][_0x7bccd1(0x1f5)]);}),_0x38f204[_0x309ff7(0x267)](_0x309ff7(0x25a))[_0x309ff7(0x1ae)]=_0x10d7cb=>{const _0x4e0afa=_0x309ff7;setAlpha(_0x10d7cb[_0x4e0afa(0x1b2)][_0x4e0afa(0x264)]),_0x38f204[_0x4e0afa(0x267)](_0x4e0afa(0x197))[_0x4e0afa(0x1c0)]=_0x10d7cb[_0x4e0afa(0x1b2)][_0x4e0afa(0x264)]+'%';let _0x6010c=document[_0x4e0afa(0x1bf)](_0x4e0afa(0x25b)),_0x4b8b29=document['getElementById'](_0x4e0afa(0x1d0));if(_0x6010c)_0x6010c[_0x4e0afa(0x264)]=_0x10d7cb[_0x4e0afa(0x1b2)][_0x4e0afa(0x264)];if(_0x4b8b29)_0x4b8b29[_0x4e0afa(0x1c0)]=_0x10d7cb[_0x4e0afa(0x1b2)][_0x4e0afa(0x264)]+'%';};}function setAlpha(_0x4a832d){const _0x161048=a0_0x545b5f;let _0x11872c=Math[_0x161048(0x238)](0x0,Math['min'](0x64,parseInt(_0x4a832d,0xa)||0x0));currentAlpha=_0x11872c/0x64;let _0xd89ac=document['getElementById'](_0x161048(0x25b)),_0x3792a6=document[_0x161048(0x1bf)]('alphaValue');if(_0xd89ac)_0xd89ac[_0x161048(0x264)]=_0x11872c;if(_0x3792a6)_0x3792a6['textContent']=_0x11872c+'%';let _0x2f1e23=document[_0x161048(0x1bf)](_0x161048(0x282)),_0xcfde4c=document[_0x161048(0x1bf)](_0x161048(0x1e3));if(_0x2f1e23)_0x2f1e23[_0x161048(0x264)]=_0x11872c;if(_0xcfde4c)_0xcfde4c[_0x161048(0x1c0)]=_0x11872c+'%';}document[a0_0x545b5f(0x244)](a0_0x545b5f(0x1e7),()=>{const _0x2fb73b=a0_0x545b5f,_0x53c787=document[_0x2fb73b(0x1bf)](_0x2fb73b(0x1be));_0x53c787&&(_0x53c787[_0x2fb73b(0x1ae)]=_0x36e76c=>{const _0xaa7d6a=_0x2fb73b;currentColor=_0x36e76c[_0xaa7d6a(0x1b2)][_0xaa7d6a(0x264)],document['querySelectorAll']('.palette-color')['forEach'](_0x243053=>_0x243053['classList'][_0xaa7d6a(0x1ec)]('selected'));});const _0x4fb3cb=document[_0x2fb73b(0x1bf)](_0x2fb73b(0x25b)),_0x3ffdbe=document[_0x2fb73b(0x1bf)](_0x2fb73b(0x1d0));_0x4fb3cb&&_0x3ffdbe&&(_0x4fb3cb['oninput']=_0x495191=>{const _0x53c27b=_0x2fb73b;setAlpha(_0x495191[_0x53c27b(0x1b2)][_0x53c27b(0x264)]),_0x3ffdbe[_0x53c27b(0x1c0)]=_0x495191[_0x53c27b(0x1b2)][_0x53c27b(0x264)]+'%';let _0x1d5bc2=document[_0x53c27b(0x1bf)](_0x53c27b(0x282)),_0x44d8be=document[_0x53c27b(0x1bf)](_0x53c27b(0x1e3));if(_0x1d5bc2)_0x1d5bc2[_0x53c27b(0x264)]=_0x495191[_0x53c27b(0x1b2)]['value'];if(_0x44d8be)_0x44d8be[_0x53c27b(0x1c0)]=_0x495191[_0x53c27b(0x1b2)][_0x53c27b(0x264)]+'%';});});async function convertToGIF(_0x208c6f,_0x5894bc=0xc8,_0x69db9f=a0_0x545b5f(0x2b4)){const _0x507975=a0_0x545b5f,_0x469716=new window['GIF']({'workers':0x2,'quality':0xa,'workerScript':_0x507975(0x1ff)});_0x208c6f[_0x507975(0x1e9)](_0x2bae00=>_0x469716[_0x507975(0x256)](_0x2bae00,{'delay':_0x5894bc})),_0x469716['on'](_0x507975(0x1d7),_0x31fc5c=>{const _0x24f998=_0x507975,_0xeadf4b=URL[_0x24f998(0x251)](_0x31fc5c),_0x347dca=document[_0x24f998(0x23a)]('a');_0x347dca[_0x24f998(0x23f)]=_0xeadf4b,_0x347dca[_0x24f998(0x19f)]=_0x69db9f,document[_0x24f998(0x1ce)]['appendChild'](_0x347dca),_0x347dca[_0x24f998(0x29f)](),setTimeout(()=>{const _0x284356=_0x24f998;document['body'][_0x284356(0x1af)](_0x347dca),URL[_0x284356(0x212)](_0xeadf4b);},0x3e8);}),_0x469716[_0x507975(0x2ce)]();}function a0_0x36af(){const _0xd1220e=['>3</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x224\x22','\x20selected','transparent','search','fill','type','onmouseup','width','undefined','parentNode','innerHTML','new-project-dialog','activeProject','pointerdown','get','beginPath','penMode','main-container','WebCodecs','nezumi_about_visited','anonymous','encode','40cdEFko','join','transaction','layerRedoStacks','nezumi-animation','readonly','clear','#000000','#ff0000','.tool-btn','\x22\x20data-tool=\x22pen\x22\x20onclick=\x22setTool(\x27pen\x27)\x22><span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>edit</span>ペン</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22tool-btn','max','保存に失敗したチュー:','createElement','frame-btn','destination-out','onload','height','href','onblur','\x22\x20style=\x22vertical-align:\x20middle;\x20width:70px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22palette-alphaValue\x22>','nezumi-projects','palette-penMode','addEventListener','palette-toolbar','drawImage','oncomplete','circle','transform','none','この色をパレットから削除','onerror','application/json','video/webm','classList','ontouchcancel','createObjectURL','#cccccc','image/png','pointermove','square','addFrame','px,\x20','keyval','menu-toggle-btn','#palette-alphaSlider','alphaSlider','className','lineTo','Enter','3187640uGiWGv','Shift','project-btn','onchange','#00ff00','value','resize','constructor','querySelector','boolean','3000','splice','#newProjCancelBtn','touchend','jpeg','touch','error','#00000000','onsuccess','px)\x20scale(','jpg','上に移動','getContext','UPNG','palette-penSize','focus','nezumi-sketch-save','getItem','flush','result','trim','select','readwrite','\x20active','menu-toggle-btn-close','palette-alphaSlider','pen','overflow','5534396WdLtWu','>丸ペン</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22margin-left:8px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20透明度:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22range\x22\x20id=\x22palette-alphaSlider\x22\x20min=\x220\x22\x20max=\x22100\x22\x20value=\x22','80px','preventDefault','fillRect','#palette-penMode','input','appendChild','parse','buffer','ontouchend','open','111948ZAVBES','stringify','min','>四角ペン</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22circle\x22','#888888','#palette-toolbar\x20.tool-btn','canvas','72434bYHCXs','removeEventListener','projectList','VideoEncoder','has','button','#newProjH','click','2657055rbsPIS','#800000','layer-btn','frameList','left','<span\x20style=\x22font-size:13px;color:#888;\x22>透明</span>','span','src','byteLength','vp8','project-name','touches','toString','getBoundingClientRect','#ffffff','then','下に移動','match','/about?terms=true','penSize','nezumi-animation.gif','#c0c0c0','IndexedDBからの読み込みに失敗したチュー…','data','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22tool-btn','/index.html','position','toDataURL','disabled','touchAction','strokeStyle','frames','innerWidth','stroke','palette-add-btn','readAsText','ontouchmove','layers','クリックで名前を編集','div','image/','clientY','round','layer-thumb','35rciNon','name','render','contains','block','length','replace','globalAlpha','#palette-alphaValue','selected','setItem','onmousedown','layer-item','moveTo','#ccc','save','download','sidebar-open','shift','title','onmouseleave','pop','map','top','onmousemove','wheel','#ffff00','deltaY','touchcancel','color-palette','nezumi-sketch-db','oninput','removeChild','fillStyle','split','target','.webm','>1</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x222\x22','11iVaRle','#000080','#newProjName','push','toggle','pointerType','sidebar','filter','style','colorPicker','getElementById','textContent','clearRect','floor','#00ffff','touchmove','パレットに色を追加','activeLayer','palette-color','all','touchstart','arc','>2</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x223\x22','apply','1182033edjDTO','body','#ff69b4','alphaValue','.section.collapsible\x20.section-content','log','keyup','コマ)','layerHistories','activeFrame','finished','querySelectorAll','keydown','nezumi-sketch.msketch','setPointerCapture','.apng','\x22\x20data-tool=\x22eraser\x22\x20onclick=\x22setTool(\x27eraser\x27)\x22><span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>delete</span>消しゴム</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22tool-btn','100vw','put','2275782xrExWa','projectCount','rgba(','palette-alphaValue','replaceWith','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22background:#fff;\x20border-radius:10px;\x20box-shadow:0\x202px\x2016px\x20#0003;\x20padding:28px\x2032px;\x20min-width:240px;\x20text-align:center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:0;\x22>新しい画像のサイズ</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:12px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>名前:\x20<input\x20id=\x22newProjName\x22\x20type=\x22text\x22\x20maxlength=\x2232\x22\x20value=\x22画像','dataset','DOMContentLoaded','レイヤー','forEach','isFinite','(((.+)+)+)+$','remove','key','.palette-color','text','IndexedDBからプロジェクトを読み込んだチュー！','getImageData','ontouchstart','close','projects','tool','number','clientX','pathname','image/jpeg','image/apng','palette-del-btn','stopPropagation','#008000','#444444','lib/gif.worker.js','nezumi-drawing','beforeunload','restore','objectStore','#0000ff','globalCompositeOperation','hidden','crossOrigin','files','onupgradeneeded','\x22\x20data-tool=\x22fill\x22\x20onclick=\x22setTool(\x27fill\x27)\x22><span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>format_color_fill</span>塗りつぶし</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22margin-left:8px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20太さ:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22palette-penSize\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x221\x22','blur','display','color','abs','add','onkeydown','alignItems','revokeObjectURL','center','#palette-penSize','onclick','frame-item'];a0_0x36af=function(){return _0xd1220e;};return a0_0x36af();}function convertToAPNG(_0x283997,_0x1ebf5a,_0xd37cb6,_0x5a32aa=0xc8,_0x15639c='nezumi-animation.apng'){const _0x125e65=a0_0x545b5f,_0x3a5f22=[],_0x30deac=[],_0x2049e1=document[_0x125e65(0x23a)](_0x125e65(0x297));_0x2049e1[_0x125e65(0x21e)]=_0x1ebf5a,_0x2049e1[_0x125e65(0x23e)]=_0xd37cb6;const _0x52b287=_0x2049e1[_0x125e65(0x275)]('2d');_0x283997[_0x125e65(0x1e9)](_0x1e52af=>{const _0x2bd899=_0x125e65;_0x52b287[_0x2bd899(0x1c1)](0x0,0x0,_0x1ebf5a,_0xd37cb6),_0x52b287[_0x2bd899(0x246)](_0x1e52af,0x0,0x0,_0x1ebf5a,_0xd37cb6);const _0xe555c6=_0x52b287[_0x2bd899(0x1f1)](0x0,0x0,_0x1ebf5a,_0xd37cb6)['data'][_0x2bd899(0x28e)];_0x3a5f22['push'](_0xe555c6),_0x30deac[_0x2bd899(0x1b8)](_0x5a32aa);});const _0x443712=window[_0x125e65(0x276)][_0x125e65(0x22c)](_0x3a5f22,_0x1ebf5a,_0xd37cb6,0x0,_0x30deac),_0xa133f5=URL[_0x125e65(0x251)](new Blob([_0x443712],{'type':_0x125e65(0x1fa)})),_0xd3c92=document[_0x125e65(0x23a)]('a');_0xd3c92[_0x125e65(0x23f)]=_0xa133f5,_0xd3c92['download']=_0x15639c,document['body'][_0x125e65(0x28c)](_0xd3c92),_0xd3c92[_0x125e65(0x29f)](),setTimeout(()=>{const _0x381d06=_0x125e65;document[_0x381d06(0x1ce)][_0x381d06(0x1af)](_0xd3c92),URL[_0x381d06(0x212)](_0xa133f5);},0x3e8);}async function loadImages(_0x35e01c){const _0x577d10=await Promise['all'](_0x35e01c['map'](_0x22707e=>{return new Promise(_0x3f9cc4=>{const _0x1d82c2=a0_0x45c9,_0x53a905=new Image();_0x53a905[_0x1d82c2(0x207)]=_0x1d82c2(0x22b),_0x53a905[_0x1d82c2(0x2a7)]=_0x22707e,_0x53a905[_0x1d82c2(0x23d)]=()=>_0x3f9cc4(_0x53a905);});}));return _0x577d10;}function toggleSection(_0x3187c4){const _0x34c5a5=a0_0x545b5f,_0xc77ad1=document[_0x34c5a5(0x1bf)](_0x3187c4),_0x1dc6fb=_0xc77ad1['querySelector']('.section-content'),_0x988e54=_0xc77ad1[_0x34c5a5(0x267)]('.toggle-btn');_0x1dc6fb[_0x34c5a5(0x1bd)][_0x34c5a5(0x20c)]===_0x34c5a5(0x24a)?(_0x1dc6fb[_0x34c5a5(0x1bd)][_0x34c5a5(0x20c)]='',_0x988e54[_0x34c5a5(0x1c0)]='▼'):(_0x1dc6fb[_0x34c5a5(0x1bd)][_0x34c5a5(0x20c)]='none',_0x988e54[_0x34c5a5(0x1c0)]='▲');}document['addEventListener'](a0_0x545b5f(0x1e7),()=>{const _0x5b25f2=a0_0x545b5f;document['querySelectorAll'](_0x5b25f2(0x1d1))[_0x5b25f2(0x1e9)](_0x1fdfee=>_0x1fdfee[_0x5b25f2(0x1bd)][_0x5b25f2(0x20c)]=''),document[_0x5b25f2(0x1d8)]('.section.collapsible\x20.toggle-btn')[_0x5b25f2(0x1e9)](_0x31de13=>_0x31de13['textContent']='▼');}),window['addEventListener'](a0_0x545b5f(0x265),updateMenuBtnDisplay),document[a0_0x545b5f(0x244)](a0_0x545b5f(0x1e7),updateMenuBtnDisplay);function toggleSideMenu(_0x420b86){const _0x568545=a0_0x545b5f,_0x489593=document[_0x568545(0x1bf)]('sidebar'),_0xc9c09=document[_0x568545(0x1bf)](_0x568545(0x228)),_0x4e47d5=document[_0x568545(0x1bf)](_0x568545(0x259)),_0x41da6d=document[_0x568545(0x1bf)]('menu-toggle-btn-close'),_0x42ee17=_0x489593[_0x568545(0x24f)][_0x568545(0x2cf)](_0x568545(0x290));let _0x1eb796=typeof _0x420b86===_0x568545(0x268)?_0x420b86:!_0x42ee17;_0x1eb796?(_0x489593[_0x568545(0x24f)]['add'](_0x568545(0x290)),_0xc9c09[_0x568545(0x24f)]['add']('sidebar-open'),document['body'][_0x568545(0x1bd)]['overflow']=_0x568545(0x206),document[_0x568545(0x1ce)][_0x568545(0x1bd)][_0x568545(0x2bd)]=_0x568545(0x24a),window[_0x568545(0x2c0)]<=0x384&&(_0x41da6d[_0x568545(0x1bd)][_0x568545(0x20c)]=_0x568545(0x2d0),_0x4e47d5[_0x568545(0x1bd)]['display']=_0x568545(0x24a))):(_0x489593[_0x568545(0x24f)]['remove']('open'),_0xc9c09[_0x568545(0x24f)]['remove'](_0x568545(0x1a0)),document[_0x568545(0x1ce)][_0x568545(0x1bd)][_0x568545(0x284)]='',document[_0x568545(0x1ce)]['style']['touchAction']='',window[_0x568545(0x2c0)]<=0x384&&(_0x41da6d[_0x568545(0x1bd)][_0x568545(0x20c)]=_0x568545(0x24a),_0x4e47d5[_0x568545(0x1bd)][_0x568545(0x20c)]='block'));}function updateMenuBtnDisplay(){const _0x56fc82=a0_0x545b5f,_0x187804=document[_0x56fc82(0x1bf)](_0x56fc82(0x1bb)),_0x21c7fe=document[_0x56fc82(0x1bf)](_0x56fc82(0x228)),_0x29b536=document[_0x56fc82(0x1bf)](_0x56fc82(0x259)),_0x3de1ce=document[_0x56fc82(0x1bf)](_0x56fc82(0x281));window[_0x56fc82(0x2c0)]>0x384?(_0x187804[_0x56fc82(0x24f)]['remove'](_0x56fc82(0x290)),_0x21c7fe['classList'][_0x56fc82(0x1ec)](_0x56fc82(0x1a0)),_0x3de1ce[_0x56fc82(0x1bd)][_0x56fc82(0x20c)]='none',_0x29b536[_0x56fc82(0x1bd)][_0x56fc82(0x20c)]=_0x56fc82(0x24a),document[_0x56fc82(0x1ce)][_0x56fc82(0x1bd)][_0x56fc82(0x284)]='',document[_0x56fc82(0x1ce)]['style'][_0x56fc82(0x2bd)]=''):_0x187804[_0x56fc82(0x24f)]['contains'](_0x56fc82(0x290))?(_0x3de1ce[_0x56fc82(0x1bd)][_0x56fc82(0x20c)]=_0x56fc82(0x2d0),_0x29b536['style']['display']=_0x56fc82(0x24a)):(_0x3de1ce[_0x56fc82(0x1bd)][_0x56fc82(0x20c)]='none',_0x29b536[_0x56fc82(0x1bd)][_0x56fc82(0x20c)]='block');}document[a0_0x545b5f(0x244)]('click',function(_0x3c928a){const _0x57a367=a0_0x545b5f;if(window[_0x57a367(0x2c0)]>0x384)return;const _0x1f5af4=document[_0x57a367(0x1bf)](_0x57a367(0x1bb)),_0xc2c255=document[_0x57a367(0x1bf)](_0x57a367(0x228)),_0x2d8570=document[_0x57a367(0x1bf)]('menu-toggle-btn'),_0x5cd21b=document['getElementById'](_0x57a367(0x281));!_0x1f5af4[_0x57a367(0x2cf)](_0x3c928a[_0x57a367(0x1b2)])&&_0x3c928a[_0x57a367(0x1b2)]!==_0x2d8570&&_0x3c928a['target']!==_0x5cd21b&&(_0x1f5af4[_0x57a367(0x24f)][_0x57a367(0x1ec)](_0x57a367(0x290)),_0xc2c255['classList'][_0x57a367(0x1ec)](_0x57a367(0x1a0)),_0x5cd21b[_0x57a367(0x1bd)][_0x57a367(0x20c)]=_0x57a367(0x24a),_0x2d8570[_0x57a367(0x1bd)][_0x57a367(0x20c)]=_0x57a367(0x2d0),document[_0x57a367(0x1ce)][_0x57a367(0x1bd)]['overflow']='',document[_0x57a367(0x1ce)][_0x57a367(0x1bd)][_0x57a367(0x2bd)]='');}),(function(){const _0x2c0f9d=a0_0x545b5f;try{(location[_0x2c0f9d(0x1f8)][_0x2c0f9d(0x2b1)](/index\.html$/)||location[_0x2c0f9d(0x1f8)]==='/'||location[_0x2c0f9d(0x1f8)]===_0x2c0f9d(0x2b9))&&(!localStorage[_0x2c0f9d(0x27a)](_0x2c0f9d(0x22a))&&(localStorage[_0x2c0f9d(0x199)](_0x2c0f9d(0x22a),'1'),location['href']=_0x2c0f9d(0x2b2)));}catch(_0x4c6ae5){}}());let scale=0x1,posX=0x0,posY=0x0,lastX=0x0,lastY=0x0,dragging=![],startX=0x0,startY=0x0,shiftPressed=![];document[a0_0x545b5f(0x244)](a0_0x545b5f(0x1d9),_0x537660=>{const _0xbb8a65=a0_0x545b5f;if(_0x537660[_0xbb8a65(0x1ed)]===_0xbb8a65(0x260))shiftPressed=!![];}),document[a0_0x545b5f(0x244)](a0_0x545b5f(0x1d3),_0x371d70=>{const _0x367130=a0_0x545b5f;if(_0x371d70[_0x367130(0x1ed)]==='Shift')shiftPressed=![];}),canvas[a0_0x545b5f(0x244)](a0_0x545b5f(0x224),_0x57cac3=>{const _0x3792ec=a0_0x545b5f;_0x57cac3[_0x3792ec(0x1ba)]===_0x3792ec(0x26e)||shiftPressed?(dragging=!![],isDrawing=![],startX=_0x57cac3[_0x3792ec(0x1f7)],startY=_0x57cac3[_0x3792ec(0x2c9)],lastX=posX,lastY=posY,canvas[_0x3792ec(0x1db)](_0x57cac3['pointerId'])):(isDrawing=!![],handleDrawStart(_0x57cac3));}),canvas[a0_0x545b5f(0x244)](a0_0x545b5f(0x254),_0x33e3a=>{const _0x108745=a0_0x545b5f;if(dragging)posX=lastX+(_0x33e3a[_0x108745(0x1f7)]-startX),posY=lastY+(_0x33e3a[_0x108745(0x2c9)]-startY),updateTransform();else isDrawing&&handleDrawMove(_0x33e3a);}),canvas[a0_0x545b5f(0x244)]('pointerup',_0x1d0d85=>{dragging=![],isDrawing&&handleDrawEnd(_0x1d0d85),isDrawing=![];}),wrapper[a0_0x545b5f(0x244)](a0_0x545b5f(0x1a8),_0x9f304=>{const _0x7604e8=a0_0x545b5f;_0x9f304[_0x7604e8(0x288)]();const _0x4f3690=_0x9f304[_0x7604e8(0x1aa)]>0x0?0.9:1.1;scale*=_0x4f3690,scale=Math[_0x7604e8(0x293)](Math[_0x7604e8(0x238)](scale,0.2),0x5),updateTransform();},{'passive':![]});function updateTransform(){const _0x4c4800=a0_0x545b5f;canvas[_0x4c4800(0x1bd)][_0x4c4800(0x249)]='translate('+posX+_0x4c4800(0x257)+posY+_0x4c4800(0x272)+scale+')';}function getCanvasCoords(_0x953848){const _0x2cebdc=a0_0x545b5f,_0x5c6ff5=canvas['getBoundingClientRect'](),_0x235cad=canvas[_0x2cebdc(0x21e)]/_0x5c6ff5[_0x2cebdc(0x21e)],_0x21e560=canvas['height']/_0x5c6ff5[_0x2cebdc(0x23e)],_0x156ec4=(_0x953848[_0x2cebdc(0x1f7)]-_0x5c6ff5[_0x2cebdc(0x2a4)]-posX)/scale/_0x235cad,_0x9ee905=(_0x953848[_0x2cebdc(0x2c9)]-_0x5c6ff5['top']-posY)/scale/_0x21e560;return{'x':_0x156ec4,'y':_0x9ee905};}function handleDrawStart(_0x38e0c8){const _0x2b0d1c=a0_0x545b5f,_0x31a64f=getCanvasCoords(_0x38e0c8);ctx[_0x2b0d1c(0x226)](),ctx[_0x2b0d1c(0x19c)](_0x31a64f['x'],_0x31a64f['y']);}function handleDrawMove(_0x4147f5){const _0x46e841=a0_0x545b5f,_0x1eddfd=getCanvasCoords(_0x4147f5);ctx[_0x46e841(0x25d)](_0x1eddfd['x'],_0x1eddfd['y']),ctx['stroke']();}function handleDrawEnd(_0x491ac6){ctx['closePath']();}