const a0_0x203104=a0_0x177c;(function(_0xeda4ae,_0x4333a7){const _0x238b35=a0_0x177c,_0x6334e7=_0xeda4ae();while(!![]){try{const _0x1d9c2d=-parseInt(_0x238b35(0x99))/0x1*(-parseInt(_0x238b35(0xcb))/0x2)+parseInt(_0x238b35(0xb7))/0x3*(parseInt(_0x238b35(0x19c))/0x4)+-parseInt(_0x238b35(0xc0))/0x5*(parseInt(_0x238b35(0x20f))/0x6)+-parseInt(_0x238b35(0x135))/0x7*(-parseInt(_0x238b35(0x105))/0x8)+-parseInt(_0x238b35(0xf2))/0x9*(-parseInt(_0x238b35(0xb9))/0xa)+parseInt(_0x238b35(0xb6))/0xb+-parseInt(_0x238b35(0x184))/0xc;if(_0x1d9c2d===_0x4333a7)break;else _0x6334e7['push'](_0x6334e7['shift']());}catch(_0x517e62){_0x6334e7['push'](_0x6334e7['shift']());}}}(a0_0x51a3,0x4e4cb));const a0_0x235d6d=(function(){let _0x2ebeac=!![];return function(_0x15ad28,_0x12418d){const _0x4b1814=_0x2ebeac?function(){const _0x318e15=a0_0x177c;if(_0x12418d){const _0x2f9e25=_0x12418d[_0x318e15(0x195)](_0x15ad28,arguments);return _0x12418d=null,_0x2f9e25;}}:function(){};return _0x2ebeac=![],_0x4b1814;};}()),a0_0x276f16=a0_0x235d6d(this,function(){const _0x231f7b=a0_0x177c;return a0_0x276f16['toString']()['search'](_0x231f7b(0x117))[_0x231f7b(0x188)]()[_0x231f7b(0x10a)](a0_0x276f16)[_0x231f7b(0xb2)]('(((.+)+)+)+$');});a0_0x276f16();let canvas=document[a0_0x203104(0x18a)](a0_0x203104(0x224)),ctx=canvas['getContext']('2d');const wrapper=document[a0_0x203104(0x18a)]('canvas-container');let cellSize=0x14,currentColor=a0_0x203104(0x1b4),currentTool=a0_0x203104(0x14f),penSize=0x1,penMode=a0_0x203104(0x16c),layers=[],activeLayer=0x0,layerHistories=[],layerRedoStacks=[],currentWidth=0x10,currentHeight=0x10,projects=[],activeProject=0x0,isDrawing=![];function createProject(_0x18e015=0x10,_0x197dcb=0x10,_0x44d44a=''){const _0x3d50de=a0_0x203104;let _0x344915=0x14,_0x4bdd53=[],_0x133980=[],_0x11095c=[],_0x42e392=document[_0x3d50de(0x19b)](_0x3d50de(0x224));_0x42e392[_0x3d50de(0xc9)]=_0x18e015*_0x344915,_0x42e392['height']=_0x197dcb*_0x344915,_0x4bdd53[_0x3d50de(0x11d)](_0x42e392),_0x133980[_0x3d50de(0x11d)]([]),_0x11095c['push']([]);let _0x2fe71e={'layers':_0x4bdd53,'activeLayer':0x0,'layerHistories':_0x133980,'layerRedoStacks':_0x11095c};return{'frames':[_0x2fe71e],'activeFrame':0x0,'width':_0x18e015,'height':_0x197dcb,'name':_0x44d44a||'ÁîªÂÉè'+(projects[_0x3d50de(0xa6)]+0x1)};}function updateProjectUI(){const _0x57ff80=a0_0x203104,_0x19e5fe=document['getElementById'](_0x57ff80(0xa2));_0x19e5fe[_0x57ff80(0xd4)]='';for(let _0x3ba8c2=0x0;_0x3ba8c2<projects[_0x57ff80(0xa6)];_0x3ba8c2++){const _0x55ea71=document[_0x57ff80(0x19b)](_0x57ff80(0x18e));_0x55ea71[_0x57ff80(0x1f8)]=_0x57ff80(0x203)+(_0x3ba8c2===activeProject?_0x57ff80(0x1bc):''),_0x55ea71['onclick']=()=>{activeProject=_0x3ba8c2,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();};const _0x424167=document[_0x57ff80(0x19b)](_0x57ff80(0x157));_0x424167[_0x57ff80(0x1f8)]=_0x57ff80(0xb8),_0x424167[_0x57ff80(0x217)]=projects[_0x3ba8c2][_0x57ff80(0x8b)]||'ÁîªÂÉè'+(_0x3ba8c2+0x1),_0x424167[_0x57ff80(0x10d)]='„ÇØ„É™„ÉÉ„ÇØ„ÅßÂêçÂâç„ÇíÁ∑®ÈõÜ',_0x424167[_0x57ff80(0x8d)]=_0x5d3f18=>{const _0x4adcfe=_0x57ff80;_0x5d3f18[_0x4adcfe(0x192)](),editProjectName(_0x3ba8c2,_0x424167);},_0x55ea71['appendChild'](_0x424167);const _0x1270d4=document[_0x57ff80(0x19b)](_0x57ff80(0x19f));_0x1270d4[_0x57ff80(0x217)]='ÂâäÈô§',_0x1270d4[_0x57ff80(0x1f8)]=_0x57ff80(0x18b),_0x1270d4['disabled']=projects[_0x57ff80(0xa6)]===0x1,_0x1270d4[_0x57ff80(0x8d)]=_0x565b66=>{const _0x1b6f29=_0x57ff80;_0x565b66[_0x1b6f29(0x192)](),removeProjectAt(_0x3ba8c2);},_0x55ea71[_0x57ff80(0x207)](_0x1270d4),_0x19e5fe['appendChild'](_0x55ea71);}document['getElementById'](_0x57ff80(0x8e))['textContent']='('+projects['length']+'Êûö)';}function editProjectName(_0x5a3159,_0x1d6fcc){const _0x1c519f=a0_0x203104,_0x4569fb=document[_0x1c519f(0x19b)](_0x1c519f(0x142));_0x4569fb[_0x1c519f(0x138)]=_0x1c519f(0x21a),_0x4569fb[_0x1c519f(0x168)]=projects[_0x5a3159][_0x1c519f(0x8b)]||'ÁîªÂÉè'+(_0x5a3159+0x1),_0x4569fb[_0x1c519f(0x1f8)]=_0x1c519f(0x1b6),_0x4569fb[_0x1c519f(0x122)]['width']=_0x1c519f(0xaa),_0x4569fb[_0x1c519f(0xe6)]=()=>{const _0x596dfe=_0x1c519f;projects[_0x5a3159][_0x596dfe(0x8b)]=_0x4569fb[_0x596dfe(0x168)][_0x596dfe(0x12f)]()||'ÁîªÂÉè'+(_0x5a3159+0x1),updateProjectUI();},_0x4569fb[_0x1c519f(0x17b)]=_0x1a1a24=>{const _0x421d07=_0x1c519f;if(_0x1a1a24[_0x421d07(0x1f3)]===_0x421d07(0x189))_0x4569fb['blur']();},_0x1d6fcc['replaceWith'](_0x4569fb),_0x4569fb[_0x1c519f(0x197)](),_0x4569fb[_0x1c519f(0xc5)]();}function showNewProjectDialog(_0x653f4){const _0x19cb41=a0_0x203104;let _0x42f2a8=document[_0x19cb41(0x18a)](_0x19cb41(0x1d9));if(_0x42f2a8)_0x42f2a8['remove']();const _0x13794f=document[_0x19cb41(0x19b)](_0x19cb41(0x18e));_0x13794f['id']=_0x19cb41(0x1d9),_0x13794f[_0x19cb41(0x122)][_0x19cb41(0x1c2)]=_0x19cb41(0x14d),_0x13794f[_0x19cb41(0x122)]['left']='0',_0x13794f[_0x19cb41(0x122)][_0x19cb41(0x194)]='0',_0x13794f[_0x19cb41(0x122)][_0x19cb41(0xc9)]=_0x19cb41(0x118),_0x13794f[_0x19cb41(0x122)][_0x19cb41(0x112)]=_0x19cb41(0xe3),_0x13794f[_0x19cb41(0x122)][_0x19cb41(0xed)]=_0x19cb41(0x121),_0x13794f[_0x19cb41(0x122)][_0x19cb41(0xa0)]=_0x19cb41(0x164),_0x13794f['style'][_0x19cb41(0x20a)]=_0x19cb41(0x1d4),_0x13794f['style'][_0x19cb41(0xd7)]=_0x19cb41(0x1d4),_0x13794f[_0x19cb41(0x122)]['zIndex']=_0x19cb41(0xe0),_0x13794f[_0x19cb41(0xd4)]=_0x19cb41(0x212)+(projects[_0x19cb41(0xa6)]+0x1)+_0x19cb41(0xe2),document[_0x19cb41(0x1a8)][_0x19cb41(0x207)](_0x13794f),_0x13794f[_0x19cb41(0x1e0)](_0x19cb41(0x17d))[_0x19cb41(0x8d)]=()=>{const _0x7947c=_0x19cb41,_0x403aae=parseInt(_0x13794f[_0x7947c(0x1e0)](_0x7947c(0x114))[_0x7947c(0x168)],0xa),_0x3d77ce=parseInt(_0x13794f[_0x7947c(0x1e0)]('#newProjH')[_0x7947c(0x168)],0xa),_0x3962b0=_0x13794f[_0x7947c(0x1e0)](_0x7947c(0x20d))[_0x7947c(0x168)]['trim']();_0x13794f[_0x7947c(0x17a)]();if(_0x653f4)_0x653f4(_0x403aae,_0x3d77ce,_0x3962b0);},_0x13794f[_0x19cb41(0x1e0)](_0x19cb41(0x1da))[_0x19cb41(0x8d)]=()=>{const _0x3104b2=_0x19cb41;_0x13794f[_0x3104b2(0x17a)]();};}function addProject(){showNewProjectDialog((_0x248936,_0x26ba85,_0x4aa593)=>{const _0x643537=a0_0x177c;if(!Number[_0x643537(0x1d3)](_0x248936)||_0x248936<0x1)_0x248936=0x10;if(!Number[_0x643537(0x1d3)](_0x26ba85)||_0x26ba85<0x1)_0x26ba85=0x10;projects[_0x643537(0x11d)](createProject(_0x248936,_0x26ba85,_0x4aa593)),activeProject=projects[_0x643537(0xa6)]-0x1,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();});}function a0_0x177c(_0x4dce6c,_0x3326b1){_0x4dce6c=_0x4dce6c-0x7c;const _0x539e33=a0_0x51a3();let _0x276f16=_0x539e33[_0x4dce6c];return _0x276f16;}function removeProjectAt(_0x1b9acb){const _0x3f3d69=a0_0x203104;if(projects[_0x3f3d69(0xa6)]<=0x1)return;projects[_0x3f3d69(0x100)](_0x1b9acb,0x1);if(activeProject>=projects[_0x3f3d69(0xa6)])activeProject=projects[_0x3f3d69(0xa6)]-0x1;updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();}function getCurrentProject(){return projects[activeProject];}function updateFrameUI(){const _0x1bfd11=a0_0x203104,_0x8fdcb7=document['getElementById'](_0x1bfd11(0x1f1)),_0x123d86=getCurrentProject();_0x8fdcb7['innerHTML']='';for(let _0x5cd264=0x0;_0x5cd264<_0x123d86[_0x1bfd11(0x1d7)]['length'];_0x5cd264++){const _0x3e2a55=document[_0x1bfd11(0x19b)](_0x1bfd11(0x18e));_0x3e2a55[_0x1bfd11(0x1f8)]=_0x1bfd11(0x1aa)+(_0x5cd264===_0x123d86[_0x1bfd11(0x183)]?'\x20active':''),_0x3e2a55['onclick']=()=>{const _0xa97cbc=_0x1bfd11;_0x123d86[_0xa97cbc(0x183)]=_0x5cd264,updateFrameUI(),updateLayerUI(),redrawAll();};const _0x2dedc4=document['createElement'](_0x1bfd11(0x224));_0x2dedc4[_0x1bfd11(0x1f8)]='frame-thumb',_0x2dedc4[_0x1bfd11(0xc9)]=0x20,_0x2dedc4['height']=0x20;let _0x15e27b=_0x2dedc4['getContext']('2d');_0x15e27b[_0x1bfd11(0x1b1)](0x0,0x0,0x20,0x20);for(let _0x3ca9ec=0x0;_0x3ca9ec<_0x123d86[_0x1bfd11(0x1d7)][_0x5cd264][_0x1bfd11(0x12c)][_0x1bfd11(0xa6)];_0x3ca9ec++){_0x15e27b[_0x1bfd11(0x136)](_0x123d86[_0x1bfd11(0x1d7)][_0x5cd264][_0x1bfd11(0x12c)][_0x3ca9ec],0x0,0x0,_0x2dedc4['width'],_0x2dedc4[_0x1bfd11(0x112)]);}_0x3e2a55['appendChild'](_0x2dedc4);const _0x3b4a11=document['createElement'](_0x1bfd11(0x157));_0x3b4a11[_0x1bfd11(0x217)]='F'+(_0x5cd264+0x1),_0x3e2a55[_0x1bfd11(0x207)](_0x3b4a11);const _0x591b94=document[_0x1bfd11(0x19b)]('button');_0x591b94[_0x1bfd11(0x217)]='ÂâäÈô§',_0x591b94[_0x1bfd11(0x1f8)]='frame-btn',_0x591b94[_0x1bfd11(0x13f)]=_0x123d86[_0x1bfd11(0x1d7)][_0x1bfd11(0xa6)]===0x1,_0x591b94[_0x1bfd11(0x8d)]=_0x2ff2db=>{_0x2ff2db['stopPropagation'](),removeFrameAt(_0x5cd264);},_0x3e2a55[_0x1bfd11(0x207)](_0x591b94),_0x8fdcb7['appendChild'](_0x3e2a55);}document[_0x1bfd11(0x18a)](_0x1bfd11(0xd2))['textContent']='('+_0x123d86['frames'][_0x1bfd11(0xa6)]+_0x1bfd11(0xf3);}function addFrame(){const _0x102fbb=a0_0x203104;let _0x4b0d1f=getCurrentProject(),_0x7e4086=_0x4b0d1f[_0x102fbb(0x1d7)][_0x4b0d1f[_0x102fbb(0x183)]],_0x476cdc=_0x7e4086[_0x102fbb(0x12c)][_0x102fbb(0x113)](_0x3fc83d=>{const _0x54da5f=_0x102fbb;let _0x3f4d0b=document[_0x54da5f(0x19b)](_0x54da5f(0x224));return _0x3f4d0b[_0x54da5f(0xc9)]=_0x3fc83d[_0x54da5f(0xc9)],_0x3f4d0b[_0x54da5f(0x112)]=_0x3fc83d['height'],_0x3f4d0b['getContext']('2d')['drawImage'](_0x3fc83d,0x0,0x0),_0x3f4d0b;}),_0x5f237c=_0x476cdc[_0x102fbb(0x113)](()=>[]),_0x261d46=_0x476cdc[_0x102fbb(0x113)](()=>[]),_0xb33839={'layers':_0x476cdc,'activeLayer':0x0,'layerHistories':_0x5f237c,'layerRedoStacks':_0x261d46};_0x4b0d1f[_0x102fbb(0x1d7)][_0x102fbb(0x100)](_0x4b0d1f[_0x102fbb(0x183)]+0x1,0x0,_0xb33839),_0x4b0d1f[_0x102fbb(0x183)]++,updateFrameUI(),updateLayerUI(),redrawAll();}function removeFrameAt(_0x36d12f){const _0x425d65=a0_0x203104;let _0x47908c=getCurrentProject();if(_0x47908c[_0x425d65(0x1d7)][_0x425d65(0xa6)]<=0x1)return;_0x47908c[_0x425d65(0x1d7)]['splice'](_0x36d12f,0x1);if(_0x47908c[_0x425d65(0x183)]>=_0x47908c['frames'][_0x425d65(0xa6)])_0x47908c[_0x425d65(0x183)]=_0x47908c[_0x425d65(0x1d7)]['length']-0x1;updateFrameUI(),updateLayerUI(),redrawAll();}function getCurrentFrame(){const _0x4cd08e=a0_0x203104;return getCurrentProject()[_0x4cd08e(0x1d7)][getCurrentProject()['activeFrame']];}function updateLayerUI(){const _0x24e0b7=a0_0x203104;let {layers:_0x3d6e45,activeLayer:_0x29b6e0}=getCurrentFrame();document['getElementById']('layerCount')[_0x24e0b7(0x217)]='('+_0x3d6e45[_0x24e0b7(0xa6)]+'Êûö)';const _0x2a2414=document[_0x24e0b7(0x18a)]('layerList');_0x2a2414[_0x24e0b7(0xd4)]='';for(let _0x1ea7c6=_0x3d6e45[_0x24e0b7(0xa6)]-0x1;_0x1ea7c6>=0x0;_0x1ea7c6--){const _0x3beba3=document[_0x24e0b7(0x19b)](_0x24e0b7(0x18e));_0x3beba3[_0x24e0b7(0x1f8)]=_0x24e0b7(0xec)+(_0x1ea7c6===_0x29b6e0?_0x24e0b7(0x1bc):''),_0x3beba3[_0x24e0b7(0x8d)]=_0x7a7cdb=>{const _0xd82996=_0x24e0b7;if(_0x7a7cdb[_0xd82996(0x1cc)][_0xd82996(0x18d)][_0xd82996(0x92)](_0xd82996(0x131)))return;getCurrentFrame()[_0xd82996(0x8a)]=_0x1ea7c6,updateLayerUI(),redrawAll();};const _0x2bb69b=document[_0x24e0b7(0x19b)](_0x24e0b7(0x224));_0x2bb69b['className']=_0x24e0b7(0x1e4),_0x2bb69b[_0x24e0b7(0xc9)]=0x20,_0x2bb69b['height']=0x20;let _0x436966=_0x2bb69b[_0x24e0b7(0x1b9)]('2d');_0x436966['clearRect'](0x0,0x0,0x20,0x20),_0x436966[_0x24e0b7(0x136)](_0x3d6e45[_0x1ea7c6],0x0,0x0,_0x2bb69b[_0x24e0b7(0xc9)],_0x2bb69b[_0x24e0b7(0x112)]),_0x3beba3[_0x24e0b7(0x207)](_0x2bb69b);const _0xab867=document['createElement'](_0x24e0b7(0x157));_0xab867[_0x24e0b7(0x217)]=_0x24e0b7(0xdb)+(_0x1ea7c6+0x1),_0x3beba3[_0x24e0b7(0x207)](_0xab867);const _0x359eb4=document[_0x24e0b7(0x19b)](_0x24e0b7(0x19f));_0x359eb4['textContent']='‚Üë',_0x359eb4[_0x24e0b7(0x1f8)]=_0x24e0b7(0x131),_0x359eb4['title']=_0x24e0b7(0x110),_0x359eb4['disabled']=_0x1ea7c6===_0x3d6e45[_0x24e0b7(0xa6)]-0x1,_0x359eb4[_0x24e0b7(0x8d)]=_0x41838a=>{const _0x5ca3ee=_0x24e0b7;_0x41838a[_0x5ca3ee(0x192)](),_0x1ea7c6<_0x3d6e45[_0x5ca3ee(0xa6)]-0x1&&swapLayer(_0x1ea7c6,_0x1ea7c6+0x1);},_0x3beba3[_0x24e0b7(0x207)](_0x359eb4);const _0x1c0ec5=document[_0x24e0b7(0x19b)](_0x24e0b7(0x19f));_0x1c0ec5[_0x24e0b7(0x217)]='‚Üì',_0x1c0ec5[_0x24e0b7(0x1f8)]=_0x24e0b7(0x131),_0x1c0ec5[_0x24e0b7(0x10d)]='‰∏ã„Å´ÁßªÂãï',_0x1c0ec5[_0x24e0b7(0x13f)]=_0x1ea7c6===0x0,_0x1c0ec5[_0x24e0b7(0x8d)]=_0x10c17c=>{_0x10c17c['stopPropagation'](),_0x1ea7c6>0x0&&swapLayer(_0x1ea7c6,_0x1ea7c6-0x1);},_0x3beba3[_0x24e0b7(0x207)](_0x1c0ec5);const _0x5581f0=document[_0x24e0b7(0x19b)](_0x24e0b7(0x19f));_0x5581f0[_0x24e0b7(0x217)]='ÂâäÈô§',_0x5581f0['className']=_0x24e0b7(0x131),_0x5581f0[_0x24e0b7(0x10d)]=_0x24e0b7(0xa5),_0x5581f0[_0x24e0b7(0x13f)]=_0x3d6e45[_0x24e0b7(0xa6)]===0x1,_0x5581f0['onclick']=_0x261099=>{_0x261099['stopPropagation'](),removeLayerAt(_0x1ea7c6);},_0x3beba3[_0x24e0b7(0x207)](_0x5581f0),_0x2a2414[_0x24e0b7(0x207)](_0x3beba3);}}function swapLayer(_0x661c71,_0xe8e0d2){const _0x20498f=a0_0x203104;let _0x500526=getCurrentFrame();[_0x500526['layers'][_0x661c71],_0x500526[_0x20498f(0x12c)][_0xe8e0d2]]=[_0x500526['layers'][_0xe8e0d2],_0x500526[_0x20498f(0x12c)][_0x661c71]],[_0x500526[_0x20498f(0x98)][_0x661c71],_0x500526[_0x20498f(0x98)][_0xe8e0d2]]=[_0x500526[_0x20498f(0x98)][_0xe8e0d2],_0x500526[_0x20498f(0x98)][_0x661c71]],[_0x500526[_0x20498f(0xf7)][_0x661c71],_0x500526[_0x20498f(0xf7)][_0xe8e0d2]]=[_0x500526[_0x20498f(0xf7)][_0xe8e0d2],_0x500526[_0x20498f(0xf7)][_0x661c71]];if(_0x500526[_0x20498f(0x8a)]===_0x661c71)_0x500526[_0x20498f(0x8a)]=_0xe8e0d2;else{if(_0x500526[_0x20498f(0x8a)]===_0xe8e0d2)_0x500526[_0x20498f(0x8a)]=_0x661c71;}updateLayerUI(),redrawAll();}function removeLayerAt(_0x23142b){const _0x34c42a=a0_0x203104;let _0x10d4e7=getCurrentFrame();if(_0x10d4e7[_0x34c42a(0x12c)][_0x34c42a(0xa6)]<=0x1)return;_0x10d4e7[_0x34c42a(0x12c)][_0x34c42a(0x100)](_0x23142b,0x1),_0x10d4e7[_0x34c42a(0x98)][_0x34c42a(0x100)](_0x23142b,0x1),_0x10d4e7['layerRedoStacks'][_0x34c42a(0x100)](_0x23142b,0x1);if(_0x10d4e7[_0x34c42a(0x8a)]>=_0x10d4e7[_0x34c42a(0x12c)][_0x34c42a(0xa6)])_0x10d4e7[_0x34c42a(0x8a)]=_0x10d4e7[_0x34c42a(0x12c)][_0x34c42a(0xa6)]-0x1;updateLayerUI(),redrawAll();}function addLayer(){const _0x50de6f=a0_0x203104;let _0x5d14b=getCurrentProject(),_0x4a5e28=getCurrentFrame(),_0x1ddfca=document['createElement'](_0x50de6f(0x224));_0x1ddfca['width']=_0x5d14b[_0x50de6f(0xc9)]*cellSize,_0x1ddfca[_0x50de6f(0x112)]=_0x5d14b[_0x50de6f(0x112)]*cellSize,_0x4a5e28[_0x50de6f(0x12c)][_0x50de6f(0x11d)](_0x1ddfca),_0x4a5e28[_0x50de6f(0x98)][_0x50de6f(0x11d)]([]),_0x4a5e28[_0x50de6f(0xf7)][_0x50de6f(0x11d)]([]),_0x4a5e28[_0x50de6f(0x8a)]=_0x4a5e28[_0x50de6f(0x12c)]['length']-0x1,saveHistory(),updateLayerUI(),redrawAll();}function removeLayer(){const _0x9260c2=a0_0x203104;let _0x568982=getCurrentFrame();if(_0x568982[_0x9260c2(0x12c)]['length']<=0x1)return;_0x568982[_0x9260c2(0x12c)][_0x9260c2(0x100)](_0x568982[_0x9260c2(0x8a)],0x1),_0x568982[_0x9260c2(0x98)]['splice'](_0x568982['activeLayer'],0x1),_0x568982[_0x9260c2(0xf7)]['splice'](_0x568982[_0x9260c2(0x8a)],0x1),_0x568982[_0x9260c2(0x8a)]=Math[_0x9260c2(0x19d)](0x0,_0x568982[_0x9260c2(0x8a)]-0x1),updateLayerUI(),redrawAll();}function selectLayer(_0x210d0d){const _0x5b5f8a=a0_0x203104;getCurrentFrame()[_0x5b5f8a(0x8a)]=parseInt(_0x210d0d),updateLayerUI();}let PALETTE_COLORS=[a0_0x203104(0x178),a0_0x203104(0x14a),a0_0x203104(0x103),a0_0x203104(0x9c),'#cccccc',a0_0x203104(0x152),a0_0x203104(0x1b4),'#ffa500','#ffff00','#00ff00',a0_0x203104(0x165),a0_0x203104(0x1b0),a0_0x203104(0x93),a0_0x203104(0xcf),a0_0x203104(0x186),a0_0x203104(0x158),a0_0x203104(0xd0),a0_0x203104(0x141),a0_0x203104(0xb5),a0_0x203104(0xe1),a0_0x203104(0x15c)],currentAlpha=0x1,animationTimer=null,animationDelay=0x12c,animationIndex=0x0;function playAnimation(){const _0x85585=a0_0x203104;let _0x26a140=getCurrentProject();if(!_0x26a140||!_0x26a140['frames']||_0x26a140[_0x85585(0x1d7)][_0x85585(0xa6)]<=0x1)return;if(animationTimer)return;animationIndex=0x0;const _0x289a2f=_0x26a140[_0x85585(0x1d7)];animationTimer=setInterval(()=>{const _0x5d75fe=_0x85585;ctx[_0x5d75fe(0x1b1)](0x0,0x0,canvas[_0x5d75fe(0xc9)],canvas[_0x5d75fe(0x112)]);let _0x3fcd55=_0x289a2f[animationIndex];for(let _0x9524b4=0x0;_0x9524b4<_0x3fcd55[_0x5d75fe(0x12c)]['length'];_0x9524b4++){ctx['drawImage'](_0x3fcd55[_0x5d75fe(0x12c)][_0x9524b4],0x0,0x0);}drawGrid(_0x26a140[_0x5d75fe(0xc9)],_0x26a140[_0x5d75fe(0x112)]),animationIndex=(animationIndex+0x1)%_0x289a2f[_0x5d75fe(0xa6)];},animationDelay);}function stopAnimation(){animationTimer&&(clearInterval(animationTimer),animationTimer=null,redrawAll());}function setAnimationDelay(_0x5adc98){_0x5adc98=Math['max'](0xa,parseInt(_0x5adc98,0xa)||0x12c),animationDelay=_0x5adc98,animationTimer&&(clearInterval(animationTimer),animationTimer=null,playAnimation());}function setTool(_0x45f4bc){const _0x4df98a=a0_0x203104;currentTool=_0x45f4bc,document['querySelectorAll'](_0x4df98a(0x1c3))[_0x4df98a(0x7f)](_0x46fa5e=>{const _0x4e1f73=_0x4df98a;_0x46fa5e['classList'][_0x4e1f73(0x204)]('active',_0x46fa5e['dataset'][_0x4e1f73(0x1ad)]===_0x45f4bc);}),document['querySelectorAll']('#palette-toolbar\x20.tool-btn')[_0x4df98a(0x7f)](_0x25205d=>{const _0x1393b8=_0x4df98a;_0x25205d[_0x1393b8(0x18d)][_0x1393b8(0x204)]('active',_0x25205d[_0x1393b8(0x1c7)][_0x1393b8(0x1ad)]===_0x45f4bc);}),_0x45f4bc===_0x4df98a(0x1cf)?canvas[_0x4df98a(0x122)]['cursor']='grab':canvas[_0x4df98a(0x122)][_0x4df98a(0x15f)]=_0x4df98a(0xb3);}function setPenSize(_0x52746f){const _0x591a3c=a0_0x203104;penSize=parseInt(_0x52746f)||0x1;let _0x318ca3=document[_0x591a3c(0x18a)](_0x591a3c(0x1b3));if(_0x318ca3)_0x318ca3[_0x591a3c(0x168)]=penSize;let _0x2c33e9=document[_0x591a3c(0x18a)](_0x591a3c(0x134));if(_0x2c33e9)_0x2c33e9[_0x591a3c(0x168)]=penSize;}function setPenMode(_0x2cae0a){const _0x2cf1bd=a0_0x203104;penMode=_0x2cae0a;let _0x2b291a=document[_0x2cf1bd(0x18a)](_0x2cf1bd(0xf1));if(_0x2b291a)_0x2b291a[_0x2cf1bd(0x168)]=penMode;let _0x2e33e1=document[_0x2cf1bd(0x18a)](_0x2cf1bd(0x91));if(_0x2e33e1)_0x2e33e1[_0x2cf1bd(0x168)]=penMode;}function hexToRgba(_0x2b24c0,_0x183a3e=0x1){const _0x3a4059=a0_0x203104;if(_0x2b24c0==='transparent'||_0x2b24c0===_0x3a4059(0x1f9))return[0x0,0x0,0x0,0x0];_0x2b24c0=_0x2b24c0[_0x3a4059(0x177)]('#','');if(_0x2b24c0[_0x3a4059(0xa6)]===0x3)_0x2b24c0=_0x2b24c0['split']('')[_0x3a4059(0x113)](_0x338484=>_0x338484+_0x338484)[_0x3a4059(0xfa)]('');let _0x50561e=parseInt(_0x2b24c0,0x10);return[_0x50561e>>0x10&0xff,_0x50561e>>0x8&0xff,_0x50561e&0xff,Math['round'](0xff*_0x183a3e)];}function fillAt(_0x42f4f5,_0x3e061a){const _0x5d6e9a=a0_0x203104;let _0x21816f=getCurrentProject(),_0x1bec68=getCurrentFrame(),_0xc4288f=_0x1bec68[_0x5d6e9a(0x12c)][_0x1bec68[_0x5d6e9a(0x8a)]][_0x5d6e9a(0x1b9)]('2d'),_0x217ec8=_0xc4288f[_0x5d6e9a(0x125)](0x0,0x0,_0x21816f[_0x5d6e9a(0xc9)]*cellSize,_0x21816f[_0x5d6e9a(0x112)]*cellSize),_0x5aa708=_0x42f4f5*cellSize,_0x522e40=_0x3e061a*cellSize,_0x442d75=getPixel(_0x217ec8,_0x5aa708,_0x522e40),_0x1b59d9=currentColor===_0x5d6e9a(0x178)||currentColor===_0x5d6e9a(0x1f9)||currentAlpha===0x0?[0x0,0x0,0x0,0x0]:hexToRgba(currentColor,currentAlpha);if(colorsMatch(_0x442d75,_0x1b59d9))return;let _0xc85e9=[[_0x42f4f5,_0x3e061a]],_0x4898a9=new Set();while(_0xc85e9[_0x5d6e9a(0xa6)]){let [_0x577239,_0x2b9598]=_0xc85e9['pop']();if(_0x577239<0x0||_0x2b9598<0x0||_0x577239>=_0x21816f[_0x5d6e9a(0xc9)]||_0x2b9598>=_0x21816f[_0x5d6e9a(0x112)])continue;let _0x987a1c=_0x577239+','+_0x2b9598;if(_0x4898a9['has'](_0x987a1c))continue;_0x4898a9[_0x5d6e9a(0x1df)](_0x987a1c);let _0x238450=_0x577239*cellSize,_0x5ebfdc=_0x2b9598*cellSize,_0x25b635=getPixel(_0x217ec8,_0x238450,_0x5ebfdc);if(!colorsMatch(_0x25b635,_0x442d75))continue;for(let _0x8989a3=0x0;_0x8989a3<cellSize;_0x8989a3++){for(let _0x3ea791=0x0;_0x3ea791<cellSize;_0x3ea791++){setPixel(_0x217ec8,_0x238450+_0x3ea791,_0x5ebfdc+_0x8989a3,_0x1b59d9);}}_0xc85e9['push']([_0x577239+0x1,_0x2b9598]),_0xc85e9['push']([_0x577239-0x1,_0x2b9598]),_0xc85e9[_0x5d6e9a(0x11d)]([_0x577239,_0x2b9598+0x1]),_0xc85e9[_0x5d6e9a(0x11d)]([_0x577239,_0x2b9598-0x1]);}_0xc4288f[_0x5d6e9a(0x145)](_0x217ec8,0x0,0x0),redrawAll();}function getPixel(_0x379934,_0x3ed79a,_0x199ea3){const _0x2287b1=a0_0x203104;let _0x12d2b5=(_0x199ea3*_0x379934[_0x2287b1(0xc9)]+_0x3ed79a)*0x4;return[_0x379934[_0x2287b1(0x218)][_0x12d2b5],_0x379934[_0x2287b1(0x218)][_0x12d2b5+0x1],_0x379934['data'][_0x12d2b5+0x2],_0x379934[_0x2287b1(0x218)][_0x12d2b5+0x3]];}function setPixel(_0x2fca7a,_0x504c2f,_0x492bcd,_0x5b3356){const _0x12d2b1=a0_0x203104;let _0xcd7e06=(_0x492bcd*_0x2fca7a[_0x12d2b1(0xc9)]+_0x504c2f)*0x4;_0x2fca7a[_0x12d2b1(0x218)][_0xcd7e06]=_0x5b3356[0x0],_0x2fca7a[_0x12d2b1(0x218)][_0xcd7e06+0x1]=_0x5b3356[0x1],_0x2fca7a[_0x12d2b1(0x218)][_0xcd7e06+0x2]=_0x5b3356[0x2],_0x2fca7a[_0x12d2b1(0x218)][_0xcd7e06+0x3]=_0x5b3356[0x3];}function colorsMatch(_0x1abd7b,_0x1af1af){return _0x1abd7b[0x0]===_0x1af1af[0x0]&&_0x1abd7b[0x1]===_0x1af1af[0x1]&&_0x1abd7b[0x2]===_0x1af1af[0x2]&&_0x1abd7b[0x3]===_0x1af1af[0x3];}function handleMouseDown(_0x510aee){const _0x307833=a0_0x203104;isDrawing=!![];const _0xfa1d9=getCanvasCoords(_0x510aee),_0xbc4441=Math[_0x307833(0x137)](_0xfa1d9['x']/cellSize),_0x3f70be=Math[_0x307833(0x137)](_0xfa1d9['y']/cellSize);currentTool===_0x307833(0x1b8)?(fillAt(_0xbc4441,_0x3f70be),saveHistory(),isDrawing=![],lastMouse=null):(drawDotXY(_0xbc4441,_0x3f70be),lastMouse={'x':_0xbc4441,'y':_0x3f70be});}function handleMouseMove(_0x415d56){const _0x59be90=a0_0x203104;if(!isDrawing)return;const _0x52a268=getCanvasCoords(_0x415d56),_0x2563b6=Math['floor'](_0x52a268['x']/cellSize),_0x324f7a=Math[_0x59be90(0x137)](_0x52a268['y']/cellSize);if(!lastMouse){drawDotXY(_0x2563b6,_0x324f7a),lastMouse={'x':_0x2563b6,'y':_0x324f7a};return;}const _0x117df4=_0x2563b6-lastMouse['x'],_0x139592=_0x324f7a-lastMouse['y'],_0x135a09=Math[_0x59be90(0x19d)](Math[_0x59be90(0x219)](_0x117df4),Math[_0x59be90(0x219)](_0x139592));if(_0x135a09<=0x1)drawDotXY(_0x2563b6,_0x324f7a);else for(let _0x1b8709=0x1;_0x1b8709<=_0x135a09;_0x1b8709++){const _0x1c6720=Math[_0x59be90(0x206)](lastMouse['x']+_0x117df4*_0x1b8709/_0x135a09),_0x2f5d52=Math['round'](lastMouse['y']+_0x139592*_0x1b8709/_0x135a09);drawDotXY(_0x1c6720,_0x2f5d52);}lastMouse={'x':_0x2563b6,'y':_0x324f7a};}function handleMouseUp(_0x50e04c){isDrawing&&saveHistory(),isDrawing=![],lastMouse=null;}let lastTouch=null,lastMouse=null,isPinching=![],pinchStartDistance=0x0,pinchStartMid=null,pinchStartScale=0x1,pinchStartPosX=0x0,pinchStartPosY=0x0,pinchRect=null;function getTouchPos(_0x5e5bf4){const _0x1658f1=a0_0x203104,_0x5d4cd3=canvas[_0x1658f1(0xbd)]();let _0x514920=_0x5e5bf4[_0x1658f1(0x1be)]&&_0x5e5bf4['touches'][0x0]?_0x5e5bf4['touches'][0x0]:_0x5e5bf4['changedTouches'][0x0];const _0x19add7=canvas['width']/_0x5d4cd3[_0x1658f1(0xc9)],_0x32f114=canvas[_0x1658f1(0x112)]/_0x5d4cd3['height'],_0x18b1b1=_0x514920[_0x1658f1(0x201)],_0x441634=_0x514920[_0x1658f1(0x1dc)],_0xd50cd8=(_0x18b1b1-_0x5d4cd3[_0x1658f1(0xaf)])*_0x19add7,_0x36dd2c=(_0x441634-_0x5d4cd3[_0x1658f1(0x194)])*_0x32f114;return{'x':Math[_0x1658f1(0x137)](_0xd50cd8/cellSize),'y':Math[_0x1658f1(0x137)](_0x36dd2c/cellSize)};}function handleTouchStart(_0x29d8b7){const _0x2368c0=a0_0x203104;if(_0x29d8b7['touches']['length']===0x2){_0x29d8b7[_0x2368c0(0x1e5)](),isPinching=!![],isDrawing=![];const _0x1679d4=_0x29d8b7[_0x2368c0(0x1be)][0x0],_0x114966=_0x29d8b7[_0x2368c0(0x1be)][0x1];pinchStartDistance=Math[_0x2368c0(0x172)](_0x114966[_0x2368c0(0x201)]-_0x1679d4[_0x2368c0(0x201)],_0x114966[_0x2368c0(0x1dc)]-_0x1679d4[_0x2368c0(0x1dc)]),pinchStartMid={'clientX':(_0x1679d4[_0x2368c0(0x201)]+_0x114966['clientX'])/0x2,'clientY':(_0x1679d4[_0x2368c0(0x1dc)]+_0x114966[_0x2368c0(0x1dc)])/0x2},pinchStartScale=scale,pinchStartPosX=posX,pinchStartPosY=posY,pinchRect=canvas[_0x2368c0(0xbd)]();}else{if(_0x29d8b7[_0x2368c0(0x1be)][_0x2368c0(0xa6)]===0x1){if(colorPickMode){_0x29d8b7[_0x2368c0(0x1e5)]();const _0x1c8a37=_0x29d8b7[_0x2368c0(0x1be)][0x0];onCanvasColorPick({'clientX':_0x1c8a37[_0x2368c0(0x201)],'clientY':_0x1c8a37[_0x2368c0(0x1dc)]});return;}_0x29d8b7['preventDefault']();if(isPinching)return;isDrawing=!![];let _0x3d02ea=getTouchPos(_0x29d8b7);lastTouch=_0x3d02ea,currentTool===_0x2368c0(0x1b8)?(fillAt(_0x3d02ea['x'],_0x3d02ea['y']),saveHistory(),isDrawing=![]):drawDotTouch(_0x3d02ea['x'],_0x3d02ea['y']);}}}function handleTouchMove(_0x5269a5){const _0x25ff3c=a0_0x203104;if(isPinching||_0x5269a5[_0x25ff3c(0x1be)]&&_0x5269a5[_0x25ff3c(0x1be)][_0x25ff3c(0xa6)]===0x2){_0x5269a5[_0x25ff3c(0x1e5)]();const _0x36edb8=_0x5269a5[_0x25ff3c(0x1be)][0x0],_0x18fb20=_0x5269a5[_0x25ff3c(0x1be)][0x1],_0x51e143=Math[_0x25ff3c(0x172)](_0x18fb20[_0x25ff3c(0x201)]-_0x36edb8['clientX'],_0x18fb20[_0x25ff3c(0x1dc)]-_0x36edb8[_0x25ff3c(0x1dc)]),_0x192f87={'clientX':(_0x36edb8[_0x25ff3c(0x201)]+_0x18fb20[_0x25ff3c(0x201)])/0x2,'clientY':(_0x36edb8[_0x25ff3c(0x1dc)]+_0x18fb20['clientY'])/0x2};if(!pinchStartDistance)pinchStartDistance=_0x51e143||0x1;const _0x29afe5=_0x51e143/pinchStartDistance||0x1;let _0x574896=pinchStartScale*_0x29afe5;_0x574896=Math[_0x25ff3c(0x154)](Math[_0x25ff3c(0x19d)](_0x574896,0.2),0x5);const _0x542b68=pinchRect||canvas[_0x25ff3c(0xbd)](),_0x4474ba=(pinchStartMid[_0x25ff3c(0x201)]-_0x542b68[_0x25ff3c(0xaf)]-pinchStartPosX)/pinchStartScale,_0x72553=(pinchStartMid[_0x25ff3c(0x1dc)]-_0x542b68['top']-pinchStartPosY)/pinchStartScale;posX=_0x192f87[_0x25ff3c(0x201)]-_0x542b68[_0x25ff3c(0xaf)]-_0x4474ba*_0x574896,posY=_0x192f87[_0x25ff3c(0x1dc)]-_0x542b68[_0x25ff3c(0x194)]-_0x72553*_0x574896,scale=_0x574896,updateTransform();return;}if(!isDrawing)return;if(_0x5269a5[_0x25ff3c(0x1be)]&&_0x5269a5['touches'][_0x25ff3c(0xa6)]>0x1)return;_0x5269a5[_0x25ff3c(0x1e5)]();let _0x51bdbd=getTouchPos(_0x5269a5);if(lastTouch){let _0x38598b=Math[_0x25ff3c(0x219)]((_0x51bdbd['x']-lastTouch['x'])*cellSize),_0x14a2f3=Math[_0x25ff3c(0x219)]((_0x51bdbd['y']-lastTouch['y'])*cellSize);if(_0x38598b>=PAN_CANCEL_DISTANCE||_0x14a2f3>=PAN_CANCEL_DISTANCE){if(currentTool!==_0x25ff3c(0x14f)){isDrawing=![];return;}}}if(lastTouch){let _0x136fad=_0x51bdbd['x']-lastTouch['x'],_0x5d5f27=_0x51bdbd['y']-lastTouch['y'],_0x4f620c=Math['max'](Math[_0x25ff3c(0x219)](_0x136fad),Math[_0x25ff3c(0x219)](_0x5d5f27));for(let _0x582583=0x1;_0x582583<=_0x4f620c;_0x582583++){let _0x5a95c8=Math[_0x25ff3c(0x206)](lastTouch['x']+_0x136fad*_0x582583/_0x4f620c),_0xf4d5ff=Math[_0x25ff3c(0x206)](lastTouch['y']+_0x5d5f27*_0x582583/_0x4f620c);drawDotTouch(_0x5a95c8,_0xf4d5ff);}}else drawDotTouch(_0x51bdbd['x'],_0x51bdbd['y']);lastTouch=_0x51bdbd;}function handleTouchEnd(_0x107ca2){const _0x283b28=a0_0x203104;isPinching&&_0x107ca2[_0x283b28(0x1be)]&&_0x107ca2[_0x283b28(0x1be)][_0x283b28(0xa6)]<0x2&&(isPinching=![],pinchStartDistance=0x0,pinchStartMid=null,pinchRect=null);isDrawing&&(!_0x107ca2[_0x283b28(0x1be)]||_0x107ca2[_0x283b28(0x1be)][_0x283b28(0xa6)]===0x0)&&saveHistory();if(_0x107ca2[_0x283b28(0x1be)]&&_0x107ca2[_0x283b28(0x1be)]['length']===0x1){let _0x46f111=_0x107ca2[_0x283b28(0x1be)][0x0];lastTouch=getTouchPos({'touches':[_0x46f111]}),isDrawing=!![];}else isDrawing=![],lastTouch=null;}function drawDotXY(_0x1cb050,_0x4adc33){const _0x4c7b17=a0_0x203104;let _0x3c4f98=getCurrentProject(),_0x5334f9=getCurrentFrame();if(!_0x5334f9||!_0x3c4f98)return;if(typeof _0x1cb050!==_0x4c7b17(0x9e)||typeof _0x4adc33!=='number'||_0x1cb050<0x0||_0x4adc33<0x0||!Number['isFinite'](_0x3c4f98['width'])||!Number[_0x4c7b17(0x1d3)](_0x3c4f98[_0x4c7b17(0x112)])||_0x1cb050>=_0x3c4f98[_0x4c7b17(0xc9)]||_0x4adc33>=_0x3c4f98[_0x4c7b17(0x112)]||!Array[_0x4c7b17(0xc1)](_0x5334f9[_0x4c7b17(0x12c)])||typeof _0x5334f9[_0x4c7b17(0x8a)]!==_0x4c7b17(0x9e)||!_0x5334f9['layers'][_0x5334f9['activeLayer']])return;let _0x188afc=_0x5334f9[_0x4c7b17(0x12c)][_0x5334f9['activeLayer']]['getContext']('2d');if(!_0x188afc)return;if(currentTool===_0x4c7b17(0x200)||currentColor===_0x4c7b17(0x178)||currentColor==='#00000000'||currentAlpha===0x0)drawPenShape(_0x188afc,_0x1cb050,_0x4adc33,_0x4c7b17(0x1f9),!![]);else{let _0x3c52ec=hexToRgba(currentColor,currentAlpha);_0x188afc['save'](),_0x188afc[_0x4c7b17(0x17c)]=_0x3c52ec[0x3]/0xff,drawPenShape(_0x188afc,_0x1cb050,_0x4adc33,_0x4c7b17(0xb1)+_0x3c52ec[0x0]+','+_0x3c52ec[0x1]+','+_0x3c52ec[0x2]+','+_0x3c52ec[0x3]/0xff+')',![]),_0x188afc[_0x4c7b17(0x20c)]();}redrawAll();}function drawPenShape(_0x7c14cd,_0x4d8f6f,_0x1df414,_0x1883a9,_0x27925b){const _0x225f2b=a0_0x203104,_0x574189=_0x4d8f6f*cellSize,_0x5a2bb7=_0x1df414*cellSize,_0x5f30d6=penSize*cellSize;_0x27925b?(_0x7c14cd['save'](),_0x7c14cd['globalCompositeOperation']=_0x225f2b(0x132),penMode===_0x225f2b(0x84)?(_0x7c14cd['beginPath'](),_0x7c14cd['arc'](_0x574189+cellSize/0x2,_0x5a2bb7+cellSize/0x2,_0x5f30d6/0x2,0x0,Math['PI']*0x2),_0x7c14cd['fill']()):_0x7c14cd[_0x225f2b(0x1b1)](_0x574189-Math['floor']((penSize-0x1)/0x2)*cellSize,_0x5a2bb7-Math[_0x225f2b(0x137)]((penSize-0x1)/0x2)*cellSize,_0x5f30d6,_0x5f30d6),_0x7c14cd[_0x225f2b(0x20c)]()):(_0x7c14cd[_0x225f2b(0xbe)](),_0x7c14cd[_0x225f2b(0x226)]=_0x1883a9,penMode===_0x225f2b(0x84)?(_0x7c14cd[_0x225f2b(0x1c4)](),_0x7c14cd[_0x225f2b(0x80)](_0x574189+cellSize/0x2,_0x5a2bb7+cellSize/0x2,_0x5f30d6/0x2,0x0,Math['PI']*0x2),_0x7c14cd['fill']()):_0x7c14cd[_0x225f2b(0x1dd)](_0x574189-Math['floor']((penSize-0x1)/0x2)*cellSize,_0x5a2bb7-Math[_0x225f2b(0x137)]((penSize-0x1)/0x2)*cellSize,_0x5f30d6,_0x5f30d6),_0x7c14cd['restore']());}function drawDotTouch(_0x4b5a1a,_0x43c751){const _0x1c641d=a0_0x203104;let _0x5ac260=getCurrentProject(),_0x1736c7=getCurrentFrame();if(_0x4b5a1a<0x0||_0x43c751<0x0||_0x4b5a1a>=_0x5ac260[_0x1c641d(0xc9)]||_0x43c751>=_0x5ac260['height'])return;let _0x180ea3=_0x1736c7[_0x1c641d(0x12c)][_0x1736c7[_0x1c641d(0x8a)]]['getContext']('2d');if(currentTool==='eraser'||currentColor==='transparent'||currentColor===_0x1c641d(0x1f9)||currentAlpha===0x0)drawPenShape(_0x180ea3,_0x4b5a1a,_0x43c751,'#00000000',!![]);else{let _0x279049=hexToRgba(currentColor,currentAlpha);_0x180ea3[_0x1c641d(0xbe)](),_0x180ea3['globalAlpha']=_0x279049[0x3]/0xff,drawPenShape(_0x180ea3,_0x4b5a1a,_0x43c751,_0x1c641d(0xb1)+_0x279049[0x0]+','+_0x279049[0x1]+','+_0x279049[0x2]+','+_0x279049[0x3]/0xff+')',![]),_0x180ea3['restore']();}redrawAll();}function applyTheme(_0x166b42){const _0x361630=a0_0x203104;document['documentElement'][_0x361630(0x1c1)]('data-theme',_0x166b42);const _0x4e1c71=document[_0x361630(0x18a)](_0x361630(0x190));_0x4e1c71&&(_0x4e1c71[_0x361630(0x217)]=_0x166b42===_0x361630(0x16f)?'‚òÄÔ∏è':'üåô',_0x4e1c71[_0x361630(0x1c1)](_0x361630(0x1cb),_0x166b42==='dark'),_0x4e1c71[_0x361630(0x10d)]=_0x166b42==='dark'?_0x361630(0xde):_0x361630(0x21b)),localStorage[_0x361630(0x150)](_0x361630(0xae),_0x166b42);}function toggleTheme(){const _0x5aeda1=a0_0x203104;applyTheme(document[_0x5aeda1(0x176)][_0x5aeda1(0x12b)]('data-theme')===_0x5aeda1(0x16f)?_0x5aeda1(0x153):_0x5aeda1(0x16f));}(function initTheme(){const _0x17433c=a0_0x203104,_0x24be0d=localStorage[_0x17433c(0x1e2)]('nezumi-theme')||(window[_0x17433c(0x159)]&&window['matchMedia'](_0x17433c(0x7c))[_0x17433c(0x104)]?_0x17433c(0x16f):'light');applyTheme(_0x24be0d),document[_0x17433c(0xbc)]('DOMContentLoaded',()=>{const _0x312877=_0x17433c,_0x45eda8=document[_0x312877(0x18a)](_0x312877(0x190));_0x45eda8&&(_0x45eda8[_0x312877(0xbc)](_0x312877(0x1f5),toggleTheme),_0x45eda8[_0x312877(0xbc)](_0x312877(0x1e9),_0x207b6d=>{const _0x257eab=_0x312877;(_0x207b6d[_0x257eab(0x1f3)]===_0x257eab(0x189)||_0x207b6d[_0x257eab(0x1f3)]==='\x20')&&(_0x207b6d[_0x257eab(0x1e5)](),toggleTheme());}));});}(),window[a0_0x203104(0x18f)]=()=>{const _0x3b5a35=a0_0x203104;projects=[createProject()],activeProject=0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),initCanvas(),setTool(_0x3b5a35(0x14f)),loadPaletteFromDB()[_0x3b5a35(0x10b)](()=>createPalette()),document['getElementById'](_0x3b5a35(0x1b3))['value']=penSize,document[_0x3b5a35(0x18a)]('penMode')[_0x3b5a35(0x168)]=penMode;const _0x533fbd=document[_0x3b5a35(0x18a)]('animSpeedRange'),_0x5716c3=document[_0x3b5a35(0x18a)](_0x3b5a35(0xf4));_0x533fbd&&_0x5716c3&&(_0x533fbd[_0x3b5a35(0x168)]=animationDelay,_0x5716c3['value']=animationDelay,_0x533fbd[_0x3b5a35(0x162)]=_0x485394=>{const _0x25ccb0=_0x3b5a35;_0x5716c3['value']=_0x485394['target'][_0x25ccb0(0x168)],setAnimationDelay(_0x485394[_0x25ccb0(0x1cc)]['value']);},_0x5716c3[_0x3b5a35(0x90)]=_0x29fb7d=>{const _0x4d2768=_0x3b5a35;let _0x4a0057=Math[_0x4d2768(0x19d)](0xa,Math[_0x4d2768(0x154)](0x1388,parseInt(_0x29fb7d[_0x4d2768(0x1cc)][_0x4d2768(0x168)])||animationDelay));_0x533fbd['value']=_0x4a0057,_0x5716c3[_0x4d2768(0x168)]=_0x4a0057,setAnimationDelay(_0x4a0057);}),canvas[_0x3b5a35(0x14b)]=handleMouseMove,canvas[_0x3b5a35(0x1ed)]=handleMouseUp,canvas[_0x3b5a35(0x11f)]=handleMouseUp,canvas[_0x3b5a35(0x1c8)]=handleTouchStart,canvas[_0x3b5a35(0x1ef)]=handleTouchMove,canvas['ontouchend']=handleTouchEnd,canvas['ontouchcancel']=handleTouchEnd,canvas[_0x3b5a35(0xbc)](_0x3b5a35(0xe9),handleTouchStart,{'passive':![]}),canvas['addEventListener'](_0x3b5a35(0xe7),handleTouchMove,{'passive':![]}),canvas['addEventListener'](_0x3b5a35(0x21d),handleTouchEnd,{'passive':![]}),canvas[_0x3b5a35(0xbc)]('touchcancel',handleTouchEnd,{'passive':![]}),idbGet(_0x3b5a35(0xa3))&&loadProjectFromIDB();});function drawGrid(_0x218628,_0x40a690){const _0x1b8c0b=a0_0x203104;ctx[_0x1b8c0b(0xbe)](),ctx[_0x1b8c0b(0x10e)]=_0x1b8c0b(0x1c6);for(let _0x1da843=0x0;_0x1da843<=_0x218628;_0x1da843++){ctx['beginPath'](),ctx[_0x1b8c0b(0x81)](_0x1da843*cellSize,0x0),ctx['lineTo'](_0x1da843*cellSize,_0x40a690*cellSize),ctx[_0x1b8c0b(0xc4)]();}for(let _0x5257ca=0x0;_0x5257ca<=_0x40a690;_0x5257ca++){ctx[_0x1b8c0b(0x1c4)](),ctx[_0x1b8c0b(0x81)](0x0,_0x5257ca*cellSize),ctx[_0x1b8c0b(0xbf)](_0x218628*cellSize,_0x5257ca*cellSize),ctx[_0x1b8c0b(0xc4)]();}ctx[_0x1b8c0b(0x20c)]();}function redrawAll(){const _0x50a5b2=a0_0x203104;let _0x426b29=getCurrentProject(),_0x200972=getCurrentFrame();canvas[_0x50a5b2(0xc9)]=_0x426b29[_0x50a5b2(0xc9)]*cellSize,canvas[_0x50a5b2(0x112)]=_0x426b29[_0x50a5b2(0x112)]*cellSize,ctx[_0x50a5b2(0x1b1)](0x0,0x0,canvas[_0x50a5b2(0xc9)],canvas[_0x50a5b2(0x112)]);for(let _0x2cb82c=0x0;_0x2cb82c<_0x200972['layers'][_0x50a5b2(0xa6)];_0x2cb82c++){ctx[_0x50a5b2(0x136)](_0x200972[_0x50a5b2(0x12c)][_0x2cb82c],0x0,0x0);}drawGrid(_0x426b29[_0x50a5b2(0xc9)],_0x426b29[_0x50a5b2(0x112)]),wrapper&&(wrapper[_0x50a5b2(0x122)]['width']=_0x50a5b2(0x1b7),wrapper[_0x50a5b2(0x122)][_0x50a5b2(0x112)]=_0x50a5b2(0x1a5));}function saveHistory(){const _0x46ae8c=a0_0x203104;let _0x57f916=getCurrentFrame(),_0x31f3cc=_0x57f916['layerHistories'][_0x57f916[_0x46ae8c(0x8a)]];_0x31f3cc[_0x46ae8c(0x11d)](_0x57f916[_0x46ae8c(0x12c)][_0x57f916[_0x46ae8c(0x8a)]][_0x46ae8c(0x1d0)]());if(_0x31f3cc[_0x46ae8c(0xa6)]>0x32)_0x31f3cc['shift']();_0x57f916[_0x46ae8c(0xf7)][_0x57f916[_0x46ae8c(0x8a)]]=[];}let copiedLayerDataUrl=null;function copyLayer(){const _0x1f9449=a0_0x203104,_0x2b51d7=getCurrentFrame();if(!_0x2b51d7)return;const _0x219b2a=_0x2b51d7[_0x1f9449(0x8a)];if(typeof _0x219b2a!==_0x1f9449(0x9e)||!_0x2b51d7[_0x1f9449(0x12c)][_0x219b2a])return;copiedLayerDataUrl=_0x2b51d7[_0x1f9449(0x12c)][_0x219b2a]['toDataURL']();const _0x566fa2=document[_0x1f9449(0x18a)](_0x1f9449(0xfe));if(_0x566fa2)_0x566fa2[_0x1f9449(0x13f)]=![];}function pasteLayer(){const _0x4e1735=a0_0x203104;if(!copiedLayerDataUrl)return;const _0x46d207=getCurrentProject(),_0x20b1ca=getCurrentFrame();if(!_0x46d207||!_0x20b1ca)return;const _0x14a2ad=document[_0x4e1735(0x19b)]('canvas');_0x14a2ad[_0x4e1735(0xc9)]=_0x46d207[_0x4e1735(0xc9)]*cellSize,_0x14a2ad[_0x4e1735(0x112)]=_0x46d207[_0x4e1735(0x112)]*cellSize;const _0x551df6=_0x14a2ad['getContext']('2d'),_0x5a4b78=new Image();_0x5a4b78[_0x4e1735(0x18f)]=()=>{const _0x1bf7bd=_0x4e1735;_0x551df6[_0x1bf7bd(0x1b1)](0x0,0x0,_0x14a2ad[_0x1bf7bd(0xc9)],_0x14a2ad[_0x1bf7bd(0x112)]),_0x551df6[_0x1bf7bd(0x136)](_0x5a4b78,0x0,0x0),_0x20b1ca[_0x1bf7bd(0x12c)][_0x1bf7bd(0x11d)](_0x14a2ad),_0x20b1ca['layerHistories'][_0x1bf7bd(0x11d)]([]),_0x20b1ca['layerRedoStacks'][_0x1bf7bd(0x11d)]([]),_0x20b1ca[_0x1bf7bd(0x8a)]=_0x20b1ca['layers'][_0x1bf7bd(0xa6)]-0x1,saveHistory(),updateLayerUI(),redrawAll();},_0x5a4b78[_0x4e1735(0x14c)]=copiedLayerDataUrl;}function undo(){const _0x2fdc0b=a0_0x203104;let _0x1817ec=getCurrentFrame(),_0x5874b9=_0x1817ec[_0x2fdc0b(0x98)][_0x1817ec['activeLayer']],_0x518c77=_0x1817ec[_0x2fdc0b(0xf7)][_0x1817ec[_0x2fdc0b(0x8a)]];if(!_0x5874b9||_0x5874b9['length']<0x2)return;_0x518c77[_0x2fdc0b(0x11d)](_0x5874b9[_0x2fdc0b(0x120)]());let _0x4c5c34=new Image();_0x4c5c34[_0x2fdc0b(0x18f)]=()=>{const _0x1a37ed=_0x2fdc0b;let _0x186828=_0x1817ec[_0x1a37ed(0x12c)][_0x1817ec[_0x1a37ed(0x8a)]]['getContext']('2d');_0x186828['clearRect'](0x0,0x0,_0x1817ec[_0x1a37ed(0x12c)][_0x1817ec['activeLayer']][_0x1a37ed(0xc9)],_0x1817ec[_0x1a37ed(0x12c)][_0x1817ec[_0x1a37ed(0x8a)]][_0x1a37ed(0x112)]),_0x186828[_0x1a37ed(0x136)](_0x4c5c34,0x0,0x0),redrawAll();},_0x4c5c34[_0x2fdc0b(0x14c)]=_0x5874b9[_0x5874b9[_0x2fdc0b(0xa6)]-0x1];}function redo(){const _0x4005ab=a0_0x203104;let _0x1622cd=getCurrentFrame(),_0xafcd4f=_0x1622cd[_0x4005ab(0x98)][_0x1622cd[_0x4005ab(0x8a)]],_0x3716e1=_0x1622cd['layerRedoStacks'][_0x1622cd[_0x4005ab(0x8a)]];if(!_0x3716e1||_0x3716e1[_0x4005ab(0xa6)]===0x0)return;let _0x468019=_0x3716e1[_0x4005ab(0x120)]();_0xafcd4f[_0x4005ab(0x11d)](_0x468019);let _0x587bee=new Image();_0x587bee[_0x4005ab(0x18f)]=()=>{const _0x4539c1=_0x4005ab;let _0x1b0715=_0x1622cd['layers'][_0x1622cd[_0x4539c1(0x8a)]][_0x4539c1(0x1b9)]('2d');_0x1b0715[_0x4539c1(0x1b1)](0x0,0x0,_0x1622cd[_0x4539c1(0x12c)][_0x1622cd[_0x4539c1(0x8a)]]['width'],_0x1622cd[_0x4539c1(0x12c)][_0x1622cd[_0x4539c1(0x8a)]][_0x4539c1(0x112)]),_0x1b0715[_0x4539c1(0x136)](_0x587bee,0x0,0x0),redrawAll();},_0x587bee['src']=_0x468019;}function exportImage(_0x3208da){const _0xd981bd=a0_0x203104;let _0x3d55bc=getCurrentProject(),_0x30d24b=_0x3d55bc[_0xd981bd(0x1d7)],_0x164805=_0x3208da===_0xd981bd(0x156)||_0x3208da===_0xd981bd(0x222)?_0xd981bd(0x181):_0xd981bd(0x1e8)+_0x3208da,_0x581f17=_0x30d24b[_0xd981bd(0xa6)]>0x1,_0x355661=(_0x3d55bc[_0xd981bd(0x8b)]||_0xd981bd(0x155))[_0xd981bd(0x177)](/[\\/:*?"<>|]/g,'_');if(!_0x581f17){let _0x5f5bab=document['createElement'](_0xd981bd(0x224));_0x5f5bab['width']=_0x3d55bc['width']*cellSize,_0x5f5bab[_0xd981bd(0x112)]=_0x3d55bc[_0xd981bd(0x112)]*cellSize;let _0x3d0c20=_0x5f5bab[_0xd981bd(0x1b9)]('2d'),_0x538ca6=getCurrentFrame();for(let _0x4fea61=0x0;_0x4fea61<_0x538ca6['layers'][_0xd981bd(0xa6)];_0x4fea61++){_0x3d0c20[_0xd981bd(0x136)](_0x538ca6[_0xd981bd(0x12c)][_0x4fea61],0x0,0x0);}let _0x4b338d=document[_0xd981bd(0x19b)]('a');_0x4b338d[_0xd981bd(0x1db)]=_0x355661+'.'+_0x3208da,_0x3208da===_0xd981bd(0x156)||_0x3208da===_0xd981bd(0x222)?_0x4b338d[_0xd981bd(0x205)]=_0x5f5bab[_0xd981bd(0x1d0)](_0x164805,0.92):_0x4b338d[_0xd981bd(0x205)]=_0x5f5bab[_0xd981bd(0x1d0)](_0x164805),_0x4b338d[_0xd981bd(0x1f5)]();}else{if(_0x3208da===_0xd981bd(0x16a)&&typeof window['WebCodecs']!=='undefined')exportWebpAnimation(_0x30d24b,_0x3d55bc['width']*cellSize,_0x3d55bc[_0xd981bd(0x112)]*cellSize,_0x355661);else for(let _0x4804a1=0x0;_0x4804a1<_0x30d24b[_0xd981bd(0xa6)];_0x4804a1++){let _0x5225f7=document[_0xd981bd(0x19b)](_0xd981bd(0x224));_0x5225f7['width']=_0x3d55bc['width']*cellSize,_0x5225f7['height']=_0x3d55bc[_0xd981bd(0x112)]*cellSize;let _0x265b3b=_0x5225f7[_0xd981bd(0x1b9)]('2d'),_0x459e48=_0x30d24b[_0x4804a1];for(let _0x252ada=0x0;_0x252ada<_0x459e48[_0xd981bd(0x12c)][_0xd981bd(0xa6)];_0x252ada++){_0x265b3b[_0xd981bd(0x136)](_0x459e48['layers'][_0x252ada],0x0,0x0);}let _0x341dfb=document['createElement']('a');_0x341dfb[_0xd981bd(0x1db)]=_0x355661+'-f'+(_0x4804a1+0x1)+'.'+_0x3208da,_0x3208da===_0xd981bd(0x156)||_0x3208da==='jpeg'?_0x341dfb[_0xd981bd(0x205)]=_0x5225f7[_0xd981bd(0x1d0)](_0x164805,0.92):_0x341dfb[_0xd981bd(0x205)]=_0x5225f7[_0xd981bd(0x1d0)](_0x164805),setTimeout(()=>_0x341dfb[_0xd981bd(0x1f5)](),_0x4804a1*0x64);}}}async function exportWebpAnimation(_0x5c02a8,_0x1992d1,_0x23df36,_0x2b2248=a0_0x203104(0xe4)){const _0x14d093=a0_0x203104;if(!window['WebCodecs']||!window[_0x14d093(0x1e1)]){alert(_0x14d093(0x7d));return;}const _0x174404=[],_0x3d6db3=new VideoEncoder({'output':_0x434813=>_0x174404[_0x14d093(0x11d)](_0x434813),'error':_0x259647=>console['error'](_0x259647)});_0x3d6db3[_0x14d093(0xa7)]({'codec':'vp8','width':_0x1992d1,'height':_0x23df36,'framerate':0x5});for(let _0x3a5126=0x0;_0x3a5126<_0x5c02a8[_0x14d093(0xa6)];_0x3a5126++){let _0x2275b0=document[_0x14d093(0x19b)]('canvas');_0x2275b0[_0x14d093(0xc9)]=_0x1992d1,_0x2275b0[_0x14d093(0x112)]=_0x23df36;let _0x27caa3=_0x2275b0[_0x14d093(0x1b9)]('2d'),_0x10e1f0=_0x5c02a8[_0x3a5126];for(let _0x120ebb=0x0;_0x120ebb<_0x10e1f0[_0x14d093(0x12c)][_0x14d093(0xa6)];_0x120ebb++){_0x27caa3[_0x14d093(0x136)](_0x10e1f0[_0x14d093(0x12c)][_0x120ebb],0x0,0x0);}let _0x41e75f=await createImageBitmap(_0x2275b0);_0x3d6db3[_0x14d093(0x19e)](_0x41e75f,{'keyFrame':!![],'duration':0xc8}),_0x41e75f[_0x14d093(0xc7)]();}await _0x3d6db3['flush'](),_0x3d6db3[_0x14d093(0xc7)]();const _0x1e13d3=new Blob(_0x174404[_0x14d093(0x113)](_0xbf17d3=>_0xbf17d3[_0x14d093(0x160)]?_0xbf17d3:_0xbf17d3['data']),{'type':_0x14d093(0x1a2)}),_0x216286=document[_0x14d093(0x19b)]('a');_0x216286[_0x14d093(0x1db)]=_0x2b2248+_0x14d093(0x185),_0x216286[_0x14d093(0x205)]=URL[_0x14d093(0x116)](_0x1e13d3),_0x216286['click']();}function exportGif(){const _0x4cd2d0=a0_0x203104;let _0x200849=getCurrentProject(),_0x34dbcb=_0x200849['frames'],_0x261a93=_0x200849[_0x4cd2d0(0xc9)]*cellSize,_0x299170=_0x200849['height']*cellSize;const _0x4acd57=_0x34dbcb[_0x4cd2d0(0x113)](_0x50b7ee=>{const _0x40126c=_0x4cd2d0;let _0xbdb61c=document[_0x40126c(0x19b)](_0x40126c(0x224));_0xbdb61c[_0x40126c(0xc9)]=_0x261a93,_0xbdb61c[_0x40126c(0x112)]=_0x299170;let _0x48d357=_0xbdb61c[_0x40126c(0x1b9)]('2d');for(let _0x20f263=0x0;_0x20f263<_0x50b7ee[_0x40126c(0x12c)][_0x40126c(0xa6)];_0x20f263++){_0x48d357['drawImage'](_0x50b7ee['layers'][_0x20f263],0x0,0x0);}return _0xbdb61c[_0x40126c(0x1d0)](_0x40126c(0x180));});Promise[_0x4cd2d0(0x83)](_0x4acd57[_0x4cd2d0(0x113)](_0x1fd86c=>{return new Promise(_0x2dc68d=>{const _0x25286c=a0_0x177c,_0x249df5=new Image();_0x249df5[_0x25286c(0x14c)]=_0x1fd86c,_0x249df5[_0x25286c(0x18f)]=()=>_0x2dc68d(_0x249df5);});}))[_0x4cd2d0(0x10b)](_0x588233=>{const _0x1bc453=_0x4cd2d0,_0x69254c=_0x588233[_0x1bc453(0x14e)](_0x14a470=>_0x14a470['width']>0x0&&_0x14a470[_0x1bc453(0x112)]>0x0);if(_0x69254c[_0x1bc453(0xa6)]===0x0){alert(_0x1bc453(0x1bd));return;}const _0x35b1d8=(_0x200849[_0x1bc453(0x8b)]||_0x1bc453(0xe4))['replace'](/[\\/:*?"<>|]/g,'_');convertToGIF(_0x69254c,animationDelay,_0x35b1d8+'.gif');});}function exportApng(){const _0x1c2ccc=a0_0x203104;let _0x1682f5=getCurrentProject(),_0x111276=_0x1682f5[_0x1c2ccc(0x1d7)],_0x3289fe=_0x1682f5[_0x1c2ccc(0xc9)]*cellSize,_0x3b1e3f=_0x1682f5['height']*cellSize;const _0x5651a0=_0x111276['map'](_0x56c1a5=>{const _0x299d07=_0x1c2ccc;let _0x87fe89=document[_0x299d07(0x19b)](_0x299d07(0x224));_0x87fe89[_0x299d07(0xc9)]=_0x3289fe,_0x87fe89['height']=_0x3b1e3f;let _0x185820=_0x87fe89[_0x299d07(0x1b9)]('2d');for(let _0x41d578=0x0;_0x41d578<_0x56c1a5[_0x299d07(0x12c)][_0x299d07(0xa6)];_0x41d578++){_0x185820['drawImage'](_0x56c1a5[_0x299d07(0x12c)][_0x41d578],0x0,0x0);}let _0xdbf2ae=new Image();return _0xdbf2ae['src']=_0x87fe89['toDataURL'](_0x299d07(0x180)),_0xdbf2ae;}),_0x2e9326=(_0x1682f5['name']||_0x1c2ccc(0xe4))[_0x1c2ccc(0x177)](/[\\/:*?"<>|]/g,'_');convertToAPNG(_0x5651a0,_0x3289fe,_0x3b1e3f,animationDelay,_0x2e9326+_0x1c2ccc(0xfd));}async function exportLayersAsGif(){const _0x14d74f=a0_0x203104,_0x4da6bd=document[_0x14d74f(0x18a)](_0x14d74f(0xdf));if(_0x4da6bd)_0x4da6bd[_0x14d74f(0x217)]=_0x14d74f(0x1bb);const _0x3d3ee9=getCurrentProject();if(!_0x3d3ee9){if(_0x4da6bd)_0x4da6bd[_0x14d74f(0x217)]='';return;}const _0x4852a1=_0x3d3ee9[_0x14d74f(0x1d7)],_0x4b280e=_0x3d3ee9[_0x14d74f(0xc9)]*cellSize,_0x1650cc=_0x3d3ee9['height']*cellSize;let _0x16ad44=0x0;_0x4852a1[_0x14d74f(0x7f)](_0x5ebb84=>{const _0x5b4912=_0x14d74f;_0x16ad44=Math[_0x5b4912(0x19d)](_0x16ad44,_0x5ebb84[_0x5b4912(0x12c)]['length']);});for(let _0x448e3f=0x0;_0x448e3f<_0x16ad44;_0x448e3f++){const _0x5b8a9c=await Promise[_0x14d74f(0x83)](_0x4852a1[_0x14d74f(0x113)](_0x51ad80=>{return new Promise(_0xd892ec=>{const _0x1e7fb4=a0_0x177c,_0x3811bf=document[_0x1e7fb4(0x19b)]('canvas');_0x3811bf[_0x1e7fb4(0xc9)]=_0x4b280e,_0x3811bf[_0x1e7fb4(0x112)]=_0x1650cc;const _0x4abf7f=_0x3811bf[_0x1e7fb4(0x1b9)]('2d');if(_0x51ad80[_0x1e7fb4(0x12c)][_0x448e3f])_0x4abf7f[_0x1e7fb4(0x136)](_0x51ad80[_0x1e7fb4(0x12c)][_0x448e3f],0x0,0x0);const _0x402447=new Image();_0x402447[_0x1e7fb4(0x18f)]=()=>_0xd892ec(_0x402447),_0x402447[_0x1e7fb4(0x14c)]=_0x3811bf[_0x1e7fb4(0x1d0)](_0x1e7fb4(0x180));});})),_0x458291=_0x5b8a9c[_0x14d74f(0x1c5)](_0x42864e=>{const _0x542a3d=_0x14d74f,_0x712365=document[_0x542a3d(0x19b)](_0x542a3d(0x224));_0x712365[_0x542a3d(0xc9)]=_0x4b280e,_0x712365[_0x542a3d(0x112)]=_0x1650cc;const _0x2ffbbf=_0x712365[_0x542a3d(0x1b9)]('2d');_0x2ffbbf[_0x542a3d(0x136)](_0x42864e,0x0,0x0);const _0x5bf081=_0x2ffbbf[_0x542a3d(0x125)](0x0,0x0,_0x4b280e,_0x1650cc)['data'];for(let _0x150764=0x3;_0x150764<_0x5bf081[_0x542a3d(0xa6)];_0x150764+=0x4)if(_0x5bf081[_0x150764]!==0x0)return!![];return![];});if(!_0x458291)continue;const _0x59fe0f=(_0x3d3ee9[_0x14d74f(0x8b)]||_0x14d74f(0xe4))['replace'](/[\\/:*?"<>|]/g,'_')+(_0x14d74f(0xa9)+(_0x448e3f+0x1)+_0x14d74f(0xe5));convertToGIF(_0x5b8a9c,animationDelay,_0x59fe0f),await new Promise(_0x29992d=>setTimeout(_0x29992d,0x78));}if(_0x4da6bd)_0x4da6bd['textContent']='';}async function exportLayersAsApng(){const _0x298aa9=a0_0x203104,_0x8a7d74=document[_0x298aa9(0x18a)]('layerExportStatus');if(_0x8a7d74)_0x8a7d74[_0x298aa9(0x217)]='Âá¶ÁêÜ‰∏≠...';const _0x60001f=getCurrentProject();if(!_0x60001f){if(_0x8a7d74)_0x8a7d74['textContent']='';return;}const _0x63fcb8=_0x60001f[_0x298aa9(0x1d7)],_0x86bd66=_0x60001f[_0x298aa9(0xc9)]*cellSize,_0x56f962=_0x60001f[_0x298aa9(0x112)]*cellSize;let _0x7439e0=0x0;_0x63fcb8[_0x298aa9(0x7f)](_0x11007a=>{const _0x60dbb=_0x298aa9;_0x7439e0=Math[_0x60dbb(0x19d)](_0x7439e0,_0x11007a['layers']['length']);});for(let _0xf8f331=0x0;_0xf8f331<_0x7439e0;_0xf8f331++){const _0x4db4f7=await Promise[_0x298aa9(0x83)](_0x63fcb8[_0x298aa9(0x113)](_0x3999d4=>{return new Promise(_0x4f98f0=>{const _0x53fdd2=a0_0x177c,_0x3f985b=document['createElement'](_0x53fdd2(0x224));_0x3f985b[_0x53fdd2(0xc9)]=_0x86bd66,_0x3f985b[_0x53fdd2(0x112)]=_0x56f962;const _0x1f8b7f=_0x3f985b[_0x53fdd2(0x1b9)]('2d');if(_0x3999d4[_0x53fdd2(0x12c)][_0xf8f331])_0x1f8b7f[_0x53fdd2(0x136)](_0x3999d4[_0x53fdd2(0x12c)][_0xf8f331],0x0,0x0);const _0x4c8aca=new Image();_0x4c8aca[_0x53fdd2(0x18f)]=()=>_0x4f98f0(_0x4c8aca),_0x4c8aca[_0x53fdd2(0x14c)]=_0x3f985b['toDataURL'](_0x53fdd2(0x180));});})),_0xa6e6ec=_0x4db4f7['some'](_0x4f768a=>{const _0x201151=_0x298aa9,_0x3a1090=document['createElement'](_0x201151(0x224));_0x3a1090[_0x201151(0xc9)]=_0x86bd66,_0x3a1090['height']=_0x56f962;const _0x39f261=_0x3a1090[_0x201151(0x1b9)]('2d');_0x39f261[_0x201151(0x136)](_0x4f768a,0x0,0x0);const _0x4c5fba=_0x39f261[_0x201151(0x125)](0x0,0x0,_0x86bd66,_0x56f962)[_0x201151(0x218)];for(let _0x1faf18=0x3;_0x1faf18<_0x4c5fba[_0x201151(0xa6)];_0x1faf18+=0x4)if(_0x4c5fba[_0x1faf18]!==0x0)return!![];return![];});if(!_0xa6e6ec)continue;const _0x510ea3=(_0x60001f['name']||'nezumi-animation')['replace'](/[\\/:*?"<>|]/g,'_')+(_0x298aa9(0xa9)+(_0xf8f331+0x1)+_0x298aa9(0xfd));convertToAPNG(_0x4db4f7,_0x86bd66,_0x56f962,animationDelay,_0x510ea3),await new Promise(_0xce2fba=>setTimeout(_0xce2fba,0x78));}if(_0x8a7d74)_0x8a7d74['textContent']='';}async function exportFramesLayersZip(){const _0x45fdcd=a0_0x203104,_0x55ca1d=document[_0x45fdcd(0x18a)](_0x45fdcd(0xdf));if(_0x55ca1d)_0x55ca1d[_0x45fdcd(0x217)]=_0x45fdcd(0x220);const _0x4016e6=getCurrentProject();if(!_0x4016e6){if(_0x55ca1d)_0x55ca1d['textContent']='';return;}const _0x56f7c7=_0x4016e6[_0x45fdcd(0x1d7)],_0x4ed78a=_0x4016e6[_0x45fdcd(0xc9)]*cellSize,_0x2fc9be=_0x4016e6[_0x45fdcd(0x112)]*cellSize,_0x2b8e5f=new JSZip();for(let _0x1df18c=0x0;_0x1df18c<_0x56f7c7['length'];_0x1df18c++){const _0x5f045d=_0x56f7c7[_0x1df18c],_0x30a0e0=_0x2b8e5f[_0x45fdcd(0x108)](_0x45fdcd(0x1fe)+(_0x1df18c+0x1));for(let _0x31a5e2=0x0;_0x31a5e2<_0x5f045d[_0x45fdcd(0x12c)][_0x45fdcd(0xa6)];_0x31a5e2++){const _0x3c55e3=document[_0x45fdcd(0x19b)](_0x45fdcd(0x224));_0x3c55e3[_0x45fdcd(0xc9)]=_0x4ed78a,_0x3c55e3[_0x45fdcd(0x112)]=_0x2fc9be;const _0x1dcfe3=_0x3c55e3[_0x45fdcd(0x1b9)]('2d');_0x1dcfe3[_0x45fdcd(0x1b1)](0x0,0x0,_0x4ed78a,_0x2fc9be);if(_0x5f045d[_0x45fdcd(0x12c)][_0x31a5e2])_0x1dcfe3[_0x45fdcd(0x136)](_0x5f045d[_0x45fdcd(0x12c)][_0x31a5e2],0x0,0x0);const _0x4d7c66=_0x3c55e3[_0x45fdcd(0x1d0)](_0x45fdcd(0x180)),_0x266d71=_0x4d7c66[_0x45fdcd(0x1f7)](',')[0x1],_0x2ef6ce=atob(_0x266d71),_0x3b8bf3=new Uint8Array(_0x2ef6ce[_0x45fdcd(0xa6)]);for(let _0x5c4725=0x0;_0x5c4725<_0x2ef6ce[_0x45fdcd(0xa6)];_0x5c4725++)_0x3b8bf3[_0x5c4725]=_0x2ef6ce['charCodeAt'](_0x5c4725);_0x30a0e0[_0x45fdcd(0x1ae)]('layer-'+(_0x31a5e2+0x1)+_0x45fdcd(0x1cd),_0x3b8bf3);}}const _0x46e7c3=await _0x2b8e5f[_0x45fdcd(0x1ff)]({'type':_0x45fdcd(0x225)}),_0x4d5467=(_0x4016e6['name']||'nezumi-export')[_0x45fdcd(0x177)](/[\\/:*?"<>|]/g,'_'),_0x157ba8=document['createElement']('a');_0x157ba8['href']=URL['createObjectURL'](_0x46e7c3),_0x157ba8[_0x45fdcd(0x1db)]=_0x4d5467+_0x45fdcd(0x12d),document[_0x45fdcd(0x1a8)][_0x45fdcd(0x207)](_0x157ba8),_0x157ba8[_0x45fdcd(0x1f5)](),setTimeout(()=>{const _0x2d8f43=_0x45fdcd;URL['revokeObjectURL'](_0x157ba8['href']),document[_0x2d8f43(0x1a8)][_0x2d8f43(0x129)](_0x157ba8);if(_0x55ca1d)_0x55ca1d[_0x2d8f43(0x217)]='';},0x4b0);}const dbName=a0_0x203104(0x140),storeName=a0_0x203104(0xf8);function openDB(){return new Promise((_0x344cc1,_0x303a4d)=>{const _0x15a8af=a0_0x177c,_0x5af62b=indexedDB[_0x15a8af(0x123)](dbName,0x1);_0x5af62b[_0x15a8af(0x21e)]=()=>{const _0x4b8f52=_0x15a8af;_0x5af62b[_0x4b8f52(0xbb)][_0x4b8f52(0x1a1)](storeName);},_0x5af62b['onsuccess']=()=>_0x344cc1(_0x5af62b[_0x15a8af(0xbb)]),_0x5af62b[_0x15a8af(0x102)]=()=>_0x303a4d(_0x5af62b[_0x15a8af(0x1ce)]);});}async function idbSet(_0x1d816f,_0x5a7e7d){const _0x11990b=await openDB();return new Promise((_0x258f90,_0x276b23)=>{const _0x5f47d7=a0_0x177c,_0x26ba51=_0x11990b[_0x5f47d7(0x1e3)](storeName,_0x5f47d7(0x88));_0x26ba51[_0x5f47d7(0xd3)](storeName)[_0x5f47d7(0x143)](_0x5a7e7d,_0x1d816f),_0x26ba51[_0x5f47d7(0x95)]=()=>_0x258f90(),_0x26ba51[_0x5f47d7(0x102)]=()=>_0x276b23(_0x26ba51[_0x5f47d7(0x1ce)]);});}async function idbGet(_0x3515d4){const _0x47236c=await openDB();return new Promise((_0x449bda,_0x167a57)=>{const _0x3a7b21=a0_0x177c,_0x118aae=_0x47236c['transaction'](storeName,_0x3a7b21(0x1a3)),_0x4ed1f5=_0x118aae[_0x3a7b21(0xd3)](storeName)[_0x3a7b21(0x1f2)](_0x3515d4);_0x4ed1f5[_0x3a7b21(0x20b)]=()=>_0x449bda(_0x4ed1f5[_0x3a7b21(0xbb)]),_0x4ed1f5[_0x3a7b21(0x102)]=()=>_0x167a57(_0x4ed1f5['error']);});}async function idbDelete(_0x316b6a){const _0x1398b6=await openDB();return new Promise((_0x264185,_0x5d89f1)=>{const _0x2d755d=a0_0x177c,_0x4cbaba=_0x1398b6[_0x2d755d(0x1e3)](storeName,'readwrite');_0x4cbaba[_0x2d755d(0xd3)](storeName)[_0x2d755d(0x11e)](_0x316b6a),_0x4cbaba[_0x2d755d(0x95)]=()=>_0x264185(),_0x4cbaba[_0x2d755d(0x102)]=()=>_0x5d89f1(_0x4cbaba['error']);});}async function idbClear(){const _0x150c84=await openDB();return new Promise((_0x34d565,_0x465f0f)=>{const _0x58c6cb=a0_0x177c,_0x5865c7=_0x150c84['transaction'](storeName,_0x58c6cb(0x88));_0x5865c7['objectStore'](storeName)[_0x58c6cb(0x193)](),_0x5865c7[_0x58c6cb(0x95)]=()=>_0x34d565(),_0x5865c7[_0x58c6cb(0x102)]=()=>_0x465f0f(_0x5865c7[_0x58c6cb(0x1ce)]);});}function saveProjectFile(){const _0x140a10=a0_0x203104,_0x442b57={'projects':projects[_0x140a10(0x113)](_0x4fbcb0=>({'width':_0x4fbcb0['width'],'height':_0x4fbcb0[_0x140a10(0x112)],'name':_0x4fbcb0[_0x140a10(0x8b)]||'','activeFrame':_0x4fbcb0[_0x140a10(0x183)],'frames':_0x4fbcb0[_0x140a10(0x1d7)][_0x140a10(0x113)](_0x243454=>({'activeLayer':_0x243454[_0x140a10(0x8a)],'layers':_0x243454[_0x140a10(0x12c)][_0x140a10(0x113)](_0x4058a3=>_0x4058a3['toDataURL']())}))})),'activeProject':activeProject},_0x503094=new Blob([JSON[_0x140a10(0xef)](_0x442b57)],{'type':_0x140a10(0x97)}),_0x4ac9d1=document['createElement']('a');_0x4ac9d1[_0x140a10(0x1db)]=_0x140a10(0x209),_0x4ac9d1[_0x140a10(0x205)]=URL[_0x140a10(0x116)](_0x503094),_0x4ac9d1['click']();}function saveProjectFile(){const _0x5373e3=a0_0x203104,_0x43a6a2={'projects':projects['map'](_0x1e1ad2=>({'width':_0x1e1ad2[_0x5373e3(0xc9)],'height':_0x1e1ad2[_0x5373e3(0x112)],'name':_0x1e1ad2[_0x5373e3(0x8b)]||'','activeFrame':_0x1e1ad2[_0x5373e3(0x183)],'frames':_0x1e1ad2[_0x5373e3(0x1d7)][_0x5373e3(0x113)](_0x11208d=>({'activeLayer':_0x11208d[_0x5373e3(0x8a)],'layers':_0x11208d['layers'][_0x5373e3(0x113)](_0x385758=>_0x385758[_0x5373e3(0x1d0)]())}))})),'activeProject':activeProject},_0x38406d=new Blob([JSON[_0x5373e3(0xef)](_0x43a6a2)],{'type':_0x5373e3(0x97)}),_0x2f461a=document[_0x5373e3(0x19b)]('a');_0x2f461a[_0x5373e3(0x1db)]='nezumi-sketch.msketch',_0x2f461a[_0x5373e3(0x205)]=URL[_0x5373e3(0x116)](_0x38406d),_0x2f461a['click']();}async function saveProjectToIDB(){const _0x4d0718=a0_0x203104,_0x1df0bd={'projects':projects['map'](_0x4dc4b6=>({'width':_0x4dc4b6[_0x4d0718(0xc9)],'height':_0x4dc4b6[_0x4d0718(0x112)],'name':_0x4dc4b6[_0x4d0718(0x8b)]||'','activeFrame':_0x4dc4b6[_0x4d0718(0x183)],'frames':_0x4dc4b6[_0x4d0718(0x1d7)][_0x4d0718(0x113)](_0x3ee972=>({'activeLayer':_0x3ee972[_0x4d0718(0x8a)],'layers':_0x3ee972['layers'][_0x4d0718(0x113)](_0x220d68=>_0x220d68[_0x4d0718(0x1d0)]())}))})),'activeProject':activeProject};try{await idbSet(_0x4d0718(0x1de),_0x1df0bd),console['log'](_0x4d0718(0x20e));}catch(_0x4d347d){console['error'](_0x4d0718(0x15a),_0x4d347d);}}setInterval(()=>{saveProjectToIDB();},0x2710),window[a0_0x203104(0xbc)](a0_0x203104(0x187),_0x4da3d9=>{saveProjectToIDB();});function loadProjectFile(_0x19d66d){const _0x5c36ba=a0_0x203104,_0x23e594=_0x19d66d['target'][_0x5c36ba(0x199)][0x0];if(!_0x23e594)return;if(_0x23e594[_0x5c36ba(0x138)]&&_0x23e594['type']['startsWith'](_0x5c36ba(0xd5))){loadStandaloneFromFile(_0x23e594)[_0x5c36ba(0x10b)](_0x2fabdf=>{const _0x4ca4e7=_0x5c36ba;alert(_0x4ca4e7(0x1d5)+(_0x2fabdf['name']||'ÁîªÂÉè'));})[_0x5c36ba(0x109)](_0x556b81=>{const _0x4fb847=_0x5c36ba;console[_0x4fb847(0x13e)](_0x556b81),alert('„Éï„Ç°„Ç§„É´„Å´„Éó„É≠„Ç∏„Çß„ÇØ„Éà„É°„Çø„Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇË™≠„ÅøËæº„Åø„Åß„Åç„Åæ„Åõ„Çì„ÄÇ');});return;}const _0x30aacc=new FileReader();_0x30aacc[_0x5c36ba(0x18f)]=function(_0xb09f82){const _0x44d5fc=_0x5c36ba;try{const _0x23b703=JSON['parse'](_0xb09f82[_0x44d5fc(0x1cc)][_0x44d5fc(0xbb)]);projects=_0x23b703[_0x44d5fc(0x1a0)][_0x44d5fc(0x113)]((_0xbf0d1c,_0x18f1cf)=>{const _0x485ce1=_0x44d5fc;let _0x233351=createProject(_0xbf0d1c['width'],_0xbf0d1c[_0x485ce1(0x112)],_0xbf0d1c[_0x485ce1(0x8b)]||'ÁîªÂÉè'+(_0x18f1cf+0x1));return _0x233351['frames']=_0xbf0d1c[_0x485ce1(0x1d7)][_0x485ce1(0x113)](_0x55749a=>{const _0x13994a=_0x485ce1;let _0x1226e5={'layers':[],'activeLayer':_0x55749a[_0x13994a(0x8a)],'layerHistories':[],'layerRedoStacks':[]};for(let _0x28b15f=0x0;_0x28b15f<_0x55749a[_0x13994a(0x12c)][_0x13994a(0xa6)];_0x28b15f++){let _0x852658=new Image();_0x852658['src']=_0x55749a[_0x13994a(0x12c)][_0x28b15f];let _0x365f97=document[_0x13994a(0x19b)](_0x13994a(0x224));_0x365f97[_0x13994a(0xc9)]=_0xbf0d1c[_0x13994a(0xc9)]*cellSize,_0x365f97[_0x13994a(0x112)]=_0xbf0d1c['height']*cellSize,_0x852658[_0x13994a(0x18f)]=()=>{const _0x436ba7=_0x13994a;let _0x1faf3a=_0x365f97[_0x436ba7(0x1b9)]('2d');_0x1faf3a[_0x436ba7(0x1b1)](0x0,0x0,_0x365f97[_0x436ba7(0xc9)],_0x365f97[_0x436ba7(0x112)]),_0x1faf3a['drawImage'](_0x852658,0x0,0x0);},_0x852658[_0x13994a(0x18f)](),_0x1226e5[_0x13994a(0x12c)][_0x13994a(0x11d)](_0x365f97),_0x1226e5[_0x13994a(0x98)][_0x13994a(0x11d)]([]),_0x1226e5['layerRedoStacks']['push']([]);}return _0x1226e5;}),_0x233351[_0x485ce1(0x183)]=_0xbf0d1c['activeFrame'],_0x233351[_0x485ce1(0x8b)]=_0xbf0d1c[_0x485ce1(0x8b)]||'ÁîªÂÉè'+(_0x18f1cf+0x1),_0x233351;}),activeProject=_0x23b703[_0x44d5fc(0xf5)]||0x0,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll();}catch(_0x4ff24f){alert(_0x44d5fc(0x1a4));}},_0x30aacc[_0x5c36ba(0x9d)](_0x23e594);}async function loadProjectFromIDB(){const _0x19c3e0=a0_0x203104;try{const _0x55616a=await idbGet(_0x19c3e0(0x1de));if(!_0x55616a)return;projects=_0x55616a[_0x19c3e0(0x1a0)][_0x19c3e0(0x113)]((_0x454b06,_0x29a964)=>{const _0x303448=_0x19c3e0;let _0x5749fa=createProject(_0x454b06[_0x303448(0xc9)],_0x454b06[_0x303448(0x112)],_0x454b06[_0x303448(0x8b)]||'ÁîªÂÉè'+(_0x29a964+0x1));return _0x5749fa[_0x303448(0x1d7)]=_0x454b06[_0x303448(0x1d7)][_0x303448(0x113)](_0x3ae585=>{const _0x392dd1=_0x303448;let _0xbeaf65={'layers':[],'activeLayer':_0x3ae585['activeLayer'],'layerHistories':[],'layerRedoStacks':[]};for(let _0x5cbc48=0x0;_0x5cbc48<_0x3ae585[_0x392dd1(0x12c)]['length'];_0x5cbc48++){let _0x24d3e2=new Image();_0x24d3e2[_0x392dd1(0x14c)]=_0x3ae585['layers'][_0x5cbc48];let _0x4072b4=document[_0x392dd1(0x19b)]('canvas');_0x4072b4[_0x392dd1(0xc9)]=_0x454b06[_0x392dd1(0xc9)]*cellSize,_0x4072b4[_0x392dd1(0x112)]=_0x454b06['height']*cellSize,_0x24d3e2[_0x392dd1(0x18f)]=()=>{const _0x51fc27=_0x392dd1;let _0x408bf4=_0x4072b4[_0x51fc27(0x1b9)]('2d');_0x408bf4['clearRect'](0x0,0x0,_0x4072b4[_0x51fc27(0xc9)],_0x4072b4['height']),_0x408bf4[_0x51fc27(0x136)](_0x24d3e2,0x0,0x0);},_0xbeaf65['layers'][_0x392dd1(0x11d)](_0x4072b4),_0xbeaf65['layerHistories'][_0x392dd1(0x11d)]([]),_0xbeaf65[_0x392dd1(0xf7)][_0x392dd1(0x11d)]([]);}return _0xbeaf65;}),_0x5749fa[_0x303448(0x183)]=_0x454b06['activeFrame'],_0x5749fa[_0x303448(0x8b)]=_0x454b06[_0x303448(0x8b)]||'ÁîªÂÉè'+(_0x29a964+0x1),_0x5749fa;}),activeProject=_0x55616a[_0x19c3e0(0xf5)]||0x0,await wait(0x64),updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll(),setTool('pen'),console[_0x19c3e0(0x191)](_0x19c3e0(0xcd));}catch(_0x36eb85){alert(_0x19c3e0(0x173)),console[_0x19c3e0(0x1ce)](_0x36eb85);}}function wait(_0xefdc4){return new Promise(_0x5b32ed=>setTimeout(_0x5b32ed,_0xefdc4));}function initCanvas(){const _0x1f951f=a0_0x203104,_0x255d9c=parseInt(0x10),_0xfdd6e3=parseInt(0x10);let _0x2e2a0c=getCurrentProject();_0x2e2a0c[_0x1f951f(0xc9)]=_0x255d9c,_0x2e2a0c[_0x1f951f(0x112)]=_0xfdd6e3,canvas[_0x1f951f(0xc9)]=_0x255d9c*cellSize,canvas[_0x1f951f(0x112)]=_0xfdd6e3*cellSize,_0x2e2a0c[_0x1f951f(0x12c)]=[],_0x2e2a0c['layerHistories']=[],_0x2e2a0c[_0x1f951f(0xf7)]=[];let _0x5d1998=document[_0x1f951f(0x19b)](_0x1f951f(0x224));_0x5d1998['width']=_0x255d9c*cellSize,_0x5d1998[_0x1f951f(0x112)]=_0xfdd6e3*cellSize,_0x2e2a0c['layers']['push'](_0x5d1998),_0x2e2a0c[_0x1f951f(0x98)]['push']([]),_0x2e2a0c['layerRedoStacks'][_0x1f951f(0x11d)]([]),_0x2e2a0c[_0x1f951f(0x8a)]=0x0,saveHistory(),updateFrameUI(),updateLayerUI(),redrawAll(),canvas['onmousedown']=null,canvas[_0x1f951f(0x14b)]=null,canvas[_0x1f951f(0x1ed)]=null,canvas['onmouseleave']=null,canvas[_0x1f951f(0x1c8)]=null,canvas[_0x1f951f(0x1ef)]=null,canvas['ontouchend']=null,canvas['ontouchcancel']=null,canvas[_0x1f951f(0xda)](_0x1f951f(0xe9),handleTouchStart),canvas[_0x1f951f(0xda)](_0x1f951f(0xe7),handleTouchMove),canvas[_0x1f951f(0xda)](_0x1f951f(0x21d),handleTouchEnd),canvas['removeEventListener'](_0x1f951f(0xfb),handleTouchEnd),canvas['onmousedown']=handleMouseDown,canvas['onmousemove']=handleMouseMove,canvas[_0x1f951f(0x1ed)]=handleMouseUp,canvas[_0x1f951f(0x11f)]=handleMouseUp,canvas[_0x1f951f(0x1c8)]=handleTouchStart,canvas['ontouchmove']=handleTouchMove,canvas[_0x1f951f(0x139)]=handleTouchEnd,canvas[_0x1f951f(0x1f4)]=handleTouchEnd,canvas['addEventListener'](_0x1f951f(0xe9),handleTouchStart,{'passive':![]}),canvas['addEventListener'](_0x1f951f(0xe7),handleTouchMove,{'passive':![]}),canvas['addEventListener']('touchend',handleTouchEnd,{'passive':![]}),canvas[_0x1f951f(0xbc)](_0x1f951f(0xfb),handleTouchEnd,{'passive':![]});}function createPalette(){const _0x43578f=a0_0x203104,_0x2411b6=document[_0x43578f(0x18a)](_0x43578f(0x12a));if(!_0x2411b6)return;_0x2411b6[_0x43578f(0xd4)]='',PALETTE_COLORS[_0x43578f(0x7f)]((_0x43fe44,_0x437c1c)=>{const _0x36f1ce=_0x43578f,_0xf1209f=document[_0x36f1ce(0x19b)](_0x36f1ce(0x19f));_0xf1209f[_0x36f1ce(0x1f8)]=_0x36f1ce(0x161);_0x43fe44===_0x36f1ce(0x178)||_0x43fe44===_0x36f1ce(0x1f9)?(_0xf1209f[_0x36f1ce(0x122)][_0x36f1ce(0xed)]='repeating-conic-gradient(#eee\x200%\x2025%,\x20#fff\x200%\x2050%)\x2050%\x20/\x2016px\x2016px',_0xf1209f[_0x36f1ce(0x10d)]='ÈÄèÊòé',_0xf1209f[_0x36f1ce(0xd4)]=_0x36f1ce(0xc3)):(_0xf1209f[_0x36f1ce(0x122)][_0x36f1ce(0xed)]=_0x43fe44,_0xf1209f['title']=_0x43fe44);_0xf1209f['onclick']=()=>{const _0x590e96=_0x36f1ce;currentColor=_0x43fe44,_0x43fe44===_0x590e96(0x178)||_0x43fe44===_0x590e96(0x1f9)?document[_0x590e96(0x18a)](_0x590e96(0x16d))['value']='#000000':document[_0x590e96(0x18a)](_0x590e96(0x16d))[_0x590e96(0x168)]=_0x43fe44,document[_0x590e96(0x10f)](_0x590e96(0xb0))[_0x590e96(0x7f)](_0x38874c=>_0x38874c[_0x590e96(0x18d)][_0x590e96(0x17a)](_0x590e96(0x128))),_0xf1209f[_0x590e96(0x18d)][_0x590e96(0x1df)](_0x590e96(0x128));};if(_0x437c1c!==0x0){const _0x47196e=document[_0x36f1ce(0x19b)](_0x36f1ce(0x157));_0x47196e['textContent']='√ó',_0x47196e[_0x36f1ce(0x1f8)]=_0x36f1ce(0x16b),_0x47196e['title']='„Åì„ÅÆËâ≤„Çí„Éë„É¨„ÉÉ„Éà„Åã„ÇâÂâäÈô§',_0x47196e[_0x36f1ce(0x8d)]=_0x47e6e2=>{const _0x362df5=_0x36f1ce;_0x47e6e2[_0x362df5(0x192)](),PALETTE_COLORS[_0x362df5(0xa6)]>0x2&&(PALETTE_COLORS[_0x362df5(0x100)](_0x437c1c,0x1),createPalette());},_0xf1209f['appendChild'](_0x47196e);}_0x2411b6[_0x36f1ce(0x207)](_0xf1209f);});const _0xc185e=document[_0x43578f(0x19b)](_0x43578f(0x19f));_0xc185e[_0x43578f(0x1f8)]=_0x43578f(0x15e),_0xc185e[_0x43578f(0x10d)]=_0x43578f(0x182),_0xc185e[_0x43578f(0xd4)]='+',_0xc185e[_0x43578f(0x8d)]=_0x33eb15=>{const _0x59193a=_0x43578f;_0x33eb15['stopPropagation']();const _0xe28117=document[_0x59193a(0x19b)](_0x59193a(0x142));_0xe28117[_0x59193a(0x138)]=_0x59193a(0xb4),_0xe28117[_0x59193a(0x122)][_0x59193a(0xa0)]=_0x59193a(0x17f);let _0x1a45e5=![];_0xe28117[_0x59193a(0x162)]=_0x4a4e51=>{const _0x4448b3=_0x59193a;if(!_0x1a45e5){PALETTE_COLORS['unshift'](_0x4a4e51[_0x4448b3(0x1cc)]['value']);if(PALETTE_COLORS[_0x4448b3(0xa6)]>0x18)PALETTE_COLORS=PALETTE_COLORS[_0x4448b3(0x163)](0x0,0x18);savePaletteToDB(),createPalette(),_0x1a45e5=!![],_0xe28117[_0x4448b3(0x17a)]();}},_0xe28117[_0x59193a(0xbc)](_0x59193a(0x1eb),()=>{const _0x49c470=_0x59193a;if(!_0x1a45e5)_0xe28117[_0x49c470(0x17a)]();}),_0xe28117[_0x59193a(0xbc)](_0x59193a(0x1f5),_0x325ae6=>_0x325ae6[_0x59193a(0x192)]()),document[_0x59193a(0x1a8)][_0x59193a(0x207)](_0xe28117),_0xe28117[_0x59193a(0x197)](),_0xe28117['click']();},_0x2411b6[_0x43578f(0x15d)](_0xc185e,_0x2411b6[_0x43578f(0x111)]);let _0x27f024=document[_0x43578f(0x18a)](_0x43578f(0x215));!_0x27f024&&(_0x27f024=document[_0x43578f(0x19b)]('div'),_0x27f024['id']=_0x43578f(0x215),_0x27f024[_0x43578f(0x1f8)]=_0x43578f(0x215),_0x2411b6[_0x43578f(0xff)][_0x43578f(0x207)](_0x27f024)),_0x27f024['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22tool-btn'+(currentTool===_0x43578f(0x14f)?_0x43578f(0x1bc):'')+_0x43578f(0x1a7)+(currentTool==='eraser'?'\x20active':'')+_0x43578f(0xba)+(currentTool===_0x43578f(0x1b8)?_0x43578f(0x1bc):'')+_0x43578f(0xc2)+(penSize==0x1?_0x43578f(0x1a9):'')+_0x43578f(0x1ac)+(penSize==0x2?_0x43578f(0x1a9):'')+_0x43578f(0xee)+(penSize==0x3?_0x43578f(0x1a9):'')+_0x43578f(0x1f0)+(penSize==0x4?_0x43578f(0x1a9):'')+_0x43578f(0x214)+(penMode===_0x43578f(0x16c)?'\x20selected':'')+'>ÂõõËßí„Éö„É≥</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22circle\x22'+(penMode==='circle'?_0x43578f(0x1a9):'')+'>‰∏∏„Éö„É≥</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22margin-left:8px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ÈÄèÊòéÂ∫¶:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22range\x22\x20id=\x22palette-alphaSlider\x22\x20min=\x220\x22\x20max=\x22100\x22\x20value=\x22'+Math[_0x43578f(0x206)](currentAlpha*0x64)+_0x43578f(0x174)+Math[_0x43578f(0x206)](currentAlpha*0x64)+_0x43578f(0x8c),_0x27f024[_0x43578f(0x1e0)]('#palette-penSize')[_0x43578f(0x90)]=_0x2f4920=>setPenSize(_0x2f4920['target']['value']),_0x27f024[_0x43578f(0x1e0)](_0x43578f(0x179))[_0x43578f(0x90)]=_0x229f55=>setPenMode(_0x229f55[_0x43578f(0x1cc)][_0x43578f(0x168)]),_0x27f024[_0x43578f(0x10f)](_0x43578f(0x1c3))[_0x43578f(0x7f)](_0x15ae64=>{const _0x546328=_0x43578f;_0x15ae64[_0x546328(0x8d)]=()=>setTool(_0x15ae64[_0x546328(0x1c7)][_0x546328(0x1ad)]);}),_0x27f024[_0x43578f(0x1e0)](_0x43578f(0x1d1))[_0x43578f(0x162)]=_0x2ce257=>{const _0x34c746=_0x43578f;setAlpha(_0x2ce257['target'][_0x34c746(0x168)]),_0x27f024[_0x34c746(0x1e0)](_0x34c746(0x221))['textContent']=_0x2ce257[_0x34c746(0x1cc)][_0x34c746(0x168)]+'%';let _0x313075=document[_0x34c746(0x18a)](_0x34c746(0x1ec)),_0xfc19d1=document[_0x34c746(0x18a)](_0x34c746(0x1e7));if(_0x313075)_0x313075[_0x34c746(0x168)]=_0x2ce257[_0x34c746(0x1cc)][_0x34c746(0x168)];if(_0xfc19d1)_0xfc19d1['textContent']=_0x2ce257[_0x34c746(0x1cc)][_0x34c746(0x168)]+'%';};}function setAlpha(_0x1d23c8){const _0xd68eee=a0_0x203104;let _0x237edf=Math[_0xd68eee(0x19d)](0x0,Math[_0xd68eee(0x154)](0x64,parseInt(_0x1d23c8,0xa)||0x0));currentAlpha=_0x237edf/0x64;let _0x4754de=document[_0xd68eee(0x18a)](_0xd68eee(0x1ec)),_0x4d4db6=document[_0xd68eee(0x18a)](_0xd68eee(0x1e7));if(_0x4754de)_0x4754de[_0xd68eee(0x168)]=_0x237edf;if(_0x4d4db6)_0x4d4db6['textContent']=_0x237edf+'%';let _0x246d5a=document['getElementById']('palette-alphaSlider'),_0x257cd9=document['getElementById']('palette-alphaValue');if(_0x246d5a)_0x246d5a[_0xd68eee(0x168)]=_0x237edf;if(_0x257cd9)_0x257cd9[_0xd68eee(0x217)]=_0x237edf+'%';}async function savePaletteToDB(){const _0x28b5d5=a0_0x203104;try{await idbSet(_0x28b5d5(0x223),PALETTE_COLORS);}catch(_0x4f7bf6){console[_0x28b5d5(0x1ce)](_0x28b5d5(0x96),_0x4f7bf6);}}async function loadPaletteFromDB(){const _0x367c8d=a0_0x203104;try{const _0x55f3cb=await idbGet(_0x367c8d(0x223));Array['isArray'](_0x55f3cb)&&_0x55f3cb[_0x367c8d(0xa6)]&&(PALETTE_COLORS=_0x55f3cb);}catch(_0x4c3983){console[_0x367c8d(0x1ce)](_0x367c8d(0x1d8),_0x4c3983);}}document[a0_0x203104(0xbc)]('DOMContentLoaded',()=>{const _0x237fa2=a0_0x203104,_0x5cbaa7=document[_0x237fa2(0x18a)](_0x237fa2(0x16d));_0x5cbaa7&&(_0x5cbaa7['oninput']=_0x2f6e=>{const _0x19ad94=_0x237fa2;currentColor=_0x2f6e[_0x19ad94(0x1cc)][_0x19ad94(0x168)],document['querySelectorAll']('.palette-color')[_0x19ad94(0x7f)](_0x575617=>_0x575617[_0x19ad94(0x18d)][_0x19ad94(0x17a)](_0x19ad94(0x128)));});const _0x10f1bf=document[_0x237fa2(0x18a)](_0x237fa2(0x1ec)),_0x35fb17=document['getElementById'](_0x237fa2(0x1e7));_0x10f1bf&&_0x35fb17&&(_0x10f1bf['oninput']=_0x3699dc=>{const _0x6e3e65=_0x237fa2;setAlpha(_0x3699dc[_0x6e3e65(0x1cc)]['value']),_0x35fb17[_0x6e3e65(0x217)]=_0x3699dc[_0x6e3e65(0x1cc)][_0x6e3e65(0x168)]+'%';let _0x57a4c0=document[_0x6e3e65(0x18a)](_0x6e3e65(0x147)),_0xd2f3ba=document[_0x6e3e65(0x18a)]('palette-alphaValue');if(_0x57a4c0)_0x57a4c0['value']=_0x3699dc[_0x6e3e65(0x1cc)][_0x6e3e65(0x168)];if(_0xd2f3ba)_0xd2f3ba[_0x6e3e65(0x217)]=_0x3699dc[_0x6e3e65(0x1cc)][_0x6e3e65(0x168)]+'%';});const _0x9b9295=document[_0x237fa2(0x18a)](_0x237fa2(0x1bf));_0x9b9295&&(_0x9b9295[_0x237fa2(0x8d)]=()=>{const _0x480a1a=_0x237fa2,_0x4c0e39=document['getElementById'](_0x480a1a(0x1ba));if(!_0x4c0e39)return;if(_0x4c0e39[_0x480a1a(0x122)][_0x480a1a(0xa0)]===_0x480a1a(0xa4)){_0x4c0e39[_0x480a1a(0x122)][_0x480a1a(0xa0)]=_0x480a1a(0x17f);return;}const _0xa5968d=scanImageColors();renderScanPanel(_0xa5968d),_0x4c0e39[_0x480a1a(0x122)][_0x480a1a(0xa0)]='block';});const _0xda4473=document['getElementById']('copyLayerBtn'),_0x75725c=document[_0x237fa2(0x18a)](_0x237fa2(0xfe)),_0xac8ada=document[_0x237fa2(0x18a)](_0x237fa2(0xa8)),_0x1c7096=document['getElementById'](_0x237fa2(0x11b)),_0x216ca2=document[_0x237fa2(0x18a)](_0x237fa2(0x13a)),_0x5f1d00=document[_0x237fa2(0x18a)]('nudgeDownBtn'),_0x139759=document[_0x237fa2(0x18a)]('nudgeLeftBtn'),_0x20d73d=document['getElementById'](_0x237fa2(0x12e)),_0x1a4d06=document[_0x237fa2(0x18a)](_0x237fa2(0x1fa));if(_0xda4473)_0xda4473[_0x237fa2(0x8d)]=()=>{copyLayer();};if(_0x75725c)_0x75725c['onclick']=()=>{pasteLayer();};if(_0x75725c)_0x75725c['disabled']=!copiedLayerDataUrl;if(_0xac8ada)_0xac8ada[_0x237fa2(0x8d)]=()=>{exportLayersAsGif();};if(_0x1c7096)_0x1c7096[_0x237fa2(0x8d)]=()=>{exportLayersAsApng();};if(_0x216ca2)_0x216ca2[_0x237fa2(0x8d)]=()=>{const _0x5ef8e1=_0x237fa2;nudgeActiveLayer(0x0,-parseInt(_0x1a4d06[_0x5ef8e1(0x168)]||0x1,0xa));};if(_0x5f1d00)_0x5f1d00['onclick']=()=>{const _0x564833=_0x237fa2;nudgeActiveLayer(0x0,parseInt(_0x1a4d06[_0x564833(0x168)]||0x1,0xa));};if(_0x139759)_0x139759[_0x237fa2(0x8d)]=()=>{nudgeActiveLayer(-parseInt(_0x1a4d06['value']||0x1,0xa),0x0);};if(_0x20d73d)_0x20d73d[_0x237fa2(0x8d)]=()=>{const _0x256424=_0x237fa2;nudgeActiveLayer(parseInt(_0x1a4d06[_0x256424(0x168)]||0x1,0xa),0x0);};document[_0x237fa2(0xbc)]('click',_0x16eb16=>{const _0x254e96=_0x237fa2,_0x3c806c=document[_0x254e96(0x18a)](_0x254e96(0x1ba)),_0x1e478c=document[_0x254e96(0x18a)](_0x254e96(0x1bf));if(!_0x3c806c||!_0x1e478c)return;_0x3c806c['style']['display']==='block'&&!_0x3c806c['contains'](_0x16eb16[_0x254e96(0x1cc)])&&_0x16eb16['target']!==_0x1e478c&&(_0x3c806c[_0x254e96(0x122)][_0x254e96(0xa0)]=_0x254e96(0x17f));}),function _0x2b0eaa(){const _0x311ab5=_0x237fa2,_0x461c43=document['getElementById']('exportFramesZipBtn');if(typeof JSZip!==_0x311ab5(0x115)){if(_0x461c43)_0x461c43[_0x311ab5(0x13f)]=![];return;}const _0x46745c=document[_0x311ab5(0x19b)](_0x311ab5(0x127));_0x46745c['src']=_0x311ab5(0x166),_0x46745c[_0x311ab5(0x18f)]=()=>{const _0x2dd43f=_0x311ab5;console[_0x2dd43f(0x1d2)](_0x2dd43f(0x208));if(_0x461c43)_0x461c43[_0x2dd43f(0x13f)]=![];},_0x46745c[_0x311ab5(0x102)]=()=>{const _0x34d9e5=_0x311ab5;console[_0x34d9e5(0x13e)]('Failed\x20to\x20load\x20JSZip\x20from\x20CDN;\x20ZIP\x20export\x20will\x20be\x20disabled.'),_0x461c43&&(_0x461c43[_0x34d9e5(0x13f)]=!![],_0x461c43[_0x34d9e5(0x10d)]=_0x34d9e5(0x1a6));},document[_0x311ab5(0x94)][_0x311ab5(0x207)](_0x46745c);}();let _0x30ee60={'active':![],'startCell':null,'offsetCells':{'x':0x0,'y':0x0}};document[_0x237fa2(0xbc)]('keydown',_0x493426=>{const _0x4d46b2=_0x237fa2,_0x39630b=_0x493426['target'],_0x13892a=_0x39630b&&(_0x39630b[_0x4d46b2(0xd8)]===_0x4d46b2(0x1d6)||_0x39630b[_0x4d46b2(0xd8)]===_0x4d46b2(0x216)||_0x39630b[_0x4d46b2(0x196)]);if(!_0x13892a){const _0x59153f=_0x493426['ctrlKey']||_0x493426[_0x4d46b2(0x126)];if(_0x59153f&&(_0x493426['key']==='z'||_0x493426[_0x4d46b2(0x1f3)]==='Z')){_0x493426[_0x4d46b2(0x1e5)]();_0x493426[_0x4d46b2(0xac)]?redo():undo();return;}if(_0x59153f&&(_0x493426[_0x4d46b2(0x1f3)]==='y'||_0x493426['key']==='Y')){_0x493426[_0x4d46b2(0x1e5)](),redo();return;}}if(currentTool==='moveLayer'){const _0x2241b5=(_0x493426[_0x4d46b2(0xac)]?0x5:0x1)*(parseInt(_0x1a4d06?_0x1a4d06[_0x4d46b2(0x168)]:0x1,0xa)||0x1);if(_0x493426[_0x4d46b2(0x1f3)]==='ArrowLeft')_0x493426[_0x4d46b2(0x1e5)](),nudgeActiveLayer(-_0x2241b5,0x0);else{if(_0x493426['key']===_0x4d46b2(0xeb))_0x493426[_0x4d46b2(0x1e5)](),nudgeActiveLayer(_0x2241b5,0x0);else{if(_0x493426['key']===_0x4d46b2(0x8f))_0x493426['preventDefault'](),nudgeActiveLayer(0x0,-_0x2241b5);else _0x493426[_0x4d46b2(0x1f3)]==='ArrowDown'&&(_0x493426[_0x4d46b2(0x1e5)](),nudgeActiveLayer(0x0,_0x2241b5));}}}}),function _0x597a85(){const _0x3049aa=_0x237fa2,_0x3c5703=document[_0x3049aa(0x18a)](_0x3049aa(0x148));if(typeof JSZip!==_0x3049aa(0x115)){if(_0x3c5703)_0x3c5703[_0x3049aa(0x13f)]=![];return;}const _0x9a614c=document[_0x3049aa(0x19b)](_0x3049aa(0x127));_0x9a614c[_0x3049aa(0x14c)]=_0x3049aa(0x166),_0x9a614c[_0x3049aa(0x18f)]=()=>{const _0x3891da=_0x3049aa;if(_0x3c5703)_0x3c5703[_0x3891da(0x13f)]=![];},_0x9a614c[_0x3049aa(0x102)]=()=>{const _0x5134b7=_0x3049aa;_0x3c5703&&(_0x3c5703[_0x5134b7(0x13f)]=!![],_0x3c5703[_0x5134b7(0x10d)]=_0x5134b7(0x1a6));},document['head']['appendChild'](_0x9a614c);}();});function shiftLayerCanvas(_0x2edb65,_0x41e527,_0x4a9fd5){const _0x376aa2=a0_0x203104;if(!_0x2edb65)return;const _0xefedd2=_0x2edb65[_0x376aa2(0xc9)],_0x1bd9fc=_0x2edb65[_0x376aa2(0x112)],_0x15d70a=document['createElement'](_0x376aa2(0x224));_0x15d70a[_0x376aa2(0xc9)]=_0xefedd2,_0x15d70a[_0x376aa2(0x112)]=_0x1bd9fc;const _0x838aee=_0x15d70a['getContext']('2d');_0x838aee[_0x376aa2(0x1b1)](0x0,0x0,_0xefedd2,_0x1bd9fc),_0x838aee[_0x376aa2(0x136)](_0x2edb65,0x0,0x0);const _0x5f0da6=_0x2edb65[_0x376aa2(0x1b9)]('2d');_0x5f0da6[_0x376aa2(0x1b1)](0x0,0x0,_0xefedd2,_0x1bd9fc),_0x5f0da6[_0x376aa2(0x136)](_0x15d70a,_0x41e527,_0x4a9fd5);}function nudgeActiveLayer(_0x44d971,_0x4540cc){const _0x5ac370=a0_0x203104,_0x5dd242=getCurrentProject();if(!_0x5dd242)return;const _0x1b38da=getCurrentFrame();if(!_0x1b38da)return;const _0x20566b=_0x1b38da[_0x5ac370(0x8a)];if(_0x20566b==null)return;const _0x4ccb60=(_0x44d971||0x0)*cellSize,_0x56f095=(_0x4540cc||0x0)*cellSize;if(_0x4ccb60===0x0&&_0x56f095===0x0)return;saveHistory(),shiftLayerCanvas(_0x1b38da[_0x5ac370(0x12c)][_0x20566b],_0x4ccb60,_0x56f095),redrawAll();}function startLayerMove(_0x36b8d6){const _0x864f1e=a0_0x203104;layerMoveState['active']=!![];const _0x44724e=getCanvasCoords(_0x36b8d6);layerMoveState['startCell']={'x':Math['floor'](_0x44724e['x']/cellSize),'y':Math[_0x864f1e(0x137)](_0x44724e['y']/cellSize)},layerMoveState[_0x864f1e(0x89)]={'x':0x0,'y':0x0};}function updateLayerMove(_0x1f004c){const _0x2db48b=a0_0x203104;if(!layerMoveState['active'])return;const _0x76aba0=getCanvasCoords(_0x1f004c),_0x79d80={'x':Math[_0x2db48b(0x137)](_0x76aba0['x']/cellSize),'y':Math[_0x2db48b(0x137)](_0x76aba0['y']/cellSize)};layerMoveState[_0x2db48b(0x89)]['x']=_0x79d80['x']-layerMoveState[_0x2db48b(0x170)]['x'],layerMoveState['offsetCells']['y']=_0x79d80['y']-layerMoveState['startCell']['y'],redrawAll();const _0x472a96=getCurrentFrame();if(!_0x472a96)return;const _0x39c875=_0x472a96[_0x2db48b(0x8a)];if(_0x39c875==null)return;ctx[_0x2db48b(0xbe)](),ctx[_0x2db48b(0x86)](layerMoveState[_0x2db48b(0x89)]['x']*cellSize,layerMoveState['offsetCells']['y']*cellSize),ctx[_0x2db48b(0x136)](_0x472a96[_0x2db48b(0x12c)][_0x39c875],0x0,0x0),ctx[_0x2db48b(0x20c)]();}function endLayerMove(_0x4b7fea){const _0x4aa5c0=a0_0x203104;if(!layerMoveState['active'])return;const _0x578df9=layerMoveState[_0x4aa5c0(0x89)]['x']*cellSize,_0x49e8a3=layerMoveState[_0x4aa5c0(0x89)]['y']*cellSize;if(_0x578df9!==0x0||_0x49e8a3!==0x0){saveHistory();const _0x59533c=getCurrentFrame();_0x59533c&&typeof _0x59533c[_0x4aa5c0(0x8a)]===_0x4aa5c0(0x9e)&&shiftLayerCanvas(_0x59533c[_0x4aa5c0(0x12c)][_0x59533c[_0x4aa5c0(0x8a)]],_0x578df9,_0x49e8a3);}layerMoveState[_0x4aa5c0(0x169)]=![],layerMoveState[_0x4aa5c0(0x170)]=null,layerMoveState[_0x4aa5c0(0x89)]={'x':0x0,'y':0x0},redrawAll();}const origHandleMouseDown=handleMouseDown;handleMouseDown=function(_0x42cb97){if(currentTool==='moveLayer'){startLayerMove(_0x42cb97);return;}origHandleMouseDown(_0x42cb97);};const origHandleMouseMove=handleMouseMove;handleMouseMove=function(_0x22f50c){const _0x14c9df=a0_0x203104;if(currentTool===_0x14c9df(0x210)){updateLayerMove(_0x22f50c);return;}origHandleMouseMove(_0x22f50c);};const origHandleMouseUp=handleMouseUp;handleMouseUp=function(_0x7bb073){if(currentTool==='moveLayer'){endLayerMove(_0x7bb073);return;}origHandleMouseUp(_0x7bb073);};function scanImageColors(){const _0x380c46=a0_0x203104,_0x3a14e5=getCurrentProject(),_0x4ab70b=getCurrentFrame();if(!_0x3a14e5||!_0x4ab70b)return[];const _0x236c26=new Map(),_0x170944=_0x3a14e5[_0x380c46(0xc9)],_0x56199d=_0x3a14e5[_0x380c46(0x112)];for(let _0x491605=0x0;_0x491605<_0x56199d;_0x491605++){for(let _0x381a6e=0x0;_0x381a6e<_0x170944;_0x381a6e++){const _0x63999f=Math[_0x380c46(0x154)](Math[_0x380c46(0x137)](_0x381a6e*cellSize+cellSize/0x2),canvas[_0x380c46(0xc9)]-0x1),_0x747b8b=Math[_0x380c46(0x154)](Math['floor'](_0x491605*cellSize+cellSize/0x2),canvas[_0x380c46(0x112)]-0x1),_0x559ba1=ctx['getImageData'](_0x63999f,_0x747b8b,0x1,0x1)['data'],_0x50a995=_0x559ba1[0x0]+','+_0x559ba1[0x1]+','+_0x559ba1[0x2]+','+_0x559ba1[0x3];_0x236c26['set'](_0x50a995,(_0x236c26[_0x380c46(0x1f2)](_0x50a995)||0x0)+0x1);}}const _0x4866f9=Array['from'](_0x236c26[_0x380c46(0x1fb)]())[_0x380c46(0x113)](([_0x1f3aa2,_0x14941f])=>{const _0x313685=_0x380c46,[_0x53c8c4,_0x1bf426,_0x11952d,_0x57a6f3]=_0x1f3aa2[_0x313685(0x1f7)](',')[_0x313685(0x113)](_0x44e59c=>parseInt(_0x44e59c,0xa));return{'r':_0x53c8c4,'g':_0x1bf426,'b':_0x11952d,'a':_0x57a6f3,'count':_0x14941f};})[_0x380c46(0x11a)]((_0x5bb38b,_0x2c729a)=>_0x2c729a[_0x380c46(0x151)]-_0x5bb38b[_0x380c46(0x151)]);return _0x4866f9;}function renderScanPanel(_0x16e1a2){const _0x15ee82=a0_0x203104,_0x3d2257=document[_0x15ee82(0x18a)](_0x15ee82(0x1ba));if(!_0x3d2257)return;_0x3d2257['innerHTML']='';if(!_0x16e1a2||_0x16e1a2['length']===0x0){_0x3d2257['textContent']=_0x15ee82(0x167);return;}const _0x2f79af=document[_0x15ee82(0x19b)](_0x15ee82(0x18e));_0x2f79af['className']='used-color-grid',_0x16e1a2[_0x15ee82(0x7f)](_0x23fbfc=>{const _0x2e44d2=_0x15ee82,_0x440853=document[_0x2e44d2(0x19b)](_0x2e44d2(0x18e));_0x440853[_0x2e44d2(0x1f8)]=_0x2e44d2(0xf6);const _0x4fe4fb=document[_0x2e44d2(0x19b)]('div');_0x4fe4fb[_0x2e44d2(0x1f8)]=_0x2e44d2(0x1ee);_0x23fbfc['a']===0x0?_0x4fe4fb[_0x2e44d2(0x18d)][_0x2e44d2(0x1df)](_0x2e44d2(0x82)):_0x4fe4fb[_0x2e44d2(0x122)]['background']=_0x2e44d2(0xb1)+_0x23fbfc['r']+','+_0x23fbfc['g']+','+_0x23fbfc['b']+','+(_0x23fbfc['a']/0xff)[_0x2e44d2(0xce)](0x2)+')';const _0x57c7ec=document['createElement']('div');_0x57c7ec[_0x2e44d2(0x1f8)]=_0x2e44d2(0x198),_0x57c7ec[_0x2e44d2(0x217)]=_0x23fbfc['a']===0x0?'ÈÄèÊòé':_0x23fbfc['a']===0xff?rgbaToHex(_0x23fbfc['r'],_0x23fbfc['g'],_0x23fbfc['b']):_0x2e44d2(0xb1)+_0x23fbfc['r']+','+_0x23fbfc['g']+','+_0x23fbfc['b']+','+(_0x23fbfc['a']/0xff)['toFixed'](0x2)+')';const _0x2ee9a9=document[_0x2e44d2(0x19b)](_0x2e44d2(0x18e));_0x2ee9a9[_0x2e44d2(0x1f8)]=_0x2e44d2(0xcc),_0x2ee9a9[_0x2e44d2(0x217)]=_0x23fbfc[_0x2e44d2(0x151)]+'„Çª„É´',_0x440853[_0x2e44d2(0x207)](_0x4fe4fb),_0x440853[_0x2e44d2(0x207)](_0x57c7ec),_0x440853['appendChild'](_0x2ee9a9),_0x440853['onclick']=()=>{const _0x40c436=_0x2e44d2;if(_0x23fbfc['a']===0x0){currentColor=_0x40c436(0x178);const _0x3543e9=document['getElementById'](_0x40c436(0x16d));if(_0x3543e9)_0x3543e9[_0x40c436(0x168)]=_0x40c436(0x14a);setAlpha(0x0);}else{currentColor=rgbaToHex(_0x23fbfc['r'],_0x23fbfc['g'],_0x23fbfc['b']);const _0x5037a8=document[_0x40c436(0x18a)]('colorPicker');if(_0x5037a8)_0x5037a8[_0x40c436(0x168)]=currentColor;setAlpha(Math[_0x40c436(0x206)](_0x23fbfc['a']/0xff*0x64));}_0x3d2257[_0x40c436(0x122)]['display']='none';},_0x2f79af[_0x2e44d2(0x207)](_0x440853);}),_0x3d2257[_0x15ee82(0x207)](_0x2f79af);}function rgbaToHex(_0x5033e9,_0x551542,_0x196ce5){const _0x5c3593=a0_0x203104;return'#'+[_0x5033e9,_0x551542,_0x196ce5][_0x5c3593(0x113)](_0x415e56=>_0x415e56[_0x5c3593(0x188)](0x10)[_0x5c3593(0x7e)](0x2,'0'))[_0x5c3593(0xfa)]('');}async function convertToGIF(_0x31af48,_0xbc27a6=0xc8,_0x55bbbf='nezumi-animation.gif'){const _0x272633=a0_0x203104,_0x54dd48=new window[(_0x272633(0x1fd))]({'workers':0x2,'quality':0xa,'workerScript':_0x272633(0x1c0)});_0x31af48['forEach'](_0x3b3070=>_0x54dd48[_0x272633(0xc8)](_0x3b3070,{'delay':_0xbc27a6})),_0x54dd48['on'](_0x272633(0x119),_0x20bdc8=>{const _0xdace17=_0x272633,_0x50bbeb=URL[_0xdace17(0x116)](_0x20bdc8),_0x158ed8=document[_0xdace17(0x19b)]('a');_0x158ed8[_0xdace17(0x205)]=_0x50bbeb,_0x158ed8[_0xdace17(0x1db)]=_0x55bbbf,document['body']['appendChild'](_0x158ed8),_0x158ed8[_0xdace17(0x1f5)](),setTimeout(()=>{const _0x4b9e5f=_0xdace17;document[_0x4b9e5f(0x1a8)][_0x4b9e5f(0x129)](_0x158ed8),URL[_0x4b9e5f(0x1fc)](_0x50bbeb);},0x3e8);}),_0x54dd48['render']();}function makeAPNGBlob(_0x2fd633,_0x3d4c79,_0x566624,_0xc5351c=0xc8){const _0x2920a7=a0_0x203104,_0x384088=[],_0x5b0a33=[],_0x11ac5b=document[_0x2920a7(0x19b)](_0x2920a7(0x224));_0x11ac5b[_0x2920a7(0xc9)]=_0x3d4c79,_0x11ac5b['height']=_0x566624;const _0x2e407a=_0x11ac5b[_0x2920a7(0x1b9)]('2d');_0x2fd633[_0x2920a7(0x7f)](_0x23fb9f=>{const _0x1f7cf5=_0x2920a7;_0x2e407a[_0x1f7cf5(0x1b1)](0x0,0x0,_0x3d4c79,_0x566624),_0x2e407a[_0x1f7cf5(0x136)](_0x23fb9f,0x0,0x0,_0x3d4c79,_0x566624);const _0x5d4a9e=_0x2e407a[_0x1f7cf5(0x125)](0x0,0x0,_0x3d4c79,_0x566624)[_0x1f7cf5(0x218)][_0x1f7cf5(0x19a)];_0x384088['push'](_0x5d4a9e),_0x5b0a33[_0x1f7cf5(0x11d)](_0xc5351c);});const _0x423085=window[_0x2920a7(0x1b5)][_0x2920a7(0x19e)](_0x384088,_0x3d4c79,_0x566624,0x0,_0x5b0a33);return new Blob([_0x423085],{'type':_0x2920a7(0x13b)});}function convertToAPNG(_0x53ce04,_0x36b644,_0x83c05e,_0x4c7cbc=0xc8,_0x10ae1b=a0_0x203104(0xa1)){const _0x1f9d83=a0_0x203104,_0x1441ac=makeAPNGBlob(_0x53ce04,_0x36b644,_0x83c05e,_0x4c7cbc),_0x399a6b=URL['createObjectURL'](_0x1441ac),_0x259b67=document['createElement']('a');_0x259b67[_0x1f9d83(0x205)]=_0x399a6b,_0x259b67[_0x1f9d83(0x1db)]=_0x10ae1b,document[_0x1f9d83(0x1a8)][_0x1f9d83(0x207)](_0x259b67),_0x259b67['click'](),setTimeout(()=>{const _0x4c8bbd=_0x1f9d83;document[_0x4c8bbd(0x1a8)]['removeChild'](_0x259b67),URL['revokeObjectURL'](_0x399a6b);},0x3e8);}async function loadImages(_0x598af0){const _0x1d382f=a0_0x203104,_0x1b9e7a=await Promise[_0x1d382f(0x83)](_0x598af0['map'](_0x24ba7b=>{return new Promise(_0x43de50=>{const _0x36da88=a0_0x177c,_0x25d6f8=new Image();_0x25d6f8['crossOrigin']='anonymous',_0x25d6f8[_0x36da88(0x14c)]=_0x24ba7b,_0x25d6f8[_0x36da88(0x18f)]=()=>_0x43de50(_0x25d6f8);});}));return _0x1b9e7a;}function exportSpriteSheetDialog(){const _0x1b39e3=a0_0x203104;let _0x43946c=prompt(_0x1b39e3(0x171),'1');if(_0x43946c===null)return;let _0x4bcdf3=Math[_0x1b39e3(0x19d)](0x1,parseInt(_0x43946c,0xa)||0x1),_0x36f069=prompt(_0x1b39e3(0x15b),'0');if(_0x36f069===null)return;let _0x5063cd=Math[_0x1b39e3(0x19d)](0x0,parseInt(_0x36f069,0xa)||0x0);exportSpriteSheet(_0x4bcdf3,_0x5063cd);}function exportSpriteSheet(_0x1dacb7=0x1,_0x49cf1f=0x0){const _0x12bc70=a0_0x203104,_0xbd07ad=getCurrentProject();if(!_0xbd07ad){alert(_0x12bc70(0x1ab));return;}const _0x14207e=_0xbd07ad['frames'];if(!_0x14207e||_0x14207e[_0x12bc70(0xa6)]===0x0){alert(_0x12bc70(0xe8));return;}const _0x246dbe=_0xbd07ad['width']*cellSize,_0x1b3bac=_0xbd07ad[_0x12bc70(0x112)]*cellSize,_0x5271e1=_0x246dbe*_0x14207e[_0x12bc70(0xa6)]*_0x1dacb7+Math[_0x12bc70(0x19d)](0x0,_0x14207e['length']-0x1)*_0x49cf1f,_0x11867b=_0x1b3bac*_0x1dacb7,_0x334b22=document['createElement']('canvas');_0x334b22[_0x12bc70(0xc9)]=_0x5271e1,_0x334b22['height']=_0x11867b;const _0x27469b=_0x334b22[_0x12bc70(0x1b9)]('2d');_0x27469b['clearRect'](0x0,0x0,_0x334b22[_0x12bc70(0xc9)],_0x334b22[_0x12bc70(0x112)]);let _0x176e4e=0x0;for(let _0x547336=0x0;_0x547336<_0x14207e[_0x12bc70(0xa6)];_0x547336++){let _0x7a1d32=document['createElement'](_0x12bc70(0x224));_0x7a1d32[_0x12bc70(0xc9)]=_0x246dbe,_0x7a1d32[_0x12bc70(0x112)]=_0x1b3bac;let _0x272404=_0x7a1d32[_0x12bc70(0x1b9)]('2d');for(let _0x530ba0=0x0;_0x530ba0<_0x14207e[_0x547336]['layers'][_0x12bc70(0xa6)];_0x530ba0++){_0x272404['drawImage'](_0x14207e[_0x547336][_0x12bc70(0x12c)][_0x530ba0],0x0,0x0);}_0x1dacb7===0x1&&_0x49cf1f===0x0?(_0x27469b[_0x12bc70(0x136)](_0x7a1d32,_0x176e4e,0x0),_0x176e4e+=_0x246dbe):(_0x27469b[_0x12bc70(0x136)](_0x7a1d32,0x0,0x0,_0x246dbe,_0x1b3bac,_0x176e4e,0x0,_0x246dbe*_0x1dacb7,_0x1b3bac*_0x1dacb7),_0x176e4e+=_0x246dbe*_0x1dacb7),_0x547336<_0x14207e[_0x12bc70(0xa6)]-0x1&&_0x49cf1f>0x0&&(_0x176e4e+=_0x49cf1f);}const _0x4c0477=(_0xbd07ad[_0x12bc70(0x8b)]||_0x12bc70(0x1af))[_0x12bc70(0x177)](/[\\/:*?"<>|]/g,'_'),_0x4a125e=document[_0x12bc70(0x19b)]('a');_0x4a125e[_0x12bc70(0x205)]=_0x334b22['toDataURL'](_0x12bc70(0x180)),_0x4a125e[_0x12bc70(0x1db)]=_0x4c0477+_0x12bc70(0xd9),document[_0x12bc70(0x1a8)]['appendChild'](_0x4a125e),_0x4a125e[_0x12bc70(0x1f5)](),setTimeout(()=>{const _0x43707f=_0x12bc70;document['body'][_0x43707f(0x129)](_0x4a125e);},0x3e8);}const NEZUMI_METADATA_SIG=a0_0x203104(0x1c9);function appendMetadataToBlob(_0x537665,_0x10910b){const _0xfec999=a0_0x203104,_0x580382=new TextEncoder(),_0x4acc5d=_0x580382[_0xfec999(0x19e)](NEZUMI_METADATA_SIG),_0x50a43d=_0x580382['encode'](JSON['stringify'](_0x10910b));return new Blob([_0x537665,_0x4acc5d,_0x50a43d],{'type':_0x537665[_0xfec999(0x138)]||_0xfec999(0xad)});}function indexOfSubarray(_0x3ef713,_0x5bcfc6){const _0x2f1e24=a0_0x203104;for(let _0x4dec2c=0x0;_0x4dec2c<=_0x3ef713['length']-_0x5bcfc6[_0x2f1e24(0xa6)];_0x4dec2c++){let _0x397c77=!![];for(let _0xb2e256=0x0;_0xb2e256<_0x5bcfc6[_0x2f1e24(0xa6)];_0xb2e256++){if(_0x3ef713[_0x4dec2c+_0xb2e256]!==_0x5bcfc6[_0xb2e256]){_0x397c77=![];break;}}if(_0x397c77)return _0x4dec2c;}return-0x1;}function extractMetadataFromArrayBuffer(_0xb78a49){const _0x1eada9=a0_0x203104,_0x4b9887=new TextEncoder()[_0x1eada9(0x19e)](NEZUMI_METADATA_SIG),_0x2fb54c=new Uint8Array(_0xb78a49),_0x5c9b34=indexOfSubarray(_0x2fb54c,_0x4b9887);if(_0x5c9b34===-0x1)return null;const _0x3fcc8b=_0x2fb54c[_0x1eada9(0x13c)](_0x5c9b34+_0x4b9887[_0x1eada9(0xa6)]);try{const _0x1268d3=new TextDecoder()[_0x1eada9(0xab)](_0x3fcc8b);return JSON[_0x1eada9(0x133)](_0x1268d3);}catch(_0x23daa4){return null;}}async function exportStandalone(){const _0x5ce2cf=a0_0x203104;let _0x3bf537=getCurrentProject(),_0x57d163=_0x3bf537[_0x5ce2cf(0x1d7)],_0x56b4cc=_0x3bf537[_0x5ce2cf(0xc9)]*cellSize,_0x1f3ec4=_0x3bf537['height']*cellSize;const _0x39c65a=_0x57d163[_0x5ce2cf(0x113)](_0x30a94b=>{const _0x536ba9=_0x5ce2cf;let _0x32dc8f=document[_0x536ba9(0x19b)](_0x536ba9(0x224));_0x32dc8f[_0x536ba9(0xc9)]=_0x56b4cc,_0x32dc8f[_0x536ba9(0x112)]=_0x1f3ec4;let _0x42bc37=_0x32dc8f[_0x536ba9(0x1b9)]('2d');for(let _0x521ac7=0x0;_0x521ac7<_0x30a94b['layers'][_0x536ba9(0xa6)];_0x521ac7++){_0x42bc37[_0x536ba9(0x136)](_0x30a94b[_0x536ba9(0x12c)][_0x521ac7],0x0,0x0);}let _0x18dbc7=new Image();return _0x18dbc7[_0x536ba9(0x14c)]=_0x32dc8f['toDataURL'](_0x536ba9(0x180)),_0x18dbc7;});await Promise['all'](_0x39c65a[_0x5ce2cf(0x113)](_0x50f3ea=>new Promise(_0x1dd0f9=>{const _0x3c9b7b=_0x5ce2cf;_0x50f3ea[_0x3c9b7b(0x18f)]=_0x1dd0f9;})))['catch'](()=>{});const _0x457232=(_0x3bf537[_0x5ce2cf(0x8b)]||_0x5ce2cf(0xe4))[_0x5ce2cf(0x177)](/[\\/:*?"<>|]/g,'_'),_0x59b53f=makeAPNGBlob(_0x39c65a,_0x56b4cc,_0x1f3ec4,animationDelay),_0x23ab7c={'type':_0x5ce2cf(0xca),'version':0x1,'project':{'width':_0x3bf537[_0x5ce2cf(0xc9)],'height':_0x3bf537[_0x5ce2cf(0x112)],'name':_0x3bf537['name']||'','activeFrame':_0x3bf537[_0x5ce2cf(0x183)],'frames':_0x3bf537[_0x5ce2cf(0x1d7)][_0x5ce2cf(0x113)](_0xba3aba=>({'activeLayer':_0xba3aba['activeLayer'],'layers':_0xba3aba[_0x5ce2cf(0x12c)][_0x5ce2cf(0x113)](_0x4e6bff=>_0x4e6bff[_0x5ce2cf(0x1d0)]())}))}},_0x4fa505=appendMetadataToBlob(_0x59b53f,_0x23ab7c),_0x3688e2=URL['createObjectURL'](_0x4fa505),_0xb4897c=document[_0x5ce2cf(0x19b)]('a');_0xb4897c[_0x5ce2cf(0x205)]=_0x3688e2,_0xb4897c['download']=_0x457232+_0x5ce2cf(0xfd),document[_0x5ce2cf(0x1a8)]['appendChild'](_0xb4897c),_0xb4897c[_0x5ce2cf(0x1f5)](),setTimeout(()=>{const _0xa0c1b5=_0x5ce2cf;document[_0xa0c1b5(0x1a8)]['removeChild'](_0xb4897c),URL[_0xa0c1b5(0x1fc)](_0x3688e2);},0x3e8);}function loadStandaloneFromFile(_0x4b0146){return new Promise((_0x10a59e,_0x346c0a)=>{const _0x1a8940=a0_0x177c,_0x285900=new FileReader();_0x285900['onload']=_0x3e2b4c=>{const _0x5ec407=a0_0x177c,_0x4d3abf=_0x3e2b4c[_0x5ec407(0x1cc)][_0x5ec407(0xbb)],_0x2ffd33=extractMetadataFromArrayBuffer(_0x4d3abf);if(!_0x2ffd33||!_0x2ffd33[_0x5ec407(0x9a)]){_0x346c0a(new Error('„É°„Çø„Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü'));return;}const _0x3dcb5a=_0x2ffd33[_0x5ec407(0x9a)];try{const _0x43fd6f=createProject(_0x3dcb5a['width'],_0x3dcb5a[_0x5ec407(0x112)],_0x3dcb5a[_0x5ec407(0x8b)]||'ÁîªÂÉè');_0x43fd6f[_0x5ec407(0x1d7)]=_0x3dcb5a[_0x5ec407(0x1d7)][_0x5ec407(0x113)](_0x2c5150=>{const _0x30dc9f=_0x5ec407;let _0x1bb13b={'layers':[],'activeLayer':_0x2c5150[_0x30dc9f(0x8a)],'layerHistories':[],'layerRedoStacks':[]};for(let _0x4779d1=0x0;_0x4779d1<_0x2c5150[_0x30dc9f(0x12c)]['length'];_0x4779d1++){let _0x53ee04=new Image();_0x53ee04[_0x30dc9f(0x14c)]=_0x2c5150[_0x30dc9f(0x12c)][_0x4779d1];let _0x573402=document['createElement'](_0x30dc9f(0x224));_0x573402[_0x30dc9f(0xc9)]=_0x3dcb5a[_0x30dc9f(0xc9)]*cellSize,_0x573402[_0x30dc9f(0x112)]=_0x3dcb5a[_0x30dc9f(0x112)]*cellSize,_0x53ee04[_0x30dc9f(0x18f)]=()=>{const _0x558fac=_0x30dc9f;let _0x4fd054=_0x573402[_0x558fac(0x1b9)]('2d');_0x4fd054[_0x558fac(0x1b1)](0x0,0x0,_0x573402[_0x558fac(0xc9)],_0x573402[_0x558fac(0x112)]),_0x4fd054[_0x558fac(0x136)](_0x53ee04,0x0,0x0);},_0x1bb13b[_0x30dc9f(0x12c)][_0x30dc9f(0x11d)](_0x573402);}return _0x1bb13b;}),projects['push'](_0x43fd6f),activeProject=projects[_0x5ec407(0xa6)]-0x1,updateProjectUI(),updateFrameUI(),updateLayerUI(),redrawAll(),_0x10a59e(_0x43fd6f);}catch(_0x9a1811){_0x346c0a(_0x9a1811);}},_0x285900[_0x1a8940(0x102)]=_0x38f878=>_0x346c0a(_0x38f878),_0x285900[_0x1a8940(0x21f)](_0x4b0146);});}function a0_0x51a3(){const _0x2d3050=['.apng','pasteLayerBtn','parentNode','splice','setPointerCapture','onerror','#444444','matches','119096sMTHiD','closePath','zoomSlider','folder','catch','constructor','then','touchAction','title','strokeStyle','querySelectorAll','‰∏ä„Å´ÁßªÂãï','firstChild','height','map','#newProjW','undefined','createObjectURL','(((.+)+)+)+$','100vw','finished','sort','exportLayerApngBtn','.section.collapsible\x20.toggle-btn','push','delete','onmouseleave','pop','rgba(0,0,0,0.3)','style','open','touch','getImageData','metaKey','script','selected','removeChild','color-palette','getAttribute','layers','-frames-layers.zip','nudgeRightBtn','trim','menu-toggle-btn-close','layer-btn','destination-out','parse','palette-penSize','287kseMmE','drawImage','floor','type','ontouchend','nudgeUpBtn','image/apng','subarray','px,\x20','warn','disabled','nezumi-sketch-db','#000080','input','put','pathname','putImageData','resize','palette-alphaSlider','exportFramesZipBtn','main-container','#000000','onmousemove','src','fixed','filter','pen','setItem','count','#ffffff','light','min','nezumi-drawing','jpg','span','#008000','matchMedia','‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åü„ÉÅ„É•„Éº:','„Éï„É¨„Éº„É†Èñì„ÅÆ‰ΩôÁôΩ(px)\x20„ÇíÊåáÂÆöÔºà‰æã:\x200Ôºâ','#ff69b4','insertBefore','palette-add-btn','cursor','byteLength','palette-color','oninput','slice','flex','#00ffff','https://cdn.jsdelivr.net/npm/jszip@3.10.0/dist/jszip.min.js','Ëâ≤„ÅØË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü','value','active','webp','palette-del-btn','square','colorPicker','sidebar-open','dark','startCell','„Çπ„Éó„É©„Ç§„Éà„Ç∑„Éº„Éà„ÅÆÊã°Â§ßÁéá„ÇíÊåáÂÆöÔºà‰æã:\x201\x20=\x20ÂÖÉ„Çµ„Ç§„Ç∫,\x202\x20=\x202ÂÄçÔºâ','hypot','IndexedDB„Åã„Çâ„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åü„ÉÅ„É•„Éº‚Ä¶','\x22\x20style=\x22vertical-align:\x20middle;\x20width:70px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22palette-alphaValue\x22>','grab','documentElement','replace','transparent','#palette-penMode','remove','onkeydown','globalAlpha','#newProjOkBtn','deltaY','none','image/png','image/jpeg','„Éë„É¨„ÉÉ„Éà„Å´Ëâ≤„ÇíËøΩÂä†','activeFrame','16844448JQCKPV','.webm','#808000','beforeunload','toString','Enter','getElementById','project-btn','pointerup','classList','div','onload','themeToggleBtn','log','stopPropagation','clear','top','apply','isContentEditable','focus','used-color-label','files','buffer','createElement','4wcUWle','max','encode','button','projects','createObjectStore','video/webm','readonly','„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ','auto','ZIP„Ç®„ÇØ„Çπ„Éù„Éº„Éà„ÅØÂà©Áî®„Åß„Åç„Åæ„Åõ„ÇìÔºà„É©„Ç§„Éñ„É©„É™Ë™≠„ÅøËæº„Åø„Å´Â§±ÊïóÔºâ','\x22\x20data-tool=\x22pen\x22\x20onclick=\x22setTool(\x27pen\x27)\x22><span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>edit</span>„Éö„É≥</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22tool-btn','body','\x20selected','frame-item','„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Åå„ÅÇ„Çä„Åæ„Åõ„Çì','>1</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x222\x22','tool','file','nezumi-spritesheet','#0000ff','clearRect','wheel','penSize','#ff0000','UPNG','project-name-edit','100%','fill','getContext','scanColorsPanel','Âá¶ÁêÜ‰∏≠...','\x20active','GIF„Å´Â§âÊèõ„Åß„Åç„ÇãÁîªÂÉè„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ','touches','scanColorsBtn','lib/gif.worker.js','setAttribute','position','.tool-btn','beginPath','some','#ccc','dataset','ontouchstart','\x0a---NEZUMI_METADATA_START---\x0a','/about?terms=true','aria-pressed','target','.png','error','pan','toDataURL','#palette-alphaSlider','info','isFinite','center','„Çπ„Çø„É≥„Éâ„Ç¢„É≠„É≥ÂΩ¢Âºè„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü:\x20','INPUT','frames','Ë™≠Ëæº„Ç®„É©„Éº','new-project-dialog','#newProjCancelBtn','download','clientY','fillRect','nezumi-sketch-save','add','querySelector','VideoEncoder','getItem','transaction','layer-thumb','preventDefault','hidden','alphaValue','image/','keydown','menu-toggle-btn','blur','alphaSlider','onmouseup','used-color-swatch','ontouchmove','>3</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x224\x22','frameList','get','key','ontouchcancel','click','.toggle-btn','split','className','#00000000','nudgeStep','entries','revokeObjectURL','GIF','frame-','generateAsync','eraser','clientX','pointerId','project-item','toggle','href','round','appendChild','Loaded\x20JSZip\x20fallback\x20from\x20jsDelivr','nezumi-sketch.msketch','alignItems','onsuccess','restore','#newProjName','„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíIndexedDB„Å´‰øùÂ≠ò„Åó„Åü„ÉÅ„É•„ÉºÔºÅ','6CrezVF','moveLayer','pointerdown','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22background:#fff;\x20border-radius:10px;\x20box-shadow:0\x202px\x2016px\x20#0003;\x20padding:28px\x2032px;\x20min-width:240px;\x20text-align:center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:0;\x22>Êñ∞„Åó„ÅÑÁîªÂÉè„ÅÆ„Çµ„Ç§„Ç∫</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:12px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>ÂêçÂâç:\x20<input\x20id=\x22newProjName\x22\x20type=\x22text\x22\x20maxlength=\x2232\x22\x20value=\x22ÁîªÂÉè','/index.html','>4</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</select>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22margin-left:8px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22palette-penMode\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x22square\x22','palette-toolbar','TEXTAREA','textContent','data','abs','text','„ÉÄ„Éº„ÇØ„ÉÜ„Éº„Éû„Å´ÂàáÊõø','pointermove','touchend','onupgradeneeded','readAsArrayBuffer','ZIP‰ΩúÊàê‰∏≠...','#palette-alphaValue','jpeg','nezumi-palette','canvas','blob','fillStyle','(prefers-color-scheme:\x20dark)','„Åì„ÅÆ„Éñ„É©„Ç¶„Ç∂„ÅØWebCodecs„Å´„Çà„ÇãWEBP„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„Å´ÂØæÂøú„Åó„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ','padStart','forEach','arc','moveTo','transparent-swatch','all','circle','grabbing','translate','sidebar','readwrite','offsetCells','activeLayer','name','%</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22undo()\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>undo</span>\x20Êàª„Åô\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22redo()\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>redo</span>\x20Êàª„Åô„ÇíÊàª„Åô\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','onclick','projectCount','ArrowUp','onchange','palette-penMode','contains','#ff00ff','head','oncomplete','‰øùÂ≠ò„Ç®„É©„Éº','application/json','layerHistories','313153hNcelI','project','Shift','#888888','readAsText','number','nezumi_about_visited','display','nezumi-animation.apng','projectList','nezumi-projects','block','„Åì„ÅÆ„É¨„Ç§„É§„Éº„ÇíÂâäÈô§','length','configure','exportLayerGifBtn','-layer','80px','decode','shiftKey','application/octet-stream','nezumi-theme','left','.palette-color','rgba(','search','crosshair','color','#800080','1920677ILnKNU','1907814SlMgBJ','project-name','38810iMUlGT','\x22\x20data-tool=\x22eraser\x22\x20onclick=\x22setTool(\x27eraser\x27)\x22><span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>delete</span>Ê∂à„Åó„Ç¥„É†</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22tool-btn','result','addEventListener','getBoundingClientRect','save','lineTo','67635jFlNAv','isArray','\x22\x20data-tool=\x22fill\x22\x20onclick=\x22setTool(\x27fill\x27)\x22><span\x20class=\x22material-icons\x22\x20style=\x22vertical-align:\x20middle;\x22>format_color_fill</span>Â°ó„Çä„Å§„Å∂„Åó</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22margin-left:8px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Â§™„Åï:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<select\x20id=\x22palette-penSize\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x221\x22','<span\x20style=\x22font-size:13px;color:#888;\x22>ÈÄèÊòé</span>','stroke','select','.section-content','close','addFrame','width','nezumi-standalone','2fuQXJp','used-color-count','IndexedDB„Åã„Çâ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíË™≠„ÅøËæº„Çì„Å†„ÉÅ„É•„ÉºÔºÅ','toFixed','#800000','#008080','DOMContentLoaded','frameCount','objectStore','innerHTML','image','pointerType','justifyContent','tagName','_spritesheet.png','removeEventListener','„É¨„Ç§„É§„Éº','innerWidth','overflow','„É©„Ç§„Éà„ÉÜ„Éº„Éû„Å´ÂàáÊõø','layerExportStatus','3000','#c0c0c0','\x22\x20style=\x22width:120px;\x22></label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:12px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>ÂπÖ:\x20<input\x20id=\x22newProjW\x22\x20type=\x22number\x22\x20min=\x221\x22\x20max=\x22256\x22\x20value=\x2216\x22\x20style=\x22width:60px;\x22></label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22margin-left:12px;\x22>È´ò„Åï:\x20<input\x20id=\x22newProjH\x22\x20type=\x22number\x22\x20min=\x221\x22\x20max=\x22256\x22\x20value=\x2216\x22\x20style=\x22width:60px;\x22></label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22newProjOkBtn\x22>‰ΩúÊàê</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22newProjCancelBtn\x22\x20style=\x22margin-left:12px;\x22>„Ç≠„É£„É≥„Çª„É´</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','100vh','nezumi-animation','.gif','onblur','touchmove','„Éï„É¨„Éº„É†„Åå„ÅÇ„Çä„Åæ„Åõ„Çì','touchstart','transform','ArrowRight','layer-item','background','>2</option>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<option\x20value=\x223\x22','stringify','match','penMode','9baAzCN','„Ç≥„Éû)','animSpeedValue','activeProject','used-color-item','layerRedoStacks','keyval','zoomValue','join','touchcancel','.section.collapsible\x20.section-content'];a0_0x51a3=function(){return _0x2d3050;};return a0_0x51a3();}function toggleSection(_0x19974e){const _0x34b1c3=a0_0x203104,_0x1499bb=document[_0x34b1c3(0x18a)](_0x19974e),_0x20ded6=_0x1499bb[_0x34b1c3(0x1e0)](_0x34b1c3(0xc6)),_0x2aff33=_0x1499bb[_0x34b1c3(0x1e0)](_0x34b1c3(0x1f6));_0x20ded6[_0x34b1c3(0x122)][_0x34b1c3(0xa0)]==='none'?(_0x20ded6[_0x34b1c3(0x122)][_0x34b1c3(0xa0)]='',_0x2aff33[_0x34b1c3(0x217)]='‚ñº'):(_0x20ded6[_0x34b1c3(0x122)][_0x34b1c3(0xa0)]='none',_0x2aff33[_0x34b1c3(0x217)]='‚ñ≤');}document[a0_0x203104(0xbc)](a0_0x203104(0xd1),()=>{const _0x2f5d7d=a0_0x203104;document['querySelectorAll'](_0x2f5d7d(0xfc))['forEach'](_0x3fa803=>_0x3fa803[_0x2f5d7d(0x122)][_0x2f5d7d(0xa0)]=''),document[_0x2f5d7d(0x10f)](_0x2f5d7d(0x11c))[_0x2f5d7d(0x7f)](_0x498d9c=>_0x498d9c[_0x2f5d7d(0x217)]='‚ñº');}),window[a0_0x203104(0xbc)](a0_0x203104(0x146),updateMenuBtnDisplay),document['addEventListener']('DOMContentLoaded',updateMenuBtnDisplay);function toggleSideMenu(_0x4502bd){const _0x3823ca=a0_0x203104,_0x3c887b=document[_0x3823ca(0x18a)]('sidebar'),_0x37a9cc=document[_0x3823ca(0x18a)](_0x3823ca(0x149)),_0x3d0440=document[_0x3823ca(0x18a)]('menu-toggle-btn'),_0x5c2c62=document[_0x3823ca(0x18a)]('menu-toggle-btn-close'),_0x124ef4=_0x3c887b[_0x3823ca(0x18d)][_0x3823ca(0x92)](_0x3823ca(0x123));let _0xf24f49=typeof _0x4502bd==='boolean'?_0x4502bd:!_0x124ef4;_0xf24f49?(_0x3c887b[_0x3823ca(0x18d)][_0x3823ca(0x1df)]('open'),_0x37a9cc['classList']['add'](_0x3823ca(0x16e)),document[_0x3823ca(0x1a8)][_0x3823ca(0x122)][_0x3823ca(0xdd)]=_0x3823ca(0x1e6),document[_0x3823ca(0x1a8)][_0x3823ca(0x122)][_0x3823ca(0x10c)]=_0x3823ca(0x17f),window[_0x3823ca(0xdc)]<=0x384&&(_0x5c2c62[_0x3823ca(0x122)][_0x3823ca(0xa0)]=_0x3823ca(0xa4),_0x3d0440[_0x3823ca(0x122)][_0x3823ca(0xa0)]=_0x3823ca(0x17f))):(_0x3c887b[_0x3823ca(0x18d)]['remove']('open'),_0x37a9cc[_0x3823ca(0x18d)][_0x3823ca(0x17a)](_0x3823ca(0x16e)),document[_0x3823ca(0x1a8)]['style'][_0x3823ca(0xdd)]='',document[_0x3823ca(0x1a8)]['style']['touchAction']='',window[_0x3823ca(0xdc)]<=0x384&&(_0x5c2c62[_0x3823ca(0x122)][_0x3823ca(0xa0)]=_0x3823ca(0x17f),_0x3d0440[_0x3823ca(0x122)]['display']=_0x3823ca(0xa4)));}function updateMenuBtnDisplay(){const _0x165e23=a0_0x203104,_0x5271ed=document[_0x165e23(0x18a)](_0x165e23(0x87)),_0x5c6f21=document[_0x165e23(0x18a)]('main-container'),_0x531666=document[_0x165e23(0x18a)](_0x165e23(0x1ea)),_0x3f5faa=document[_0x165e23(0x18a)](_0x165e23(0x130));window['innerWidth']>0x384?(_0x5271ed[_0x165e23(0x18d)][_0x165e23(0x17a)](_0x165e23(0x123)),_0x5c6f21[_0x165e23(0x18d)][_0x165e23(0x17a)](_0x165e23(0x16e)),_0x3f5faa[_0x165e23(0x122)][_0x165e23(0xa0)]=_0x165e23(0x17f),_0x531666[_0x165e23(0x122)][_0x165e23(0xa0)]=_0x165e23(0x17f),document[_0x165e23(0x1a8)][_0x165e23(0x122)][_0x165e23(0xdd)]='',document[_0x165e23(0x1a8)][_0x165e23(0x122)][_0x165e23(0x10c)]=''):_0x5271ed['classList']['contains']('open')?(_0x3f5faa[_0x165e23(0x122)]['display']=_0x165e23(0xa4),_0x531666['style'][_0x165e23(0xa0)]='none'):(_0x3f5faa['style']['display']='none',_0x531666['style']['display']=_0x165e23(0xa4));}document[a0_0x203104(0xbc)](a0_0x203104(0x1f5),function(_0xf16d58){const _0x22bf52=a0_0x203104;if(window[_0x22bf52(0xdc)]>0x384)return;const _0x43bd53=document[_0x22bf52(0x18a)]('sidebar'),_0x260364=document[_0x22bf52(0x18a)](_0x22bf52(0x149)),_0x3c5368=document[_0x22bf52(0x18a)](_0x22bf52(0x1ea)),_0x5618e8=document[_0x22bf52(0x18a)](_0x22bf52(0x130));!_0x43bd53[_0x22bf52(0x92)](_0xf16d58[_0x22bf52(0x1cc)])&&_0xf16d58[_0x22bf52(0x1cc)]!==_0x3c5368&&_0xf16d58[_0x22bf52(0x1cc)]!==_0x5618e8&&(_0x43bd53['classList'][_0x22bf52(0x17a)]('open'),_0x260364[_0x22bf52(0x18d)]['remove'](_0x22bf52(0x16e)),_0x5618e8[_0x22bf52(0x122)]['display']=_0x22bf52(0x17f),_0x3c5368[_0x22bf52(0x122)][_0x22bf52(0xa0)]='block',document[_0x22bf52(0x1a8)][_0x22bf52(0x122)][_0x22bf52(0xdd)]='',document[_0x22bf52(0x1a8)][_0x22bf52(0x122)]['touchAction']='');}),(function(){const _0x2fb9fb=a0_0x203104;try{(location[_0x2fb9fb(0x144)][_0x2fb9fb(0xf0)](/index\.html$/)||location[_0x2fb9fb(0x144)]==='/'||location[_0x2fb9fb(0x144)]===_0x2fb9fb(0x213))&&(!localStorage['getItem'](_0x2fb9fb(0x9f))&&(localStorage[_0x2fb9fb(0x150)]('nezumi_about_visited','1'),location[_0x2fb9fb(0x205)]=_0x2fb9fb(0x1ca)));}catch(_0x509cdc){}}());let scale=0x1,posX=0x0,posY=0x0,lastX=0x0,lastY=0x0,dragging=![],startX=0x0,startY=0x0,shiftPressed=![],pointerDownX=0x0,pointerDownY=0x0;const PAN_CANCEL_DISTANCE=0x8;document[a0_0x203104(0xbc)](a0_0x203104(0x1e9),_0x493555=>{const _0x17d2fe=a0_0x203104;if(_0x493555[_0x17d2fe(0x1f3)]===_0x17d2fe(0x9b))shiftPressed=!![];}),document[a0_0x203104(0xbc)]('keyup',_0x241077=>{const _0x341fe5=a0_0x203104;if(_0x241077[_0x341fe5(0x1f3)]===_0x341fe5(0x9b))shiftPressed=![];}),canvas[a0_0x203104(0xbc)](a0_0x203104(0x211),_0x1964a2=>{const _0x3c8898=a0_0x203104;if(_0x1964a2[_0x3c8898(0xd6)]==='touch')return;currentTool===_0x3c8898(0x1cf)||shiftPressed?(dragging=!![],isDrawing=![],startX=_0x1964a2[_0x3c8898(0x201)],startY=_0x1964a2[_0x3c8898(0x1dc)],lastX=posX,lastY=posY,canvas[_0x3c8898(0x101)](_0x1964a2['pointerId']),canvas[_0x3c8898(0x122)]['cursor']=_0x3c8898(0x85)):(isDrawing=!![],pointerDownX=_0x1964a2[_0x3c8898(0x201)],pointerDownY=_0x1964a2[_0x3c8898(0x1dc)],handleMouseDown(_0x1964a2),canvas[_0x3c8898(0x101)](_0x1964a2[_0x3c8898(0x202)]));}),canvas[a0_0x203104(0xbc)](a0_0x203104(0x21c),_0x5b91c4=>{const _0x5354a8=a0_0x203104;if(_0x5b91c4[_0x5354a8(0xd6)]===_0x5354a8(0x124))return;if(dragging)posX=lastX+(_0x5b91c4[_0x5354a8(0x201)]-startX),posY=lastY+(_0x5b91c4[_0x5354a8(0x1dc)]-startY),updateTransform();else{if(isDrawing){if(currentTool!=='pen'){const _0x1b06d9=Math[_0x5354a8(0x219)](_0x5b91c4[_0x5354a8(0x201)]-pointerDownX),_0x48bfb3=Math[_0x5354a8(0x219)](_0x5b91c4[_0x5354a8(0x1dc)]-pointerDownY);if(_0x1b06d9>=PAN_CANCEL_DISTANCE||_0x48bfb3>=PAN_CANCEL_DISTANCE){isDrawing=![];try{handleMouseUp(_0x5b91c4);}catch(_0x3b5e26){}return;}}handleMouseMove(_0x5b91c4);}}}),canvas[a0_0x203104(0xbc)](a0_0x203104(0x18c),_0x4a8327=>{const _0x201c77=a0_0x203104;if(_0x4a8327[_0x201c77(0xd6)]===_0x201c77(0x124))return;dragging=![];isDrawing&&handleMouseUp(_0x4a8327);isDrawing=![];try{canvas['releasePointerCapture'](_0x4a8327[_0x201c77(0x202)]);}catch(_0x3a4965){}if(currentTool===_0x201c77(0x1cf))canvas['style'][_0x201c77(0x15f)]=_0x201c77(0x175);else canvas[_0x201c77(0x122)][_0x201c77(0x15f)]='crosshair';}),wrapper[a0_0x203104(0xbc)](a0_0x203104(0x1b2),_0xe8a7ea=>{const _0x5f5981=a0_0x203104;_0xe8a7ea[_0x5f5981(0x1e5)]();const _0x2bed6a=canvas[_0x5f5981(0xbd)](),_0x59dd89=_0xe8a7ea[_0x5f5981(0x201)],_0x1d859=_0xe8a7ea[_0x5f5981(0x1dc)],_0x5d7f2d=(_0x59dd89-_0x2bed6a[_0x5f5981(0xaf)]-posX)/scale,_0x5daa47=(_0x1d859-_0x2bed6a[_0x5f5981(0x194)]-posY)/scale,_0x27a07c=_0xe8a7ea[_0x5f5981(0x17e)]>0x0?0.9:1.1;let _0x3fa8b5=scale*_0x27a07c;_0x3fa8b5=Math[_0x5f5981(0x154)](Math[_0x5f5981(0x19d)](_0x3fa8b5,0.2),0x5),posX=_0x59dd89-_0x2bed6a[_0x5f5981(0xaf)]-_0x5d7f2d*_0x3fa8b5,posY=_0x1d859-_0x2bed6a[_0x5f5981(0x194)]-_0x5daa47*_0x3fa8b5,scale=_0x3fa8b5,updateTransform();const _0x3a1ef1=document[_0x5f5981(0x18a)]('zoomSlider'),_0x45639d=document[_0x5f5981(0x18a)]('zoomValue');if(_0x3a1ef1)_0x3a1ef1[_0x5f5981(0x168)]=Math[_0x5f5981(0x206)](scale*0x64);if(_0x45639d)_0x45639d[_0x5f5981(0x217)]=Math[_0x5f5981(0x206)](scale*0x64)+'%';},{'passive':![]});function updateTransform(){const _0x2181f5=a0_0x203104;canvas[_0x2181f5(0x122)][_0x2181f5(0xea)]='translate('+posX+_0x2181f5(0x13d)+posY+'px)\x20scale('+scale+')';}function setZoomValue(_0x3a4b11){const _0x2dad9e=a0_0x203104,_0x52777f=Math[_0x2dad9e(0x19d)](0x14,Math[_0x2dad9e(0x154)](0x1f4,parseInt(_0x3a4b11,0xa)||0x64)),_0x355ab9=_0x52777f/0x64;scale=_0x355ab9,updateTransform();const _0x449617=document[_0x2dad9e(0x18a)](_0x2dad9e(0x107)),_0x256124=document[_0x2dad9e(0x18a)](_0x2dad9e(0xf9));if(_0x449617)_0x449617[_0x2dad9e(0x168)]=_0x52777f;if(_0x256124)_0x256124['textContent']=_0x52777f+'%';}function zoomIn(){const _0x13e725=a0_0x203104,_0x345b89=document[_0x13e725(0x18a)](_0x13e725(0x107));let _0x29c7c=_0x345b89?parseInt(_0x345b89[_0x13e725(0x168)],0xa):Math[_0x13e725(0x206)](scale*0x64);_0x29c7c=Math[_0x13e725(0x154)](0x1f4,_0x29c7c+0xa),setZoomValue(_0x29c7c);}function zoomOut(){const _0x6d3bb9=a0_0x203104,_0x2e6797=document[_0x6d3bb9(0x18a)](_0x6d3bb9(0x107));let _0xeee0fa=_0x2e6797?parseInt(_0x2e6797[_0x6d3bb9(0x168)],0xa):Math[_0x6d3bb9(0x206)](scale*0x64);_0xeee0fa=Math[_0x6d3bb9(0x19d)](0x14,_0xeee0fa-0xa),setZoomValue(_0xeee0fa);}const zs=document[a0_0x203104(0x18a)](a0_0x203104(0x107));if(zs)zs[a0_0x203104(0x162)]=_0x23266d=>setZoomValue(_0x23266d[a0_0x203104(0x1cc)][a0_0x203104(0x168)]);const zv=document[a0_0x203104(0x18a)](a0_0x203104(0xf9));if(zv)zv[a0_0x203104(0x217)]=Math[a0_0x203104(0x206)](scale*0x64)+'%';function getCanvasCoords(_0x2f486){const _0x2af3c3=a0_0x203104,_0xf4779d=canvas[_0x2af3c3(0xbd)](),_0x4ec66f=canvas[_0x2af3c3(0xc9)]/_0xf4779d[_0x2af3c3(0xc9)],_0x1e91d4=canvas[_0x2af3c3(0x112)]/_0xf4779d['height'],_0x5c1f7e=(_0x2f486[_0x2af3c3(0x201)]-_0xf4779d[_0x2af3c3(0xaf)])*_0x4ec66f,_0x218d90=(_0x2f486['clientY']-_0xf4779d[_0x2af3c3(0x194)])*_0x1e91d4;return{'x':_0x5c1f7e,'y':_0x218d90};}function handleDrawStart(_0x3f5b6d){const _0xebb078=a0_0x203104,_0xbb0f14=getCanvasCoords(_0x3f5b6d);ctx[_0xebb078(0x1c4)](),ctx['moveTo'](_0xbb0f14['x'],_0xbb0f14['y']);}function handleDrawMove(_0x758cbc){const _0x317536=a0_0x203104,_0x4c14f9=getCanvasCoords(_0x758cbc);ctx[_0x317536(0xbf)](_0x4c14f9['x'],_0x4c14f9['y']),ctx[_0x317536(0xc4)]();}function handleDrawEnd(_0x343ca8){const _0xe5fb5d=a0_0x203104;ctx[_0xe5fb5d(0x106)]();}